const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Macro-GdX9XakF.js","assets/Macro-COwzCFHl.css"])))=>i.map(i=>d[i]);
var FK=Object.defineProperty;var sI=n=>{throw TypeError(n)};var BK=(n,e,t)=>e in n?FK(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var hy=(n,e,t)=>BK(n,typeof e!="symbol"?e+"":e,t),OK=(n,e,t)=>e.has(n)||sI("Cannot "+t);var ei=(n,e,t)=>(OK(n,e,"read from private field"),t?t.call(n):e.get(n)),Cf=(n,e,t)=>e.has(n)?sI("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();var UK=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var R9={exports:{}},SS={},P9={exports:{}},qn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mv=Symbol.for("react.element"),zK=Symbol.for("react.portal"),VK=Symbol.for("react.fragment"),GK=Symbol.for("react.strict_mode"),qK=Symbol.for("react.profiler"),HK=Symbol.for("react.provider"),$K=Symbol.for("react.context"),jK=Symbol.for("react.forward_ref"),WK=Symbol.for("react.suspense"),XK=Symbol.for("react.memo"),YK=Symbol.for("react.lazy"),oI=Symbol.iterator;function QK(n){return n===null||typeof n!="object"?null:(n=oI&&n[oI]||n["@@iterator"],typeof n=="function"?n:null)}var N9={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I9=Object.assign,D9={};function q0(n,e,t){this.props=n,this.context=e,this.refs=D9,this.updater=t||N9}q0.prototype.isReactComponent={};q0.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};q0.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function k9(){}k9.prototype=q0.prototype;function I5(n,e,t){this.props=n,this.context=e,this.refs=D9,this.updater=t||N9}var D5=I5.prototype=new k9;D5.constructor=I5;I9(D5,q0.prototype);D5.isPureReactComponent=!0;var aI=Array.isArray,L9=Object.prototype.hasOwnProperty,k5={current:null},F9={key:!0,ref:!0,__self:!0,__source:!0};function B9(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)L9.call(e,i)&&!F9.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:mv,type:n,key:s,ref:o,props:r,_owner:k5.current}}function KK(n,e){return{$$typeof:mv,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function L5(n){return typeof n=="object"&&n!==null&&n.$$typeof===mv}function ZK(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var lI=/\/+/g;function fE(n,e){return typeof n=="object"&&n!==null&&n.key!=null?ZK(""+n.key):e.toString(36)}function m2(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case mv:case zK:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+fE(o,0):i,aI(r)?(t="",n!=null&&(t=n.replace(lI,"$&/")+"/"),m2(r,e,t,"",function(u){return u})):r!=null&&(L5(r)&&(r=KK(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(lI,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",aI(n))for(var a=0;a<n.length;a++){s=n[a];var l=i+fE(s,a);o+=m2(s,e,t,l,r)}else if(l=QK(n),typeof l=="function")for(n=l.call(n),a=0;!(s=n.next()).done;)s=s.value,l=i+fE(s,a++),o+=m2(s,e,t,l,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function fy(n,e,t){if(n==null)return n;var i=[],r=0;return m2(n,i,"","",function(s){return e.call(t,s,r++)}),i}function JK(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var so={current:null},g2={transition:null},eZ={ReactCurrentDispatcher:so,ReactCurrentBatchConfig:g2,ReactCurrentOwner:k5};function O9(){throw Error("act(...) is not supported in production builds of React.")}qn.Children={map:fy,forEach:function(n,e,t){fy(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return fy(n,function(){e++}),e},toArray:function(n){return fy(n,function(e){return e})||[]},only:function(n){if(!L5(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};qn.Component=q0;qn.Fragment=VK;qn.Profiler=qK;qn.PureComponent=I5;qn.StrictMode=GK;qn.Suspense=WK;qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eZ;qn.act=O9;qn.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=I9({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=k5.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)L9.call(e,l)&&!F9.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:mv,type:n.type,key:r,ref:s,props:i,_owner:o}};qn.createContext=function(n){return n={$$typeof:$K,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:HK,_context:n},n.Consumer=n};qn.createElement=B9;qn.createFactory=function(n){var e=B9.bind(null,n);return e.type=n,e};qn.createRef=function(){return{current:null}};qn.forwardRef=function(n){return{$$typeof:jK,render:n}};qn.isValidElement=L5;qn.lazy=function(n){return{$$typeof:YK,_payload:{_status:-1,_result:n},_init:JK}};qn.memo=function(n,e){return{$$typeof:XK,type:n,compare:e===void 0?null:e}};qn.startTransition=function(n){var e=g2.transition;g2.transition={};try{n()}finally{g2.transition=e}};qn.unstable_act=O9;qn.useCallback=function(n,e){return so.current.useCallback(n,e)};qn.useContext=function(n){return so.current.useContext(n)};qn.useDebugValue=function(){};qn.useDeferredValue=function(n){return so.current.useDeferredValue(n)};qn.useEffect=function(n,e){return so.current.useEffect(n,e)};qn.useId=function(){return so.current.useId()};qn.useImperativeHandle=function(n,e,t){return so.current.useImperativeHandle(n,e,t)};qn.useInsertionEffect=function(n,e){return so.current.useInsertionEffect(n,e)};qn.useLayoutEffect=function(n,e){return so.current.useLayoutEffect(n,e)};qn.useMemo=function(n,e){return so.current.useMemo(n,e)};qn.useReducer=function(n,e,t){return so.current.useReducer(n,e,t)};qn.useRef=function(n){return so.current.useRef(n)};qn.useState=function(n){return so.current.useState(n)};qn.useSyncExternalStore=function(n,e,t){return so.current.useSyncExternalStore(n,e,t)};qn.useTransition=function(){return so.current.useTransition()};qn.version="18.3.1";P9.exports=qn;var de=P9.exports;const _i=G0(de);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tZ=de,nZ=Symbol.for("react.element"),iZ=Symbol.for("react.fragment"),rZ=Object.prototype.hasOwnProperty,sZ=tZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oZ={key:!0,ref:!0,__self:!0,__source:!0};function U9(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)rZ.call(e,i)&&!oZ.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:nZ,type:n,key:s,ref:o,props:r,_owner:sZ.current}}SS.Fragment=iZ;SS.jsx=U9;SS.jsxs=U9;R9.exports=SS;var fe=R9.exports,z9={exports:{}},ca={},V9={exports:{}},G9={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ie,oe){var me=ie.length;ie.push(oe);e:for(;0<me;){var _e=me-1>>>1,Oe=ie[_e];if(0<r(Oe,oe))ie[_e]=oe,ie[me]=Oe,me=_e;else break e}}function t(ie){return ie.length===0?null:ie[0]}function i(ie){if(ie.length===0)return null;var oe=ie[0],me=ie.pop();if(me!==oe){ie[0]=me;e:for(var _e=0,Oe=ie.length,Ke=Oe>>>1;_e<Ke;){var Me=2*(_e+1)-1,ze=ie[Me],nt=Me+1,tt=ie[nt];if(0>r(ze,me))nt<Oe&&0>r(tt,ze)?(ie[_e]=tt,ie[nt]=me,_e=nt):(ie[_e]=ze,ie[Me]=me,_e=Me);else if(nt<Oe&&0>r(tt,me))ie[_e]=tt,ie[nt]=me,_e=nt;else break e}}return oe}function r(ie,oe){var me=ie.sortIndex-oe.sortIndex;return me!==0?me:ie.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,A=3,v=!1,_=!1,S=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ie){for(var oe=t(u);oe!==null;){if(oe.callback===null)i(u);else if(oe.startTime<=ie)i(u),oe.sortIndex=oe.expirationTime,e(l,oe);else break;oe=t(u)}}function N(ie){if(S=!1,R(ie),!_)if(t(l)!==null)_=!0,Z(B);else{var oe=t(u);oe!==null&&ce(N,oe.startTime-ie)}}function B(ie,oe){_=!1,S&&(S=!1,x(F),F=-1),v=!0;var me=A;try{for(R(oe),h=t(l);h!==null&&(!(h.expirationTime>oe)||ie&&!z());){var _e=h.callback;if(typeof _e=="function"){h.callback=null,A=h.priorityLevel;var Oe=_e(h.expirationTime<=oe);oe=n.unstable_now(),typeof Oe=="function"?h.callback=Oe:h===t(l)&&i(l),R(oe)}else i(l);h=t(l)}if(h!==null)var Ke=!0;else{var Me=t(u);Me!==null&&ce(N,Me.startTime-oe),Ke=!1}return Ke}finally{h=null,A=me,v=!1}}var T=!1,D=null,F=-1,L=5,O=-1;function z(){return!(n.unstable_now()-O<L)}function Q(){if(D!==null){var ie=n.unstable_now();O=ie;var oe=!0;try{oe=D(!0,ie)}finally{oe?j():(T=!1,D=null)}}else T=!1}var j;if(typeof M=="function")j=function(){M(Q)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,$=ee.port2;ee.port1.onmessage=Q,j=function(){$.postMessage(null)}}else j=function(){w(Q,0)};function Z(ie){D=ie,T||(T=!0,j())}function ce(ie,oe){F=w(function(){ie(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_continueExecution=function(){_||v||(_=!0,Z(B))},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(ie){switch(A){case 1:case 2:case 3:var oe=3;break;default:oe=A}var me=A;A=oe;try{return ie()}finally{A=me}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ie,oe){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var me=A;A=ie;try{return oe()}finally{A=me}},n.unstable_scheduleCallback=function(ie,oe,me){var _e=n.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?_e+me:_e):me=_e,ie){case 1:var Oe=-1;break;case 2:Oe=250;break;case 5:Oe=1073741823;break;case 4:Oe=1e4;break;default:Oe=5e3}return Oe=me+Oe,ie={id:c++,callback:oe,priorityLevel:ie,startTime:me,expirationTime:Oe,sortIndex:-1},me>_e?(ie.sortIndex=me,e(u,ie),t(l)===null&&ie===t(u)&&(S?(x(F),F=-1):S=!0,ce(N,me-_e))):(ie.sortIndex=Oe,e(l,ie),_||v||(_=!0,Z(B))),ie},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(ie){var oe=A;return function(){var me=A;A=oe;try{return ie.apply(this,arguments)}finally{A=me}}}})(G9);V9.exports=G9;var aZ=V9.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lZ=de,aa=aZ;function lt(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var q9=new Set,r1={};function Qd(n,e){a0(n,e),a0(n+"Capture",e)}function a0(n,e){for(r1[n]=e,n=0;n<e.length;n++)q9.add(e[n])}var ac=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_C=Object.prototype.hasOwnProperty,uZ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uI={},cI={};function cZ(n){return _C.call(cI,n)?!0:_C.call(uI,n)?!1:uZ.test(n)?cI[n]=!0:(uI[n]=!0,!1)}function hZ(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function fZ(n,e,t,i){if(e===null||typeof e>"u"||hZ(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function oo(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var cs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){cs[n]=new oo(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];cs[e]=new oo(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){cs[n]=new oo(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){cs[n]=new oo(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){cs[n]=new oo(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){cs[n]=new oo(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){cs[n]=new oo(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){cs[n]=new oo(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){cs[n]=new oo(n,5,!1,n.toLowerCase(),null,!1,!1)});var F5=/[\-:]([a-z])/g;function B5(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(F5,B5);cs[e]=new oo(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(F5,B5);cs[e]=new oo(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(F5,B5);cs[e]=new oo(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){cs[n]=new oo(n,1,!1,n.toLowerCase(),null,!1,!1)});cs.xlinkHref=new oo("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){cs[n]=new oo(n,1,!1,n.toLowerCase(),null,!0,!0)});function O5(n,e,t,i){var r=cs.hasOwnProperty(e)?cs[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fZ(e,t,r,i)&&(t=null),i||r===null?cZ(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var wc=lZ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dy=Symbol.for("react.element"),oA=Symbol.for("react.portal"),aA=Symbol.for("react.fragment"),U5=Symbol.for("react.strict_mode"),xC=Symbol.for("react.profiler"),H9=Symbol.for("react.provider"),$9=Symbol.for("react.context"),z5=Symbol.for("react.forward_ref"),bC=Symbol.for("react.suspense"),SC=Symbol.for("react.suspense_list"),V5=Symbol.for("react.memo"),oh=Symbol.for("react.lazy"),j9=Symbol.for("react.offscreen"),hI=Symbol.iterator;function wm(n){return n===null||typeof n!="object"?null:(n=hI&&n[hI]||n["@@iterator"],typeof n=="function"?n:null)}var lr=Object.assign,dE;function ug(n){if(dE===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);dE=e&&e[1]||""}return`
`+dE+n}var pE=!1;function AE(n,e){if(!n||pE)return"";pE=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{pE=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?ug(n):""}function dZ(n){switch(n.tag){case 5:return ug(n.type);case 16:return ug("Lazy");case 13:return ug("Suspense");case 19:return ug("SuspenseList");case 0:case 2:case 15:return n=AE(n.type,!1),n;case 11:return n=AE(n.type.render,!1),n;case 1:return n=AE(n.type,!0),n;default:return""}}function wC(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case aA:return"Fragment";case oA:return"Portal";case xC:return"Profiler";case U5:return"StrictMode";case bC:return"Suspense";case SC:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case $9:return(n.displayName||"Context")+".Consumer";case H9:return(n._context.displayName||"Context")+".Provider";case z5:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case V5:return e=n.displayName||null,e!==null?e:wC(n.type)||"Memo";case oh:e=n._payload,n=n._init;try{return wC(n(e))}catch{}}return null}function pZ(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wC(e);case 8:return e===U5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wh(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function W9(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AZ(n){var e=W9(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function py(n){n._valueTracker||(n._valueTracker=AZ(n))}function X9(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=W9(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function ax(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function EC(n,e){var t=e.checked;return lr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function fI(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Wh(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Y9(n,e){e=e.checked,e!=null&&O5(n,"checked",e,!1)}function TC(n,e){Y9(n,e);var t=Wh(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?CC(n,e.type,t):e.hasOwnProperty("defaultValue")&&CC(n,e.type,Wh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function dI(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function CC(n,e,t){(e!=="number"||ax(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var cg=Array.isArray;function BA(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Wh(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function MC(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(lt(91));return lr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function pI(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(lt(92));if(cg(t)){if(1<t.length)throw Error(lt(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Wh(t)}}function Q9(n,e){var t=Wh(e.value),i=Wh(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function AI(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function K9(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function RC(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?K9(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ay,Z9=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Ay=Ay||document.createElement("div"),Ay.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ay.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function s1(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Tg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mZ=["Webkit","ms","Moz","O"];Object.keys(Tg).forEach(function(n){mZ.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Tg[e]=Tg[n]})});function J9(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Tg.hasOwnProperty(n)&&Tg[n]?(""+e).trim():e+"px"}function eU(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=J9(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var gZ=lr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function PC(n,e){if(e){if(gZ[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(lt(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(lt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(lt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(lt(62))}}function NC(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var IC=null;function G5(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var DC=null,OA=null,UA=null;function mI(n){if(n=yv(n)){if(typeof DC!="function")throw Error(lt(280));var e=n.stateNode;e&&(e=MS(e),DC(n.stateNode,n.type,e))}}function tU(n){OA?UA?UA.push(n):UA=[n]:OA=n}function nU(){if(OA){var n=OA,e=UA;if(UA=OA=null,mI(n),e)for(n=0;n<e.length;n++)mI(e[n])}}function iU(n,e){return n(e)}function rU(){}var mE=!1;function sU(n,e,t){if(mE)return n(e,t);mE=!0;try{return iU(n,e,t)}finally{mE=!1,(OA!==null||UA!==null)&&(rU(),nU())}}function o1(n,e){var t=n.stateNode;if(t===null)return null;var i=MS(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(lt(231,e,typeof t));return t}var kC=!1;if(ac)try{var Em={};Object.defineProperty(Em,"passive",{get:function(){kC=!0}}),window.addEventListener("test",Em,Em),window.removeEventListener("test",Em,Em)}catch{kC=!1}function vZ(n,e,t,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var Cg=!1,lx=null,ux=!1,LC=null,yZ={onError:function(n){Cg=!0,lx=n}};function _Z(n,e,t,i,r,s,o,a,l){Cg=!1,lx=null,vZ.apply(yZ,arguments)}function xZ(n,e,t,i,r,s,o,a,l){if(_Z.apply(this,arguments),Cg){if(Cg){var u=lx;Cg=!1,lx=null}else throw Error(lt(198));ux||(ux=!0,LC=u)}}function Kd(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function oU(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function gI(n){if(Kd(n)!==n)throw Error(lt(188))}function bZ(n){var e=n.alternate;if(!e){if(e=Kd(n),e===null)throw Error(lt(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return gI(r),n;if(s===i)return gI(r),e;s=s.sibling}throw Error(lt(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(lt(189))}}if(t.alternate!==i)throw Error(lt(190))}if(t.tag!==3)throw Error(lt(188));return t.stateNode.current===t?n:e}function aU(n){return n=bZ(n),n!==null?lU(n):null}function lU(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=lU(n);if(e!==null)return e;n=n.sibling}return null}var uU=aa.unstable_scheduleCallback,vI=aa.unstable_cancelCallback,SZ=aa.unstable_shouldYield,wZ=aa.unstable_requestPaint,vr=aa.unstable_now,EZ=aa.unstable_getCurrentPriorityLevel,q5=aa.unstable_ImmediatePriority,cU=aa.unstable_UserBlockingPriority,cx=aa.unstable_NormalPriority,TZ=aa.unstable_LowPriority,hU=aa.unstable_IdlePriority,wS=null,Yl=null;function CZ(n){if(Yl&&typeof Yl.onCommitFiberRoot=="function")try{Yl.onCommitFiberRoot(wS,n,void 0,(n.current.flags&128)===128)}catch{}}var yl=Math.clz32?Math.clz32:PZ,MZ=Math.log,RZ=Math.LN2;function PZ(n){return n>>>=0,n===0?32:31-(MZ(n)/RZ|0)|0}var my=64,gy=4194304;function hg(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function hx(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=hg(a):(s&=o,s!==0&&(i=hg(s)))}else o=t&~r,o!==0?i=hg(o):s!==0&&(i=hg(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-yl(e),r=1<<t,i|=n[t],e&=~r;return i}function NZ(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IZ(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-yl(s),a=1<<o,l=r[o];l===-1?(!(a&t)||a&i)&&(r[o]=NZ(a,e)):l<=e&&(n.expiredLanes|=a),s&=~a}}function FC(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function fU(){var n=my;return my<<=1,!(my&4194240)&&(my=64),n}function gE(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function gv(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-yl(e),n[e]=t}function DZ(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-yl(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function H5(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-yl(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var xi=0;function dU(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var pU,$5,AU,mU,gU,BC=!1,vy=[],Mh=null,Rh=null,Ph=null,a1=new Map,l1=new Map,dh=[],kZ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yI(n,e){switch(n){case"focusin":case"focusout":Mh=null;break;case"dragenter":case"dragleave":Rh=null;break;case"mouseover":case"mouseout":Ph=null;break;case"pointerover":case"pointerout":a1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":l1.delete(e.pointerId)}}function Tm(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=yv(e),e!==null&&$5(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function LZ(n,e,t,i,r){switch(e){case"focusin":return Mh=Tm(Mh,n,e,t,i,r),!0;case"dragenter":return Rh=Tm(Rh,n,e,t,i,r),!0;case"mouseover":return Ph=Tm(Ph,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return a1.set(s,Tm(a1.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,l1.set(s,Tm(l1.get(s)||null,n,e,t,i,r)),!0}return!1}function vU(n){var e=od(n.target);if(e!==null){var t=Kd(e);if(t!==null){if(e=t.tag,e===13){if(e=oU(t),e!==null){n.blockedOn=e,gU(n.priority,function(){AU(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function v2(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=OC(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);IC=i,t.target.dispatchEvent(i),IC=null}else return e=yv(t),e!==null&&$5(e),n.blockedOn=t,!1;e.shift()}return!0}function _I(n,e,t){v2(n)&&t.delete(e)}function FZ(){BC=!1,Mh!==null&&v2(Mh)&&(Mh=null),Rh!==null&&v2(Rh)&&(Rh=null),Ph!==null&&v2(Ph)&&(Ph=null),a1.forEach(_I),l1.forEach(_I)}function Cm(n,e){n.blockedOn===e&&(n.blockedOn=null,BC||(BC=!0,aa.unstable_scheduleCallback(aa.unstable_NormalPriority,FZ)))}function u1(n){function e(r){return Cm(r,n)}if(0<vy.length){Cm(vy[0],n);for(var t=1;t<vy.length;t++){var i=vy[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Mh!==null&&Cm(Mh,n),Rh!==null&&Cm(Rh,n),Ph!==null&&Cm(Ph,n),a1.forEach(e),l1.forEach(e),t=0;t<dh.length;t++)i=dh[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<dh.length&&(t=dh[0],t.blockedOn===null);)vU(t),t.blockedOn===null&&dh.shift()}var zA=wc.ReactCurrentBatchConfig,fx=!0;function BZ(n,e,t,i){var r=xi,s=zA.transition;zA.transition=null;try{xi=1,j5(n,e,t,i)}finally{xi=r,zA.transition=s}}function OZ(n,e,t,i){var r=xi,s=zA.transition;zA.transition=null;try{xi=4,j5(n,e,t,i)}finally{xi=r,zA.transition=s}}function j5(n,e,t,i){if(fx){var r=OC(n,e,t,i);if(r===null)CE(n,e,i,dx,t),yI(n,i);else if(LZ(r,n,e,t,i))i.stopPropagation();else if(yI(n,i),e&4&&-1<kZ.indexOf(n)){for(;r!==null;){var s=yv(r);if(s!==null&&pU(s),s=OC(n,e,t,i),s===null&&CE(n,e,i,dx,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else CE(n,e,i,null,t)}}var dx=null;function OC(n,e,t,i){if(dx=null,n=G5(i),n=od(n),n!==null)if(e=Kd(n),e===null)n=null;else if(t=e.tag,t===13){if(n=oU(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return dx=n,null}function yU(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(EZ()){case q5:return 1;case cU:return 4;case cx:case TZ:return 16;case hU:return 536870912;default:return 16}default:return 16}}var wh=null,W5=null,y2=null;function _U(){if(y2)return y2;var n,e=W5,t=e.length,i,r="value"in wh?wh.value:wh.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return y2=r.slice(n,1<i?1-i:void 0)}function _2(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function yy(){return!0}function xI(){return!1}function ha(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?yy:xI,this.isPropagationStopped=xI,this}return lr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=yy)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=yy)},persist:function(){},isPersistent:yy}),e}var H0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},X5=ha(H0),vv=lr({},H0,{view:0,detail:0}),UZ=ha(vv),vE,yE,Mm,ES=lr({},vv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Y5,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Mm&&(Mm&&n.type==="mousemove"?(vE=n.screenX-Mm.screenX,yE=n.screenY-Mm.screenY):yE=vE=0,Mm=n),vE)},movementY:function(n){return"movementY"in n?n.movementY:yE}}),bI=ha(ES),zZ=lr({},ES,{dataTransfer:0}),VZ=ha(zZ),GZ=lr({},vv,{relatedTarget:0}),_E=ha(GZ),qZ=lr({},H0,{animationName:0,elapsedTime:0,pseudoElement:0}),HZ=ha(qZ),$Z=lr({},H0,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),jZ=ha($Z),WZ=lr({},H0,{data:0}),SI=ha(WZ),XZ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},YZ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QZ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KZ(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=QZ[n])?!!e[n]:!1}function Y5(){return KZ}var ZZ=lr({},vv,{key:function(n){if(n.key){var e=XZ[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=_2(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?YZ[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Y5,charCode:function(n){return n.type==="keypress"?_2(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?_2(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),JZ=ha(ZZ),eJ=lr({},ES,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wI=ha(eJ),tJ=lr({},vv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Y5}),nJ=ha(tJ),iJ=lr({},H0,{propertyName:0,elapsedTime:0,pseudoElement:0}),rJ=ha(iJ),sJ=lr({},ES,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),oJ=ha(sJ),aJ=[9,13,27,32],Q5=ac&&"CompositionEvent"in window,Mg=null;ac&&"documentMode"in document&&(Mg=document.documentMode);var lJ=ac&&"TextEvent"in window&&!Mg,xU=ac&&(!Q5||Mg&&8<Mg&&11>=Mg),EI=" ",TI=!1;function bU(n,e){switch(n){case"keyup":return aJ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function SU(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var lA=!1;function uJ(n,e){switch(n){case"compositionend":return SU(e);case"keypress":return e.which!==32?null:(TI=!0,EI);case"textInput":return n=e.data,n===EI&&TI?null:n;default:return null}}function cJ(n,e){if(lA)return n==="compositionend"||!Q5&&bU(n,e)?(n=_U(),y2=W5=wh=null,lA=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xU&&e.locale!=="ko"?null:e.data;default:return null}}var hJ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function CI(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!hJ[n.type]:e==="textarea"}function wU(n,e,t,i){tU(i),e=px(e,"onChange"),0<e.length&&(t=new X5("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var Rg=null,c1=null;function fJ(n){LU(n,0)}function TS(n){var e=hA(n);if(X9(e))return n}function dJ(n,e){if(n==="change")return e}var EU=!1;if(ac){var xE;if(ac){var bE="oninput"in document;if(!bE){var MI=document.createElement("div");MI.setAttribute("oninput","return;"),bE=typeof MI.oninput=="function"}xE=bE}else xE=!1;EU=xE&&(!document.documentMode||9<document.documentMode)}function RI(){Rg&&(Rg.detachEvent("onpropertychange",TU),c1=Rg=null)}function TU(n){if(n.propertyName==="value"&&TS(c1)){var e=[];wU(e,c1,n,G5(n)),sU(fJ,e)}}function pJ(n,e,t){n==="focusin"?(RI(),Rg=e,c1=t,Rg.attachEvent("onpropertychange",TU)):n==="focusout"&&RI()}function AJ(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return TS(c1)}function mJ(n,e){if(n==="click")return TS(e)}function gJ(n,e){if(n==="input"||n==="change")return TS(e)}function vJ(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Sl=typeof Object.is=="function"?Object.is:vJ;function h1(n,e){if(Sl(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!_C.call(e,r)||!Sl(n[r],e[r]))return!1}return!0}function PI(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function NI(n,e){var t=PI(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=PI(t)}}function CU(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?CU(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function MU(){for(var n=window,e=ax();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=ax(n.document)}return e}function K5(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function yJ(n){var e=MU(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&CU(t.ownerDocument.documentElement,t)){if(i!==null&&K5(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=NI(t,s);var o=NI(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var _J=ac&&"documentMode"in document&&11>=document.documentMode,uA=null,UC=null,Pg=null,zC=!1;function II(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;zC||uA==null||uA!==ax(i)||(i=uA,"selectionStart"in i&&K5(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Pg&&h1(Pg,i)||(Pg=i,i=px(UC,"onSelect"),0<i.length&&(e=new X5("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=uA)))}function _y(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var cA={animationend:_y("Animation","AnimationEnd"),animationiteration:_y("Animation","AnimationIteration"),animationstart:_y("Animation","AnimationStart"),transitionend:_y("Transition","TransitionEnd")},SE={},RU={};ac&&(RU=document.createElement("div").style,"AnimationEvent"in window||(delete cA.animationend.animation,delete cA.animationiteration.animation,delete cA.animationstart.animation),"TransitionEvent"in window||delete cA.transitionend.transition);function CS(n){if(SE[n])return SE[n];if(!cA[n])return n;var e=cA[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in RU)return SE[n]=e[t];return n}var PU=CS("animationend"),NU=CS("animationiteration"),IU=CS("animationstart"),DU=CS("transitionend"),kU=new Map,DI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function uf(n,e){kU.set(n,e),Qd(e,[n])}for(var wE=0;wE<DI.length;wE++){var EE=DI[wE],xJ=EE.toLowerCase(),bJ=EE[0].toUpperCase()+EE.slice(1);uf(xJ,"on"+bJ)}uf(PU,"onAnimationEnd");uf(NU,"onAnimationIteration");uf(IU,"onAnimationStart");uf("dblclick","onDoubleClick");uf("focusin","onFocus");uf("focusout","onBlur");uf(DU,"onTransitionEnd");a0("onMouseEnter",["mouseout","mouseover"]);a0("onMouseLeave",["mouseout","mouseover"]);a0("onPointerEnter",["pointerout","pointerover"]);a0("onPointerLeave",["pointerout","pointerover"]);Qd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SJ=new Set("cancel close invalid load scroll toggle".split(" ").concat(fg));function kI(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,xZ(i,e,void 0,n),n.currentTarget=null}function LU(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;kI(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;kI(r,a,u),s=l}}}if(ux)throw n=LC,ux=!1,LC=null,n}function Li(n,e){var t=e[$C];t===void 0&&(t=e[$C]=new Set);var i=n+"__bubble";t.has(i)||(FU(e,n,2,!1),t.add(i))}function TE(n,e,t){var i=0;e&&(i|=4),FU(t,n,i,e)}var xy="_reactListening"+Math.random().toString(36).slice(2);function f1(n){if(!n[xy]){n[xy]=!0,q9.forEach(function(t){t!=="selectionchange"&&(SJ.has(t)||TE(t,!1,n),TE(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[xy]||(e[xy]=!0,TE("selectionchange",!1,e))}}function FU(n,e,t,i){switch(yU(e)){case 1:var r=BZ;break;case 4:r=OZ;break;default:r=j5}t=r.bind(null,e,t,n),r=void 0,!kC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function CE(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=od(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}sU(function(){var u=s,c=G5(t),h=[];e:{var A=kU.get(n);if(A!==void 0){var v=X5,_=n;switch(n){case"keypress":if(_2(t)===0)break e;case"keydown":case"keyup":v=JZ;break;case"focusin":_="focus",v=_E;break;case"focusout":_="blur",v=_E;break;case"beforeblur":case"afterblur":v=_E;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=bI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=VZ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=nJ;break;case PU:case NU:case IU:v=HZ;break;case DU:v=rJ;break;case"scroll":v=UZ;break;case"wheel":v=oJ;break;case"copy":case"cut":case"paste":v=jZ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=wI}var S=(e&4)!==0,w=!S&&n==="scroll",x=S?A!==null?A+"Capture":null:A;S=[];for(var M=u,R;M!==null;){R=M;var N=R.stateNode;if(R.tag===5&&N!==null&&(R=N,x!==null&&(N=o1(M,x),N!=null&&S.push(d1(M,N,R)))),w)break;M=M.return}0<S.length&&(A=new v(A,_,null,t,c),h.push({event:A,listeners:S}))}}if(!(e&7)){e:{if(A=n==="mouseover"||n==="pointerover",v=n==="mouseout"||n==="pointerout",A&&t!==IC&&(_=t.relatedTarget||t.fromElement)&&(od(_)||_[lc]))break e;if((v||A)&&(A=c.window===c?c:(A=c.ownerDocument)?A.defaultView||A.parentWindow:window,v?(_=t.relatedTarget||t.toElement,v=u,_=_?od(_):null,_!==null&&(w=Kd(_),_!==w||_.tag!==5&&_.tag!==6)&&(_=null)):(v=null,_=u),v!==_)){if(S=bI,N="onMouseLeave",x="onMouseEnter",M="mouse",(n==="pointerout"||n==="pointerover")&&(S=wI,N="onPointerLeave",x="onPointerEnter",M="pointer"),w=v==null?A:hA(v),R=_==null?A:hA(_),A=new S(N,M+"leave",v,t,c),A.target=w,A.relatedTarget=R,N=null,od(c)===u&&(S=new S(x,M+"enter",_,t,c),S.target=R,S.relatedTarget=w,N=S),w=N,v&&_)t:{for(S=v,x=_,M=0,R=S;R;R=Ap(R))M++;for(R=0,N=x;N;N=Ap(N))R++;for(;0<M-R;)S=Ap(S),M--;for(;0<R-M;)x=Ap(x),R--;for(;M--;){if(S===x||x!==null&&S===x.alternate)break t;S=Ap(S),x=Ap(x)}S=null}else S=null;v!==null&&LI(h,A,v,S,!1),_!==null&&w!==null&&LI(h,w,_,S,!0)}}e:{if(A=u?hA(u):window,v=A.nodeName&&A.nodeName.toLowerCase(),v==="select"||v==="input"&&A.type==="file")var B=dJ;else if(CI(A))if(EU)B=gJ;else{B=AJ;var T=pJ}else(v=A.nodeName)&&v.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(B=mJ);if(B&&(B=B(n,u))){wU(h,B,t,c);break e}T&&T(n,A,u),n==="focusout"&&(T=A._wrapperState)&&T.controlled&&A.type==="number"&&CC(A,"number",A.value)}switch(T=u?hA(u):window,n){case"focusin":(CI(T)||T.contentEditable==="true")&&(uA=T,UC=u,Pg=null);break;case"focusout":Pg=UC=uA=null;break;case"mousedown":zC=!0;break;case"contextmenu":case"mouseup":case"dragend":zC=!1,II(h,t,c);break;case"selectionchange":if(_J)break;case"keydown":case"keyup":II(h,t,c)}var D;if(Q5)e:{switch(n){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else lA?bU(n,t)&&(F="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(F="onCompositionStart");F&&(xU&&t.locale!=="ko"&&(lA||F!=="onCompositionStart"?F==="onCompositionEnd"&&lA&&(D=_U()):(wh=c,W5="value"in wh?wh.value:wh.textContent,lA=!0)),T=px(u,F),0<T.length&&(F=new SI(F,n,null,t,c),h.push({event:F,listeners:T}),D?F.data=D:(D=SU(t),D!==null&&(F.data=D)))),(D=lJ?uJ(n,t):cJ(n,t))&&(u=px(u,"onBeforeInput"),0<u.length&&(c=new SI("onBeforeInput","beforeinput",null,t,c),h.push({event:c,listeners:u}),c.data=D))}LU(h,e)})}function d1(n,e,t){return{instance:n,listener:e,currentTarget:t}}function px(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=o1(n,t),s!=null&&i.unshift(d1(n,s,r)),s=o1(n,e),s!=null&&i.push(d1(n,s,r))),n=n.return}return i}function Ap(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function LI(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=o1(t,s),l!=null&&o.unshift(d1(t,l,a))):r||(l=o1(t,s),l!=null&&o.push(d1(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var wJ=/\r\n?/g,EJ=/\u0000|\uFFFD/g;function FI(n){return(typeof n=="string"?n:""+n).replace(wJ,`
`).replace(EJ,"")}function by(n,e,t){if(e=FI(e),FI(n)!==e&&t)throw Error(lt(425))}function Ax(){}var VC=null,GC=null;function qC(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var HC=typeof setTimeout=="function"?setTimeout:void 0,TJ=typeof clearTimeout=="function"?clearTimeout:void 0,BI=typeof Promise=="function"?Promise:void 0,CJ=typeof queueMicrotask=="function"?queueMicrotask:typeof BI<"u"?function(n){return BI.resolve(null).then(n).catch(MJ)}:HC;function MJ(n){setTimeout(function(){throw n})}function ME(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),u1(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);u1(e)}function Nh(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function OI(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var $0=Math.random().toString(36).slice(2),Gl="__reactFiber$"+$0,p1="__reactProps$"+$0,lc="__reactContainer$"+$0,$C="__reactEvents$"+$0,RJ="__reactListeners$"+$0,PJ="__reactHandles$"+$0;function od(n){var e=n[Gl];if(e)return e;for(var t=n.parentNode;t;){if(e=t[lc]||t[Gl]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=OI(n);n!==null;){if(t=n[Gl])return t;n=OI(n)}return e}n=t,t=n.parentNode}return null}function yv(n){return n=n[Gl]||n[lc],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function hA(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(lt(33))}function MS(n){return n[p1]||null}var jC=[],fA=-1;function cf(n){return{current:n}}function zi(n){0>fA||(n.current=jC[fA],jC[fA]=null,fA--)}function Di(n,e){fA++,jC[fA]=n.current,n.current=e}var Xh={},ks=cf(Xh),Ro=cf(!1),Td=Xh;function l0(n,e){var t=n.type.contextTypes;if(!t)return Xh;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Po(n){return n=n.childContextTypes,n!=null}function mx(){zi(Ro),zi(ks)}function UI(n,e,t){if(ks.current!==Xh)throw Error(lt(168));Di(ks,e),Di(Ro,t)}function BU(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(lt(108,pZ(n)||"Unknown",r));return lr({},t,i)}function gx(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Xh,Td=ks.current,Di(ks,n),Di(Ro,Ro.current),!0}function zI(n,e,t){var i=n.stateNode;if(!i)throw Error(lt(169));t?(n=BU(n,e,Td),i.__reactInternalMemoizedMergedChildContext=n,zi(Ro),zi(ks),Di(ks,n)):zi(Ro),Di(Ro,t)}var Du=null,RS=!1,RE=!1;function OU(n){Du===null?Du=[n]:Du.push(n)}function NJ(n){RS=!0,OU(n)}function hf(){if(!RE&&Du!==null){RE=!0;var n=0,e=xi;try{var t=Du;for(xi=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Du=null,RS=!1}catch(r){throw Du!==null&&(Du=Du.slice(n+1)),uU(q5,hf),r}finally{xi=e,RE=!1}}return null}var dA=[],pA=0,vx=null,yx=0,wa=[],Ea=0,Cd=null,Uu=1,zu="";function zf(n,e){dA[pA++]=yx,dA[pA++]=vx,vx=n,yx=e}function UU(n,e,t){wa[Ea++]=Uu,wa[Ea++]=zu,wa[Ea++]=Cd,Cd=n;var i=Uu;n=zu;var r=32-yl(i)-1;i&=~(1<<r),t+=1;var s=32-yl(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Uu=1<<32-yl(e)+r|t<<r|i,zu=s+n}else Uu=1<<s|t<<r|i,zu=n}function Z5(n){n.return!==null&&(zf(n,1),UU(n,1,0))}function J5(n){for(;n===vx;)vx=dA[--pA],dA[pA]=null,yx=dA[--pA],dA[pA]=null;for(;n===Cd;)Cd=wa[--Ea],wa[Ea]=null,zu=wa[--Ea],wa[Ea]=null,Uu=wa[--Ea],wa[Ea]=null}var ra=null,ia=null,qi=!1,ol=null;function zU(n,e){var t=Na(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function VI(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ra=n,ia=Nh(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ra=n,ia=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Cd!==null?{id:Uu,overflow:zu}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Na(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,ra=n,ia=null,!0):!1;default:return!1}}function WC(n){return(n.mode&1)!==0&&(n.flags&128)===0}function XC(n){if(qi){var e=ia;if(e){var t=e;if(!VI(n,e)){if(WC(n))throw Error(lt(418));e=Nh(t.nextSibling);var i=ra;e&&VI(n,e)?zU(i,t):(n.flags=n.flags&-4097|2,qi=!1,ra=n)}}else{if(WC(n))throw Error(lt(418));n.flags=n.flags&-4097|2,qi=!1,ra=n}}}function GI(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ra=n}function Sy(n){if(n!==ra)return!1;if(!qi)return GI(n),qi=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!qC(n.type,n.memoizedProps)),e&&(e=ia)){if(WC(n))throw VU(),Error(lt(418));for(;e;)zU(n,e),e=Nh(e.nextSibling)}if(GI(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(lt(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ia=Nh(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ia=null}}else ia=ra?Nh(n.stateNode.nextSibling):null;return!0}function VU(){for(var n=ia;n;)n=Nh(n.nextSibling)}function u0(){ia=ra=null,qi=!1}function eP(n){ol===null?ol=[n]:ol.push(n)}var IJ=wc.ReactCurrentBatchConfig;function Rm(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(lt(309));var i=t.stateNode}if(!i)throw Error(lt(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(lt(284));if(!t._owner)throw Error(lt(290,n))}return n}function wy(n,e){throw n=Object.prototype.toString.call(e),Error(lt(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function qI(n){var e=n._init;return e(n._payload)}function GU(n){function e(x,M){if(n){var R=x.deletions;R===null?(x.deletions=[M],x.flags|=16):R.push(M)}}function t(x,M){if(!n)return null;for(;M!==null;)e(x,M),M=M.sibling;return null}function i(x,M){for(x=new Map;M!==null;)M.key!==null?x.set(M.key,M):x.set(M.index,M),M=M.sibling;return x}function r(x,M){return x=Lh(x,M),x.index=0,x.sibling=null,x}function s(x,M,R){return x.index=R,n?(R=x.alternate,R!==null?(R=R.index,R<M?(x.flags|=2,M):R):(x.flags|=2,M)):(x.flags|=1048576,M)}function o(x){return n&&x.alternate===null&&(x.flags|=2),x}function a(x,M,R,N){return M===null||M.tag!==6?(M=FE(R,x.mode,N),M.return=x,M):(M=r(M,R),M.return=x,M)}function l(x,M,R,N){var B=R.type;return B===aA?c(x,M,R.props.children,N,R.key):M!==null&&(M.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===oh&&qI(B)===M.type)?(N=r(M,R.props),N.ref=Rm(x,M,R),N.return=x,N):(N=C2(R.type,R.key,R.props,null,x.mode,N),N.ref=Rm(x,M,R),N.return=x,N)}function u(x,M,R,N){return M===null||M.tag!==4||M.stateNode.containerInfo!==R.containerInfo||M.stateNode.implementation!==R.implementation?(M=BE(R,x.mode,N),M.return=x,M):(M=r(M,R.children||[]),M.return=x,M)}function c(x,M,R,N,B){return M===null||M.tag!==7?(M=xd(R,x.mode,N,B),M.return=x,M):(M=r(M,R),M.return=x,M)}function h(x,M,R){if(typeof M=="string"&&M!==""||typeof M=="number")return M=FE(""+M,x.mode,R),M.return=x,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case dy:return R=C2(M.type,M.key,M.props,null,x.mode,R),R.ref=Rm(x,null,M),R.return=x,R;case oA:return M=BE(M,x.mode,R),M.return=x,M;case oh:var N=M._init;return h(x,N(M._payload),R)}if(cg(M)||wm(M))return M=xd(M,x.mode,R,null),M.return=x,M;wy(x,M)}return null}function A(x,M,R,N){var B=M!==null?M.key:null;if(typeof R=="string"&&R!==""||typeof R=="number")return B!==null?null:a(x,M,""+R,N);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case dy:return R.key===B?l(x,M,R,N):null;case oA:return R.key===B?u(x,M,R,N):null;case oh:return B=R._init,A(x,M,B(R._payload),N)}if(cg(R)||wm(R))return B!==null?null:c(x,M,R,N,null);wy(x,R)}return null}function v(x,M,R,N,B){if(typeof N=="string"&&N!==""||typeof N=="number")return x=x.get(R)||null,a(M,x,""+N,B);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case dy:return x=x.get(N.key===null?R:N.key)||null,l(M,x,N,B);case oA:return x=x.get(N.key===null?R:N.key)||null,u(M,x,N,B);case oh:var T=N._init;return v(x,M,R,T(N._payload),B)}if(cg(N)||wm(N))return x=x.get(R)||null,c(M,x,N,B,null);wy(M,N)}return null}function _(x,M,R,N){for(var B=null,T=null,D=M,F=M=0,L=null;D!==null&&F<R.length;F++){D.index>F?(L=D,D=null):L=D.sibling;var O=A(x,D,R[F],N);if(O===null){D===null&&(D=L);break}n&&D&&O.alternate===null&&e(x,D),M=s(O,M,F),T===null?B=O:T.sibling=O,T=O,D=L}if(F===R.length)return t(x,D),qi&&zf(x,F),B;if(D===null){for(;F<R.length;F++)D=h(x,R[F],N),D!==null&&(M=s(D,M,F),T===null?B=D:T.sibling=D,T=D);return qi&&zf(x,F),B}for(D=i(x,D);F<R.length;F++)L=v(D,x,F,R[F],N),L!==null&&(n&&L.alternate!==null&&D.delete(L.key===null?F:L.key),M=s(L,M,F),T===null?B=L:T.sibling=L,T=L);return n&&D.forEach(function(z){return e(x,z)}),qi&&zf(x,F),B}function S(x,M,R,N){var B=wm(R);if(typeof B!="function")throw Error(lt(150));if(R=B.call(R),R==null)throw Error(lt(151));for(var T=B=null,D=M,F=M=0,L=null,O=R.next();D!==null&&!O.done;F++,O=R.next()){D.index>F?(L=D,D=null):L=D.sibling;var z=A(x,D,O.value,N);if(z===null){D===null&&(D=L);break}n&&D&&z.alternate===null&&e(x,D),M=s(z,M,F),T===null?B=z:T.sibling=z,T=z,D=L}if(O.done)return t(x,D),qi&&zf(x,F),B;if(D===null){for(;!O.done;F++,O=R.next())O=h(x,O.value,N),O!==null&&(M=s(O,M,F),T===null?B=O:T.sibling=O,T=O);return qi&&zf(x,F),B}for(D=i(x,D);!O.done;F++,O=R.next())O=v(D,x,F,O.value,N),O!==null&&(n&&O.alternate!==null&&D.delete(O.key===null?F:O.key),M=s(O,M,F),T===null?B=O:T.sibling=O,T=O);return n&&D.forEach(function(Q){return e(x,Q)}),qi&&zf(x,F),B}function w(x,M,R,N){if(typeof R=="object"&&R!==null&&R.type===aA&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case dy:e:{for(var B=R.key,T=M;T!==null;){if(T.key===B){if(B=R.type,B===aA){if(T.tag===7){t(x,T.sibling),M=r(T,R.props.children),M.return=x,x=M;break e}}else if(T.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===oh&&qI(B)===T.type){t(x,T.sibling),M=r(T,R.props),M.ref=Rm(x,T,R),M.return=x,x=M;break e}t(x,T);break}else e(x,T);T=T.sibling}R.type===aA?(M=xd(R.props.children,x.mode,N,R.key),M.return=x,x=M):(N=C2(R.type,R.key,R.props,null,x.mode,N),N.ref=Rm(x,M,R),N.return=x,x=N)}return o(x);case oA:e:{for(T=R.key;M!==null;){if(M.key===T)if(M.tag===4&&M.stateNode.containerInfo===R.containerInfo&&M.stateNode.implementation===R.implementation){t(x,M.sibling),M=r(M,R.children||[]),M.return=x,x=M;break e}else{t(x,M);break}else e(x,M);M=M.sibling}M=BE(R,x.mode,N),M.return=x,x=M}return o(x);case oh:return T=R._init,w(x,M,T(R._payload),N)}if(cg(R))return _(x,M,R,N);if(wm(R))return S(x,M,R,N);wy(x,R)}return typeof R=="string"&&R!==""||typeof R=="number"?(R=""+R,M!==null&&M.tag===6?(t(x,M.sibling),M=r(M,R),M.return=x,x=M):(t(x,M),M=FE(R,x.mode,N),M.return=x,x=M),o(x)):t(x,M)}return w}var c0=GU(!0),qU=GU(!1),_x=cf(null),xx=null,AA=null,tP=null;function nP(){tP=AA=xx=null}function iP(n){var e=_x.current;zi(_x),n._currentValue=e}function YC(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function VA(n,e){xx=n,tP=AA=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(So=!0),n.firstContext=null)}function Ba(n){var e=n._currentValue;if(tP!==n)if(n={context:n,memoizedValue:e,next:null},AA===null){if(xx===null)throw Error(lt(308));AA=n,xx.dependencies={lanes:0,firstContext:n}}else AA=AA.next=n;return e}var ad=null;function rP(n){ad===null?ad=[n]:ad.push(n)}function HU(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,rP(e)):(t.next=r.next,r.next=t),e.interleaved=t,uc(n,i)}function uc(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ah=!1;function sP(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $U(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Wu(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ih(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,ri&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,uc(n,t)}return r=i.interleaved,r===null?(e.next=e,rP(i)):(e.next=r.next,r.next=e),i.interleaved=e,uc(n,t)}function x2(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,H5(n,t)}}function HI(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function bx(n,e,t,i){var r=n.updateQueue;ah=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=n.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;o=0,c=u=l=null,a=s;do{var A=a.lane,v=a.eventTime;if((i&A)===A){c!==null&&(c=c.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=n,S=a;switch(A=e,v=t,S.tag){case 1:if(_=S.payload,typeof _=="function"){h=_.call(v,h,A);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=S.payload,A=typeof _=="function"?_.call(v,h,A):_,A==null)break e;h=lr({},h,A);break e;case 2:ah=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,A=r.effects,A===null?r.effects=[a]:A.push(a))}else v={eventTime:v,lane:A,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=v,l=h):c=c.next=v,o|=A;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;A=a,a=A.next,A.next=null,r.lastBaseUpdate=A,r.shared.pending=null}}while(!0);if(c===null&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Rd|=o,n.lanes=o,n.memoizedState=h}}function $I(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(lt(191,r));r.call(i)}}}var _v={},Ql=cf(_v),A1=cf(_v),m1=cf(_v);function ld(n){if(n===_v)throw Error(lt(174));return n}function oP(n,e){switch(Di(m1,e),Di(A1,n),Di(Ql,_v),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:RC(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=RC(e,n)}zi(Ql),Di(Ql,e)}function h0(){zi(Ql),zi(A1),zi(m1)}function jU(n){ld(m1.current);var e=ld(Ql.current),t=RC(e,n.type);e!==t&&(Di(A1,n),Di(Ql,t))}function aP(n){A1.current===n&&(zi(Ql),zi(A1))}var Ji=cf(0);function Sx(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var PE=[];function lP(){for(var n=0;n<PE.length;n++)PE[n]._workInProgressVersionPrimary=null;PE.length=0}var b2=wc.ReactCurrentDispatcher,NE=wc.ReactCurrentBatchConfig,Md=0,or=null,kr=null,jr=null,wx=!1,Ng=!1,g1=0,DJ=0;function ys(){throw Error(lt(321))}function uP(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Sl(n[t],e[t]))return!1;return!0}function cP(n,e,t,i,r,s){if(Md=s,or=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,b2.current=n===null||n.memoizedState===null?BJ:OJ,n=t(i,r),Ng){s=0;do{if(Ng=!1,g1=0,25<=s)throw Error(lt(301));s+=1,jr=kr=null,e.updateQueue=null,b2.current=UJ,n=t(i,r)}while(Ng)}if(b2.current=Ex,e=kr!==null&&kr.next!==null,Md=0,jr=kr=or=null,wx=!1,e)throw Error(lt(300));return n}function hP(){var n=g1!==0;return g1=0,n}function zl(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jr===null?or.memoizedState=jr=n:jr=jr.next=n,jr}function Oa(){if(kr===null){var n=or.alternate;n=n!==null?n.memoizedState:null}else n=kr.next;var e=jr===null?or.memoizedState:jr.next;if(e!==null)jr=e,kr=n;else{if(n===null)throw Error(lt(310));kr=n,n={memoizedState:kr.memoizedState,baseState:kr.baseState,baseQueue:kr.baseQueue,queue:kr.queue,next:null},jr===null?or.memoizedState=jr=n:jr=jr.next=n}return jr}function v1(n,e){return typeof e=="function"?e(n):e}function IE(n){var e=Oa(),t=e.queue;if(t===null)throw Error(lt(311));t.lastRenderedReducer=n;var i=kr,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Md&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=i):l=l.next=h,or.lanes|=c,Rd|=c}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,Sl(i,e.memoizedState)||(So=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,or.lanes|=s,Rd|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function DE(n){var e=Oa(),t=e.queue;if(t===null)throw Error(lt(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);Sl(s,e.memoizedState)||(So=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function WU(){}function XU(n,e){var t=or,i=Oa(),r=e(),s=!Sl(i.memoizedState,r);if(s&&(i.memoizedState=r,So=!0),i=i.queue,fP(KU.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||jr!==null&&jr.memoizedState.tag&1){if(t.flags|=2048,y1(9,QU.bind(null,t,i,r,e),void 0,null),Yr===null)throw Error(lt(349));Md&30||YU(t,e,r)}return r}function YU(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=or.updateQueue,e===null?(e={lastEffect:null,stores:null},or.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function QU(n,e,t,i){e.value=t,e.getSnapshot=i,ZU(e)&&JU(n)}function KU(n,e,t){return t(function(){ZU(e)&&JU(n)})}function ZU(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Sl(n,t)}catch{return!0}}function JU(n){var e=uc(n,1);e!==null&&_l(e,n,1,-1)}function jI(n){var e=zl();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:v1,lastRenderedState:n},e.queue=n,n=n.dispatch=FJ.bind(null,or,n),[e.memoizedState,n]}function y1(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=or.updateQueue,e===null?(e={lastEffect:null,stores:null},or.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function ez(){return Oa().memoizedState}function S2(n,e,t,i){var r=zl();or.flags|=n,r.memoizedState=y1(1|e,t,void 0,i===void 0?null:i)}function PS(n,e,t,i){var r=Oa();i=i===void 0?null:i;var s=void 0;if(kr!==null){var o=kr.memoizedState;if(s=o.destroy,i!==null&&uP(i,o.deps)){r.memoizedState=y1(e,t,s,i);return}}or.flags|=n,r.memoizedState=y1(1|e,t,s,i)}function WI(n,e){return S2(8390656,8,n,e)}function fP(n,e){return PS(2048,8,n,e)}function tz(n,e){return PS(4,2,n,e)}function nz(n,e){return PS(4,4,n,e)}function iz(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function rz(n,e,t){return t=t!=null?t.concat([n]):null,PS(4,4,iz.bind(null,e,n),t)}function dP(){}function sz(n,e){var t=Oa();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&uP(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function oz(n,e){var t=Oa();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&uP(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function az(n,e,t){return Md&21?(Sl(t,e)||(t=fU(),or.lanes|=t,Rd|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,So=!0),n.memoizedState=t)}function kJ(n,e){var t=xi;xi=t!==0&&4>t?t:4,n(!0);var i=NE.transition;NE.transition={};try{n(!1),e()}finally{xi=t,NE.transition=i}}function lz(){return Oa().memoizedState}function LJ(n,e,t){var i=kh(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},uz(n))cz(e,t);else if(t=HU(n,e,t,i),t!==null){var r=eo();_l(t,n,i,r),hz(t,e,i)}}function FJ(n,e,t){var i=kh(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(uz(n))cz(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Sl(a,o)){var l=e.interleaved;l===null?(r.next=r,rP(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=HU(n,e,r,i),t!==null&&(r=eo(),_l(t,n,i,r),hz(t,e,i))}}function uz(n){var e=n.alternate;return n===or||e!==null&&e===or}function cz(n,e){Ng=wx=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function hz(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,H5(n,t)}}var Ex={readContext:Ba,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},BJ={readContext:Ba,useCallback:function(n,e){return zl().memoizedState=[n,e===void 0?null:e],n},useContext:Ba,useEffect:WI,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,S2(4194308,4,iz.bind(null,e,n),t)},useLayoutEffect:function(n,e){return S2(4194308,4,n,e)},useInsertionEffect:function(n,e){return S2(4,2,n,e)},useMemo:function(n,e){var t=zl();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=zl();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=LJ.bind(null,or,n),[i.memoizedState,n]},useRef:function(n){var e=zl();return n={current:n},e.memoizedState=n},useState:jI,useDebugValue:dP,useDeferredValue:function(n){return zl().memoizedState=n},useTransition:function(){var n=jI(!1),e=n[0];return n=kJ.bind(null,n[1]),zl().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=or,r=zl();if(qi){if(t===void 0)throw Error(lt(407));t=t()}else{if(t=e(),Yr===null)throw Error(lt(349));Md&30||YU(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,WI(KU.bind(null,i,s,n),[n]),i.flags|=2048,y1(9,QU.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=zl(),e=Yr.identifierPrefix;if(qi){var t=zu,i=Uu;t=(i&~(1<<32-yl(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=g1++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=DJ++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},OJ={readContext:Ba,useCallback:sz,useContext:Ba,useEffect:fP,useImperativeHandle:rz,useInsertionEffect:tz,useLayoutEffect:nz,useMemo:oz,useReducer:IE,useRef:ez,useState:function(){return IE(v1)},useDebugValue:dP,useDeferredValue:function(n){var e=Oa();return az(e,kr.memoizedState,n)},useTransition:function(){var n=IE(v1)[0],e=Oa().memoizedState;return[n,e]},useMutableSource:WU,useSyncExternalStore:XU,useId:lz,unstable_isNewReconciler:!1},UJ={readContext:Ba,useCallback:sz,useContext:Ba,useEffect:fP,useImperativeHandle:rz,useInsertionEffect:tz,useLayoutEffect:nz,useMemo:oz,useReducer:DE,useRef:ez,useState:function(){return DE(v1)},useDebugValue:dP,useDeferredValue:function(n){var e=Oa();return kr===null?e.memoizedState=n:az(e,kr.memoizedState,n)},useTransition:function(){var n=DE(v1)[0],e=Oa().memoizedState;return[n,e]},useMutableSource:WU,useSyncExternalStore:XU,useId:lz,unstable_isNewReconciler:!1};function il(n,e){if(n&&n.defaultProps){e=lr({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function QC(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:lr({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var NS={isMounted:function(n){return(n=n._reactInternals)?Kd(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=eo(),r=kh(n),s=Wu(i,r);s.payload=e,t!=null&&(s.callback=t),e=Ih(n,s,r),e!==null&&(_l(e,n,r,i),x2(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=eo(),r=kh(n),s=Wu(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Ih(n,s,r),e!==null&&(_l(e,n,r,i),x2(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=eo(),i=kh(n),r=Wu(t,i);r.tag=2,e!=null&&(r.callback=e),e=Ih(n,r,i),e!==null&&(_l(e,n,i,t),x2(e,n,i))}};function XI(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!h1(t,i)||!h1(r,s):!0}function fz(n,e,t){var i=!1,r=Xh,s=e.contextType;return typeof s=="object"&&s!==null?s=Ba(s):(r=Po(e)?Td:ks.current,i=e.contextTypes,s=(i=i!=null)?l0(n,r):Xh),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=NS,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function YI(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&NS.enqueueReplaceState(e,e.state,null)}function KC(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},sP(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Ba(s):(s=Po(e)?Td:ks.current,r.context=l0(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(QC(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&NS.enqueueReplaceState(r,r.state,null),bx(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function f0(n,e){try{var t="",i=e;do t+=dZ(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function kE(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function ZC(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var zJ=typeof WeakMap=="function"?WeakMap:Map;function dz(n,e,t){t=Wu(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){Cx||(Cx=!0,lM=i),ZC(n,e)},t}function pz(n,e,t){t=Wu(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){ZC(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){ZC(n,e),typeof i!="function"&&(Dh===null?Dh=new Set([this]):Dh.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function QI(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new zJ;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=eee.bind(null,n,e,t),e.then(n,n))}function KI(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function ZI(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Wu(-1,1),e.tag=2,Ih(t,e,1))),t.lanes|=1),n)}var VJ=wc.ReactCurrentOwner,So=!1;function $s(n,e,t,i){e.child=n===null?qU(e,null,t,i):c0(e,n.child,t,i)}function JI(n,e,t,i,r){t=t.render;var s=e.ref;return VA(e,r),i=cP(n,e,t,i,s,r),t=hP(),n!==null&&!So?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,cc(n,e,r)):(qi&&t&&Z5(e),e.flags|=1,$s(n,e,i,r),e.child)}function eD(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!xP(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,Az(n,e,s,i,r)):(n=C2(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:h1,t(o,i)&&n.ref===e.ref)return cc(n,e,r)}return e.flags|=1,n=Lh(s,i),n.ref=e.ref,n.return=e,e.child=n}function Az(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(h1(s,i)&&n.ref===e.ref)if(So=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(So=!0);else return e.lanes=n.lanes,cc(n,e,r)}return JC(n,e,t,i,r)}function mz(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Di(gA,Qo),Qo|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Di(gA,Qo),Qo|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,Di(gA,Qo),Qo|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,Di(gA,Qo),Qo|=i;return $s(n,e,r,t),e.child}function gz(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function JC(n,e,t,i,r){var s=Po(t)?Td:ks.current;return s=l0(e,s),VA(e,r),t=cP(n,e,t,i,s,r),i=hP(),n!==null&&!So?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,cc(n,e,r)):(qi&&i&&Z5(e),e.flags|=1,$s(n,e,t,r),e.child)}function tD(n,e,t,i,r){if(Po(t)){var s=!0;gx(e)}else s=!1;if(VA(e,r),e.stateNode===null)w2(n,e),fz(e,t,i),KC(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Ba(u):(u=Po(t)?Td:ks.current,u=l0(e,u));var c=t.getDerivedStateFromProps,h=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&YI(e,o,i,u),ah=!1;var A=e.memoizedState;o.state=A,bx(e,i,o,r),l=e.memoizedState,a!==i||A!==l||Ro.current||ah?(typeof c=="function"&&(QC(e,t,c,i),l=e.memoizedState),(a=ah||XI(e,t,a,i,A,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,$U(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:il(e.type,a),o.props=u,h=e.pendingProps,A=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Ba(l):(l=Po(t)?Td:ks.current,l=l0(e,l));var v=t.getDerivedStateFromProps;(c=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||A!==l)&&YI(e,o,i,l),ah=!1,A=e.memoizedState,o.state=A,bx(e,i,o,r);var _=e.memoizedState;a!==h||A!==_||Ro.current||ah?(typeof v=="function"&&(QC(e,t,v,i),_=e.memoizedState),(u=ah||XI(e,t,u,i,A,_,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&A===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&A===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),o.props=i,o.state=_,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&A===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&A===n.memoizedState||(e.flags|=1024),i=!1)}return eM(n,e,t,i,s,r)}function eM(n,e,t,i,r,s){gz(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&zI(e,t,!1),cc(n,e,s);i=e.stateNode,VJ.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=c0(e,n.child,null,s),e.child=c0(e,null,a,s)):$s(n,e,a,s),e.memoizedState=i.state,r&&zI(e,t,!0),e.child}function vz(n){var e=n.stateNode;e.pendingContext?UI(n,e.pendingContext,e.pendingContext!==e.context):e.context&&UI(n,e.context,!1),oP(n,e.containerInfo)}function nD(n,e,t,i,r){return u0(),eP(r),e.flags|=256,$s(n,e,t,i),e.child}var tM={dehydrated:null,treeContext:null,retryLane:0};function nM(n){return{baseLanes:n,cachePool:null,transitions:null}}function yz(n,e,t){var i=e.pendingProps,r=Ji.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Di(Ji,r&1),n===null)return XC(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=kS(o,i,0,null),n=xd(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=nM(t),e.memoizedState=tM,n):pP(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return GJ(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Lh(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Lh(a,s):(s=xd(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?nM(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=tM,i}return s=n.child,n=s.sibling,i=Lh(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function pP(n,e){return e=kS({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ey(n,e,t,i){return i!==null&&eP(i),c0(e,n.child,null,t),n=pP(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function GJ(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=kE(Error(lt(422))),Ey(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=kS({mode:"visible",children:i.children},r,0,null),s=xd(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&c0(e,n.child,null,o),e.child.memoizedState=nM(o),e.memoizedState=tM,s);if(!(e.mode&1))return Ey(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(lt(419)),i=kE(s,i,void 0),Ey(n,e,o,i)}if(a=(o&n.childLanes)!==0,So||a){if(i=Yr,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,uc(n,r),_l(i,n,r,-1))}return _P(),i=kE(Error(lt(421))),Ey(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=tee.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,ia=Nh(r.nextSibling),ra=e,qi=!0,ol=null,n!==null&&(wa[Ea++]=Uu,wa[Ea++]=zu,wa[Ea++]=Cd,Uu=n.id,zu=n.overflow,Cd=e),e=pP(e,i.children),e.flags|=4096,e)}function iD(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),YC(n.return,e,t)}function LE(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function _z(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if($s(n,e,i.children,t),i=Ji.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&iD(n,t,e);else if(n.tag===19)iD(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Di(Ji,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Sx(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),LE(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Sx(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}LE(e,!0,t,null,s);break;case"together":LE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function w2(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function cc(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Rd|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(lt(153));if(e.child!==null){for(n=e.child,t=Lh(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Lh(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function qJ(n,e,t){switch(e.tag){case 3:vz(e),u0();break;case 5:jU(e);break;case 1:Po(e.type)&&gx(e);break;case 4:oP(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Di(_x,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Di(Ji,Ji.current&1),e.flags|=128,null):t&e.child.childLanes?yz(n,e,t):(Di(Ji,Ji.current&1),n=cc(n,e,t),n!==null?n.sibling:null);Di(Ji,Ji.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return _z(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Di(Ji,Ji.current),i)break;return null;case 22:case 23:return e.lanes=0,mz(n,e,t)}return cc(n,e,t)}var xz,iM,bz,Sz;xz=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};iM=function(){};bz=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,ld(Ql.current);var s=null;switch(t){case"input":r=EC(n,r),i=EC(n,i),s=[];break;case"select":r=lr({},r,{value:void 0}),i=lr({},i,{value:void 0}),s=[];break;case"textarea":r=MC(n,r),i=MC(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Ax)}PC(t,i);var o;t=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(r1.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(r1.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Li("scroll",n),s||a===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Sz=function(n,e,t,i){t!==i&&(e.flags|=4)};function Pm(n,e){if(!qi)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function _s(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function HJ(n,e,t){var i=e.pendingProps;switch(J5(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _s(e),null;case 1:return Po(e.type)&&mx(),_s(e),null;case 3:return i=e.stateNode,h0(),zi(Ro),zi(ks),lP(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Sy(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ol!==null&&(hM(ol),ol=null))),iM(n,e),_s(e),null;case 5:aP(e);var r=ld(m1.current);if(t=e.type,n!==null&&e.stateNode!=null)bz(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(lt(166));return _s(e),null}if(n=ld(Ql.current),Sy(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[Gl]=e,i[p1]=s,n=(e.mode&1)!==0,t){case"dialog":Li("cancel",i),Li("close",i);break;case"iframe":case"object":case"embed":Li("load",i);break;case"video":case"audio":for(r=0;r<fg.length;r++)Li(fg[r],i);break;case"source":Li("error",i);break;case"img":case"image":case"link":Li("error",i),Li("load",i);break;case"details":Li("toggle",i);break;case"input":fI(i,s),Li("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Li("invalid",i);break;case"textarea":pI(i,s),Li("invalid",i)}PC(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&by(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&by(i.textContent,a,n),r=["children",""+a]):r1.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Li("scroll",i)}switch(t){case"input":py(i),dI(i,s,!0);break;case"textarea":py(i),AI(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Ax)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=K9(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Gl]=e,n[p1]=i,xz(n,e,!1,!1),e.stateNode=n;e:{switch(o=NC(t,i),t){case"dialog":Li("cancel",n),Li("close",n),r=i;break;case"iframe":case"object":case"embed":Li("load",n),r=i;break;case"video":case"audio":for(r=0;r<fg.length;r++)Li(fg[r],n);r=i;break;case"source":Li("error",n),r=i;break;case"img":case"image":case"link":Li("error",n),Li("load",n),r=i;break;case"details":Li("toggle",n),r=i;break;case"input":fI(n,i),r=EC(n,i),Li("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=lr({},i,{value:void 0}),Li("invalid",n);break;case"textarea":pI(n,i),r=MC(n,i),Li("invalid",n);break;default:r=i}PC(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?eU(n,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Z9(n,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&s1(n,l):typeof l=="number"&&s1(n,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(r1.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Li("scroll",n):l!=null&&O5(n,s,l,o))}switch(t){case"input":py(n),dI(n,i,!1);break;case"textarea":py(n),AI(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Wh(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?BA(n,!!i.multiple,s,!1):i.defaultValue!=null&&BA(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=Ax)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return _s(e),null;case 6:if(n&&e.stateNode!=null)Sz(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(lt(166));if(t=ld(m1.current),ld(Ql.current),Sy(e)){if(i=e.stateNode,t=e.memoizedProps,i[Gl]=e,(s=i.nodeValue!==t)&&(n=ra,n!==null))switch(n.tag){case 3:by(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&by(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Gl]=e,e.stateNode=i}return _s(e),null;case 13:if(zi(Ji),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(qi&&ia!==null&&e.mode&1&&!(e.flags&128))VU(),u0(),e.flags|=98560,s=!1;else if(s=Sy(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(lt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(lt(317));s[Gl]=e}else u0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;_s(e),s=!1}else ol!==null&&(hM(ol),ol=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Ji.current&1?Or===0&&(Or=3):_P())),e.updateQueue!==null&&(e.flags|=4),_s(e),null);case 4:return h0(),iM(n,e),n===null&&f1(e.stateNode.containerInfo),_s(e),null;case 10:return iP(e.type._context),_s(e),null;case 17:return Po(e.type)&&mx(),_s(e),null;case 19:if(zi(Ji),s=e.memoizedState,s===null)return _s(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Pm(s,!1);else{if(Or!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Sx(n),o!==null){for(e.flags|=128,Pm(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Di(Ji,Ji.current&1|2),e.child}n=n.sibling}s.tail!==null&&vr()>d0&&(e.flags|=128,i=!0,Pm(s,!1),e.lanes=4194304)}else{if(!i)if(n=Sx(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Pm(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!qi)return _s(e),null}else 2*vr()-s.renderingStartTime>d0&&t!==1073741824&&(e.flags|=128,i=!0,Pm(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=vr(),e.sibling=null,t=Ji.current,Di(Ji,i?t&1|2:t&1),e):(_s(e),null);case 22:case 23:return yP(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Qo&1073741824&&(_s(e),e.subtreeFlags&6&&(e.flags|=8192)):_s(e),null;case 24:return null;case 25:return null}throw Error(lt(156,e.tag))}function $J(n,e){switch(J5(e),e.tag){case 1:return Po(e.type)&&mx(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return h0(),zi(Ro),zi(ks),lP(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return aP(e),null;case 13:if(zi(Ji),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(lt(340));u0()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return zi(Ji),null;case 4:return h0(),null;case 10:return iP(e.type._context),null;case 22:case 23:return yP(),null;case 24:return null;default:return null}}var Ty=!1,Ms=!1,jJ=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function mA(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){fr(n,e,i)}else t.current=null}function rM(n,e,t){try{t()}catch(i){fr(n,e,i)}}var rD=!1;function WJ(n,e){if(VC=fx,n=MU(),K5(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,c=0,h=n,A=null;t:for(;;){for(var v;h!==t||r!==0&&h.nodeType!==3||(a=o+r),h!==s||i!==0&&h.nodeType!==3||(l=o+i),h.nodeType===3&&(o+=h.nodeValue.length),(v=h.firstChild)!==null;)A=h,h=v;for(;;){if(h===n)break t;if(A===t&&++u===r&&(a=o),A===s&&++c===i&&(l=o),(v=h.nextSibling)!==null)break;h=A,A=h.parentNode}h=v}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(GC={focusedElem:n,selectionRange:t},fx=!1,Ut=e;Ut!==null;)if(e=Ut,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Ut=n;else for(;Ut!==null;){e=Ut;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var S=_.memoizedProps,w=_.memoizedState,x=e.stateNode,M=x.getSnapshotBeforeUpdate(e.elementType===e.type?S:il(e.type,S),w);x.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var R=e.stateNode.containerInfo;R.nodeType===1?R.textContent="":R.nodeType===9&&R.documentElement&&R.removeChild(R.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(lt(163))}}catch(N){fr(e,e.return,N)}if(n=e.sibling,n!==null){n.return=e.return,Ut=n;break}Ut=e.return}return _=rD,rD=!1,_}function Ig(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&rM(e,t,s)}r=r.next}while(r!==i)}}function IS(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function sM(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function wz(n){var e=n.alternate;e!==null&&(n.alternate=null,wz(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Gl],delete e[p1],delete e[$C],delete e[RJ],delete e[PJ])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Ez(n){return n.tag===5||n.tag===3||n.tag===4}function sD(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Ez(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function oM(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Ax));else if(i!==4&&(n=n.child,n!==null))for(oM(n,e,t),n=n.sibling;n!==null;)oM(n,e,t),n=n.sibling}function aM(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(aM(n,e,t),n=n.sibling;n!==null;)aM(n,e,t),n=n.sibling}var ns=null,rl=!1;function zc(n,e,t){for(t=t.child;t!==null;)Tz(n,e,t),t=t.sibling}function Tz(n,e,t){if(Yl&&typeof Yl.onCommitFiberUnmount=="function")try{Yl.onCommitFiberUnmount(wS,t)}catch{}switch(t.tag){case 5:Ms||mA(t,e);case 6:var i=ns,r=rl;ns=null,zc(n,e,t),ns=i,rl=r,ns!==null&&(rl?(n=ns,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ns.removeChild(t.stateNode));break;case 18:ns!==null&&(rl?(n=ns,t=t.stateNode,n.nodeType===8?ME(n.parentNode,t):n.nodeType===1&&ME(n,t),u1(n)):ME(ns,t.stateNode));break;case 4:i=ns,r=rl,ns=t.stateNode.containerInfo,rl=!0,zc(n,e,t),ns=i,rl=r;break;case 0:case 11:case 14:case 15:if(!Ms&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&rM(t,e,o),r=r.next}while(r!==i)}zc(n,e,t);break;case 1:if(!Ms&&(mA(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){fr(t,e,a)}zc(n,e,t);break;case 21:zc(n,e,t);break;case 22:t.mode&1?(Ms=(i=Ms)||t.memoizedState!==null,zc(n,e,t),Ms=i):zc(n,e,t);break;default:zc(n,e,t)}}function oD(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new jJ),e.forEach(function(i){var r=nee.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function qa(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:ns=a.stateNode,rl=!1;break e;case 3:ns=a.stateNode.containerInfo,rl=!0;break e;case 4:ns=a.stateNode.containerInfo,rl=!0;break e}a=a.return}if(ns===null)throw Error(lt(160));Tz(s,o,r),ns=null,rl=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){fr(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Cz(e,n),e=e.sibling}function Cz(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(qa(e,n),Bl(n),i&4){try{Ig(3,n,n.return),IS(3,n)}catch(S){fr(n,n.return,S)}try{Ig(5,n,n.return)}catch(S){fr(n,n.return,S)}}break;case 1:qa(e,n),Bl(n),i&512&&t!==null&&mA(t,t.return);break;case 5:if(qa(e,n),Bl(n),i&512&&t!==null&&mA(t,t.return),n.flags&32){var r=n.stateNode;try{s1(r,"")}catch(S){fr(n,n.return,S)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Y9(r,s),NC(a,o);var u=NC(a,s);for(o=0;o<l.length;o+=2){var c=l[o],h=l[o+1];c==="style"?eU(r,h):c==="dangerouslySetInnerHTML"?Z9(r,h):c==="children"?s1(r,h):O5(r,c,h,u)}switch(a){case"input":TC(r,s);break;case"textarea":Q9(r,s);break;case"select":var A=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?BA(r,!!s.multiple,v,!1):A!==!!s.multiple&&(s.defaultValue!=null?BA(r,!!s.multiple,s.defaultValue,!0):BA(r,!!s.multiple,s.multiple?[]:"",!1))}r[p1]=s}catch(S){fr(n,n.return,S)}}break;case 6:if(qa(e,n),Bl(n),i&4){if(n.stateNode===null)throw Error(lt(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(S){fr(n,n.return,S)}}break;case 3:if(qa(e,n),Bl(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{u1(e.containerInfo)}catch(S){fr(n,n.return,S)}break;case 4:qa(e,n),Bl(n);break;case 13:qa(e,n),Bl(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(gP=vr())),i&4&&oD(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ms=(u=Ms)||c,qa(e,n),Ms=u):qa(e,n),Bl(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(Ut=n,c=n.child;c!==null;){for(h=Ut=c;Ut!==null;){switch(A=Ut,v=A.child,A.tag){case 0:case 11:case 14:case 15:Ig(4,A,A.return);break;case 1:mA(A,A.return);var _=A.stateNode;if(typeof _.componentWillUnmount=="function"){i=A,t=A.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(S){fr(i,t,S)}}break;case 5:mA(A,A.return);break;case 22:if(A.memoizedState!==null){lD(h);continue}}v!==null?(v.return=A,Ut=v):lD(h)}c=c.sibling}e:for(c=null,h=n;;){if(h.tag===5){if(c===null){c=h;try{r=h.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=J9("display",o))}catch(S){fr(n,n.return,S)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(S){fr(n,n.return,S)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:qa(e,n),Bl(n),i&4&&oD(n);break;case 21:break;default:qa(e,n),Bl(n)}}function Bl(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Ez(t)){var i=t;break e}t=t.return}throw Error(lt(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(s1(r,""),i.flags&=-33);var s=sD(n);aM(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=sD(n);oM(n,a,o);break;default:throw Error(lt(161))}}catch(l){fr(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function XJ(n,e,t){Ut=n,Mz(n)}function Mz(n,e,t){for(var i=(n.mode&1)!==0;Ut!==null;){var r=Ut,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Ty;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Ms;a=Ty;var u=Ms;if(Ty=o,(Ms=l)&&!u)for(Ut=r;Ut!==null;)o=Ut,l=o.child,o.tag===22&&o.memoizedState!==null?uD(r):l!==null?(l.return=o,Ut=l):uD(r);for(;s!==null;)Ut=s,Mz(s),s=s.sibling;Ut=r,Ty=a,Ms=u}aD(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Ut=s):aD(n)}}function aD(n){for(;Ut!==null;){var e=Ut;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ms||IS(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Ms)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:il(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&$I(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}$I(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&u1(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(lt(163))}Ms||e.flags&512&&sM(e)}catch(A){fr(e,e.return,A)}}if(e===n){Ut=null;break}if(t=e.sibling,t!==null){t.return=e.return,Ut=t;break}Ut=e.return}}function lD(n){for(;Ut!==null;){var e=Ut;if(e===n){Ut=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Ut=t;break}Ut=e.return}}function uD(n){for(;Ut!==null;){var e=Ut;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{IS(4,e)}catch(l){fr(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){fr(e,r,l)}}var s=e.return;try{sM(e)}catch(l){fr(e,s,l)}break;case 5:var o=e.return;try{sM(e)}catch(l){fr(e,o,l)}}}catch(l){fr(e,e.return,l)}if(e===n){Ut=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Ut=a;break}Ut=e.return}}var YJ=Math.ceil,Tx=wc.ReactCurrentDispatcher,AP=wc.ReactCurrentOwner,ka=wc.ReactCurrentBatchConfig,ri=0,Yr=null,Cr=null,as=0,Qo=0,gA=cf(0),Or=0,_1=null,Rd=0,DS=0,mP=0,Dg=null,yo=null,gP=0,d0=1/0,Nu=null,Cx=!1,lM=null,Dh=null,Cy=!1,Eh=null,Mx=0,kg=0,uM=null,E2=-1,T2=0;function eo(){return ri&6?vr():E2!==-1?E2:E2=vr()}function kh(n){return n.mode&1?ri&2&&as!==0?as&-as:IJ.transition!==null?(T2===0&&(T2=fU()),T2):(n=xi,n!==0||(n=window.event,n=n===void 0?16:yU(n.type)),n):1}function _l(n,e,t,i){if(50<kg)throw kg=0,uM=null,Error(lt(185));gv(n,t,i),(!(ri&2)||n!==Yr)&&(n===Yr&&(!(ri&2)&&(DS|=t),Or===4&&ph(n,as)),No(n,i),t===1&&ri===0&&!(e.mode&1)&&(d0=vr()+500,RS&&hf()))}function No(n,e){var t=n.callbackNode;IZ(n,e);var i=hx(n,n===Yr?as:0);if(i===0)t!==null&&vI(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&vI(t),e===1)n.tag===0?NJ(cD.bind(null,n)):OU(cD.bind(null,n)),CJ(function(){!(ri&6)&&hf()}),t=null;else{switch(dU(i)){case 1:t=q5;break;case 4:t=cU;break;case 16:t=cx;break;case 536870912:t=hU;break;default:t=cx}t=Fz(t,Rz.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Rz(n,e){if(E2=-1,T2=0,ri&6)throw Error(lt(327));var t=n.callbackNode;if(GA()&&n.callbackNode!==t)return null;var i=hx(n,n===Yr?as:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Rx(n,i);else{e=i;var r=ri;ri|=2;var s=Nz();(Yr!==n||as!==e)&&(Nu=null,d0=vr()+500,_d(n,e));do try{ZJ();break}catch(a){Pz(n,a)}while(!0);nP(),Tx.current=s,ri=r,Cr!==null?e=0:(Yr=null,as=0,e=Or)}if(e!==0){if(e===2&&(r=FC(n),r!==0&&(i=r,e=cM(n,r))),e===1)throw t=_1,_d(n,0),ph(n,i),No(n,vr()),t;if(e===6)ph(n,i);else{if(r=n.current.alternate,!(i&30)&&!QJ(r)&&(e=Rx(n,i),e===2&&(s=FC(n),s!==0&&(i=s,e=cM(n,s))),e===1))throw t=_1,_d(n,0),ph(n,i),No(n,vr()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(lt(345));case 2:Vf(n,yo,Nu);break;case 3:if(ph(n,i),(i&130023424)===i&&(e=gP+500-vr(),10<e)){if(hx(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){eo(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=HC(Vf.bind(null,n,yo,Nu),e);break}Vf(n,yo,Nu);break;case 4:if(ph(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-yl(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=vr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*YJ(i/1960))-i,10<i){n.timeoutHandle=HC(Vf.bind(null,n,yo,Nu),i);break}Vf(n,yo,Nu);break;case 5:Vf(n,yo,Nu);break;default:throw Error(lt(329))}}}return No(n,vr()),n.callbackNode===t?Rz.bind(null,n):null}function cM(n,e){var t=Dg;return n.current.memoizedState.isDehydrated&&(_d(n,e).flags|=256),n=Rx(n,e),n!==2&&(e=yo,yo=t,e!==null&&hM(e)),n}function hM(n){yo===null?yo=n:yo.push.apply(yo,n)}function QJ(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!Sl(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ph(n,e){for(e&=~mP,e&=~DS,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-yl(e),i=1<<t;n[t]=-1,e&=~i}}function cD(n){if(ri&6)throw Error(lt(327));GA();var e=hx(n,0);if(!(e&1))return No(n,vr()),null;var t=Rx(n,e);if(n.tag!==0&&t===2){var i=FC(n);i!==0&&(e=i,t=cM(n,i))}if(t===1)throw t=_1,_d(n,0),ph(n,e),No(n,vr()),t;if(t===6)throw Error(lt(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Vf(n,yo,Nu),No(n,vr()),null}function vP(n,e){var t=ri;ri|=1;try{return n(e)}finally{ri=t,ri===0&&(d0=vr()+500,RS&&hf())}}function Pd(n){Eh!==null&&Eh.tag===0&&!(ri&6)&&GA();var e=ri;ri|=1;var t=ka.transition,i=xi;try{if(ka.transition=null,xi=1,n)return n()}finally{xi=i,ka.transition=t,ri=e,!(ri&6)&&hf()}}function yP(){Qo=gA.current,zi(gA)}function _d(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,TJ(t)),Cr!==null)for(t=Cr.return;t!==null;){var i=t;switch(J5(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&mx();break;case 3:h0(),zi(Ro),zi(ks),lP();break;case 5:aP(i);break;case 4:h0();break;case 13:zi(Ji);break;case 19:zi(Ji);break;case 10:iP(i.type._context);break;case 22:case 23:yP()}t=t.return}if(Yr=n,Cr=n=Lh(n.current,null),as=Qo=e,Or=0,_1=null,mP=DS=Rd=0,yo=Dg=null,ad!==null){for(e=0;e<ad.length;e++)if(t=ad[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}ad=null}return n}function Pz(n,e){do{var t=Cr;try{if(nP(),b2.current=Ex,wx){for(var i=or.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}wx=!1}if(Md=0,jr=kr=or=null,Ng=!1,g1=0,AP.current=null,t===null||t.return===null){Or=1,_1=e,Cr=null;break}e:{var s=n,o=t.return,a=t,l=e;if(e=as,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var A=c.alternate;A?(c.updateQueue=A.updateQueue,c.memoizedState=A.memoizedState,c.lanes=A.lanes):(c.updateQueue=null,c.memoizedState=null)}var v=KI(o);if(v!==null){v.flags&=-257,ZI(v,o,a,s,e),v.mode&1&&QI(s,u,e),e=v,l=u;var _=e.updateQueue;if(_===null){var S=new Set;S.add(l),e.updateQueue=S}else _.add(l);break e}else{if(!(e&1)){QI(s,u,e),_P();break e}l=Error(lt(426))}}else if(qi&&a.mode&1){var w=KI(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),ZI(w,o,a,s,e),eP(f0(l,a));break e}}s=l=f0(l,a),Or!==4&&(Or=2),Dg===null?Dg=[s]:Dg.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=dz(s,l,e);HI(s,x);break e;case 1:a=l;var M=s.type,R=s.stateNode;if(!(s.flags&128)&&(typeof M.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(Dh===null||!Dh.has(R)))){s.flags|=65536,e&=-e,s.lanes|=e;var N=pz(s,a,e);HI(s,N);break e}}s=s.return}while(s!==null)}Dz(t)}catch(B){e=B,Cr===t&&t!==null&&(Cr=t=t.return);continue}break}while(!0)}function Nz(){var n=Tx.current;return Tx.current=Ex,n===null?Ex:n}function _P(){(Or===0||Or===3||Or===2)&&(Or=4),Yr===null||!(Rd&268435455)&&!(DS&268435455)||ph(Yr,as)}function Rx(n,e){var t=ri;ri|=2;var i=Nz();(Yr!==n||as!==e)&&(Nu=null,_d(n,e));do try{KJ();break}catch(r){Pz(n,r)}while(!0);if(nP(),ri=t,Tx.current=i,Cr!==null)throw Error(lt(261));return Yr=null,as=0,Or}function KJ(){for(;Cr!==null;)Iz(Cr)}function ZJ(){for(;Cr!==null&&!SZ();)Iz(Cr)}function Iz(n){var e=Lz(n.alternate,n,Qo);n.memoizedProps=n.pendingProps,e===null?Dz(n):Cr=e,AP.current=null}function Dz(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=$J(t,e),t!==null){t.flags&=32767,Cr=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Or=6,Cr=null;return}}else if(t=HJ(t,e,Qo),t!==null){Cr=t;return}if(e=e.sibling,e!==null){Cr=e;return}Cr=e=n}while(e!==null);Or===0&&(Or=5)}function Vf(n,e,t){var i=xi,r=ka.transition;try{ka.transition=null,xi=1,JJ(n,e,t,i)}finally{ka.transition=r,xi=i}return null}function JJ(n,e,t,i){do GA();while(Eh!==null);if(ri&6)throw Error(lt(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(lt(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(DZ(n,s),n===Yr&&(Cr=Yr=null,as=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Cy||(Cy=!0,Fz(cx,function(){return GA(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=ka.transition,ka.transition=null;var o=xi;xi=1;var a=ri;ri|=4,AP.current=null,WJ(n,t),Cz(t,n),yJ(GC),fx=!!VC,GC=VC=null,n.current=t,XJ(t),wZ(),ri=a,xi=o,ka.transition=s}else n.current=t;if(Cy&&(Cy=!1,Eh=n,Mx=r),s=n.pendingLanes,s===0&&(Dh=null),CZ(t.stateNode),No(n,vr()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(Cx)throw Cx=!1,n=lM,lM=null,n;return Mx&1&&n.tag!==0&&GA(),s=n.pendingLanes,s&1?n===uM?kg++:(kg=0,uM=n):kg=0,hf(),null}function GA(){if(Eh!==null){var n=dU(Mx),e=ka.transition,t=xi;try{if(ka.transition=null,xi=16>n?16:n,Eh===null)var i=!1;else{if(n=Eh,Eh=null,Mx=0,ri&6)throw Error(lt(331));var r=ri;for(ri|=4,Ut=n.current;Ut!==null;){var s=Ut,o=s.child;if(Ut.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Ut=u;Ut!==null;){var c=Ut;switch(c.tag){case 0:case 11:case 15:Ig(8,c,s)}var h=c.child;if(h!==null)h.return=c,Ut=h;else for(;Ut!==null;){c=Ut;var A=c.sibling,v=c.return;if(wz(c),c===u){Ut=null;break}if(A!==null){A.return=v,Ut=A;break}Ut=v}}}var _=s.alternate;if(_!==null){var S=_.child;if(S!==null){_.child=null;do{var w=S.sibling;S.sibling=null,S=w}while(S!==null)}}Ut=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Ut=o;else e:for(;Ut!==null;){if(s=Ut,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ig(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,Ut=x;break e}Ut=s.return}}var M=n.current;for(Ut=M;Ut!==null;){o=Ut;var R=o.child;if(o.subtreeFlags&2064&&R!==null)R.return=o,Ut=R;else e:for(o=M;Ut!==null;){if(a=Ut,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:IS(9,a)}}catch(B){fr(a,a.return,B)}if(a===o){Ut=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,Ut=N;break e}Ut=a.return}}if(ri=r,hf(),Yl&&typeof Yl.onPostCommitFiberRoot=="function")try{Yl.onPostCommitFiberRoot(wS,n)}catch{}i=!0}return i}finally{xi=t,ka.transition=e}}return!1}function hD(n,e,t){e=f0(t,e),e=dz(n,e,1),n=Ih(n,e,1),e=eo(),n!==null&&(gv(n,1,e),No(n,e))}function fr(n,e,t){if(n.tag===3)hD(n,n,t);else for(;e!==null;){if(e.tag===3){hD(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Dh===null||!Dh.has(i))){n=f0(t,n),n=pz(e,n,1),e=Ih(e,n,1),n=eo(),e!==null&&(gv(e,1,n),No(e,n));break}}e=e.return}}function eee(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=eo(),n.pingedLanes|=n.suspendedLanes&t,Yr===n&&(as&t)===t&&(Or===4||Or===3&&(as&130023424)===as&&500>vr()-gP?_d(n,0):mP|=t),No(n,e)}function kz(n,e){e===0&&(n.mode&1?(e=gy,gy<<=1,!(gy&130023424)&&(gy=4194304)):e=1);var t=eo();n=uc(n,e),n!==null&&(gv(n,e,t),No(n,t))}function tee(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),kz(n,t)}function nee(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(lt(314))}i!==null&&i.delete(e),kz(n,t)}var Lz;Lz=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ro.current)So=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return So=!1,qJ(n,e,t);So=!!(n.flags&131072)}else So=!1,qi&&e.flags&1048576&&UU(e,yx,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;w2(n,e),n=e.pendingProps;var r=l0(e,ks.current);VA(e,t),r=cP(null,e,i,n,r,t);var s=hP();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Po(i)?(s=!0,gx(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,sP(e),r.updater=NS,e.stateNode=r,r._reactInternals=e,KC(e,i,n,t),e=eM(null,e,i,!0,s,t)):(e.tag=0,qi&&s&&Z5(e),$s(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(w2(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=ree(i),n=il(i,n),r){case 0:e=JC(null,e,i,n,t);break e;case 1:e=tD(null,e,i,n,t);break e;case 11:e=JI(null,e,i,n,t);break e;case 14:e=eD(null,e,i,il(i.type,n),t);break e}throw Error(lt(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:il(i,r),JC(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:il(i,r),tD(n,e,i,r,t);case 3:e:{if(vz(e),n===null)throw Error(lt(387));i=e.pendingProps,s=e.memoizedState,r=s.element,$U(n,e),bx(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=f0(Error(lt(423)),e),e=nD(n,e,i,t,r);break e}else if(i!==r){r=f0(Error(lt(424)),e),e=nD(n,e,i,t,r);break e}else for(ia=Nh(e.stateNode.containerInfo.firstChild),ra=e,qi=!0,ol=null,t=qU(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(u0(),i===r){e=cc(n,e,t);break e}$s(n,e,i,t)}e=e.child}return e;case 5:return jU(e),n===null&&XC(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,qC(i,r)?o=null:s!==null&&qC(i,s)&&(e.flags|=32),gz(n,e),$s(n,e,o,t),e.child;case 6:return n===null&&XC(e),null;case 13:return yz(n,e,t);case 4:return oP(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=c0(e,null,i,t):$s(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:il(i,r),JI(n,e,i,r,t);case 7:return $s(n,e,e.pendingProps,t),e.child;case 8:return $s(n,e,e.pendingProps.children,t),e.child;case 12:return $s(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Di(_x,i._currentValue),i._currentValue=o,s!==null)if(Sl(s.value,o)){if(s.children===r.children&&!Ro.current){e=cc(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Wu(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),YC(s.return,t,e),a.lanes|=t;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(lt(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),YC(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}$s(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,VA(e,t),r=Ba(r),i=i(r),e.flags|=1,$s(n,e,i,t),e.child;case 14:return i=e.type,r=il(i,e.pendingProps),r=il(i.type,r),eD(n,e,i,r,t);case 15:return Az(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:il(i,r),w2(n,e),e.tag=1,Po(i)?(n=!0,gx(e)):n=!1,VA(e,t),fz(e,i,r),KC(e,i,r,t),eM(null,e,i,!0,n,t);case 19:return _z(n,e,t);case 22:return mz(n,e,t)}throw Error(lt(156,e.tag))};function Fz(n,e){return uU(n,e)}function iee(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(n,e,t,i){return new iee(n,e,t,i)}function xP(n){return n=n.prototype,!(!n||!n.isReactComponent)}function ree(n){if(typeof n=="function")return xP(n)?1:0;if(n!=null){if(n=n.$$typeof,n===z5)return 11;if(n===V5)return 14}return 2}function Lh(n,e){var t=n.alternate;return t===null?(t=Na(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function C2(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")xP(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case aA:return xd(t.children,r,s,e);case U5:o=8,r|=8;break;case xC:return n=Na(12,t,e,r|2),n.elementType=xC,n.lanes=s,n;case bC:return n=Na(13,t,e,r),n.elementType=bC,n.lanes=s,n;case SC:return n=Na(19,t,e,r),n.elementType=SC,n.lanes=s,n;case j9:return kS(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case H9:o=10;break e;case $9:o=9;break e;case z5:o=11;break e;case V5:o=14;break e;case oh:o=16,i=null;break e}throw Error(lt(130,n==null?n:typeof n,""))}return e=Na(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function xd(n,e,t,i){return n=Na(7,n,i,e),n.lanes=t,n}function kS(n,e,t,i){return n=Na(22,n,i,e),n.elementType=j9,n.lanes=t,n.stateNode={isHidden:!1},n}function FE(n,e,t){return n=Na(6,n,null,e),n.lanes=t,n}function BE(n,e,t){return e=Na(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function see(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gE(0),this.expirationTimes=gE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gE(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function bP(n,e,t,i,r,s,o,a,l){return n=new see(n,e,t,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Na(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},sP(s),n}function oee(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:oA,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function Bz(n){if(!n)return Xh;n=n._reactInternals;e:{if(Kd(n)!==n||n.tag!==1)throw Error(lt(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Po(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(lt(171))}if(n.tag===1){var t=n.type;if(Po(t))return BU(n,t,e)}return e}function Oz(n,e,t,i,r,s,o,a,l){return n=bP(t,i,!0,n,r,s,o,a,l),n.context=Bz(null),t=n.current,i=eo(),r=kh(t),s=Wu(i,r),s.callback=e??null,Ih(t,s,r),n.current.lanes=r,gv(n,r,i),No(n,i),n}function LS(n,e,t,i){var r=e.current,s=eo(),o=kh(r);return t=Bz(t),e.context===null?e.context=t:e.pendingContext=t,e=Wu(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Ih(r,e,o),n!==null&&(_l(n,r,o,s),x2(n,r,o)),o}function Px(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function fD(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function SP(n,e){fD(n,e),(n=n.alternate)&&fD(n,e)}function aee(){return null}var Uz=typeof reportError=="function"?reportError:function(n){console.error(n)};function wP(n){this._internalRoot=n}FS.prototype.render=wP.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(lt(409));LS(n,e,null,null)};FS.prototype.unmount=wP.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Pd(function(){LS(null,n,null,null)}),e[lc]=null}};function FS(n){this._internalRoot=n}FS.prototype.unstable_scheduleHydration=function(n){if(n){var e=mU();n={blockedOn:null,target:n,priority:e};for(var t=0;t<dh.length&&e!==0&&e<dh[t].priority;t++);dh.splice(t,0,n),t===0&&vU(n)}};function EP(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function BS(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function dD(){}function lee(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=Px(o);s.call(u)}}var o=Oz(e,i,n,0,null,!1,!1,"",dD);return n._reactRootContainer=o,n[lc]=o.current,f1(n.nodeType===8?n.parentNode:n),Pd(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=Px(l);a.call(u)}}var l=bP(n,0,!1,null,null,!1,!1,"",dD);return n._reactRootContainer=l,n[lc]=l.current,f1(n.nodeType===8?n.parentNode:n),Pd(function(){LS(e,l,t,i)}),l}function OS(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=Px(o);a.call(l)}}LS(e,o,n,r)}else o=lee(t,e,n,r,i);return Px(o)}pU=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=hg(e.pendingLanes);t!==0&&(H5(e,t|1),No(e,vr()),!(ri&6)&&(d0=vr()+500,hf()))}break;case 13:Pd(function(){var i=uc(n,1);if(i!==null){var r=eo();_l(i,n,1,r)}}),SP(n,1)}};$5=function(n){if(n.tag===13){var e=uc(n,134217728);if(e!==null){var t=eo();_l(e,n,134217728,t)}SP(n,134217728)}};AU=function(n){if(n.tag===13){var e=kh(n),t=uc(n,e);if(t!==null){var i=eo();_l(t,n,e,i)}SP(n,e)}};mU=function(){return xi};gU=function(n,e){var t=xi;try{return xi=n,e()}finally{xi=t}};DC=function(n,e,t){switch(e){case"input":if(TC(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=MS(i);if(!r)throw Error(lt(90));X9(i),TC(i,r)}}}break;case"textarea":Q9(n,t);break;case"select":e=t.value,e!=null&&BA(n,!!t.multiple,e,!1)}};iU=vP;rU=Pd;var uee={usingClientEntryPoint:!1,Events:[yv,hA,MS,tU,nU,vP]},Nm={findFiberByHostInstance:od,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cee={bundleType:Nm.bundleType,version:Nm.version,rendererPackageName:Nm.rendererPackageName,rendererConfig:Nm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wc.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=aU(n),n===null?null:n.stateNode},findFiberByHostInstance:Nm.findFiberByHostInstance||aee,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var My=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!My.isDisabled&&My.supportsFiber)try{wS=My.inject(cee),Yl=My}catch{}}ca.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uee;ca.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!EP(e))throw Error(lt(200));return oee(n,e,null,t)};ca.createRoot=function(n,e){if(!EP(n))throw Error(lt(299));var t=!1,i="",r=Uz;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=bP(n,1,!1,null,null,t,!1,i,r),n[lc]=e.current,f1(n.nodeType===8?n.parentNode:n),new wP(e)};ca.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(lt(188)):(n=Object.keys(n).join(","),Error(lt(268,n)));return n=aU(e),n=n===null?null:n.stateNode,n};ca.flushSync=function(n){return Pd(n)};ca.hydrate=function(n,e,t){if(!BS(e))throw Error(lt(200));return OS(null,n,e,!0,t)};ca.hydrateRoot=function(n,e,t){if(!EP(n))throw Error(lt(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=Uz;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=Oz(e,null,n,1,t??null,r,!1,s,o),n[lc]=e.current,f1(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new FS(e)};ca.render=function(n,e,t){if(!BS(e))throw Error(lt(200));return OS(null,n,e,!1,t)};ca.unmountComponentAtNode=function(n){if(!BS(n))throw Error(lt(40));return n._reactRootContainer?(Pd(function(){OS(null,null,n,!1,function(){n._reactRootContainer=null,n[lc]=null})}),!0):!1};ca.unstable_batchedUpdates=vP;ca.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!BS(t))throw Error(lt(200));if(n==null||n._reactInternals===void 0)throw Error(lt(38));return OS(n,e,t,!1,i)};ca.version="18.3.1-next-f1338f8080-20240426";function zz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zz)}catch(n){console.error(n)}}zz(),z9.exports=ca;var Vz=z9.exports;const Ry=G0(Vz);var Gz,pD=Vz;Gz=pD.createRoot,pD.hydrateRoot;var TP={};Object.defineProperty(TP,"__esModule",{value:!0});TP.parse=gee;TP.serialize=vee;const hee=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,fee=/^[\u0021-\u003A\u003C-\u007E]*$/,dee=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,pee=/^[\u0020-\u003A\u003D-\u007E]*$/,Aee=Object.prototype.toString,mee=(()=>{const n=function(){};return n.prototype=Object.create(null),n})();function gee(n,e){const t=new mee,i=n.length;if(i<2)return t;const r=(e==null?void 0:e.decode)||yee;let s=0;do{const o=n.indexOf("=",s);if(o===-1)break;const a=n.indexOf(";",s),l=a===-1?i:a;if(o>l){s=n.lastIndexOf(";",o-1)+1;continue}const u=AD(n,s,o),c=mD(n,o,u),h=n.slice(u,c);if(t[h]===void 0){let A=AD(n,o+1,l),v=mD(n,l,A);const _=r(n.slice(A,v));t[h]=_}s=l+1}while(s<i);return t}function AD(n,e,t){do{const i=n.charCodeAt(e);if(i!==32&&i!==9)return e}while(++e<t);return t}function mD(n,e,t){for(;e>t;){const i=n.charCodeAt(--e);if(i!==32&&i!==9)return e+1}return t}function vee(n,e,t){const i=(t==null?void 0:t.encode)||encodeURIComponent;if(!hee.test(n))throw new TypeError(`argument name is invalid: ${n}`);const r=i(e);if(!fee.test(r))throw new TypeError(`argument val is invalid: ${e}`);let s=n+"="+r;if(!t)return s;if(t.maxAge!==void 0){if(!Number.isInteger(t.maxAge))throw new TypeError(`option maxAge is invalid: ${t.maxAge}`);s+="; Max-Age="+t.maxAge}if(t.domain){if(!dee.test(t.domain))throw new TypeError(`option domain is invalid: ${t.domain}`);s+="; Domain="+t.domain}if(t.path){if(!pee.test(t.path))throw new TypeError(`option path is invalid: ${t.path}`);s+="; Path="+t.path}if(t.expires){if(!_ee(t.expires)||!Number.isFinite(t.expires.valueOf()))throw new TypeError(`option expires is invalid: ${t.expires}`);s+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(s+="; HttpOnly"),t.secure&&(s+="; Secure"),t.partitioned&&(s+="; Partitioned"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():void 0){case"low":s+="; Priority=Low";break;case"medium":s+="; Priority=Medium";break;case"high":s+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${t.priority}`)}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:case"strict":s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"none":s+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${t.sameSite}`)}return s}function yee(n){if(n.indexOf("%")===-1)return n;try{return decodeURIComponent(n)}catch{return n}}function _ee(n){return Aee.call(n)==="[object Date]"}/**
 * react-router v7.1.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var gD="popstate";function xee(n={}){function e(r,s){let{pathname:o="/",search:a="",hash:l=""}=Zd(r.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),fM("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){let o=r.document.querySelector("base"),a="";if(o&&o.getAttribute("href")){let l=r.location.href,u=l.indexOf("#");a=u===-1?l:l.slice(0,u)}return a+"#"+(typeof s=="string"?s:x1(s))}function i(r,s){wl(r.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(s)})`)}return See(e,t,i,n)}function ar(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function wl(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bee(){return Math.random().toString(36).substring(2,10)}function vD(n,e){return{usr:n.state,key:n.key,idx:e}}function fM(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Zd(e):e,state:t,key:e&&e.key||i||bee()}}function x1({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Zd(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function See(n,e,t,i={}){let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a="POP",l=null,u=c();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function c(){return(o.state||{idx:null}).idx}function h(){a="POP";let w=c(),x=w==null?null:w-u;u=w,l&&l({action:a,location:S.location,delta:x})}function A(w,x){a="PUSH";let M=fM(S.location,w,x);t&&t(M,w),u=c()+1;let R=vD(M,u),N=S.createHref(M);try{o.pushState(R,"",N)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;r.location.assign(N)}s&&l&&l({action:a,location:S.location,delta:1})}function v(w,x){a="REPLACE";let M=fM(S.location,w,x);t&&t(M,w),u=c();let R=vD(M,u),N=S.createHref(M);o.replaceState(R,"",N),s&&l&&l({action:a,location:S.location,delta:0})}function _(w){let x=r.location.origin!=="null"?r.location.origin:r.location.href,M=typeof w=="string"?w:x1(w);return M=M.replace(/ $/,"%20"),ar(x,`No window.location.(origin|href) available to create URL for href: ${M}`),new URL(M,x)}let S={get action(){return a},get location(){return n(r,o)},listen(w){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(gD,h),l=w,()=>{r.removeEventListener(gD,h),l=null}},createHref(w){return e(r,w)},createURL:_,encodeLocation(w){let x=_(w);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:A,replace:v,go(w){return o.go(w)}};return S}function qz(n,e,t="/"){return wee(n,e,t,!1)}function wee(n,e,t,i){let r=typeof e=="string"?Zd(e):e,s=Yh(r.pathname||"/",t);if(s==null)return null;let o=Hz(n);Eee(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=Fee(s);a=kee(o[l],u,i)}return a}function Hz(n,e=[],t=[],i=""){let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(ar(l.relativePath.startsWith(i),`Absolute route path "${l.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(i.length));let u=Xu([i,l.relativePath]),c=t.concat(l);s.children&&s.children.length>0&&(ar(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),Hz(s.children,e,c,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:Iee(u,s.index),routesMeta:c})};return n.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of $z(s.path))r(s,o,l)}),e}function $z(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,r=t.endsWith("?"),s=t.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=$z(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function Eee(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Dee(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var Tee=/^:[\w-]+$/,Cee=3,Mee=2,Ree=1,Pee=10,Nee=-2,yD=n=>n==="*";function Iee(n,e){let t=n.split("/"),i=t.length;return t.some(yD)&&(i+=Nee),e&&(i+=Mee),t.filter(r=>!yD(r)).reduce((r,s)=>r+(Tee.test(s)?Cee:s===""?Ree:Pee),i)}function Dee(n,e){return n.length===e.length&&n.slice(0,-1).every((i,r)=>i===e[r])?n[n.length-1]-e[e.length-1]:0}function kee(n,e,t=!1){let{routesMeta:i}=n,r={},s="/",o=[];for(let a=0;a<i.length;++a){let l=i[a],u=a===i.length-1,c=s==="/"?e:e.slice(s.length)||"/",h=Nx({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),A=l.route;if(!h&&u&&t&&!i[i.length-1].route.index&&(h=Nx({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!h)return null;Object.assign(r,h.params),o.push({params:r,pathname:Xu([s,h.pathname]),pathnameBase:zee(Xu([s,h.pathnameBase])),route:A}),h.pathnameBase!=="/"&&(s=Xu([s,h.pathnameBase]))}return o}function Nx(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=Lee(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((u,{paramName:c,isOptional:h},A)=>{if(c==="*"){let _=a[A]||"";o=s.slice(0,s.length-_.length).replace(/(.)\/+$/,"$1")}const v=a[A];return h&&!v?u[c]=void 0:u[c]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:n}}function Lee(n,e=!1,t=!0){wl(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(i.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function Fee(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return wl(!1,`The URL path "${n}" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Yh(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function Bee(n,e="/"){let{pathname:t,search:i="",hash:r=""}=typeof n=="string"?Zd(n):n;return{pathname:t?t.startsWith("/")?t:Oee(t,e):e,search:Vee(i),hash:Gee(r)}}function Oee(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function OE(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Uee(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function jz(n){let e=Uee(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function Wz(n,e,t,i=!1){let r;typeof n=="string"?r=Zd(n):(r={...n},ar(!r.pathname||!r.pathname.includes("?"),OE("?","pathname","search",r)),ar(!r.pathname||!r.pathname.includes("#"),OE("#","pathname","hash",r)),ar(!r.search||!r.search.includes("#"),OE("#","search","hash",r)));let s=n===""||r.pathname==="",o=s?"/":r.pathname,a;if(o==null)a=t;else{let h=e.length-1;if(!i&&o.startsWith("..")){let A=o.split("/");for(;A[0]==="..";)A.shift(),h-=1;r.pathname=A.join("/")}a=h>=0?e[h]:"/"}let l=Bee(r,a),u=o&&o!=="/"&&o.endsWith("/"),c=(s||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var Xu=n=>n.join("/").replace(/\/\/+/g,"/"),zee=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Vee=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Gee=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function qee(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var Xz=["POST","PUT","PATCH","DELETE"];new Set(Xz);var Hee=["GET",...Xz];new Set(Hee);var j0=de.createContext(null);j0.displayName="DataRouter";var US=de.createContext(null);US.displayName="DataRouterState";var Yz=de.createContext({isTransitioning:!1});Yz.displayName="ViewTransition";var $ee=de.createContext(new Map);$ee.displayName="Fetchers";var jee=de.createContext(null);jee.displayName="Await";var uu=de.createContext(null);uu.displayName="Navigation";var xv=de.createContext(null);xv.displayName="Location";var Ec=de.createContext({outlet:null,matches:[],isDataRoute:!1});Ec.displayName="Route";var CP=de.createContext(null);CP.displayName="RouteError";function Wee(n,{relative:e}={}){ar(bv(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=de.useContext(uu),{hash:r,pathname:s,search:o}=Sv(n,{relative:e}),a=s;return t!=="/"&&(a=s==="/"?t:Xu([t,s])),i.createHref({pathname:a,search:o,hash:r})}function bv(){return de.useContext(xv)!=null}function Jd(){return ar(bv(),"useLocation() may be used only in the context of a <Router> component."),de.useContext(xv).location}var Qz="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Kz(n){de.useContext(uu).static||de.useLayoutEffect(n)}function MP(){let{isDataRoute:n}=de.useContext(Ec);return n?ote():Xee()}function Xee(){ar(bv(),"useNavigate() may be used only in the context of a <Router> component.");let n=de.useContext(j0),{basename:e,navigator:t}=de.useContext(uu),{matches:i}=de.useContext(Ec),{pathname:r}=Jd(),s=JSON.stringify(jz(i)),o=de.useRef(!1);return Kz(()=>{o.current=!0}),de.useCallback((l,u={})=>{if(wl(o.current,Qz),!o.current)return;if(typeof l=="number"){t.go(l);return}let c=Wz(l,JSON.parse(s),r,u.relative==="path");n==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Xu([e,c.pathname])),(u.replace?t.replace:t.push)(c,u.state,u)},[e,t,s,r,n])}de.createContext(null);function Sv(n,{relative:e}={}){let{matches:t}=de.useContext(Ec),{pathname:i}=Jd(),r=JSON.stringify(jz(t));return de.useMemo(()=>Wz(n,JSON.parse(r),i,e==="path"),[n,r,i,e])}function Yee(n,e){return Zz(n,e)}function Zz(n,e,t,i){var x;ar(bv(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=de.useContext(uu),{matches:s}=de.useContext(Ec),o=s[s.length-1],a=o?o.params:{},l=o?o.pathname:"/",u=o?o.pathnameBase:"/",c=o&&o.route;{let M=c&&c.path||"";Jz(l,!c||M.endsWith("*")||M.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${M}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${M}"> to <Route path="${M==="/"?"*":`${M}/*`}">.`)}let h=Jd(),A;if(e){let M=typeof e=="string"?Zd(e):e;ar(u==="/"||((x=M.pathname)==null?void 0:x.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${M.pathname}" was given in the \`location\` prop.`),A=M}else A=h;let v=A.pathname||"/",_=v;if(u!=="/"){let M=u.replace(/^\//,"").split("/");_="/"+v.replace(/^\//,"").split("/").slice(M.length).join("/")}let S=qz(n,{pathname:_});wl(c||S!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),wl(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=ete(S&&S.map(M=>Object.assign({},M,{params:Object.assign({},a,M.params),pathname:Xu([u,r.encodeLocation?r.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?u:Xu([u,r.encodeLocation?r.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),s,t,i);return e&&w?de.createElement(xv.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},w):w}function Qee(){let n=ste(),e=qee(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},s={padding:"2px 4px",backgroundColor:i},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=de.createElement(de.Fragment,null,de.createElement("p",null," Hey developer "),de.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",de.createElement("code",{style:s},"ErrorBoundary")," or"," ",de.createElement("code",{style:s},"errorElement")," prop on your route.")),de.createElement(de.Fragment,null,de.createElement("h2",null,"Unexpected Application Error!"),de.createElement("h3",{style:{fontStyle:"italic"}},e),t?de.createElement("pre",{style:r},t):null,o)}var Kee=de.createElement(Qee,null),Zee=class extends de.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?de.createElement(Ec.Provider,{value:this.props.routeContext},de.createElement(CP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Jee({routeContext:n,match:e,children:t}){let i=de.useContext(j0);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),de.createElement(Ec.Provider,{value:n},t)}function ete(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let r=n,s=t==null?void 0:t.errors;if(s!=null){let l=r.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);ar(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),r=r.slice(0,Math.min(r.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<r.length;l++){let u=r[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(a=l),u.route.id){let{loaderData:c,errors:h}=t,A=u.route.loader&&!c.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||A){o=!0,a>=0?r=r.slice(0,a+1):r=[r[0]];break}}}return r.reduceRight((l,u,c)=>{let h,A=!1,v=null,_=null;t&&(h=s&&u.route.id?s[u.route.id]:void 0,v=u.route.errorElement||Kee,o&&(a<0&&c===0?(Jz("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,_=null):a===c&&(A=!0,_=u.route.hydrateFallbackElement||null)));let S=e.concat(r.slice(0,c+1)),w=()=>{let x;return h?x=v:A?x=_:u.route.Component?x=de.createElement(u.route.Component,null):u.route.element?x=u.route.element:x=l,de.createElement(Jee,{match:u,routeContext:{outlet:l,matches:S,isDataRoute:t!=null},children:x})};return t&&(u.route.ErrorBoundary||u.route.errorElement||c===0)?de.createElement(Zee,{location:t.location,revalidation:t.revalidation,component:v,error:h,children:w(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):w()},null)}function RP(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function tte(n){let e=de.useContext(j0);return ar(e,RP(n)),e}function nte(n){let e=de.useContext(US);return ar(e,RP(n)),e}function ite(n){let e=de.useContext(Ec);return ar(e,RP(n)),e}function PP(n){let e=ite(n),t=e.matches[e.matches.length-1];return ar(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function rte(){return PP("useRouteId")}function ste(){var i;let n=de.useContext(CP),e=nte("useRouteError"),t=PP("useRouteError");return n!==void 0?n:(i=e.errors)==null?void 0:i[t]}function ote(){let{router:n}=tte("useNavigate"),e=PP("useNavigate"),t=de.useRef(!1);return Kz(()=>{t.current=!0}),de.useCallback(async(r,s={})=>{wl(t.current,Qz),t.current&&(typeof r=="number"?n.navigate(r):await n.navigate(r,{fromRouteId:e,...s}))},[n,e])}var _D={};function Jz(n,e,t){!e&&!_D[n]&&(_D[n]=!0,wl(!1,t))}de.memo(ate);function ate({routes:n,future:e,state:t}){return Zz(n,void 0,t,e)}function Ja(n){ar(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function lte({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:r,static:s=!1}){ar(!bv(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),a=de.useMemo(()=>({basename:o,navigator:r,static:s,future:{}}),[o,r,s]);typeof t=="string"&&(t=Zd(t));let{pathname:l="/",search:u="",hash:c="",state:h=null,key:A="default"}=t,v=de.useMemo(()=>{let _=Yh(l,o);return _==null?null:{location:{pathname:_,search:u,hash:c,state:h,key:A},navigationType:i}},[o,l,u,c,h,A,i]);return wl(v!=null,`<Router basename="${o}"> is not able to match the URL "${l}${u}${c}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:de.createElement(uu.Provider,{value:a},de.createElement(xv.Provider,{children:e,value:v}))}function ute({children:n,location:e}){return Yee(dM(n),e)}function dM(n,e=[]){let t=[];return de.Children.forEach(n,(i,r)=>{if(!de.isValidElement(i))return;let s=[...e,r];if(i.type===de.Fragment){t.push.apply(t,dM(i.props.children,s));return}ar(i.type===Ja,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ar(!i.props.index||!i.props.children,"An index route cannot have child routes.");let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=dM(i.props.children,s)),t.push(o)}),t}var M2="get",R2="application/x-www-form-urlencoded";function zS(n){return n!=null&&typeof n.tagName=="string"}function cte(n){return zS(n)&&n.tagName.toLowerCase()==="button"}function hte(n){return zS(n)&&n.tagName.toLowerCase()==="form"}function fte(n){return zS(n)&&n.tagName.toLowerCase()==="input"}function dte(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function pte(n,e){return n.button===0&&(!e||e==="_self")&&!dte(n)}var Py=null;function Ate(){if(Py===null)try{new FormData(document.createElement("form"),0),Py=!1}catch{Py=!0}return Py}var mte=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function UE(n){return n!=null&&!mte.has(n)?(wl(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${R2}"`),null):n}function gte(n,e){let t,i,r,s,o;if(hte(n)){let a=n.getAttribute("action");i=a?Yh(a,e):null,t=n.getAttribute("method")||M2,r=UE(n.getAttribute("enctype"))||R2,s=new FormData(n)}else if(cte(n)||fte(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(i=l?Yh(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||M2,r=UE(n.getAttribute("formenctype"))||UE(a.getAttribute("enctype"))||R2,s=new FormData(a,n),!Ate()){let{name:u,type:c,value:h}=n;if(c==="image"){let A=u?`${u}.`:"";s.append(`${A}x`,"0"),s.append(`${A}y`,"0")}else u&&s.append(u,h)}}else{if(zS(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=M2,i=null,r=R2,o=n}return s&&r==="text/plain"&&(o=s,s=void 0),{action:i,method:t.toLowerCase(),encType:r,formData:s,body:o}}function NP(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function vte(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function yte(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function _te(n,e,t){let i=await Promise.all(n.map(async r=>{let s=e.routes[r.route.id];if(s){let o=await vte(s,t);return o.links?o.links():[]}return[]}));return wte(i.flat(1).filter(yte).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function xD(n,e,t,i,r,s){let o=(l,u)=>t[u]?l.route.id!==t[u].route.id:!0,a=(l,u)=>{var c;return t[u].pathname!==l.pathname||((c=t[u].route.path)==null?void 0:c.endsWith("*"))&&t[u].params["*"]!==l.params["*"]};return s==="assets"?e.filter((l,u)=>o(l,u)||a(l,u)):s==="data"?e.filter((l,u)=>{var h;let c=i.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(o(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let A=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((h=t[0])==null?void 0:h.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof A=="boolean")return A}return!0}):[]}function xte(n,e){return bte(n.map(t=>{let i=e.routes[t.route.id];if(!i)return[];let r=[i.module];return i.imports&&(r=r.concat(i.imports)),r}).flat(1))}function bte(n){return[...new Set(n)]}function Ste(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function wte(n,e){let t=new Set;return new Set(e),n.reduce((i,r)=>{let s=JSON.stringify(Ste(r));return t.has(s)||(t.add(s),i.push({key:s,link:r})),i},[])}function Ete(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function Tte(){let n=de.useContext(j0);return NP(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function Cte(){let n=de.useContext(US);return NP(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var IP=de.createContext(void 0);IP.displayName="FrameworkContext";function eV(){let n=de.useContext(IP);return NP(n,"You must render this element inside a <HydratedRouter> element"),n}function Mte(n,e){let t=de.useContext(IP),[i,r]=de.useState(!1),[s,o]=de.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=e,A=de.useRef(null);de.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let S=x=>{x.forEach(M=>{o(M.isIntersecting)})},w=new IntersectionObserver(S,{threshold:.5});return A.current&&w.observe(A.current),()=>{w.disconnect()}}},[n]),de.useEffect(()=>{if(i){let S=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(S)}}},[i]);let v=()=>{r(!0)},_=()=>{r(!1),o(!1)};return t?n!=="intent"?[s,A,{}]:[s,A,{onFocus:Im(a,v),onBlur:Im(l,_),onMouseEnter:Im(u,v),onMouseLeave:Im(c,_),onTouchStart:Im(h,v)}]:[!1,A,{}]}function Im(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function Rte({page:n,...e}){let{router:t}=Tte(),i=de.useMemo(()=>qz(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?de.createElement(Nte,{page:n,matches:i,...e}):null}function Pte(n){let{manifest:e,routeModules:t}=eV(),[i,r]=de.useState([]);return de.useEffect(()=>{let s=!1;return _te(n,e,t).then(o=>{s||r(o)}),()=>{s=!0}},[n,e,t]),i}function Nte({page:n,matches:e,...t}){let i=Jd(),{manifest:r,routeModules:s}=eV(),{loaderData:o,matches:a}=Cte(),l=de.useMemo(()=>xD(n,e,a,r,i,"data"),[n,e,a,r,i]),u=de.useMemo(()=>xD(n,e,a,r,i,"assets"),[n,e,a,r,i]),c=de.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let v=new Set,_=!1;if(e.forEach(w=>{var M;let x=r.routes[w.route.id];!x||!x.hasLoader||(!l.some(R=>R.route.id===w.route.id)&&w.route.id in o&&((M=s[w.route.id])!=null&&M.shouldRevalidate)||x.hasClientLoader?_=!0:v.add(w.route.id))}),v.size===0)return[];let S=Ete(n);return _&&v.size>0&&S.searchParams.set("_routes",e.filter(w=>v.has(w.route.id)).map(w=>w.route.id).join(",")),[S.pathname+S.search]},[o,i,r,l,e,n,s]),h=de.useMemo(()=>xte(u,r),[u,r]),A=Pte(u);return de.createElement(de.Fragment,null,c.map(v=>de.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...t})),h.map(v=>de.createElement("link",{key:v,rel:"modulepreload",href:v,...t})),A.map(({key:v,link:_})=>de.createElement("link",{key:v,..._})))}function Ite(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var tV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{tV&&(window.__reactRouterVersion="7.1.0")}catch{}function Dte({basename:n,children:e,window:t}){let i=de.useRef();i.current==null&&(i.current=xee({window:t,v5Compat:!0}));let r=i.current,[s,o]=de.useState({action:r.action,location:r.location}),a=de.useCallback(l=>{de.startTransition(()=>o(l))},[o]);return de.useLayoutEffect(()=>r.listen(a),[r,a]),de.createElement(lte,{basename:n,children:e,location:s.location,navigationType:s.action,navigator:r})}var nV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_o=de.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:r,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h,...A},v){let{basename:_}=de.useContext(uu),S=typeof u=="string"&&nV.test(u),w,x=!1;if(typeof u=="string"&&S&&(w=u,tV))try{let L=new URL(window.location.href),O=u.startsWith("//")?new URL(L.protocol+u):new URL(u),z=Yh(O.pathname,_);O.origin===L.origin&&z!=null?u=z+O.search+O.hash:x=!0}catch{wl(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let M=Wee(u,{relative:r}),[R,N,B]=Mte(i,A),T=Bte(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:r,viewTransition:h});function D(L){e&&e(L),L.defaultPrevented||T(L)}let F=de.createElement("a",{...A,...B,href:w||M,onClick:x||s?e:D,ref:Ite(v,N),target:l,"data-discover":!S&&t==="render"?"true":void 0});return R&&!S?de.createElement(de.Fragment,null,F,de.createElement(Rte,{page:M})):F});_o.displayName="Link";var kte=de.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:r=!1,style:s,to:o,viewTransition:a,children:l,...u},c){let h=Sv(o,{relative:u.relative}),A=Jd(),v=de.useContext(US),{navigator:_,basename:S}=de.useContext(uu),w=v!=null&&Gte(h)&&a===!0,x=_.encodeLocation?_.encodeLocation(h).pathname:h.pathname,M=A.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(M=M.toLowerCase(),R=R?R.toLowerCase():null,x=x.toLowerCase()),R&&S&&(R=Yh(R,S)||R);const N=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let B=M===x||!r&&M.startsWith(x)&&M.charAt(N)==="/",T=R!=null&&(R===x||!r&&R.startsWith(x)&&R.charAt(x.length)==="/"),D={isActive:B,isPending:T,isTransitioning:w},F=B?e:void 0,L;typeof i=="function"?L=i(D):L=[i,B?"active":null,T?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let O=typeof s=="function"?s(D):s;return de.createElement(_o,{...u,"aria-current":F,className:L,ref:c,style:O,to:o,viewTransition:a},typeof l=="function"?l(D):l)});kte.displayName="NavLink";var Lte=de.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:r,state:s,method:o=M2,action:a,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:h,...A},v)=>{let _=zte(),S=Vte(a,{relative:u}),w=o.toLowerCase()==="get"?"get":"post",x=typeof a=="string"&&nV.test(a),M=R=>{if(l&&l(R),R.defaultPrevented)return;R.preventDefault();let N=R.nativeEvent.submitter,B=(N==null?void 0:N.getAttribute("formmethod"))||o;_(N||R.currentTarget,{fetcherKey:e,method:B,navigate:t,replace:r,state:s,relative:u,preventScrollReset:c,viewTransition:h})};return de.createElement("form",{ref:v,method:w,action:S,onSubmit:i?l:M,...A,"data-discover":!x&&n==="render"?"true":void 0})});Lte.displayName="Form";function Fte(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function iV(n){let e=de.useContext(j0);return ar(e,Fte(n)),e}function Bte(n,{target:e,replace:t,state:i,preventScrollReset:r,relative:s,viewTransition:o}={}){let a=MP(),l=Jd(),u=Sv(n,{relative:s});return de.useCallback(c=>{if(pte(c,e)){c.preventDefault();let h=t!==void 0?t:x1(l)===x1(u);a(n,{replace:h,state:i,preventScrollReset:r,relative:s,viewTransition:o})}},[l,a,u,t,i,e,n,r,s,o])}var Ote=0,Ute=()=>`__${String(++Ote)}__`;function zte(){let{router:n}=iV("useSubmit"),{basename:e}=de.useContext(uu),t=rte();return de.useCallback(async(i,r={})=>{let{action:s,method:o,encType:a,formData:l,body:u}=gte(i,e);if(r.navigate===!1){let c=r.fetcherKey||Ute();await n.fetch(c,t,r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||o,formEncType:r.encType||a,flushSync:r.flushSync})}else await n.navigate(r.action||s,{preventScrollReset:r.preventScrollReset,formData:l,body:u,formMethod:r.method||o,formEncType:r.encType||a,replace:r.replace,state:r.state,fromRouteId:t,flushSync:r.flushSync,viewTransition:r.viewTransition})},[n,e,t])}function Vte(n,{relative:e}={}){let{basename:t}=de.useContext(uu),i=de.useContext(Ec);ar(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),s={...Sv(n||".",{relative:e})},o=Jd();if(n==null){s.search=o.search;let a=new URLSearchParams(s.search),l=a.getAll("index");if(l.some(c=>c==="")){a.delete("index"),l.filter(h=>h).forEach(h=>a.append("index",h));let c=a.toString();s.search=c?`?${c}`:""}}return(!n||n===".")&&r.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:Xu([t,s.pathname])),x1(s)}function Gte(n,e={}){let t=de.useContext(Yz);ar(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=iV("useViewTransitionState"),r=Sv(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=Yh(t.currentLocation.pathname,i)||t.currentLocation.pathname,o=Yh(t.nextLocation.pathname,i)||t.nextLocation.pathname;return Nx(r.pathname,o)!=null||Nx(r.pathname,s)!=null}new TextEncoder;const qte="modulepreload",Hte=function(n){return"/"+n},bD={},DP=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(l=>{if(l=Hte(l),l in bD)return;bD[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":qte,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((A,v)=>{h.addEventListener("load",A),h.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};function Ls(){return Ls=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Ls.apply(null,arguments)}function kP(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function b1(n,e){return b1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},b1(n,e)}function VS(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,b1(n,e)}var rV={exports:{}},$te="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",jte=$te,Wte=jte;function sV(){}function oV(){}oV.resetWarningCache=sV;var Xte=function(){function n(i,r,s,o,a,l){if(l!==Wte){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:oV,resetWarningCache:sV};return t.PropTypes=t,t};rV.exports=Xte();var Yte=rV.exports;const V=G0(Yte);function Qte(n,e){return n.classList?!!e&&n.classList.contains(e):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+e+" ")!==-1}function Kte(n,e){n.classList?n.classList.add(e):Qte(n,e)||(typeof n.className=="string"?n.className=n.className+" "+e:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+e))}function SD(n,e){return n.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Zte(n,e){n.classList?n.classList.remove(e):typeof n.className=="string"?n.className=SD(n.className,e):n.setAttribute("class",SD(n.className&&n.className.baseVal||"",e))}const wD={disabled:!1},Ix=_i.createContext(null);var aV=function(e){return e.scrollTop},dg="unmounted",Gf="exited",qf="entering",nA="entered",pM="exiting",Tc=function(n){VS(e,n);function e(i,r){var s;s=n.call(this,i,r)||this;var o=r,a=o&&!o.isMounting?i.enter:i.appear,l;return s.appearStatus=null,i.in?a?(l=Gf,s.appearStatus=qf):l=nA:i.unmountOnExit||i.mountOnEnter?l=dg:l=Gf,s.state={status:l},s.nextCallback=null,s}e.getDerivedStateFromProps=function(r,s){var o=r.in;return o&&s.status===dg?{status:Gf}:null};var t=e.prototype;return t.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},t.componentDidUpdate=function(r){var s=null;if(r!==this.props){var o=this.state.status;this.props.in?o!==qf&&o!==nA&&(s=qf):(o===qf||o===nA)&&(s=pM)}this.updateStatus(!1,s)},t.componentWillUnmount=function(){this.cancelNextCallback()},t.getTimeouts=function(){var r=this.props.timeout,s,o,a;return s=o=a=r,r!=null&&typeof r!="number"&&(s=r.exit,o=r.enter,a=r.appear!==void 0?r.appear:o),{exit:s,enter:o,appear:a}},t.updateStatus=function(r,s){if(r===void 0&&(r=!1),s!==null)if(this.cancelNextCallback(),s===qf){if(this.props.unmountOnExit||this.props.mountOnEnter){var o=this.props.nodeRef?this.props.nodeRef.current:Ry.findDOMNode(this);o&&aV(o)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Gf&&this.setState({status:dg})},t.performEnter=function(r){var s=this,o=this.props.enter,a=this.context?this.context.isMounting:r,l=this.props.nodeRef?[a]:[Ry.findDOMNode(this),a],u=l[0],c=l[1],h=this.getTimeouts(),A=a?h.appear:h.enter;if(!r&&!o||wD.disabled){this.safeSetState({status:nA},function(){s.props.onEntered(u)});return}this.props.onEnter(u,c),this.safeSetState({status:qf},function(){s.props.onEntering(u,c),s.onTransitionEnd(A,function(){s.safeSetState({status:nA},function(){s.props.onEntered(u,c)})})})},t.performExit=function(){var r=this,s=this.props.exit,o=this.getTimeouts(),a=this.props.nodeRef?void 0:Ry.findDOMNode(this);if(!s||wD.disabled){this.safeSetState({status:Gf},function(){r.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:pM},function(){r.props.onExiting(a),r.onTransitionEnd(o.exit,function(){r.safeSetState({status:Gf},function(){r.props.onExited(a)})})})},t.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},t.safeSetState=function(r,s){s=this.setNextCallback(s),this.setState(r,s)},t.setNextCallback=function(r){var s=this,o=!0;return this.nextCallback=function(a){o&&(o=!1,s.nextCallback=null,r(a))},this.nextCallback.cancel=function(){o=!1},this.nextCallback},t.onTransitionEnd=function(r,s){this.setNextCallback(s);var o=this.props.nodeRef?this.props.nodeRef.current:Ry.findDOMNode(this),a=r==null&&!this.props.addEndListener;if(!o||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[o,this.nextCallback],u=l[0],c=l[1];this.props.addEndListener(u,c)}r!=null&&setTimeout(this.nextCallback,r)},t.render=function(){var r=this.state.status;if(r===dg)return null;var s=this.props,o=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var a=kP(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return _i.createElement(Ix.Provider,{value:null},typeof o=="function"?o(r,a):_i.cloneElement(_i.Children.only(o),a))},e}(_i.Component);Tc.contextType=Ix;Tc.propTypes={};function mp(){}Tc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:mp,onEntering:mp,onEntered:mp,onExit:mp,onExiting:mp,onExited:mp};Tc.UNMOUNTED=dg;Tc.EXITED=Gf;Tc.ENTERING=qf;Tc.ENTERED=nA;Tc.EXITING=pM;var Jte=function(e,t){return e&&t&&t.split(" ").forEach(function(i){return Kte(e,i)})},zE=function(e,t){return e&&t&&t.split(" ").forEach(function(i){return Zte(e,i)})},LP=function(n){VS(e,n);function e(){for(var i,r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=n.call.apply(n,[this].concat(s))||this,i.appliedClasses={appear:{},enter:{},exit:{}},i.onEnter=function(a,l){var u=i.resolveArguments(a,l),c=u[0],h=u[1];i.removeClasses(c,"exit"),i.addClass(c,h?"appear":"enter","base"),i.props.onEnter&&i.props.onEnter(a,l)},i.onEntering=function(a,l){var u=i.resolveArguments(a,l),c=u[0],h=u[1],A=h?"appear":"enter";i.addClass(c,A,"active"),i.props.onEntering&&i.props.onEntering(a,l)},i.onEntered=function(a,l){var u=i.resolveArguments(a,l),c=u[0],h=u[1],A=h?"appear":"enter";i.removeClasses(c,A),i.addClass(c,A,"done"),i.props.onEntered&&i.props.onEntered(a,l)},i.onExit=function(a){var l=i.resolveArguments(a),u=l[0];i.removeClasses(u,"appear"),i.removeClasses(u,"enter"),i.addClass(u,"exit","base"),i.props.onExit&&i.props.onExit(a)},i.onExiting=function(a){var l=i.resolveArguments(a),u=l[0];i.addClass(u,"exit","active"),i.props.onExiting&&i.props.onExiting(a)},i.onExited=function(a){var l=i.resolveArguments(a),u=l[0];i.removeClasses(u,"exit"),i.addClass(u,"exit","done"),i.props.onExited&&i.props.onExited(a)},i.resolveArguments=function(a,l){return i.props.nodeRef?[i.props.nodeRef.current,a]:[a,l]},i.getClassNames=function(a){var l=i.props.classNames,u=typeof l=="string",c=u&&l?l+"-":"",h=u?""+c+a:l[a],A=u?h+"-active":l[a+"Active"],v=u?h+"-done":l[a+"Done"];return{baseClassName:h,activeClassName:A,doneClassName:v}},i}var t=e.prototype;return t.addClass=function(r,s,o){var a=this.getClassNames(s)[o+"ClassName"],l=this.getClassNames("enter"),u=l.doneClassName;s==="appear"&&o==="done"&&u&&(a+=" "+u),o==="active"&&r&&aV(r),a&&(this.appliedClasses[s][o]=a,Jte(r,a))},t.removeClasses=function(r,s){var o=this.appliedClasses[s],a=o.base,l=o.active,u=o.done;this.appliedClasses[s]={},a&&zE(r,a),l&&zE(r,l),u&&zE(r,u)},t.render=function(){var r=this.props;r.classNames;var s=kP(r,["classNames"]);return _i.createElement(Tc,Ls({},s,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},e}(_i.Component);LP.defaultProps={classNames:""};LP.propTypes={};function lV(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function FP(n,e){var t=function(s){return e&&de.isValidElement(s)?e(s):s},i=Object.create(null);return n&&de.Children.map(n,function(r){return r}).forEach(function(r){i[r.key]=t(r)}),i}function ene(n,e){n=n||{},e=e||{};function t(c){return c in e?e[c]:n[c]}var i=Object.create(null),r=[];for(var s in n)s in e?r.length&&(i[s]=r,r=[]):r.push(s);var o,a={};for(var l in e){if(i[l])for(o=0;o<i[l].length;o++){var u=i[l][o];a[i[l][o]]=t(u)}a[l]=t(l)}for(o=0;o<r.length;o++)a[r[o]]=t(r[o]);return a}function ud(n,e,t){return t[e]!=null?t[e]:n.props[e]}function tne(n,e){return FP(n.children,function(t){return de.cloneElement(t,{onExited:e.bind(null,t),in:!0,appear:ud(t,"appear",n),enter:ud(t,"enter",n),exit:ud(t,"exit",n)})})}function nne(n,e,t){var i=FP(n.children),r=ene(e,i);return Object.keys(r).forEach(function(s){var o=r[s];if(de.isValidElement(o)){var a=s in e,l=s in i,u=e[s],c=de.isValidElement(u)&&!u.props.in;l&&(!a||c)?r[s]=de.cloneElement(o,{onExited:t.bind(null,o),in:!0,exit:ud(o,"exit",n),enter:ud(o,"enter",n)}):!l&&a&&!c?r[s]=de.cloneElement(o,{in:!1}):l&&a&&de.isValidElement(u)&&(r[s]=de.cloneElement(o,{onExited:t.bind(null,o),in:u.props.in,exit:ud(o,"exit",n),enter:ud(o,"enter",n)}))}}),r}var ine=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},rne={component:"div",childFactory:function(e){return e}},BP=function(n){VS(e,n);function e(i,r){var s;s=n.call(this,i,r)||this;var o=s.handleExited.bind(lV(s));return s.state={contextValue:{isMounting:!0},handleExited:o,firstRender:!0},s}var t=e.prototype;return t.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},t.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(r,s){var o=s.children,a=s.handleExited,l=s.firstRender;return{children:l?tne(r,a):nne(r,o,a),firstRender:!1}},t.handleExited=function(r,s){var o=FP(this.props.children);r.key in o||(r.props.onExited&&r.props.onExited(s),this.mounted&&this.setState(function(a){var l=Ls({},a.children);return delete l[r.key],{children:l}}))},t.render=function(){var r=this.props,s=r.component,o=r.childFactory,a=kP(r,["component","childFactory"]),l=this.state.contextValue,u=ine(this.state.children).map(o);return delete a.appear,delete a.enter,delete a.exit,s===null?_i.createElement(Ix.Provider,{value:l},u):_i.createElement(Ix.Provider,{value:l},_i.createElement(s,a,u))},e}(_i.Component);BP.propTypes={};BP.defaultProps=rne;const sne="/dfd.jpg";var uV={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ED=_i.createContext&&_i.createContext(uV),one=["attr","size","title"];function ane(n,e){if(n==null)return{};var t=lne(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function lne(n,e){if(n==null)return{};var t={};for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){if(e.indexOf(i)>=0)continue;t[i]=n[i]}return t}function Dx(){return Dx=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Dx.apply(this,arguments)}function TD(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function kx(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?TD(Object(t),!0).forEach(function(i){une(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):TD(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function une(n,e,t){return e=cne(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function cne(n){var e=hne(n,"string");return typeof e=="symbol"?e:e+""}function hne(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function cV(n){return n&&n.map((e,t)=>_i.createElement(e.tag,kx({key:t},e.attr),cV(e.child)))}function fne(n){return e=>_i.createElement(dne,Dx({attr:kx({},n.attr)},e),cV(n.child))}function dne(n){var e=t=>{var{attr:i,size:r,title:s}=n,o=ane(n,one),a=r||t.size||"1em",l;return t.className&&(l=t.className),n.className&&(l=(l?l+" ":"")+n.className),_i.createElement("svg",Dx({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,o,{className:l,style:kx(kx({color:n.color||t.color},t.style),n.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&_i.createElement("title",null,s),n.children)};return ED!==void 0?_i.createElement(ED.Consumer,null,t=>e(t)):e(uV)}function pne(n){return fne({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(n)}function Ane(){return fe.jsxs("div",{className:"navbar",children:[fe.jsx("img",{src:sne,alt:"Logo",className:"navbar-logo"}),fe.jsxs("div",{className:"navbar-links",children:[fe.jsx("a",{href:"/#/unit-overview",children:"Unit Overview"}),fe.jsx("a",{href:"/#/references",children:"References"}),fe.jsx("a",{href:"/#/contact",children:"Contact"}),fe.jsx(pne,{className:"navbar-search-icon"})]})]})}function mne(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function gne(n,e,t){return e=Ene(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function CD(n,e){return _ne(n)||mne(n,e)||hV(n,e)||Sne()}function vne(n){return yne(n)||xne(n)||hV(n)||bne()}function yne(n){if(Array.isArray(n))return AM(n)}function _ne(n){if(Array.isArray(n))return n}function xne(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function hV(n,e){if(n){if(typeof n=="string")return AM(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return AM(n,e)}}function AM(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function bne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wne(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ene(n){var e=wne(n,"string");return typeof e=="symbol"?e:String(e)}var Tne=function(e,t){var i=new Set(t);return Object.assign.apply(Object,[{}].concat(vne(Object.entries(e).filter(function(r){var s=CD(r,1),o=s[0];return!i.has(o)}).map(function(r){var s=CD(r,2),o=s[0],a=s[1];return gne({},o,a)}))))};/*! fromentries. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Cne=function(e){return[...e].reduce((t,[i,r])=>(t[i]=r,t),{})};const MD=G0(Cne);function mM(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Mne(n){if(Array.isArray(n))return n}function Rne(n){if(Array.isArray(n))return mM(n)}function Pne(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Nne(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Ine(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fV(n,e){return Mne(n)||Nne(n,e)||dV(n,e)||Ine()}function RD(n){return Rne(n)||Pne(n)||dV(n)||Dne()}function gM(n){"@babel/helpers - typeof";return gM=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gM(n)}function dV(n,e){if(n){if(typeof n=="string")return mM(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?mM(n,e):void 0}}function kne(n,e){var t=gM(e)==="object"?e:{wrapperElementType:e,methodNames:(arguments.length<=2?void 0:arguments[2])||void 0,initPropNames:(arguments.length<=3?void 0:arguments[3])||void 0},i=t.wrapperElementType,r=i===void 0?"div":i,s=t.nodeMapper,o=s===void 0?function(h){return h}:s,a=t.methodNames,l=a===void 0?[]:a,u=t.initPropNames,c=u===void 0?[]:u;return de.forwardRef(function(h,A){var v=de.useRef(),_=de.useState({}),S=fV(_,2),w=S[0],x=S[1];de.useEffect(function(){return x(h)});var M=de.useMemo(function(){var B=MD(c.filter(function(T){return h.hasOwnProperty(T)}).map(function(T){return[T,h[T]]}));return n(B)},[]);PD(function(){M(o(v.current))},de.useLayoutEffect),PD(function(){return M._destructor instanceof Function?M._destructor:void 0});var R=de.useCallback(function(B){for(var T=arguments.length,D=new Array(T>1?T-1:0),F=1;F<T;F++)D[F-1]=arguments[F];return M[B]instanceof Function?M[B].apply(M,D):void 0},[M]),N=Tne(h,[].concat(RD(l),RD(c)));return Object.keys(N).filter(function(B){return w[B]!==h[B]}).forEach(function(B){return R(B,h[B])}),de.useImperativeHandle(A,function(){return MD(l.map(function(B){return[B,function(){for(var T=arguments.length,D=new Array(T),F=0;F<T;F++)D[F]=arguments[F];return R.apply(void 0,[B].concat(D))}]}))}),_i.createElement(r,{ref:v})})}function PD(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:de.useEffect,t=de.useRef(),i=de.useRef(!1),r=de.useRef(!1),s=de.useState(0),o=fV(s,2);o[0];var a=o[1];i.current&&(r.current=!0),e(function(){return i.current||(t.current=n(),i.current=!0),a(function(l){return l+1}),function(){r.current&&t.current&&t.current()}},[])}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const GS="170",sa={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},vA={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Lne=0,ND=1,Fne=2,pV=1,Bne=2,Pu=3,Qh=0,Ds=1,Ks=2,Yu=0,Fh=1,ID=2,DD=3,kD=4,One=5,Zf=100,Une=101,zne=102,Vne=103,Gne=104,qne=200,Hne=201,$ne=202,jne=203,vM=204,yM=205,Wne=206,Xne=207,Yne=208,Qne=209,Kne=210,Zne=211,Jne=212,eie=213,tie=214,_M=0,xM=1,bM=2,p0=3,SM=4,wM=5,EM=6,TM=7,qS=0,nie=1,iie=2,Bh=0,rie=1,sie=2,oie=3,aie=4,lie=5,uie=6,cie=7,AV=300,A0=301,m0=302,CM=303,MM=304,HS=306,RM=1e3,cd=1001,PM=1002,xl=1003,hie=1004,Ny=1005,$l=1006,VE=1007,hd=1008,hc=1009,mV=1010,gV=1011,S1=1012,OP=1013,Nd=1014,Vu=1015,W0=1016,UP=1017,zP=1018,g0=1020,vV=35902,yV=1021,_V=1022,dl=1023,xV=1024,bV=1025,qA=1026,v0=1027,SV=1028,VP=1029,wV=1030,GP=1031,qP=1033,P2=33776,N2=33777,I2=33778,D2=33779,NM=35840,IM=35841,DM=35842,kM=35843,LM=36196,FM=37492,BM=37496,OM=37808,UM=37809,zM=37810,VM=37811,GM=37812,qM=37813,HM=37814,$M=37815,jM=37816,WM=37817,XM=37818,YM=37819,QM=37820,KM=37821,k2=36492,ZM=36494,JM=36495,EV=36283,e4=36284,t4=36285,n4=36286,fie=0,die=1,LD=2,pie=3200,Aie=3201,HP=0,mie=1,Ah="",vo="srgb",X0="srgb-linear",$S="linear",wi="srgb",gp=7680,FD=519,gie=512,vie=513,yie=514,TV=515,_ie=516,xie=517,bie=518,Sie=519,i4=35044,BD="300 es",Gu=2e3,Lx=2001;let ff=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const xs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let OD=1234567;const Lg=Math.PI/180,w1=180/Math.PI;function Kl(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(xs[n&255]+xs[n>>8&255]+xs[n>>16&255]+xs[n>>24&255]+"-"+xs[e&255]+xs[e>>8&255]+"-"+xs[e>>16&15|64]+xs[e>>24&255]+"-"+xs[t&63|128]+xs[t>>8&255]+"-"+xs[t>>16&255]+xs[t>>24&255]+xs[i&255]+xs[i>>8&255]+xs[i>>16&255]+xs[i>>24&255]).toLowerCase()}function Lr(n,e,t){return Math.max(e,Math.min(t,n))}function $P(n,e){return(n%e+e)%e}function wie(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function Eie(n,e,t){return n!==e?(t-n)/(e-n):0}function Fg(n,e,t){return(1-t)*n+t*e}function Tie(n,e,t,i){return Fg(n,e,1-Math.exp(-t*i))}function Cie(n,e=1){return e-Math.abs($P(n,e*2)-e)}function Mie(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Rie(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function Pie(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Nie(n,e){return n+Math.random()*(e-n)}function Iie(n){return n*(.5-Math.random())}function Die(n){n!==void 0&&(OD=n);let e=OD+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function kie(n){return n*Lg}function Lie(n){return n*w1}function Fie(n){return(n&n-1)===0&&n!==0}function Bie(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Oie(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Uie(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),c=o((e+i)/2),h=s((e-i)/2),A=o((e-i)/2),v=s((i-e)/2),_=o((i-e)/2);switch(r){case"XYX":n.set(a*c,l*h,l*A,a*u);break;case"YZY":n.set(l*A,a*c,l*h,a*u);break;case"ZXZ":n.set(l*h,l*A,a*c,a*u);break;case"XZX":n.set(a*c,l*_,l*v,a*u);break;case"YXY":n.set(l*v,a*c,l*_,a*u);break;case"ZYZ":n.set(l*_,l*v,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ul(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function yi(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Fx={DEG2RAD:Lg,RAD2DEG:w1,generateUUID:Kl,clamp:Lr,euclideanModulo:$P,mapLinear:wie,inverseLerp:Eie,lerp:Fg,damp:Tie,pingpong:Cie,smoothstep:Mie,smootherstep:Rie,randInt:Pie,randFloat:Nie,randFloatSpread:Iie,seededRandom:Die,degToRad:kie,radToDeg:Lie,isPowerOfTwo:Fie,ceilPowerOfTwo:Bie,floorPowerOfTwo:Oie,setQuaternionFromProperEuler:Uie,normalize:yi,denormalize:ul};let rt=class CV{constructor(e=0,t=0){CV.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Lr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Ln=class MV{constructor(e,t,i,r,s,o,a,l,u){MV.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=s,c[5]=l,c[6]=i,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],c=i[4],h=i[7],A=i[2],v=i[5],_=i[8],S=r[0],w=r[3],x=r[6],M=r[1],R=r[4],N=r[7],B=r[2],T=r[5],D=r[8];return s[0]=o*S+a*M+l*B,s[3]=o*w+a*R+l*T,s[6]=o*x+a*N+l*D,s[1]=u*S+c*M+h*B,s[4]=u*w+c*R+h*T,s[7]=u*x+c*N+h*D,s[2]=A*S+v*M+_*B,s[5]=A*w+v*R+_*T,s[8]=A*x+v*N+_*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-i*s*c+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,A=a*l-c*s,v=u*s-o*l,_=t*h+i*A+r*v;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const S=1/_;return e[0]=h*S,e[1]=(r*u-c*i)*S,e[2]=(a*i-r*o)*S,e[3]=A*S,e[4]=(c*t-r*l)*S,e[5]=(r*s-a*t)*S,e[6]=v*S,e[7]=(i*l-u*t)*S,e[8]=(o*t-i*s)*S,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(GE.makeScale(e,t)),this}rotate(e){return this.premultiply(GE.makeRotation(-e)),this}translate(e,t){return this.premultiply(GE.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}};const GE=new Ln;function RV(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function E1(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function zie(){const n=E1("canvas");return n.style.display="block",n}const UD={};function pg(n){n in UD||(UD[n]=!0,console.warn(n))}function Vie(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}function Gie(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function qie(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const ni={enabled:!0,workingColorSpace:X0,spaces:{},convert:function(n,e,t){return this.enabled===!1||e===t||!e||!t||(this.spaces[e].transfer===wi&&(n.r=Qu(n.r),n.g=Qu(n.g),n.b=Qu(n.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(n.applyMatrix3(this.spaces[e].toXYZ),n.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===wi&&(n.r=HA(n.r),n.g=HA(n.g),n.b=HA(n.b))),n},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)},getPrimaries:function(n){return this.spaces[n].primaries},getTransfer:function(n){return n===Ah?$S:this.spaces[n].transfer},getLuminanceCoefficients:function(n,e=this.workingColorSpace){return n.fromArray(this.spaces[e].luminanceCoefficients)},define:function(n){Object.assign(this.spaces,n)},_getMatrix:function(n,e,t){return n.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace}};function Qu(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function HA(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const zD=[.64,.33,.3,.6,.15,.06],VD=[.2126,.7152,.0722],GD=[.3127,.329],qD=new Ln().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),HD=new Ln().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);ni.define({[X0]:{primaries:zD,whitePoint:GD,transfer:$S,toXYZ:qD,fromXYZ:HD,luminanceCoefficients:VD,workingColorSpaceConfig:{unpackColorSpace:vo},outputColorSpaceConfig:{drawingBufferColorSpace:vo}},[vo]:{primaries:zD,whitePoint:GD,transfer:wi,toXYZ:qD,fromXYZ:HD,luminanceCoefficients:VD,outputColorSpaceConfig:{drawingBufferColorSpace:vo}}});let vp,Hie=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{vp===void 0&&(vp=E1("canvas")),vp.width=e.width,vp.height=e.height;const i=vp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=vp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=E1("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Qu(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Qu(t[i]/255)*255):t[i]=Qu(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},$ie=0,PV=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:$ie++}),this.uuid=Kl(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(qE(r[o].image)):s.push(qE(r[o]))}else s=qE(r);i.url=s}return t||(e.images[this.uuid]=i),i}};function qE(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Hie.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let jie=0,Il=class L2 extends ff{constructor(e=L2.DEFAULT_IMAGE,t=L2.DEFAULT_MAPPING,i=cd,r=cd,s=$l,o=hd,a=dl,l=hc,u=L2.DEFAULT_ANISOTROPY,c=Ah){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:jie++}),this.uuid=Kl(),this.name="",this.source=new PV(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new rt(0,0),this.repeat=new rt(1,1),this.center=new rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==AV)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case RM:e.x=e.x-Math.floor(e.x);break;case cd:e.x=e.x<0?0:1;break;case PM:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case RM:e.y=e.y-Math.floor(e.y);break;case cd:e.y=e.y<0?0:1;break;case PM:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}};Il.DEFAULT_IMAGE=null;Il.DEFAULT_MAPPING=AV;Il.DEFAULT_ANISOTROPY=1;let Ui=class NV{constructor(e=0,t=0,i=0,r=1){NV.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],c=l[4],h=l[8],A=l[1],v=l[5],_=l[9],S=l[2],w=l[6],x=l[10];if(Math.abs(c-A)<.01&&Math.abs(h-S)<.01&&Math.abs(_-w)<.01){if(Math.abs(c+A)<.1&&Math.abs(h+S)<.1&&Math.abs(_+w)<.1&&Math.abs(u+v+x-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(u+1)/2,N=(v+1)/2,B=(x+1)/2,T=(c+A)/4,D=(h+S)/4,F=(_+w)/4;return R>N&&R>B?R<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(R),r=T/i,s=D/i):N>B?N<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(N),i=T/r,s=F/r):B<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(B),i=D/s,r=F/s),this.set(i,r,s,t),this}let M=Math.sqrt((w-_)*(w-_)+(h-S)*(h-S)+(A-c)*(A-c));return Math.abs(M)<.001&&(M=1),this.x=(w-_)/M,this.y=(h-S)/M,this.z=(A-c)/M,this.w=Math.acos((u+v+x-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Wie=class extends ff{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ui(0,0,e,t),this.scissorTest=!1,this.viewport=new Ui(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:$l,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new Il(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new PV(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Kh=class extends Wie{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}},IV=class extends Il{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=xl,this.minFilter=xl,this.wrapR=cd,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}};class Xie extends Il{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=xl,this.minFilter=xl,this.wrapR=cd,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let El=class{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const A=s[o+0],v=s[o+1],_=s[o+2],S=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=A,e[t+1]=v,e[t+2]=_,e[t+3]=S;return}if(h!==S||l!==A||u!==v||c!==_){let w=1-a;const x=l*A+u*v+c*_+h*S,M=x>=0?1:-1,R=1-x*x;if(R>Number.EPSILON){const B=Math.sqrt(R),T=Math.atan2(B,x*M);w=Math.sin(w*T)/B,a=Math.sin(a*T)/B}const N=a*M;if(l=l*w+A*N,u=u*w+v*N,c=c*w+_*N,h=h*w+S*N,w===1-a){const B=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=B,u*=B,c*=B,h*=B}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=s[o],A=s[o+1],v=s[o+2],_=s[o+3];return e[t]=a*_+c*h+l*v-u*A,e[t+1]=l*_+c*A+u*h-a*v,e[t+2]=u*_+c*v+a*A-l*h,e[t+3]=c*_-a*h-l*A-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),h=a(s/2),A=l(i/2),v=l(r/2),_=l(s/2);switch(o){case"XYZ":this._x=A*c*h+u*v*_,this._y=u*v*h-A*c*_,this._z=u*c*_+A*v*h,this._w=u*c*h-A*v*_;break;case"YXZ":this._x=A*c*h+u*v*_,this._y=u*v*h-A*c*_,this._z=u*c*_-A*v*h,this._w=u*c*h+A*v*_;break;case"ZXY":this._x=A*c*h-u*v*_,this._y=u*v*h+A*c*_,this._z=u*c*_+A*v*h,this._w=u*c*h-A*v*_;break;case"ZYX":this._x=A*c*h-u*v*_,this._y=u*v*h+A*c*_,this._z=u*c*_-A*v*h,this._w=u*c*h+A*v*_;break;case"YZX":this._x=A*c*h+u*v*_,this._y=u*v*h+A*c*_,this._z=u*c*_-A*v*h,this._w=u*c*h-A*v*_;break;case"XZY":this._x=A*c*h-u*v*_,this._y=u*v*h-A*c*_,this._z=u*c*_+A*v*h,this._w=u*c*h+A*v*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],A=i+a+h;if(A>0){const v=.5/Math.sqrt(A+1);this._w=.25/v,this._x=(c-l)*v,this._y=(s-u)*v,this._z=(o-r)*v}else if(i>a&&i>h){const v=2*Math.sqrt(1+i-a-h);this._w=(c-l)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+u)/v}else if(a>h){const v=2*Math.sqrt(1+a-i-h);this._w=(s-u)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(l+c)/v}else{const v=2*Math.sqrt(1+h-i-a);this._w=(o-r)/v,this._x=(s+u)/v,this._y=(l+c)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Lr(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+o*a+r*u-s*l,this._y=r*c+o*l+s*a-i*u,this._z=s*c+o*u+i*l-r*a,this._w=o*c-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*i+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,A=Math.sin(t*c)/u;return this._w=o*h+this._w*A,this._x=i*h+this._x*A,this._y=r*h+this._y*A,this._z=s*h+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},le=class DV{constructor(e=0,t=0,i=0){DV.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion($D.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion($D.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),c=2*(a*t-s*r),h=2*(s*i-o*t);return this.x=t+l*u+o*h-a*c,this.y=i+l*c+a*u-s*h,this.z=r+l*h+s*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return HE.copy(this).projectOnVector(e),this.sub(HE)}reflect(e){return this.sub(HE.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Lr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};const HE=new le,$D=new El;let Cc=class{constructor(e=new le(1/0,1/0,1/0),t=new le(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Ha.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Ha.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ha.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Ha):Ha.fromBufferAttribute(s,o),Ha.applyMatrix4(e.matrixWorld),this.expandByPoint(Ha);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Iy.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Iy.copy(i.boundingBox)),Iy.applyMatrix4(e.matrixWorld),this.union(Iy)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ha),Ha.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Dm),Dy.subVectors(this.max,Dm),yp.subVectors(e.a,Dm),_p.subVectors(e.b,Dm),xp.subVectors(e.c,Dm),Vc.subVectors(_p,yp),Gc.subVectors(xp,_p),Mf.subVectors(yp,xp);let t=[0,-Vc.z,Vc.y,0,-Gc.z,Gc.y,0,-Mf.z,Mf.y,Vc.z,0,-Vc.x,Gc.z,0,-Gc.x,Mf.z,0,-Mf.x,-Vc.y,Vc.x,0,-Gc.y,Gc.x,0,-Mf.y,Mf.x,0];return!$E(t,yp,_p,xp,Dy)||(t=[1,0,0,0,1,0,0,0,1],!$E(t,yp,_p,xp,Dy))?!1:(ky.crossVectors(Vc,Gc),t=[ky.x,ky.y,ky.z],$E(t,yp,_p,xp,Dy))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ha).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ha).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(gu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};const gu=[new le,new le,new le,new le,new le,new le,new le,new le],Ha=new le,Iy=new Cc,yp=new le,_p=new le,xp=new le,Vc=new le,Gc=new le,Mf=new le,Dm=new le,Dy=new le,ky=new le,Rf=new le;function $E(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Rf.fromArray(n,s);const a=r.x*Math.abs(Rf.x)+r.y*Math.abs(Rf.y)+r.z*Math.abs(Rf.z),l=e.dot(Rf),u=t.dot(Rf),c=i.dot(Rf);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const Yie=new Cc,km=new le,jE=new le;let Y0=class{constructor(e=new le,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):Yie.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;km.subVectors(e,this.center);const t=km.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(km,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(jE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(km.copy(e.center).add(jE)),this.expandByPoint(km.copy(e.center).sub(jE))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};const vu=new le,WE=new le,Ly=new le,qc=new le,XE=new le,Fy=new le,YE=new le;let jS=class{constructor(e=new le,t=new le(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,vu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=vu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(vu.copy(this.origin).addScaledVector(this.direction,t),vu.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){WE.copy(e).add(t).multiplyScalar(.5),Ly.copy(t).sub(e).normalize(),qc.copy(this.origin).sub(WE);const s=e.distanceTo(t)*.5,o=-this.direction.dot(Ly),a=qc.dot(this.direction),l=-qc.dot(Ly),u=qc.lengthSq(),c=Math.abs(1-o*o);let h,A,v,_;if(c>0)if(h=o*l-a,A=o*a-l,_=s*c,h>=0)if(A>=-_)if(A<=_){const S=1/c;h*=S,A*=S,v=h*(h+o*A+2*a)+A*(o*h+A+2*l)+u}else A=s,h=Math.max(0,-(o*A+a)),v=-h*h+A*(A+2*l)+u;else A=-s,h=Math.max(0,-(o*A+a)),v=-h*h+A*(A+2*l)+u;else A<=-_?(h=Math.max(0,-(-o*s+a)),A=h>0?-s:Math.min(Math.max(-s,-l),s),v=-h*h+A*(A+2*l)+u):A<=_?(h=0,A=Math.min(Math.max(-s,-l),s),v=A*(A+2*l)+u):(h=Math.max(0,-(o*s+a)),A=h>0?s:Math.min(Math.max(-s,-l),s),v=-h*h+A*(A+2*l)+u);else A=o>0?-s:s,h=Math.max(0,-(o*A+a)),v=-h*h+A*(A+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(WE).addScaledVector(Ly,A),v}intersectSphere(e,t){vu.subVectors(e.center,this.origin);const i=vu.dot(this.direction),r=vu.dot(vu)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,A=this.origin;return u>=0?(i=(e.min.x-A.x)*u,r=(e.max.x-A.x)*u):(i=(e.max.x-A.x)*u,r=(e.min.x-A.x)*u),c>=0?(s=(e.min.y-A.y)*c,o=(e.max.y-A.y)*c):(s=(e.max.y-A.y)*c,o=(e.min.y-A.y)*c),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-A.z)*h,l=(e.max.z-A.z)*h):(a=(e.max.z-A.z)*h,l=(e.min.z-A.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,vu)!==null}intersectTriangle(e,t,i,r,s){XE.subVectors(t,e),Fy.subVectors(i,e),YE.crossVectors(XE,Fy);let o=this.direction.dot(YE),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;qc.subVectors(this.origin,e);const l=a*this.direction.dot(Fy.crossVectors(qc,Fy));if(l<0)return null;const u=a*this.direction.dot(XE.cross(qc));if(u<0||l+u>o)return null;const c=-a*qc.dot(YE);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ki=class r4{constructor(e,t,i,r,s,o,a,l,u,c,h,A,v,_,S,w){r4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,c,h,A,v,_,S,w)}set(e,t,i,r,s,o,a,l,u,c,h,A,v,_,S,w){const x=this.elements;return x[0]=e,x[4]=t,x[8]=i,x[12]=r,x[1]=s,x[5]=o,x[9]=a,x[13]=l,x[2]=u,x[6]=c,x[10]=h,x[14]=A,x[3]=v,x[7]=_,x[11]=S,x[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new r4().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/bp.setFromMatrixColumn(e,0).length(),s=1/bp.setFromMatrixColumn(e,1).length(),o=1/bp.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const A=o*c,v=o*h,_=a*c,S=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=v+_*u,t[5]=A-S*u,t[9]=-a*l,t[2]=S-A*u,t[6]=_+v*u,t[10]=o*l}else if(e.order==="YXZ"){const A=l*c,v=l*h,_=u*c,S=u*h;t[0]=A+S*a,t[4]=_*a-v,t[8]=o*u,t[1]=o*h,t[5]=o*c,t[9]=-a,t[2]=v*a-_,t[6]=S+A*a,t[10]=o*l}else if(e.order==="ZXY"){const A=l*c,v=l*h,_=u*c,S=u*h;t[0]=A-S*a,t[4]=-o*h,t[8]=_+v*a,t[1]=v+_*a,t[5]=o*c,t[9]=S-A*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const A=o*c,v=o*h,_=a*c,S=a*h;t[0]=l*c,t[4]=_*u-v,t[8]=A*u+S,t[1]=l*h,t[5]=S*u+A,t[9]=v*u-_,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const A=o*l,v=o*u,_=a*l,S=a*u;t[0]=l*c,t[4]=S-A*h,t[8]=_*h+v,t[1]=h,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=v*h+_,t[10]=A-S*h}else if(e.order==="XZY"){const A=o*l,v=o*u,_=a*l,S=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=A*h+S,t[5]=o*c,t[9]=v*h-_,t[2]=_*h-v,t[6]=a*c,t[10]=S*h+A}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Qie,e,Kie)}lookAt(e,t,i){const r=this.elements;return Go.subVectors(e,t),Go.lengthSq()===0&&(Go.z=1),Go.normalize(),Hc.crossVectors(i,Go),Hc.lengthSq()===0&&(Math.abs(i.z)===1?Go.x+=1e-4:Go.z+=1e-4,Go.normalize(),Hc.crossVectors(i,Go)),Hc.normalize(),By.crossVectors(Go,Hc),r[0]=Hc.x,r[4]=By.x,r[8]=Go.x,r[1]=Hc.y,r[5]=By.y,r[9]=Go.y,r[2]=Hc.z,r[6]=By.z,r[10]=Go.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],c=i[1],h=i[5],A=i[9],v=i[13],_=i[2],S=i[6],w=i[10],x=i[14],M=i[3],R=i[7],N=i[11],B=i[15],T=r[0],D=r[4],F=r[8],L=r[12],O=r[1],z=r[5],Q=r[9],j=r[13],ee=r[2],$=r[6],Z=r[10],ce=r[14],ie=r[3],oe=r[7],me=r[11],_e=r[15];return s[0]=o*T+a*O+l*ee+u*ie,s[4]=o*D+a*z+l*$+u*oe,s[8]=o*F+a*Q+l*Z+u*me,s[12]=o*L+a*j+l*ce+u*_e,s[1]=c*T+h*O+A*ee+v*ie,s[5]=c*D+h*z+A*$+v*oe,s[9]=c*F+h*Q+A*Z+v*me,s[13]=c*L+h*j+A*ce+v*_e,s[2]=_*T+S*O+w*ee+x*ie,s[6]=_*D+S*z+w*$+x*oe,s[10]=_*F+S*Q+w*Z+x*me,s[14]=_*L+S*j+w*ce+x*_e,s[3]=M*T+R*O+N*ee+B*ie,s[7]=M*D+R*z+N*$+B*oe,s[11]=M*F+R*Q+N*Z+B*me,s[15]=M*L+R*j+N*ce+B*_e,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],A=e[10],v=e[14],_=e[3],S=e[7],w=e[11],x=e[15];return _*(+s*l*h-r*u*h-s*a*A+i*u*A+r*a*v-i*l*v)+S*(+t*l*v-t*u*A+s*o*A-r*o*v+r*u*c-s*l*c)+w*(+t*u*h-t*a*v-s*o*h+i*o*v+s*a*c-i*u*c)+x*(-r*a*c-t*l*h+t*a*A+r*o*h-i*o*A+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],A=e[10],v=e[11],_=e[12],S=e[13],w=e[14],x=e[15],M=h*w*u-S*A*u+S*l*v-a*w*v-h*l*x+a*A*x,R=_*A*u-c*w*u-_*l*v+o*w*v+c*l*x-o*A*x,N=c*S*u-_*h*u+_*a*v-o*S*v-c*a*x+o*h*x,B=_*h*l-c*S*l-_*a*A+o*S*A+c*a*w-o*h*w,T=t*M+i*R+r*N+s*B;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/T;return e[0]=M*D,e[1]=(S*A*s-h*w*s-S*r*v+i*w*v+h*r*x-i*A*x)*D,e[2]=(a*w*s-S*l*s+S*r*u-i*w*u-a*r*x+i*l*x)*D,e[3]=(h*l*s-a*A*s-h*r*u+i*A*u+a*r*v-i*l*v)*D,e[4]=R*D,e[5]=(c*w*s-_*A*s+_*r*v-t*w*v-c*r*x+t*A*x)*D,e[6]=(_*l*s-o*w*s-_*r*u+t*w*u+o*r*x-t*l*x)*D,e[7]=(o*A*s-c*l*s+c*r*u-t*A*u-o*r*v+t*l*v)*D,e[8]=N*D,e[9]=(_*h*s-c*S*s-_*i*v+t*S*v+c*i*x-t*h*x)*D,e[10]=(o*S*s-_*a*s+_*i*u-t*S*u-o*i*x+t*a*x)*D,e[11]=(c*a*s-o*h*s-c*i*u+t*h*u+o*i*v-t*a*v)*D,e[12]=B*D,e[13]=(c*S*r-_*h*r+_*i*A-t*S*A-c*i*w+t*h*w)*D,e[14]=(_*a*r-o*S*r-_*i*l+t*S*l+o*i*w-t*a*w)*D,e[15]=(o*h*r-c*a*r+c*i*l-t*h*l-o*i*A+t*a*A)*D,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*o,0,u*l-r*a,c*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,c=o+o,h=a+a,A=s*u,v=s*c,_=s*h,S=o*c,w=o*h,x=a*h,M=l*u,R=l*c,N=l*h,B=i.x,T=i.y,D=i.z;return r[0]=(1-(S+x))*B,r[1]=(v+N)*B,r[2]=(_-R)*B,r[3]=0,r[4]=(v-N)*T,r[5]=(1-(A+x))*T,r[6]=(w+M)*T,r[7]=0,r[8]=(_+R)*D,r[9]=(w-M)*D,r[10]=(1-(A+S))*D,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=bp.set(r[0],r[1],r[2]).length();const o=bp.set(r[4],r[5],r[6]).length(),a=bp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],$a.copy(this);const u=1/s,c=1/o,h=1/a;return $a.elements[0]*=u,$a.elements[1]*=u,$a.elements[2]*=u,$a.elements[4]*=c,$a.elements[5]*=c,$a.elements[6]*=c,$a.elements[8]*=h,$a.elements[9]*=h,$a.elements[10]*=h,t.setFromRotationMatrix($a),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Gu){const l=this.elements,u=2*s/(t-e),c=2*s/(i-r),h=(t+e)/(t-e),A=(i+r)/(i-r);let v,_;if(a===Gu)v=-(o+s)/(o-s),_=-2*o*s/(o-s);else if(a===Lx)v=-o/(o-s),_=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=A,l[13]=0,l[2]=0,l[6]=0,l[10]=v,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Gu){const l=this.elements,u=1/(t-e),c=1/(i-r),h=1/(o-s),A=(t+e)*u,v=(i+r)*c;let _,S;if(a===Gu)_=(o+s)*h,S=-2*h;else if(a===Lx)_=s*h,S=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-A,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-v,l[2]=0,l[6]=0,l[10]=S,l[14]=-_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}};const bp=new le,$a=new ki,Qie=new le(0,0,0),Kie=new le(1,1,1),Hc=new le,By=new le,Go=new le,jD=new ki,WD=new El;let la=class kV{constructor(e=0,t=0,i=0,r=kV.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],A=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(Lr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(A,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Lr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Lr(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-h,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Lr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(A,v),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Lr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-Lr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(A,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return jD.makeRotationFromQuaternion(e),this.setFromRotationMatrix(jD,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return WD.setFromEuler(this),this.setFromQuaternion(WD,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};la.DEFAULT_ORDER="XYZ";let jP=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Zie=0;const XD=new le,Sp=new El,yu=new ki,Oy=new le,Lm=new le,Jie=new le,ere=new El,YD=new le(1,0,0),QD=new le(0,1,0),KD=new le(0,0,1),ZD={type:"added"},tre={type:"removed"},wp={type:"childadded",child:null},QE={type:"childremoved",child:null};let Fs=class F2 extends ff{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Zie++}),this.uuid=Kl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=F2.DEFAULT_UP.clone();const e=new le,t=new la,i=new El,r=new le(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ki},normalMatrix:{value:new Ln}}),this.matrix=new ki,this.matrixWorld=new ki,this.matrixAutoUpdate=F2.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=F2.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jP,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Sp.setFromAxisAngle(e,t),this.quaternion.multiply(Sp),this}rotateOnWorldAxis(e,t){return Sp.setFromAxisAngle(e,t),this.quaternion.premultiply(Sp),this}rotateX(e){return this.rotateOnAxis(YD,e)}rotateY(e){return this.rotateOnAxis(QD,e)}rotateZ(e){return this.rotateOnAxis(KD,e)}translateOnAxis(e,t){return XD.copy(e).applyQuaternion(this.quaternion),this.position.add(XD.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(YD,e)}translateY(e){return this.translateOnAxis(QD,e)}translateZ(e){return this.translateOnAxis(KD,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(yu.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Oy.copy(e):Oy.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Lm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?yu.lookAt(Lm,Oy,this.up):yu.lookAt(Oy,Lm,this.up),this.quaternion.setFromRotationMatrix(yu),r&&(yu.extractRotation(r.matrixWorld),Sp.setFromRotationMatrix(yu),this.quaternion.premultiply(Sp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(ZD),wp.child=e,this.dispatchEvent(wp),wp.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(tre),QE.child=e,this.dispatchEvent(QE),QE.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),yu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),yu.multiply(e.parent.matrixWorld)),e.applyMatrix4(yu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(ZD),wp.child=e,this.dispatchEvent(wp),wp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lm,e,Jie),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Lm,ere,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),A=o(e.skeletons),v=o(e.animations),_=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),A.length>0&&(i.skeletons=A),v.length>0&&(i.animations=v),_.length>0&&(i.nodes=_)}return i.object=r,i;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}};Fs.DEFAULT_UP=new le(0,1,0);Fs.DEFAULT_MATRIX_AUTO_UPDATE=!0;Fs.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ja=new le,_u=new le,KE=new le,xu=new le,Ep=new le,Tp=new le,JD=new le,ZE=new le,JE=new le,e3=new le,t3=new Ui,n3=new Ui,i3=new Ui;let Fm=class iA{constructor(e=new le,t=new le,i=new le){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ja.subVectors(e,t),r.cross(ja);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ja.subVectors(r,t),_u.subVectors(i,t),KE.subVectors(e,t);const o=ja.dot(ja),a=ja.dot(_u),l=ja.dot(KE),u=_u.dot(_u),c=_u.dot(KE),h=o*u-a*a;if(h===0)return s.set(0,0,0),null;const A=1/h,v=(u*l-a*c)*A,_=(o*c-a*l)*A;return s.set(1-v-_,_,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,xu)===null?!1:xu.x>=0&&xu.y>=0&&xu.x+xu.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,xu)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,xu.x),l.addScaledVector(o,xu.y),l.addScaledVector(a,xu.z),l)}static getInterpolatedAttribute(e,t,i,r,s,o){return t3.setScalar(0),n3.setScalar(0),i3.setScalar(0),t3.fromBufferAttribute(e,t),n3.fromBufferAttribute(e,i),i3.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(t3,s.x),o.addScaledVector(n3,s.y),o.addScaledVector(i3,s.z),o}static isFrontFacing(e,t,i,r){return ja.subVectors(i,t),_u.subVectors(e,t),ja.cross(_u).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ja.subVectors(this.c,this.b),_u.subVectors(this.a,this.b),ja.cross(_u).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return iA.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return iA.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return iA.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return iA.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return iA.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Ep.subVectors(r,i),Tp.subVectors(s,i),ZE.subVectors(e,i);const l=Ep.dot(ZE),u=Tp.dot(ZE);if(l<=0&&u<=0)return t.copy(i);JE.subVectors(e,r);const c=Ep.dot(JE),h=Tp.dot(JE);if(c>=0&&h<=c)return t.copy(r);const A=l*h-c*u;if(A<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(i).addScaledVector(Ep,o);e3.subVectors(e,s);const v=Ep.dot(e3),_=Tp.dot(e3);if(_>=0&&v<=_)return t.copy(s);const S=v*u-l*_;if(S<=0&&u>=0&&_<=0)return a=u/(u-_),t.copy(i).addScaledVector(Tp,a);const w=c*_-v*h;if(w<=0&&h-c>=0&&v-_>=0)return JD.subVectors(s,r),a=(h-c)/(h-c+(v-_)),t.copy(r).addScaledVector(JD,a);const x=1/(w+S+A);return o=S*x,a=A*x,t.copy(i).addScaledVector(Ep,o).addScaledVector(Tp,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const LV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$c={h:0,s:0,l:0},Uy={h:0,s:0,l:0};function r3(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let fn=class{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=vo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ni.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=ni.workingColorSpace){return this.r=e,this.g=t,this.b=i,ni.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=ni.workingColorSpace){if(e=$P(e,1),t=Lr(t,0,1),i=Lr(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=r3(o,s,e+1/3),this.g=r3(o,s,e),this.b=r3(o,s,e-1/3)}return ni.toWorkingColorSpace(this,r),this}setStyle(e,t=vo){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=vo){const i=LV[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Qu(e.r),this.g=Qu(e.g),this.b=Qu(e.b),this}copyLinearToSRGB(e){return this.r=HA(e.r),this.g=HA(e.g),this.b=HA(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vo){return ni.fromWorkingColorSpace(bs.copy(this),e),Math.round(Lr(bs.r*255,0,255))*65536+Math.round(Lr(bs.g*255,0,255))*256+Math.round(Lr(bs.b*255,0,255))}getHexString(e=vo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ni.workingColorSpace){ni.fromWorkingColorSpace(bs.copy(this),t);const i=bs.r,r=bs.g,s=bs.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const h=o-a;switch(u=c<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=ni.workingColorSpace){return ni.fromWorkingColorSpace(bs.copy(this),t),e.r=bs.r,e.g=bs.g,e.b=bs.b,e}getStyle(e=vo){ni.fromWorkingColorSpace(bs.copy(this),e);const t=bs.r,i=bs.g,r=bs.b;return e!==vo?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL($c),this.setHSL($c.h+e,$c.s+t,$c.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL($c),e.getHSL(Uy);const i=Fg($c.h,Uy.h,t),r=Fg($c.s,Uy.s,t),s=Fg($c.l,Uy.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const bs=new fn;fn.NAMES=LV;let nre=0,ep=class extends ff{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nre++}),this.uuid=Kl(),this.name="",this.blending=Fh,this.side=Qh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=vM,this.blendDst=yM,this.blendEquation=Zf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new fn(0,0,0),this.blendAlpha=0,this.depthFunc=p0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=FD,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=gp,this.stencilZFail=gp,this.stencilZPass=gp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Fh&&(i.blending=this.blending),this.side!==Qh&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==vM&&(i.blendSrc=this.blendSrc),this.blendDst!==yM&&(i.blendDst=this.blendDst),this.blendEquation!==Zf&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==p0&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==FD&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==gp&&(i.stencilFail=this.stencilFail),this.stencilZFail!==gp&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==gp&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}},WS=class extends ep{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.combine=qS,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};const xr=new le,zy=new rt;let Qr=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=i4,this.updateRanges=[],this.gpuType=Vu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)zy.fromBufferAttribute(this,t),zy.applyMatrix3(e),this.setXY(t,zy.x,zy.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)xr.fromBufferAttribute(this,t),xr.applyMatrix3(e),this.setXYZ(t,xr.x,xr.y,xr.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)xr.fromBufferAttribute(this,t),xr.applyMatrix4(e),this.setXYZ(t,xr.x,xr.y,xr.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)xr.fromBufferAttribute(this,t),xr.applyNormalMatrix(e),this.setXYZ(t,xr.x,xr.y,xr.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)xr.fromBufferAttribute(this,t),xr.transformDirection(e),this.setXYZ(t,xr.x,xr.y,xr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=ul(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=yi(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=ul(t,this.array)),t}setX(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=ul(t,this.array)),t}setY(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=ul(t,this.array)),t}setZ(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=ul(t,this.array)),t}setW(e,t){return this.normalized&&(t=yi(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=yi(t,this.array),i=yi(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=yi(t,this.array),i=yi(i,this.array),r=yi(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=yi(t,this.array),i=yi(i,this.array),r=yi(r,this.array),s=yi(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==i4&&(e.usage=this.usage),e}},FV=class extends Qr{constructor(e,t,i){super(new Uint16Array(e),t,i)}},BV=class extends Qr{constructor(e,t,i){super(new Uint32Array(e),t,i)}},si=class extends Qr{constructor(e,t,i){super(new Float32Array(e),t,i)}},ire=0;const va=new ki,s3=new Fs,Cp=new le,qo=new Cc,Bm=new Cc,qr=new le;let ur=class OV extends ff{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ire++}),this.uuid=Kl(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(RV(e)?BV:FV)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Ln().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return va.makeRotationFromQuaternion(e),this.applyMatrix4(va),this}rotateX(e){return va.makeRotationX(e),this.applyMatrix4(va),this}rotateY(e){return va.makeRotationY(e),this.applyMatrix4(va),this}rotateZ(e){return va.makeRotationZ(e),this.applyMatrix4(va),this}translate(e,t,i){return va.makeTranslation(e,t,i),this.applyMatrix4(va),this}scale(e,t,i){return va.makeScale(e,t,i),this.applyMatrix4(va),this}lookAt(e){return s3.lookAt(e),s3.updateMatrix(),this.applyMatrix4(s3.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cp).negate(),this.translate(Cp.x,Cp.y,Cp.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new si(i,3))}else{for(let i=0,r=t.count;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cc);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new le(-1/0,-1/0,-1/0),new le(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];qo.setFromBufferAttribute(s),this.morphTargetsRelative?(qr.addVectors(this.boundingBox.min,qo.min),this.boundingBox.expandByPoint(qr),qr.addVectors(this.boundingBox.max,qo.max),this.boundingBox.expandByPoint(qr)):(this.boundingBox.expandByPoint(qo.min),this.boundingBox.expandByPoint(qo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Y0);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new le,1/0);return}if(e){const i=this.boundingSphere.center;if(qo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Bm.setFromBufferAttribute(a),this.morphTargetsRelative?(qr.addVectors(qo.min,Bm.min),qo.expandByPoint(qr),qr.addVectors(qo.max,Bm.max),qo.expandByPoint(qr)):(qo.expandByPoint(Bm.min),qo.expandByPoint(Bm.max))}qo.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)qr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(qr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)qr.fromBufferAttribute(a,u),l&&(Cp.fromBufferAttribute(e,u),qr.add(Cp)),r=Math.max(r,i.distanceToSquared(qr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Qr(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let F=0;F<i.count;F++)a[F]=new le,l[F]=new le;const u=new le,c=new le,h=new le,A=new rt,v=new rt,_=new rt,S=new le,w=new le;function x(F,L,O){u.fromBufferAttribute(i,F),c.fromBufferAttribute(i,L),h.fromBufferAttribute(i,O),A.fromBufferAttribute(s,F),v.fromBufferAttribute(s,L),_.fromBufferAttribute(s,O),c.sub(u),h.sub(u),v.sub(A),_.sub(A);const z=1/(v.x*_.y-_.x*v.y);isFinite(z)&&(S.copy(c).multiplyScalar(_.y).addScaledVector(h,-v.y).multiplyScalar(z),w.copy(h).multiplyScalar(v.x).addScaledVector(c,-_.x).multiplyScalar(z),a[F].add(S),a[L].add(S),a[O].add(S),l[F].add(w),l[L].add(w),l[O].add(w))}let M=this.groups;M.length===0&&(M=[{start:0,count:e.count}]);for(let F=0,L=M.length;F<L;++F){const O=M[F],z=O.start,Q=O.count;for(let j=z,ee=z+Q;j<ee;j+=3)x(e.getX(j+0),e.getX(j+1),e.getX(j+2))}const R=new le,N=new le,B=new le,T=new le;function D(F){B.fromBufferAttribute(r,F),T.copy(B);const L=a[F];R.copy(L),R.sub(B.multiplyScalar(B.dot(L))).normalize(),N.crossVectors(T,L);const z=N.dot(l[F])<0?-1:1;o.setXYZW(F,R.x,R.y,R.z,z)}for(let F=0,L=M.length;F<L;++F){const O=M[F],z=O.start,Q=O.count;for(let j=z,ee=z+Q;j<ee;j+=3)D(e.getX(j+0)),D(e.getX(j+1)),D(e.getX(j+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Qr(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let A=0,v=i.count;A<v;A++)i.setXYZ(A,0,0,0);const r=new le,s=new le,o=new le,a=new le,l=new le,u=new le,c=new le,h=new le;if(e)for(let A=0,v=e.count;A<v;A+=3){const _=e.getX(A+0),S=e.getX(A+1),w=e.getX(A+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,S),o.fromBufferAttribute(t,w),c.subVectors(o,s),h.subVectors(r,s),c.cross(h),a.fromBufferAttribute(i,_),l.fromBufferAttribute(i,S),u.fromBufferAttribute(i,w),a.add(c),l.add(c),u.add(c),i.setXYZ(_,a.x,a.y,a.z),i.setXYZ(S,l.x,l.y,l.z),i.setXYZ(w,u.x,u.y,u.z)}else for(let A=0,v=t.count;A<v;A+=3)r.fromBufferAttribute(t,A+0),s.fromBufferAttribute(t,A+1),o.fromBufferAttribute(t,A+2),c.subVectors(o,s),h.subVectors(r,s),c.cross(h),i.setXYZ(A+0,c.x,c.y,c.z),i.setXYZ(A+1,c.x,c.y,c.z),i.setXYZ(A+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)qr.fromBufferAttribute(e,t),qr.normalize(),e.setXYZ(t,qr.x,qr.y,qr.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,A=new u.constructor(l.length*c);let v=0,_=0;for(let S=0,w=l.length;S<w;S++){a.isInterleavedBufferAttribute?v=l[S]*a.data.stride+a.offset:v=l[S]*c;for(let x=0;x<c;x++)A[_++]=u[v++]}return new Qr(A,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new OV,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let c=0,h=u.length;c<h;c++){const A=u[c],v=e(A,i);l.push(v)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,A=u.length;h<A;h++){const v=u[h];c.push(v.toJSON(e.data))}c.length>0&&(r[l]=c,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const c=r[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let A=0,v=h.length;A<v;A++)c.push(h[A].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};const ek=new ki,Pf=new jS,Vy=new Y0,tk=new le,Gy=new le,qy=new le,Hy=new le,o3=new le,$y=new le,nk=new le,jy=new le;let rr=class extends Fs{constructor(e=new ur,t=new WS){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){$y.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=a[l],h=s[l];c!==0&&(o3.fromBufferAttribute(h,e),o?$y.addScaledVector(o3,c):$y.addScaledVector(o3.sub(t),c))}t.add($y)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Vy.copy(i.boundingSphere),Vy.applyMatrix4(s),Pf.copy(e.ray).recast(e.near),!(Vy.containsPoint(Pf.origin)===!1&&(Pf.intersectSphere(Vy,tk)===null||Pf.origin.distanceToSquared(tk)>(e.far-e.near)**2))&&(ek.copy(s).invert(),Pf.copy(e.ray).applyMatrix4(ek),!(i.boundingBox!==null&&Pf.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Pf)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,A=s.groups,v=s.drawRange;if(a!==null)if(Array.isArray(o))for(let _=0,S=A.length;_<S;_++){const w=A[_],x=o[w.materialIndex],M=Math.max(w.start,v.start),R=Math.min(a.count,Math.min(w.start+w.count,v.start+v.count));for(let N=M,B=R;N<B;N+=3){const T=a.getX(N),D=a.getX(N+1),F=a.getX(N+2);r=Wy(this,x,e,i,u,c,h,T,D,F),r&&(r.faceIndex=Math.floor(N/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const _=Math.max(0,v.start),S=Math.min(a.count,v.start+v.count);for(let w=_,x=S;w<x;w+=3){const M=a.getX(w),R=a.getX(w+1),N=a.getX(w+2);r=Wy(this,o,e,i,u,c,h,M,R,N),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let _=0,S=A.length;_<S;_++){const w=A[_],x=o[w.materialIndex],M=Math.max(w.start,v.start),R=Math.min(l.count,Math.min(w.start+w.count,v.start+v.count));for(let N=M,B=R;N<B;N+=3){const T=N,D=N+1,F=N+2;r=Wy(this,x,e,i,u,c,h,T,D,F),r&&(r.faceIndex=Math.floor(N/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const _=Math.max(0,v.start),S=Math.min(l.count,v.start+v.count);for(let w=_,x=S;w<x;w+=3){const M=w,R=w+1,N=w+2;r=Wy(this,o,e,i,u,c,h,M,R,N),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}}};function rre(n,e,t,i,r,s,o,a){let l;if(e.side===Ds?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Qh,a),l===null)return null;jy.copy(a),jy.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(jy);return u<t.near||u>t.far?null:{distance:u,point:jy.clone(),object:n}}function Wy(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,Gy),n.getVertexPosition(l,qy),n.getVertexPosition(u,Hy);const c=rre(n,e,t,i,Gy,qy,Hy,nk);if(c){const h=new le;Fm.getBarycoord(nk,Gy,qy,Hy,h),r&&(c.uv=Fm.getInterpolatedAttribute(r,a,l,u,h,new rt)),s&&(c.uv1=Fm.getInterpolatedAttribute(s,a,l,u,h,new rt)),o&&(c.normal=Fm.getInterpolatedAttribute(o,a,l,u,h,new le),c.normal.dot(i.direction)>0&&c.normal.multiplyScalar(-1));const A={a,b:l,c:u,normal:new le,materialIndex:0};Fm.getNormal(Gy,qy,Hy,A.normal),c.face=A,c.barycoord=h}return c}let XS=class UV extends ur{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],c=[],h=[];let A=0,v=0;_("z","y","x",-1,-1,i,t,e,o,s,0),_("z","y","x",1,-1,i,t,-e,o,s,1),_("x","z","y",1,1,e,i,t,r,o,2),_("x","z","y",1,-1,e,i,-t,r,o,3),_("x","y","z",1,-1,e,t,i,r,s,4),_("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new si(u,3)),this.setAttribute("normal",new si(c,3)),this.setAttribute("uv",new si(h,2));function _(S,w,x,M,R,N,B,T,D,F,L){const O=N/D,z=B/F,Q=N/2,j=B/2,ee=T/2,$=D+1,Z=F+1;let ce=0,ie=0;const oe=new le;for(let me=0;me<Z;me++){const _e=me*z-j;for(let Oe=0;Oe<$;Oe++){const Ke=Oe*O-Q;oe[S]=Ke*M,oe[w]=_e*R,oe[x]=ee,u.push(oe.x,oe.y,oe.z),oe[S]=0,oe[w]=0,oe[x]=T>0?1:-1,c.push(oe.x,oe.y,oe.z),h.push(Oe/D),h.push(1-me/F),ce+=1}}for(let me=0;me<F;me++)for(let _e=0;_e<D;_e++){const Oe=A+_e+$*me,Ke=A+_e+$*(me+1),Me=A+(_e+1)+$*(me+1),ze=A+(_e+1)+$*me;l.push(Oe,Ke,ze),l.push(Ke,Me,ze),ie+=6}a.addGroup(v,ie,L),v+=ie,A+=ce}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UV(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function y0(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Hs(n){const e={};for(let t=0;t<n.length;t++){const i=y0(n[t]);for(const r in i)e[r]=i[r]}return e}function sre(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function zV(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:ni.workingColorSpace}const YS={clone:y0,merge:Hs};var ore=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,are=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;let ko=class extends ep{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=ore,this.fragmentShader=are,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=y0(e.uniforms),this.uniformsGroups=sre(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},VV=class extends Fs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ki,this.projectionMatrix=new ki,this.projectionMatrixInverse=new ki,this.coordinateSystem=Gu}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const jc=new le,ik=new rt,rk=new rt;let Ta=class extends VV{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=w1*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Lg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return w1*2*Math.atan(Math.tan(Lg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){jc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(jc.x,jc.y).multiplyScalar(-e/jc.z),jc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(jc.x,jc.y).multiplyScalar(-e/jc.z)}getViewSize(e,t){return this.getViewBounds(e,ik,rk),t.subVectors(rk,ik)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Lg*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const Mp=-90,Rp=1;let lre=class extends Fs{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ta(Mp,Rp,e,t);r.layers=this.layers,this.add(r);const s=new Ta(Mp,Rp,e,t);s.layers=this.layers,this.add(s);const o=new Ta(Mp,Rp,e,t);o.layers=this.layers,this.add(o);const a=new Ta(Mp,Rp,e,t);a.layers=this.layers,this.add(a);const l=new Ta(Mp,Rp,e,t);l.layers=this.layers,this.add(l);const u=new Ta(Mp,Rp,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===Gu)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Lx)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,c]=this.children,h=e.getRenderTarget(),A=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const S=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=S,e.setRenderTarget(i,5,r),e.render(t,c),e.setRenderTarget(h,A,v),e.xr.enabled=_,i.texture.needsPMREMUpdate=!0}},GV=class extends Il{constructor(e,t,i,r,s,o,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:A0,super(e,t,i,r,s,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},ure=class extends Kh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new GV(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:$l}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new XS(5,5,5),s=new ko({name:"CubemapFromEquirect",uniforms:y0(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ds,blending:Yu});s.uniforms.tEquirect.value=t;const o=new rr(r,s),a=t.minFilter;return t.minFilter===hd&&(t.minFilter=$l),new lre(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}};const a3=new le,cre=new le,hre=new Ln;let lh=class{constructor(e=new le(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=a3.subVectors(i,t).cross(cre.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(a3),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||hre.getNormalMatrix(e),r=this.coplanarPoint(a3).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const Nf=new Y0,Xy=new le;let WP=class{constructor(e=new lh,t=new lh,i=new lh,r=new lh,s=new lh,o=new lh){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Gu){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],c=r[5],h=r[6],A=r[7],v=r[8],_=r[9],S=r[10],w=r[11],x=r[12],M=r[13],R=r[14],N=r[15];if(i[0].setComponents(l-s,A-u,w-v,N-x).normalize(),i[1].setComponents(l+s,A+u,w+v,N+x).normalize(),i[2].setComponents(l+o,A+c,w+_,N+M).normalize(),i[3].setComponents(l-o,A-c,w-_,N-M).normalize(),i[4].setComponents(l-a,A-h,w-S,N-R).normalize(),t===Gu)i[5].setComponents(l+a,A+h,w+S,N+R).normalize();else if(t===Lx)i[5].setComponents(a,h,S,R).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Nf.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Nf.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Nf)}intersectsSprite(e){return Nf.center.set(0,0,0),Nf.radius=.7071067811865476,Nf.applyMatrix4(e.matrixWorld),this.intersectsSphere(Nf)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Xy.x=r.normal.x>0?e.max.x:e.min.x,Xy.y=r.normal.y>0?e.max.y:e.min.y,Xy.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Xy)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function qV(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function fre(n){const e=new WeakMap;function t(a,l){const u=a.array,c=a.usage,h=u.byteLength,A=n.createBuffer();n.bindBuffer(l,A),n.bufferData(l,u,c),a.onUploadCallback();let v;if(u instanceof Float32Array)v=n.FLOAT;else if(u instanceof Uint16Array)a.isFloat16BufferAttribute?v=n.HALF_FLOAT:v=n.UNSIGNED_SHORT;else if(u instanceof Int16Array)v=n.SHORT;else if(u instanceof Uint32Array)v=n.UNSIGNED_INT;else if(u instanceof Int32Array)v=n.INT;else if(u instanceof Int8Array)v=n.BYTE;else if(u instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:A,type:v,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:h}}function i(a,l,u){const c=l.array,h=l.updateRanges;if(n.bindBuffer(u,a),h.length===0)n.bufferSubData(u,0,c);else{h.sort((v,_)=>v.start-_.start);let A=0;for(let v=1;v<h.length;v++){const _=h[A],S=h[v];S.start<=_.start+_.count+1?_.count=Math.max(_.count,S.start+S.count-_.start):(++A,h[A]=S)}h.length=A+1;for(let v=0,_=h.length;v<_;v++){const S=h[v];n.bufferSubData(u,S.start*c.BYTES_PER_ELEMENT,c,S.start,S.count)}l.clearUpdateRanges()}l.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(n.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const c=e.get(a);(!c||c.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const u=e.get(a);if(u===void 0)e.set(a,t(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(u.buffer,a,l),u.version=a.version}}return{get:r,remove:s,update:o}}class QS extends ur{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),l=Math.floor(r),u=a+1,c=l+1,h=e/a,A=t/l,v=[],_=[],S=[],w=[];for(let x=0;x<c;x++){const M=x*A-o;for(let R=0;R<u;R++){const N=R*h-s;_.push(N,-M,0),S.push(0,0,1),w.push(R/a),w.push(1-x/l)}}for(let x=0;x<l;x++)for(let M=0;M<a;M++){const R=M+u*x,N=M+u*(x+1),B=M+1+u*(x+1),T=M+1+u*x;v.push(R,N,T),v.push(N,B,T)}this.setIndex(v),this.setAttribute("position",new si(_,3)),this.setAttribute("normal",new si(S,3)),this.setAttribute("uv",new si(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QS(e.width,e.height,e.widthSegments,e.heightSegments)}}var dre=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,pre=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Are=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,mre=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gre=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,vre=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,yre=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,_re=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xre=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,bre=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Sre=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,wre=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Ere=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Tre=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Cre=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Mre=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Rre=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Pre=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Nre=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Ire=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Dre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,kre=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Lre=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Fre=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Bre=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Ore=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Ure=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,zre=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Vre=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Gre=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,qre="gl_FragColor = linearToOutputTexel( gl_FragColor );",Hre=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,$re=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,jre=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Wre=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Xre=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Yre=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Qre=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Kre=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Zre=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Jre=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ese=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,tse=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,nse=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,ise=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,rse=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,sse=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,ose=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,ase=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lse=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,use=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,cse=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,hse=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,fse=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,dse=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,pse=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Ase=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,mse=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,gse=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,vse=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,yse=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,_se=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,xse=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,bse=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Sse=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,wse=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Ese=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Tse=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Cse=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Mse=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Rse=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Pse=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Nse=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Ise=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Dse=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kse=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Lse=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Fse=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Bse=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Ose=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Use=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,zse=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Vse=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Gse=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,qse=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Hse=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,$se=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,jse=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Wse=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Xse=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Yse=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Qse=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Kse=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Zse=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Jse=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,eoe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,toe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,noe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ioe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,roe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,soe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,ooe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,aoe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,loe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uoe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,coe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,hoe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const foe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,doe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,poe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Aoe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,moe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,goe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,voe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,yoe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,_oe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,xoe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,boe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Soe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,woe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Eoe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Toe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Coe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Moe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Roe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Poe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Noe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ioe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Doe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,koe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Loe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Foe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Boe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ooe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Uoe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zoe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Voe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Goe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qoe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Hoe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$oe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pn={alphahash_fragment:dre,alphahash_pars_fragment:pre,alphamap_fragment:Are,alphamap_pars_fragment:mre,alphatest_fragment:gre,alphatest_pars_fragment:vre,aomap_fragment:yre,aomap_pars_fragment:_re,batching_pars_vertex:xre,batching_vertex:bre,begin_vertex:Sre,beginnormal_vertex:wre,bsdfs:Ere,iridescence_fragment:Tre,bumpmap_pars_fragment:Cre,clipping_planes_fragment:Mre,clipping_planes_pars_fragment:Rre,clipping_planes_pars_vertex:Pre,clipping_planes_vertex:Nre,color_fragment:Ire,color_pars_fragment:Dre,color_pars_vertex:kre,color_vertex:Lre,common:Fre,cube_uv_reflection_fragment:Bre,defaultnormal_vertex:Ore,displacementmap_pars_vertex:Ure,displacementmap_vertex:zre,emissivemap_fragment:Vre,emissivemap_pars_fragment:Gre,colorspace_fragment:qre,colorspace_pars_fragment:Hre,envmap_fragment:$re,envmap_common_pars_fragment:jre,envmap_pars_fragment:Wre,envmap_pars_vertex:Xre,envmap_physical_pars_fragment:sse,envmap_vertex:Yre,fog_vertex:Qre,fog_pars_vertex:Kre,fog_fragment:Zre,fog_pars_fragment:Jre,gradientmap_pars_fragment:ese,lightmap_pars_fragment:tse,lights_lambert_fragment:nse,lights_lambert_pars_fragment:ise,lights_pars_begin:rse,lights_toon_fragment:ose,lights_toon_pars_fragment:ase,lights_phong_fragment:lse,lights_phong_pars_fragment:use,lights_physical_fragment:cse,lights_physical_pars_fragment:hse,lights_fragment_begin:fse,lights_fragment_maps:dse,lights_fragment_end:pse,logdepthbuf_fragment:Ase,logdepthbuf_pars_fragment:mse,logdepthbuf_pars_vertex:gse,logdepthbuf_vertex:vse,map_fragment:yse,map_pars_fragment:_se,map_particle_fragment:xse,map_particle_pars_fragment:bse,metalnessmap_fragment:Sse,metalnessmap_pars_fragment:wse,morphinstance_vertex:Ese,morphcolor_vertex:Tse,morphnormal_vertex:Cse,morphtarget_pars_vertex:Mse,morphtarget_vertex:Rse,normal_fragment_begin:Pse,normal_fragment_maps:Nse,normal_pars_fragment:Ise,normal_pars_vertex:Dse,normal_vertex:kse,normalmap_pars_fragment:Lse,clearcoat_normal_fragment_begin:Fse,clearcoat_normal_fragment_maps:Bse,clearcoat_pars_fragment:Ose,iridescence_pars_fragment:Use,opaque_fragment:zse,packing:Vse,premultiplied_alpha_fragment:Gse,project_vertex:qse,dithering_fragment:Hse,dithering_pars_fragment:$se,roughnessmap_fragment:jse,roughnessmap_pars_fragment:Wse,shadowmap_pars_fragment:Xse,shadowmap_pars_vertex:Yse,shadowmap_vertex:Qse,shadowmask_pars_fragment:Kse,skinbase_vertex:Zse,skinning_pars_vertex:Jse,skinning_vertex:eoe,skinnormal_vertex:toe,specularmap_fragment:noe,specularmap_pars_fragment:ioe,tonemapping_fragment:roe,tonemapping_pars_fragment:soe,transmission_fragment:ooe,transmission_pars_fragment:aoe,uv_pars_fragment:loe,uv_pars_vertex:uoe,uv_vertex:coe,worldpos_vertex:hoe,background_vert:foe,background_frag:doe,backgroundCube_vert:poe,backgroundCube_frag:Aoe,cube_vert:moe,cube_frag:goe,depth_vert:voe,depth_frag:yoe,distanceRGBA_vert:_oe,distanceRGBA_frag:xoe,equirect_vert:boe,equirect_frag:Soe,linedashed_vert:woe,linedashed_frag:Eoe,meshbasic_vert:Toe,meshbasic_frag:Coe,meshlambert_vert:Moe,meshlambert_frag:Roe,meshmatcap_vert:Poe,meshmatcap_frag:Noe,meshnormal_vert:Ioe,meshnormal_frag:Doe,meshphong_vert:koe,meshphong_frag:Loe,meshphysical_vert:Foe,meshphysical_frag:Boe,meshtoon_vert:Ooe,meshtoon_frag:Uoe,points_vert:zoe,points_frag:Voe,shadow_vert:Goe,shadow_frag:qoe,sprite_vert:Hoe,sprite_frag:$oe},Et={common:{diffuse:{value:new fn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ln},alphaMap:{value:null},alphaMapTransform:{value:new Ln},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ln}},envmap:{envMap:{value:null},envMapRotation:{value:new Ln},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ln}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ln}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ln},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ln},normalScale:{value:new rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ln},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ln}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ln}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ln}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ln},alphaTest:{value:0},uvTransform:{value:new Ln}},sprite:{diffuse:{value:new fn(16777215)},opacity:{value:1},center:{value:new rt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ln},alphaMap:{value:null},alphaMapTransform:{value:new Ln},alphaTest:{value:0}}},xo={basic:{uniforms:Hs([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.fog]),vertexShader:Pn.meshbasic_vert,fragmentShader:Pn.meshbasic_frag},lambert:{uniforms:Hs([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new fn(0)}}]),vertexShader:Pn.meshlambert_vert,fragmentShader:Pn.meshlambert_frag},phong:{uniforms:Hs([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new fn(0)},specular:{value:new fn(1118481)},shininess:{value:30}}]),vertexShader:Pn.meshphong_vert,fragmentShader:Pn.meshphong_frag},standard:{uniforms:Hs([Et.common,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.roughnessmap,Et.metalnessmap,Et.fog,Et.lights,{emissive:{value:new fn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag},toon:{uniforms:Hs([Et.common,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.gradientmap,Et.fog,Et.lights,{emissive:{value:new fn(0)}}]),vertexShader:Pn.meshtoon_vert,fragmentShader:Pn.meshtoon_frag},matcap:{uniforms:Hs([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,{matcap:{value:null}}]),vertexShader:Pn.meshmatcap_vert,fragmentShader:Pn.meshmatcap_frag},points:{uniforms:Hs([Et.points,Et.fog]),vertexShader:Pn.points_vert,fragmentShader:Pn.points_frag},dashed:{uniforms:Hs([Et.common,Et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pn.linedashed_vert,fragmentShader:Pn.linedashed_frag},depth:{uniforms:Hs([Et.common,Et.displacementmap]),vertexShader:Pn.depth_vert,fragmentShader:Pn.depth_frag},normal:{uniforms:Hs([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,{opacity:{value:1}}]),vertexShader:Pn.meshnormal_vert,fragmentShader:Pn.meshnormal_frag},sprite:{uniforms:Hs([Et.sprite,Et.fog]),vertexShader:Pn.sprite_vert,fragmentShader:Pn.sprite_frag},background:{uniforms:{uvTransform:{value:new Ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pn.background_vert,fragmentShader:Pn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ln}},vertexShader:Pn.backgroundCube_vert,fragmentShader:Pn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pn.cube_vert,fragmentShader:Pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pn.equirect_vert,fragmentShader:Pn.equirect_frag},distanceRGBA:{uniforms:Hs([Et.common,Et.displacementmap,{referencePosition:{value:new le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pn.distanceRGBA_vert,fragmentShader:Pn.distanceRGBA_frag},shadow:{uniforms:Hs([Et.lights,Et.fog,{color:{value:new fn(0)},opacity:{value:1}}]),vertexShader:Pn.shadow_vert,fragmentShader:Pn.shadow_frag}};xo.physical={uniforms:Hs([xo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ln},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ln},clearcoatNormalScale:{value:new rt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ln},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ln},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ln},sheen:{value:0},sheenColor:{value:new fn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ln},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ln},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ln},transmissionSamplerSize:{value:new rt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ln},attenuationDistance:{value:0},attenuationColor:{value:new fn(0)},specularColor:{value:new fn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ln},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ln},anisotropyVector:{value:new rt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ln}}]),vertexShader:Pn.meshphysical_vert,fragmentShader:Pn.meshphysical_frag};const Yy={r:0,b:0,g:0},If=new la,joe=new ki;function Woe(n,e,t,i,r,s,o){const a=new fn(0);let l=s===!0?0:1,u,c,h=null,A=0,v=null;function _(M){let R=M.isScene===!0?M.background:null;return R&&R.isTexture&&(R=(M.backgroundBlurriness>0?t:e).get(R)),R}function S(M){let R=!1;const N=_(M);N===null?x(a,l):N&&N.isColor&&(x(N,1),R=!0);const B=n.xr.getEnvironmentBlendMode();B==="additive"?i.buffers.color.setClear(0,0,0,1,o):B==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||R)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function w(M,R){const N=_(R);N&&(N.isCubeTexture||N.mapping===HS)?(c===void 0&&(c=new rr(new XS(1,1,1),new ko({name:"BackgroundCubeMaterial",uniforms:y0(xo.backgroundCube.uniforms),vertexShader:xo.backgroundCube.vertexShader,fragmentShader:xo.backgroundCube.fragmentShader,side:Ds,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(B,T,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),If.copy(R.backgroundRotation),If.x*=-1,If.y*=-1,If.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&(If.y*=-1,If.z*=-1),c.material.uniforms.envMap.value=N,c.material.uniforms.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=R.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(joe.makeRotationFromEuler(If)),c.material.toneMapped=ni.getTransfer(N.colorSpace)!==wi,(h!==N||A!==N.version||v!==n.toneMapping)&&(c.material.needsUpdate=!0,h=N,A=N.version,v=n.toneMapping),c.layers.enableAll(),M.unshift(c,c.geometry,c.material,0,0,null)):N&&N.isTexture&&(u===void 0&&(u=new rr(new QS(2,2),new ko({name:"BackgroundMaterial",uniforms:y0(xo.background.uniforms),vertexShader:xo.background.vertexShader,fragmentShader:xo.background.fragmentShader,side:Qh,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=N,u.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,u.material.toneMapped=ni.getTransfer(N.colorSpace)!==wi,N.matrixAutoUpdate===!0&&N.updateMatrix(),u.material.uniforms.uvTransform.value.copy(N.matrix),(h!==N||A!==N.version||v!==n.toneMapping)&&(u.material.needsUpdate=!0,h=N,A=N.version,v=n.toneMapping),u.layers.enableAll(),M.unshift(u,u.geometry,u.material,0,0,null))}function x(M,R){M.getRGB(Yy,zV(n)),i.buffers.color.setClear(Yy.r,Yy.g,Yy.b,R,o)}return{getClearColor:function(){return a},setClearColor:function(M,R=1){a.set(M),l=R,x(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(M){l=M,x(a,l)},render:S,addToRenderList:w}}function Xoe(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=A(null);let s=r,o=!1;function a(O,z,Q,j,ee){let $=!1;const Z=h(j,Q,z);s!==Z&&(s=Z,u(s.object)),$=v(O,j,Q,ee),$&&_(O,j,Q,ee),ee!==null&&e.update(ee,n.ELEMENT_ARRAY_BUFFER),($||o)&&(o=!1,N(O,z,Q,j),ee!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(ee).buffer))}function l(){return n.createVertexArray()}function u(O){return n.bindVertexArray(O)}function c(O){return n.deleteVertexArray(O)}function h(O,z,Q){const j=Q.wireframe===!0;let ee=i[O.id];ee===void 0&&(ee={},i[O.id]=ee);let $=ee[z.id];$===void 0&&($={},ee[z.id]=$);let Z=$[j];return Z===void 0&&(Z=A(l()),$[j]=Z),Z}function A(O){const z=[],Q=[],j=[];for(let ee=0;ee<t;ee++)z[ee]=0,Q[ee]=0,j[ee]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:z,enabledAttributes:Q,attributeDivisors:j,object:O,attributes:{},index:null}}function v(O,z,Q,j){const ee=s.attributes,$=z.attributes;let Z=0;const ce=Q.getAttributes();for(const ie in ce)if(ce[ie].location>=0){const me=ee[ie];let _e=$[ie];if(_e===void 0&&(ie==="instanceMatrix"&&O.instanceMatrix&&(_e=O.instanceMatrix),ie==="instanceColor"&&O.instanceColor&&(_e=O.instanceColor)),me===void 0||me.attribute!==_e||_e&&me.data!==_e.data)return!0;Z++}return s.attributesNum!==Z||s.index!==j}function _(O,z,Q,j){const ee={},$=z.attributes;let Z=0;const ce=Q.getAttributes();for(const ie in ce)if(ce[ie].location>=0){let me=$[ie];me===void 0&&(ie==="instanceMatrix"&&O.instanceMatrix&&(me=O.instanceMatrix),ie==="instanceColor"&&O.instanceColor&&(me=O.instanceColor));const _e={};_e.attribute=me,me&&me.data&&(_e.data=me.data),ee[ie]=_e,Z++}s.attributes=ee,s.attributesNum=Z,s.index=j}function S(){const O=s.newAttributes;for(let z=0,Q=O.length;z<Q;z++)O[z]=0}function w(O){x(O,0)}function x(O,z){const Q=s.newAttributes,j=s.enabledAttributes,ee=s.attributeDivisors;Q[O]=1,j[O]===0&&(n.enableVertexAttribArray(O),j[O]=1),ee[O]!==z&&(n.vertexAttribDivisor(O,z),ee[O]=z)}function M(){const O=s.newAttributes,z=s.enabledAttributes;for(let Q=0,j=z.length;Q<j;Q++)z[Q]!==O[Q]&&(n.disableVertexAttribArray(Q),z[Q]=0)}function R(O,z,Q,j,ee,$,Z){Z===!0?n.vertexAttribIPointer(O,z,Q,ee,$):n.vertexAttribPointer(O,z,Q,j,ee,$)}function N(O,z,Q,j){S();const ee=j.attributes,$=Q.getAttributes(),Z=z.defaultAttributeValues;for(const ce in $){const ie=$[ce];if(ie.location>=0){let oe=ee[ce];if(oe===void 0&&(ce==="instanceMatrix"&&O.instanceMatrix&&(oe=O.instanceMatrix),ce==="instanceColor"&&O.instanceColor&&(oe=O.instanceColor)),oe!==void 0){const me=oe.normalized,_e=oe.itemSize,Oe=e.get(oe);if(Oe===void 0)continue;const Ke=Oe.buffer,Me=Oe.type,ze=Oe.bytesPerElement,nt=Me===n.INT||Me===n.UNSIGNED_INT||oe.gpuType===OP;if(oe.isInterleavedBufferAttribute){const tt=oe.data,Ot=tt.stride,Ht=oe.offset;if(tt.isInstancedInterleavedBuffer){for(let Ct=0;Ct<ie.locationSize;Ct++)x(ie.location+Ct,tt.meshPerAttribute);O.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=tt.meshPerAttribute*tt.count)}else for(let Ct=0;Ct<ie.locationSize;Ct++)w(ie.location+Ct);n.bindBuffer(n.ARRAY_BUFFER,Ke);for(let Ct=0;Ct<ie.locationSize;Ct++)R(ie.location+Ct,_e/ie.locationSize,Me,me,Ot*ze,(Ht+_e/ie.locationSize*Ct)*ze,nt)}else{if(oe.isInstancedBufferAttribute){for(let tt=0;tt<ie.locationSize;tt++)x(ie.location+tt,oe.meshPerAttribute);O.isInstancedMesh!==!0&&j._maxInstanceCount===void 0&&(j._maxInstanceCount=oe.meshPerAttribute*oe.count)}else for(let tt=0;tt<ie.locationSize;tt++)w(ie.location+tt);n.bindBuffer(n.ARRAY_BUFFER,Ke);for(let tt=0;tt<ie.locationSize;tt++)R(ie.location+tt,_e/ie.locationSize,Me,me,_e*ze,_e/ie.locationSize*tt*ze,nt)}}else if(Z!==void 0){const me=Z[ce];if(me!==void 0)switch(me.length){case 2:n.vertexAttrib2fv(ie.location,me);break;case 3:n.vertexAttrib3fv(ie.location,me);break;case 4:n.vertexAttrib4fv(ie.location,me);break;default:n.vertexAttrib1fv(ie.location,me)}}}}M()}function B(){F();for(const O in i){const z=i[O];for(const Q in z){const j=z[Q];for(const ee in j)c(j[ee].object),delete j[ee];delete z[Q]}delete i[O]}}function T(O){if(i[O.id]===void 0)return;const z=i[O.id];for(const Q in z){const j=z[Q];for(const ee in j)c(j[ee].object),delete j[ee];delete z[Q]}delete i[O.id]}function D(O){for(const z in i){const Q=i[z];if(Q[O.id]===void 0)continue;const j=Q[O.id];for(const ee in j)c(j[ee].object),delete j[ee];delete Q[O.id]}}function F(){L(),o=!0,s!==r&&(s=r,u(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:F,resetDefaultState:L,dispose:B,releaseStatesOfGeometry:T,releaseStatesOfProgram:D,initAttributes:S,enableAttribute:w,disableUnusedAttributes:M}}function Yoe(n,e,t){let i;function r(u){i=u}function s(u,c){n.drawArrays(i,u,c),t.update(c,i,1)}function o(u,c,h){h!==0&&(n.drawArraysInstanced(i,u,c,h),t.update(c,i,h))}function a(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,u,0,c,0,h);let v=0;for(let _=0;_<h;_++)v+=c[_];t.update(v,i,1)}function l(u,c,h,A){if(h===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let _=0;_<u.length;_++)o(u[_],c[_],A[_]);else{v.multiDrawArraysInstancedWEBGL(i,u,0,c,0,A,0,h);let _=0;for(let S=0;S<h;S++)_+=c[S]*A[S];t.update(_,i,1)}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function Qoe(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(D){return!(D!==dl&&i.convert(D)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(D){const F=D===W0&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(D!==hc&&i.convert(D)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&D!==Vu&&!F)}function l(D){if(D==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return D==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=t.precision!==void 0?t.precision:"highp";const c=l(u);c!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const h=t.logarithmicDepthBuffer===!0,A=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),v=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),_=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_TEXTURE_SIZE),w=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),x=n.getParameter(n.MAX_VERTEX_ATTRIBS),M=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),R=n.getParameter(n.MAX_VARYING_VECTORS),N=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),B=_>0,T=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:u,logarithmicDepthBuffer:h,reverseDepthBuffer:A,maxTextures:v,maxVertexTextures:_,maxTextureSize:S,maxCubemapSize:w,maxAttributes:x,maxVertexUniforms:M,maxVaryings:R,maxFragmentUniforms:N,vertexTextures:B,maxSamples:T}}function Koe(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new lh,a=new Ln,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,A){const v=h.length!==0||A||i!==0||r;return r=A,i=h.length,v},this.beginShadows=function(){s=!0,c(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,A){t=c(h,A,0)},this.setState=function(h,A,v){const _=h.clippingPlanes,S=h.clipIntersection,w=h.clipShadows,x=n.get(h);if(!r||_===null||_.length===0||s&&!w)s?c(null):u();else{const M=s?0:i,R=M*4;let N=x.clippingState||null;l.value=N,N=c(_,A,R,v);for(let B=0;B!==R;++B)N[B]=t[B];x.clippingState=N,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=M}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function c(h,A,v,_){const S=h!==null?h.length:0;let w=null;if(S!==0){if(w=l.value,_!==!0||w===null){const x=v+S*4,M=A.matrixWorldInverse;a.getNormalMatrix(M),(w===null||w.length<x)&&(w=new Float32Array(x));for(let R=0,N=v;R!==S;++R,N+=4)o.copy(h[R]).applyMatrix4(M,a),o.normal.toArray(w,N),w[N+3]=o.constant}l.value=w,l.needsUpdate=!0}return e.numPlanes=S,e.numIntersection=0,w}}function Zoe(n){let e=new WeakMap;function t(o,a){return a===CM?o.mapping=A0:a===MM&&(o.mapping=m0),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===CM||a===MM)if(e.has(o)){const l=e.get(o).texture;return t(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new ure(l.height);return u.fromEquirectangularTexture(n,o),e.set(o,u),o.addEventListener("dispose",r),t(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}let XP=class extends VV{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};const yA=4,sk=[.125,.215,.35,.446,.526,.582],Jf=20,l3=new XP,ok=new fn;let u3=null,c3=0,h3=0,f3=!1;const Hf=(1+Math.sqrt(5))/2,Pp=1/Hf,ak=[new le(-Hf,Pp,0),new le(Hf,Pp,0),new le(-Pp,0,Hf),new le(Pp,0,Hf),new le(0,Hf,-Pp),new le(0,Hf,Pp),new le(-1,1,-1),new le(1,1,-1),new le(-1,1,1),new le(1,1,1)];let lk=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){u3=this._renderer.getRenderTarget(),c3=this._renderer.getActiveCubeFace(),h3=this._renderer.getActiveMipmapLevel(),f3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=hk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ck(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(u3,c3,h3),this._renderer.xr.enabled=f3,e.scissorTest=!1,Qy(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===A0||e.mapping===m0?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),u3=this._renderer.getRenderTarget(),c3=this._renderer.getActiveCubeFace(),h3=this._renderer.getActiveMipmapLevel(),f3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:$l,minFilter:$l,generateMipmaps:!1,type:W0,format:dl,colorSpace:X0,depthBuffer:!1},r=uk(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=uk(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Joe(s)),this._blurMaterial=eae(s,e,t)}return r}_compileMaterial(e){const t=new rr(this._lodPlanes[0],e);this._renderer.compile(t,l3)}_sceneToCubeUV(e,t,i,r){const a=new Ta(90,1,t,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],c=this._renderer,h=c.autoClear,A=c.toneMapping;c.getClearColor(ok),c.toneMapping=Bh,c.autoClear=!1;const v=new WS({name:"PMREM.Background",side:Ds,depthWrite:!1,depthTest:!1}),_=new rr(new XS,v);let S=!1;const w=e.background;w?w.isColor&&(v.color.copy(w),e.background=null,S=!0):(v.color.copy(ok),S=!0);for(let x=0;x<6;x++){const M=x%3;M===0?(a.up.set(0,l[x],0),a.lookAt(u[x],0,0)):M===1?(a.up.set(0,0,l[x]),a.lookAt(0,u[x],0)):(a.up.set(0,l[x],0),a.lookAt(0,0,u[x]));const R=this._cubeSize;Qy(r,M*R,x>2?R:0,R,R),c.setRenderTarget(r),S&&c.render(_,a),c.render(e,a)}_.geometry.dispose(),_.material.dispose(),c.toneMapping=A,c.autoClear=h,e.background=w}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===A0||e.mapping===m0;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=hk()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ck());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new rr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;Qy(t,0,0,3*l,2*l),i.setRenderTarget(t),i.render(o,l3)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=ak[(r-s-1)%ak.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new rr(this._lodPlanes[r],u),A=u.uniforms,v=this._sizeLods[i]-1,_=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Jf-1),S=s/_,w=isFinite(s)?1+Math.floor(c*S):Jf;w>Jf&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${Jf}`);const x=[];let M=0;for(let D=0;D<Jf;++D){const F=D/S,L=Math.exp(-F*F/2);x.push(L),D===0?M+=L:D<w&&(M+=2*L)}for(let D=0;D<x.length;D++)x[D]=x[D]/M;A.envMap.value=e.texture,A.samples.value=w,A.weights.value=x,A.latitudinal.value=o==="latitudinal",a&&(A.poleAxis.value=a);const{_lodMax:R}=this;A.dTheta.value=_,A.mipInt.value=R-i;const N=this._sizeLods[r],B=3*N*(r>R-yA?r-R+yA:0),T=4*(this._cubeSize-N);Qy(t,B,T,3*N,2*N),l.setRenderTarget(t),l.render(h,l3)}};function Joe(n){const e=[],t=[],i=[];let r=n;const s=n-yA+1+sk.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let l=1/a;o>n-yA?l=sk[o-n+yA-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),c=-u,h=1+u,A=[c,c,h,c,h,h,c,c,h,h,c,h],v=6,_=6,S=3,w=2,x=1,M=new Float32Array(S*_*v),R=new Float32Array(w*_*v),N=new Float32Array(x*_*v);for(let T=0;T<v;T++){const D=T%3*2/3-1,F=T>2?0:-1,L=[D,F,0,D+2/3,F,0,D+2/3,F+1,0,D,F,0,D+2/3,F+1,0,D,F+1,0];M.set(L,S*_*T),R.set(A,w*_*T);const O=[T,T,T,T,T,T];N.set(O,x*_*T)}const B=new ur;B.setAttribute("position",new Qr(M,S)),B.setAttribute("uv",new Qr(R,w)),B.setAttribute("faceIndex",new Qr(N,x)),e.push(B),r>yA&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function uk(n,e,t){const i=new Kh(n,e,t);return i.texture.mapping=HS,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Qy(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function eae(n,e,t){const i=new Float32Array(Jf),r=new le(0,1,0);return new ko({name:"SphericalGaussianBlur",defines:{n:Jf,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:YP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Yu,depthTest:!1,depthWrite:!1})}function ck(){return new ko({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:YP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Yu,depthTest:!1,depthWrite:!1})}function hk(){return new ko({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:YP(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Yu,depthTest:!1,depthWrite:!1})}function YP(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function tae(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===CM||l===MM,c=l===A0||l===m0;if(u||c){let h=e.get(a);const A=h!==void 0?h.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==A)return t===null&&(t=new lk(n)),h=u?t.fromEquirectangular(a,h):t.fromCubemap(a,h),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),h.texture;if(h!==void 0)return h.texture;{const v=a.image;return u&&v&&v.height>0||c&&v&&r(v)?(t===null&&(t=new lk(n)),h=u?t.fromEquirectangular(a):t.fromCubemap(a),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),a.addEventListener("dispose",s),h.texture):null}}}return a}function r(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function nae(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return r===null&&pg("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function iae(n,e,t,i){const r={},s=new WeakMap;function o(h){const A=h.target;A.index!==null&&e.remove(A.index);for(const _ in A.attributes)e.remove(A.attributes[_]);for(const _ in A.morphAttributes){const S=A.morphAttributes[_];for(let w=0,x=S.length;w<x;w++)e.remove(S[w])}A.removeEventListener("dispose",o),delete r[A.id];const v=s.get(A);v&&(e.remove(v),s.delete(A)),i.releaseStatesOfGeometry(A),A.isInstancedBufferGeometry===!0&&delete A._maxInstanceCount,t.memory.geometries--}function a(h,A){return r[A.id]===!0||(A.addEventListener("dispose",o),r[A.id]=!0,t.memory.geometries++),A}function l(h){const A=h.attributes;for(const _ in A)e.update(A[_],n.ARRAY_BUFFER);const v=h.morphAttributes;for(const _ in v){const S=v[_];for(let w=0,x=S.length;w<x;w++)e.update(S[w],n.ARRAY_BUFFER)}}function u(h){const A=[],v=h.index,_=h.attributes.position;let S=0;if(v!==null){const M=v.array;S=v.version;for(let R=0,N=M.length;R<N;R+=3){const B=M[R+0],T=M[R+1],D=M[R+2];A.push(B,T,T,D,D,B)}}else if(_!==void 0){const M=_.array;S=_.version;for(let R=0,N=M.length/3-1;R<N;R+=3){const B=R+0,T=R+1,D=R+2;A.push(B,T,T,D,D,B)}}else return;const w=new(RV(A)?BV:FV)(A,1);w.version=S;const x=s.get(h);x&&e.remove(x),s.set(h,w)}function c(h){const A=s.get(h);if(A){const v=h.index;v!==null&&A.version<v.version&&u(h)}else u(h);return s.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function rae(n,e,t){let i;function r(A){i=A}let s,o;function a(A){s=A.type,o=A.bytesPerElement}function l(A,v){n.drawElements(i,v,s,A*o),t.update(v,i,1)}function u(A,v,_){_!==0&&(n.drawElementsInstanced(i,v,s,A*o,_),t.update(v,i,_))}function c(A,v,_){if(_===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,s,A,0,_);let w=0;for(let x=0;x<_;x++)w+=v[x];t.update(w,i,1)}function h(A,v,_,S){if(_===0)return;const w=e.get("WEBGL_multi_draw");if(w===null)for(let x=0;x<A.length;x++)u(A[x]/o,v[x],S[x]);else{w.multiDrawElementsInstancedWEBGL(i,v,0,s,A,0,S,0,_);let x=0;for(let M=0;M<_;M++)x+=v[M]*S[M];t.update(x,i,1)}}this.setMode=r,this.setIndex=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function sae(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function oae(n,e,t){const i=new WeakMap,r=new Ui;function s(o,a,l){const u=o.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,h=c!==void 0?c.length:0;let A=i.get(a);if(A===void 0||A.count!==h){let L=function(){D.dispose(),i.delete(a),a.removeEventListener("dispose",L)};A!==void 0&&A.texture.dispose();const v=a.morphAttributes.position!==void 0,_=a.morphAttributes.normal!==void 0,S=a.morphAttributes.color!==void 0,w=a.morphAttributes.position||[],x=a.morphAttributes.normal||[],M=a.morphAttributes.color||[];let R=0;v===!0&&(R=1),_===!0&&(R=2),S===!0&&(R=3);let N=a.attributes.position.count*R,B=1;N>e.maxTextureSize&&(B=Math.ceil(N/e.maxTextureSize),N=e.maxTextureSize);const T=new Float32Array(N*B*4*h),D=new IV(T,N,B,h);D.type=Vu,D.needsUpdate=!0;const F=R*4;for(let O=0;O<h;O++){const z=w[O],Q=x[O],j=M[O],ee=N*B*4*O;for(let $=0;$<z.count;$++){const Z=$*F;v===!0&&(r.fromBufferAttribute(z,$),T[ee+Z+0]=r.x,T[ee+Z+1]=r.y,T[ee+Z+2]=r.z,T[ee+Z+3]=0),_===!0&&(r.fromBufferAttribute(Q,$),T[ee+Z+4]=r.x,T[ee+Z+5]=r.y,T[ee+Z+6]=r.z,T[ee+Z+7]=0),S===!0&&(r.fromBufferAttribute(j,$),T[ee+Z+8]=r.x,T[ee+Z+9]=r.y,T[ee+Z+10]=r.z,T[ee+Z+11]=j.itemSize===4?r.w:1)}}A={count:h,texture:D,size:new rt(N,B)},i.set(a,A),a.addEventListener("dispose",L)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let v=0;for(let S=0;S<u.length;S++)v+=u[S];const _=a.morphTargetsRelative?1:1-v;l.getUniforms().setValue(n,"morphTargetBaseInfluence",_),l.getUniforms().setValue(n,"morphTargetInfluences",u)}l.getUniforms().setValue(n,"morphTargetsTexture",A.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",A.size)}return{update:s}}function aae(n,e,t,i){let r=new WeakMap;function s(l){const u=i.render.frame,c=l.geometry,h=e.get(l,c);if(r.get(h)!==u&&(e.update(h),r.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),r.get(l)!==u&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),r.set(l,u))),l.isSkinnedMesh){const A=l.skeleton;r.get(A)!==u&&(A.update(),r.set(A,u))}return h}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return{update:s,dispose:o}}let HV=class extends Il{constructor(e,t,i,r,s,o,a,l,u,c=qA){if(c!==qA&&c!==v0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===qA&&(i=Nd),i===void 0&&c===v0&&(i=g0),super(null,r,s,o,a,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:xl,this.minFilter=l!==void 0?l:xl,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};const $V=new Il,fk=new HV(1,1),jV=new IV,WV=new Xie,XV=new GV,dk=[],pk=[],Ak=new Float32Array(16),mk=new Float32Array(9),gk=new Float32Array(4);function Q0(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=dk[r];if(s===void 0&&(s=new Float32Array(r),dk[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Ur(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function zr(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function KS(n,e){let t=pk[e];t===void 0&&(t=new Int32Array(e),pk[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function lae(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function uae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ur(t,e))return;n.uniform2fv(this.addr,e),zr(t,e)}}function cae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ur(t,e))return;n.uniform3fv(this.addr,e),zr(t,e)}}function hae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ur(t,e))return;n.uniform4fv(this.addr,e),zr(t,e)}}function fae(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ur(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),zr(t,e)}else{if(Ur(t,i))return;gk.set(i),n.uniformMatrix2fv(this.addr,!1,gk),zr(t,i)}}function dae(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ur(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),zr(t,e)}else{if(Ur(t,i))return;mk.set(i),n.uniformMatrix3fv(this.addr,!1,mk),zr(t,i)}}function pae(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Ur(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),zr(t,e)}else{if(Ur(t,i))return;Ak.set(i),n.uniformMatrix4fv(this.addr,!1,Ak),zr(t,i)}}function Aae(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function mae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ur(t,e))return;n.uniform2iv(this.addr,e),zr(t,e)}}function gae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ur(t,e))return;n.uniform3iv(this.addr,e),zr(t,e)}}function vae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ur(t,e))return;n.uniform4iv(this.addr,e),zr(t,e)}}function yae(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function _ae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ur(t,e))return;n.uniform2uiv(this.addr,e),zr(t,e)}}function xae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ur(t,e))return;n.uniform3uiv(this.addr,e),zr(t,e)}}function bae(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ur(t,e))return;n.uniform4uiv(this.addr,e),zr(t,e)}}function Sae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(fk.compareFunction=TV,s=fk):s=$V,t.setTexture2D(e||s,r)}function wae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||WV,r)}function Eae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||XV,r)}function Tae(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||jV,r)}function Cae(n){switch(n){case 5126:return lae;case 35664:return uae;case 35665:return cae;case 35666:return hae;case 35674:return fae;case 35675:return dae;case 35676:return pae;case 5124:case 35670:return Aae;case 35667:case 35671:return mae;case 35668:case 35672:return gae;case 35669:case 35673:return vae;case 5125:return yae;case 36294:return _ae;case 36295:return xae;case 36296:return bae;case 35678:case 36198:case 36298:case 36306:case 35682:return Sae;case 35679:case 36299:case 36307:return wae;case 35680:case 36300:case 36308:case 36293:return Eae;case 36289:case 36303:case 36311:case 36292:return Tae}}function Mae(n,e){n.uniform1fv(this.addr,e)}function Rae(n,e){const t=Q0(e,this.size,2);n.uniform2fv(this.addr,t)}function Pae(n,e){const t=Q0(e,this.size,3);n.uniform3fv(this.addr,t)}function Nae(n,e){const t=Q0(e,this.size,4);n.uniform4fv(this.addr,t)}function Iae(n,e){const t=Q0(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Dae(n,e){const t=Q0(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function kae(n,e){const t=Q0(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Lae(n,e){n.uniform1iv(this.addr,e)}function Fae(n,e){n.uniform2iv(this.addr,e)}function Bae(n,e){n.uniform3iv(this.addr,e)}function Oae(n,e){n.uniform4iv(this.addr,e)}function Uae(n,e){n.uniform1uiv(this.addr,e)}function zae(n,e){n.uniform2uiv(this.addr,e)}function Vae(n,e){n.uniform3uiv(this.addr,e)}function Gae(n,e){n.uniform4uiv(this.addr,e)}function qae(n,e,t){const i=this.cache,r=e.length,s=KS(t,r);Ur(i,s)||(n.uniform1iv(this.addr,s),zr(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||$V,s[o])}function Hae(n,e,t){const i=this.cache,r=e.length,s=KS(t,r);Ur(i,s)||(n.uniform1iv(this.addr,s),zr(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||WV,s[o])}function $ae(n,e,t){const i=this.cache,r=e.length,s=KS(t,r);Ur(i,s)||(n.uniform1iv(this.addr,s),zr(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||XV,s[o])}function jae(n,e,t){const i=this.cache,r=e.length,s=KS(t,r);Ur(i,s)||(n.uniform1iv(this.addr,s),zr(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||jV,s[o])}function Wae(n){switch(n){case 5126:return Mae;case 35664:return Rae;case 35665:return Pae;case 35666:return Nae;case 35674:return Iae;case 35675:return Dae;case 35676:return kae;case 5124:case 35670:return Lae;case 35667:case 35671:return Fae;case 35668:case 35672:return Bae;case 35669:case 35673:return Oae;case 5125:return Uae;case 36294:return zae;case 36295:return Vae;case 36296:return Gae;case 35678:case 36198:case 36298:case 36306:case 35682:return qae;case 35679:case 36299:case 36307:return Hae;case 35680:case 36300:case 36308:case 36293:return $ae;case 36289:case 36303:case 36311:case 36292:return jae}}class Xae{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=Cae(t.type)}}class Yae{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Wae(t.type)}}class Qae{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const d3=/(\w+)(\])?(\[|\.)?/g;function vk(n,e){n.seq.push(e),n.map[e.id]=e}function Kae(n,e,t){const i=n.name,r=i.length;for(d3.lastIndex=0;;){const s=d3.exec(i),o=d3.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){vk(t,u===void 0?new Xae(a,n,e):new Yae(a,n,e));break}else{let h=t.map[a];h===void 0&&(h=new Qae(a),vk(t,h)),t=h}}}class B2{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);Kae(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function yk(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const Zae=37297;let Jae=0;function ele(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}const _k=new Ln;function tle(n){ni._getMatrix(_k,ni.workingColorSpace,n);const e=`mat3( ${_k.elements.map(t=>t.toFixed(4))} )`;switch(ni.getTransfer(n)){case $S:return[e,"LinearTransferOETF"];case wi:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function xk(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+ele(n.getShaderSource(e),o)}else return r}function nle(n,e){const t=tle(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function ile(n,e){let t;switch(e){case rie:t="Linear";break;case sie:t="Reinhard";break;case oie:t="Cineon";break;case aie:t="ACESFilmic";break;case uie:t="AgX";break;case cie:t="Neutral";break;case lie:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Ky=new le;function rle(){ni.getLuminanceCoefficients(Ky);const n=Ky.x.toFixed(4),e=Ky.y.toFixed(4),t=Ky.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function sle(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ag).join(`
`)}function ole(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function ale(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Ag(n){return n!==""}function bk(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Sk(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const lle=/^[ \t]*#include +<([\w\d./]+)>/gm;function s4(n){return n.replace(lle,cle)}const ule=new Map;function cle(n,e){let t=Pn[e];if(t===void 0){const i=ule.get(e);if(i!==void 0)t=Pn[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return s4(t)}const hle=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wk(n){return n.replace(hle,fle)}function fle(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Ek(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function dle(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===pV?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Bne?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Pu&&(e="SHADOWMAP_TYPE_VSM"),e}function ple(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case A0:case m0:e="ENVMAP_TYPE_CUBE";break;case HS:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Ale(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case m0:e="ENVMAP_MODE_REFRACTION";break}return e}function mle(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case qS:e="ENVMAP_BLENDING_MULTIPLY";break;case nie:e="ENVMAP_BLENDING_MIX";break;case iie:e="ENVMAP_BLENDING_ADD";break}return e}function gle(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function vle(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const l=dle(t),u=ple(t),c=Ale(t),h=mle(t),A=gle(t),v=sle(t),_=ole(s),S=r.createProgram();let w,x,M=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(w=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Ag).join(`
`),w.length>0&&(w+=`
`),x=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(Ag).join(`
`),x.length>0&&(x+=`
`)):(w=[Ek(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ag).join(`
`),x=[Ek(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+h:"",A?"#define CUBEUV_TEXEL_WIDTH "+A.texelWidth:"",A?"#define CUBEUV_TEXEL_HEIGHT "+A.texelHeight:"",A?"#define CUBEUV_MAX_MIP "+A.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Bh?"#define TONE_MAPPING":"",t.toneMapping!==Bh?Pn.tonemapping_pars_fragment:"",t.toneMapping!==Bh?ile("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pn.colorspace_pars_fragment,nle("linearToOutputTexel",t.outputColorSpace),rle(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Ag).join(`
`)),o=s4(o),o=bk(o,t),o=Sk(o,t),a=s4(a),a=bk(a,t),a=Sk(a,t),o=wk(o),a=wk(a),t.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,w=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+w,x=["#define varying in",t.glslVersion===BD?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===BD?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);const R=M+w+o,N=M+x+a,B=yk(r,r.VERTEX_SHADER,R),T=yk(r,r.FRAGMENT_SHADER,N);r.attachShader(S,B),r.attachShader(S,T),t.index0AttributeName!==void 0?r.bindAttribLocation(S,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(S,0,"position"),r.linkProgram(S);function D(z){if(n.debug.checkShaderErrors){const Q=r.getProgramInfoLog(S).trim(),j=r.getShaderInfoLog(B).trim(),ee=r.getShaderInfoLog(T).trim();let $=!0,Z=!0;if(r.getProgramParameter(S,r.LINK_STATUS)===!1)if($=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,S,B,T);else{const ce=xk(r,B,"vertex"),ie=xk(r,T,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(S,r.VALIDATE_STATUS)+`

Material Name: `+z.name+`
Material Type: `+z.type+`

Program Info Log: `+Q+`
`+ce+`
`+ie)}else Q!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Q):(j===""||ee==="")&&(Z=!1);Z&&(z.diagnostics={runnable:$,programLog:Q,vertexShader:{log:j,prefix:w},fragmentShader:{log:ee,prefix:x}})}r.deleteShader(B),r.deleteShader(T),F=new B2(r,S),L=ale(r,S)}let F;this.getUniforms=function(){return F===void 0&&D(this),F};let L;this.getAttributes=function(){return L===void 0&&D(this),L};let O=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=r.getProgramParameter(S,Zae)),O},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(S),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Jae++,this.cacheKey=e,this.usedTimes=1,this.program=S,this.vertexShader=B,this.fragmentShader=T,this}let yle=0;class _le{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new xle(e),t.set(e,i)),i}}class xle{constructor(e){this.id=yle++,this.code=e,this.usedTimes=0}}function ble(n,e,t,i,r,s,o){const a=new jP,l=new _le,u=new Set,c=[],h=r.logarithmicDepthBuffer,A=r.vertexTextures;let v=r.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function S(L){return u.add(L),L===0?"uv":`uv${L}`}function w(L,O,z,Q,j){const ee=Q.fog,$=j.geometry,Z=L.isMeshStandardMaterial?Q.environment:null,ce=(L.isMeshStandardMaterial?t:e).get(L.envMap||Z),ie=ce&&ce.mapping===HS?ce.image.height:null,oe=_[L.type];L.precision!==null&&(v=r.getMaxPrecision(L.precision),v!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",v,"instead."));const me=$.morphAttributes.position||$.morphAttributes.normal||$.morphAttributes.color,_e=me!==void 0?me.length:0;let Oe=0;$.morphAttributes.position!==void 0&&(Oe=1),$.morphAttributes.normal!==void 0&&(Oe=2),$.morphAttributes.color!==void 0&&(Oe=3);let Ke,Me,ze,nt;if(oe){const Fn=xo[oe];Ke=Fn.vertexShader,Me=Fn.fragmentShader}else Ke=L.vertexShader,Me=L.fragmentShader,l.update(L),ze=l.getVertexShaderID(L),nt=l.getFragmentShaderID(L);const tt=n.getRenderTarget(),Ot=n.state.buffers.depth.getReversed(),Ht=j.isInstancedMesh===!0,Ct=j.isBatchedMesh===!0,en=!!L.map,Ze=!!L.matcap,at=!!ce,ue=!!L.aoMap,zt=!!L.lightMap,st=!!L.bumpMap,xt=!!L.normalMap,ht=!!L.displacementMap,Yt=!!L.emissiveMap,Nt=!!L.metalnessMap,re=!!L.roughnessMap,W=L.anisotropy>0,Ne=L.clearcoat>0,He=L.dispersion>0,et=L.iridescence>0,Be=L.sheen>0,It=L.transmission>0,ut=W&&!!L.anisotropyMap,Dt=Ne&&!!L.clearcoatMap,_n=Ne&&!!L.clearcoatNormalMap,ke=Ne&&!!L.clearcoatRoughnessMap,Lt=et&&!!L.iridescenceMap,Zt=et&&!!L.iridescenceThicknessMap,tn=Be&&!!L.sheenColorMap,kt=Be&&!!L.sheenRoughnessMap,Mn=!!L.specularMap,pn=!!L.specularColorMap,hi=!!L.specularIntensityMap,ve=It&&!!L.transmissionMap,ft=It&&!!L.thicknessMap,Fe=!!L.gradientMap,Ve=!!L.alphaMap,Te=L.alphaTest>0,Ye=!!L.alphaHash,an=!!L.extensions;let bi=Bh;L.toneMapped&&(tt===null||tt.isXRRenderTarget===!0)&&(bi=n.toneMapping);const yr={shaderID:oe,shaderType:L.type,shaderName:L.name,vertexShader:Ke,fragmentShader:Me,defines:L.defines,customVertexShaderID:ze,customFragmentShaderID:nt,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:v,batching:Ct,batchingColor:Ct&&j._colorsTexture!==null,instancing:Ht,instancingColor:Ht&&j.instanceColor!==null,instancingMorph:Ht&&j.morphTexture!==null,supportsVertexTextures:A,outputColorSpace:tt===null?n.outputColorSpace:tt.isXRRenderTarget===!0?tt.texture.colorSpace:X0,alphaToCoverage:!!L.alphaToCoverage,map:en,matcap:Ze,envMap:at,envMapMode:at&&ce.mapping,envMapCubeUVHeight:ie,aoMap:ue,lightMap:zt,bumpMap:st,normalMap:xt,displacementMap:A&&ht,emissiveMap:Yt,normalMapObjectSpace:xt&&L.normalMapType===mie,normalMapTangentSpace:xt&&L.normalMapType===HP,metalnessMap:Nt,roughnessMap:re,anisotropy:W,anisotropyMap:ut,clearcoat:Ne,clearcoatMap:Dt,clearcoatNormalMap:_n,clearcoatRoughnessMap:ke,dispersion:He,iridescence:et,iridescenceMap:Lt,iridescenceThicknessMap:Zt,sheen:Be,sheenColorMap:tn,sheenRoughnessMap:kt,specularMap:Mn,specularColorMap:pn,specularIntensityMap:hi,transmission:It,transmissionMap:ve,thicknessMap:ft,gradientMap:Fe,opaque:L.transparent===!1&&L.blending===Fh&&L.alphaToCoverage===!1,alphaMap:Ve,alphaTest:Te,alphaHash:Ye,combine:L.combine,mapUv:en&&S(L.map.channel),aoMapUv:ue&&S(L.aoMap.channel),lightMapUv:zt&&S(L.lightMap.channel),bumpMapUv:st&&S(L.bumpMap.channel),normalMapUv:xt&&S(L.normalMap.channel),displacementMapUv:ht&&S(L.displacementMap.channel),emissiveMapUv:Yt&&S(L.emissiveMap.channel),metalnessMapUv:Nt&&S(L.metalnessMap.channel),roughnessMapUv:re&&S(L.roughnessMap.channel),anisotropyMapUv:ut&&S(L.anisotropyMap.channel),clearcoatMapUv:Dt&&S(L.clearcoatMap.channel),clearcoatNormalMapUv:_n&&S(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ke&&S(L.clearcoatRoughnessMap.channel),iridescenceMapUv:Lt&&S(L.iridescenceMap.channel),iridescenceThicknessMapUv:Zt&&S(L.iridescenceThicknessMap.channel),sheenColorMapUv:tn&&S(L.sheenColorMap.channel),sheenRoughnessMapUv:kt&&S(L.sheenRoughnessMap.channel),specularMapUv:Mn&&S(L.specularMap.channel),specularColorMapUv:pn&&S(L.specularColorMap.channel),specularIntensityMapUv:hi&&S(L.specularIntensityMap.channel),transmissionMapUv:ve&&S(L.transmissionMap.channel),thicknessMapUv:ft&&S(L.thicknessMap.channel),alphaMapUv:Ve&&S(L.alphaMap.channel),vertexTangents:!!$.attributes.tangent&&(xt||W),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!$.attributes.color&&$.attributes.color.itemSize===4,pointsUvs:j.isPoints===!0&&!!$.attributes.uv&&(en||Ve),fog:!!ee,useFog:L.fog===!0,fogExp2:!!ee&&ee.isFogExp2,flatShading:L.flatShading===!0,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:Ot,skinning:j.isSkinnedMesh===!0,morphTargets:$.morphAttributes.position!==void 0,morphNormals:$.morphAttributes.normal!==void 0,morphColors:$.morphAttributes.color!==void 0,morphTargetsCount:_e,morphTextureStride:Oe,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:L.dithering,shadowMapEnabled:n.shadowMap.enabled&&z.length>0,shadowMapType:n.shadowMap.type,toneMapping:bi,decodeVideoTexture:en&&L.map.isVideoTexture===!0&&ni.getTransfer(L.map.colorSpace)===wi,decodeVideoTextureEmissive:Yt&&L.emissiveMap.isVideoTexture===!0&&ni.getTransfer(L.emissiveMap.colorSpace)===wi,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===Ks,flipSided:L.side===Ds,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:an&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(an&&L.extensions.multiDraw===!0||Ct)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return yr.vertexUv1s=u.has(1),yr.vertexUv2s=u.has(2),yr.vertexUv3s=u.has(3),u.clear(),yr}function x(L){const O=[];if(L.shaderID?O.push(L.shaderID):(O.push(L.customVertexShaderID),O.push(L.customFragmentShaderID)),L.defines!==void 0)for(const z in L.defines)O.push(z),O.push(L.defines[z]);return L.isRawShaderMaterial===!1&&(M(O,L),R(O,L),O.push(n.outputColorSpace)),O.push(L.customProgramCacheKey),O.join()}function M(L,O){L.push(O.precision),L.push(O.outputColorSpace),L.push(O.envMapMode),L.push(O.envMapCubeUVHeight),L.push(O.mapUv),L.push(O.alphaMapUv),L.push(O.lightMapUv),L.push(O.aoMapUv),L.push(O.bumpMapUv),L.push(O.normalMapUv),L.push(O.displacementMapUv),L.push(O.emissiveMapUv),L.push(O.metalnessMapUv),L.push(O.roughnessMapUv),L.push(O.anisotropyMapUv),L.push(O.clearcoatMapUv),L.push(O.clearcoatNormalMapUv),L.push(O.clearcoatRoughnessMapUv),L.push(O.iridescenceMapUv),L.push(O.iridescenceThicknessMapUv),L.push(O.sheenColorMapUv),L.push(O.sheenRoughnessMapUv),L.push(O.specularMapUv),L.push(O.specularColorMapUv),L.push(O.specularIntensityMapUv),L.push(O.transmissionMapUv),L.push(O.thicknessMapUv),L.push(O.combine),L.push(O.fogExp2),L.push(O.sizeAttenuation),L.push(O.morphTargetsCount),L.push(O.morphAttributeCount),L.push(O.numDirLights),L.push(O.numPointLights),L.push(O.numSpotLights),L.push(O.numSpotLightMaps),L.push(O.numHemiLights),L.push(O.numRectAreaLights),L.push(O.numDirLightShadows),L.push(O.numPointLightShadows),L.push(O.numSpotLightShadows),L.push(O.numSpotLightShadowsWithMaps),L.push(O.numLightProbes),L.push(O.shadowMapType),L.push(O.toneMapping),L.push(O.numClippingPlanes),L.push(O.numClipIntersection),L.push(O.depthPacking)}function R(L,O){a.disableAll(),O.supportsVertexTextures&&a.enable(0),O.instancing&&a.enable(1),O.instancingColor&&a.enable(2),O.instancingMorph&&a.enable(3),O.matcap&&a.enable(4),O.envMap&&a.enable(5),O.normalMapObjectSpace&&a.enable(6),O.normalMapTangentSpace&&a.enable(7),O.clearcoat&&a.enable(8),O.iridescence&&a.enable(9),O.alphaTest&&a.enable(10),O.vertexColors&&a.enable(11),O.vertexAlphas&&a.enable(12),O.vertexUv1s&&a.enable(13),O.vertexUv2s&&a.enable(14),O.vertexUv3s&&a.enable(15),O.vertexTangents&&a.enable(16),O.anisotropy&&a.enable(17),O.alphaHash&&a.enable(18),O.batching&&a.enable(19),O.dispersion&&a.enable(20),O.batchingColor&&a.enable(21),L.push(a.mask),a.disableAll(),O.fog&&a.enable(0),O.useFog&&a.enable(1),O.flatShading&&a.enable(2),O.logarithmicDepthBuffer&&a.enable(3),O.reverseDepthBuffer&&a.enable(4),O.skinning&&a.enable(5),O.morphTargets&&a.enable(6),O.morphNormals&&a.enable(7),O.morphColors&&a.enable(8),O.premultipliedAlpha&&a.enable(9),O.shadowMapEnabled&&a.enable(10),O.doubleSided&&a.enable(11),O.flipSided&&a.enable(12),O.useDepthPacking&&a.enable(13),O.dithering&&a.enable(14),O.transmission&&a.enable(15),O.sheen&&a.enable(16),O.opaque&&a.enable(17),O.pointsUvs&&a.enable(18),O.decodeVideoTexture&&a.enable(19),O.decodeVideoTextureEmissive&&a.enable(20),O.alphaToCoverage&&a.enable(21),L.push(a.mask)}function N(L){const O=_[L.type];let z;if(O){const Q=xo[O];z=YS.clone(Q.uniforms)}else z=L.uniforms;return z}function B(L,O){let z;for(let Q=0,j=c.length;Q<j;Q++){const ee=c[Q];if(ee.cacheKey===O){z=ee,++z.usedTimes;break}}return z===void 0&&(z=new vle(n,O,L,s),c.push(z)),z}function T(L){if(--L.usedTimes===0){const O=c.indexOf(L);c[O]=c[c.length-1],c.pop(),L.destroy()}}function D(L){l.remove(L)}function F(){l.dispose()}return{getParameters:w,getProgramCacheKey:x,getUniforms:N,acquireProgram:B,releaseProgram:T,releaseShaderCache:D,programs:c,dispose:F}}function Sle(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let a=n.get(o);return a===void 0&&(a={},n.set(o,a)),a}function i(o){n.delete(o)}function r(o,a,l){n.get(o)[a]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function wle(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function Tk(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function Ck(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(h,A,v,_,S,w){let x=n[e];return x===void 0?(x={id:h.id,object:h,geometry:A,material:v,groupOrder:_,renderOrder:h.renderOrder,z:S,group:w},n[e]=x):(x.id=h.id,x.object=h,x.geometry=A,x.material=v,x.groupOrder=_,x.renderOrder=h.renderOrder,x.z=S,x.group=w),e++,x}function a(h,A,v,_,S,w){const x=o(h,A,v,_,S,w);v.transmission>0?i.push(x):v.transparent===!0?r.push(x):t.push(x)}function l(h,A,v,_,S,w){const x=o(h,A,v,_,S,w);v.transmission>0?i.unshift(x):v.transparent===!0?r.unshift(x):t.unshift(x)}function u(h,A){t.length>1&&t.sort(h||wle),i.length>1&&i.sort(A||Tk),r.length>1&&r.sort(A||Tk)}function c(){for(let h=e,A=n.length;h<A;h++){const v=n[h];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:c,sort:u}}function Ele(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new Ck,n.set(i,[o])):r>=s.length?(o=new Ck,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function Tle(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new le,color:new fn};break;case"SpotLight":t={position:new le,direction:new le,color:new fn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new le,color:new fn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new le,skyColor:new fn,groundColor:new fn};break;case"RectAreaLight":t={color:new fn,position:new le,halfWidth:new le,halfHeight:new le};break}return n[e.id]=t,t}}}function Cle(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new rt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let Mle=0;function Rle(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Ple(n){const e=new Tle,t=Cle(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new le);const r=new le,s=new ki,o=new ki;function a(u){let c=0,h=0,A=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let v=0,_=0,S=0,w=0,x=0,M=0,R=0,N=0,B=0,T=0,D=0;u.sort(Rle);for(let L=0,O=u.length;L<O;L++){const z=u[L],Q=z.color,j=z.intensity,ee=z.distance,$=z.shadow&&z.shadow.map?z.shadow.map.texture:null;if(z.isAmbientLight)c+=Q.r*j,h+=Q.g*j,A+=Q.b*j;else if(z.isLightProbe){for(let Z=0;Z<9;Z++)i.probe[Z].addScaledVector(z.sh.coefficients[Z],j);D++}else if(z.isDirectionalLight){const Z=e.get(z);if(Z.color.copy(z.color).multiplyScalar(z.intensity),z.castShadow){const ce=z.shadow,ie=t.get(z);ie.shadowIntensity=ce.intensity,ie.shadowBias=ce.bias,ie.shadowNormalBias=ce.normalBias,ie.shadowRadius=ce.radius,ie.shadowMapSize=ce.mapSize,i.directionalShadow[v]=ie,i.directionalShadowMap[v]=$,i.directionalShadowMatrix[v]=z.shadow.matrix,M++}i.directional[v]=Z,v++}else if(z.isSpotLight){const Z=e.get(z);Z.position.setFromMatrixPosition(z.matrixWorld),Z.color.copy(Q).multiplyScalar(j),Z.distance=ee,Z.coneCos=Math.cos(z.angle),Z.penumbraCos=Math.cos(z.angle*(1-z.penumbra)),Z.decay=z.decay,i.spot[S]=Z;const ce=z.shadow;if(z.map&&(i.spotLightMap[B]=z.map,B++,ce.updateMatrices(z),z.castShadow&&T++),i.spotLightMatrix[S]=ce.matrix,z.castShadow){const ie=t.get(z);ie.shadowIntensity=ce.intensity,ie.shadowBias=ce.bias,ie.shadowNormalBias=ce.normalBias,ie.shadowRadius=ce.radius,ie.shadowMapSize=ce.mapSize,i.spotShadow[S]=ie,i.spotShadowMap[S]=$,N++}S++}else if(z.isRectAreaLight){const Z=e.get(z);Z.color.copy(Q).multiplyScalar(j),Z.halfWidth.set(z.width*.5,0,0),Z.halfHeight.set(0,z.height*.5,0),i.rectArea[w]=Z,w++}else if(z.isPointLight){const Z=e.get(z);if(Z.color.copy(z.color).multiplyScalar(z.intensity),Z.distance=z.distance,Z.decay=z.decay,z.castShadow){const ce=z.shadow,ie=t.get(z);ie.shadowIntensity=ce.intensity,ie.shadowBias=ce.bias,ie.shadowNormalBias=ce.normalBias,ie.shadowRadius=ce.radius,ie.shadowMapSize=ce.mapSize,ie.shadowCameraNear=ce.camera.near,ie.shadowCameraFar=ce.camera.far,i.pointShadow[_]=ie,i.pointShadowMap[_]=$,i.pointShadowMatrix[_]=z.shadow.matrix,R++}i.point[_]=Z,_++}else if(z.isHemisphereLight){const Z=e.get(z);Z.skyColor.copy(z.color).multiplyScalar(j),Z.groundColor.copy(z.groundColor).multiplyScalar(j),i.hemi[x]=Z,x++}}w>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Et.LTC_FLOAT_1,i.rectAreaLTC2=Et.LTC_FLOAT_2):(i.rectAreaLTC1=Et.LTC_HALF_1,i.rectAreaLTC2=Et.LTC_HALF_2)),i.ambient[0]=c,i.ambient[1]=h,i.ambient[2]=A;const F=i.hash;(F.directionalLength!==v||F.pointLength!==_||F.spotLength!==S||F.rectAreaLength!==w||F.hemiLength!==x||F.numDirectionalShadows!==M||F.numPointShadows!==R||F.numSpotShadows!==N||F.numSpotMaps!==B||F.numLightProbes!==D)&&(i.directional.length=v,i.spot.length=S,i.rectArea.length=w,i.point.length=_,i.hemi.length=x,i.directionalShadow.length=M,i.directionalShadowMap.length=M,i.pointShadow.length=R,i.pointShadowMap.length=R,i.spotShadow.length=N,i.spotShadowMap.length=N,i.directionalShadowMatrix.length=M,i.pointShadowMatrix.length=R,i.spotLightMatrix.length=N+B-T,i.spotLightMap.length=B,i.numSpotLightShadowsWithMaps=T,i.numLightProbes=D,F.directionalLength=v,F.pointLength=_,F.spotLength=S,F.rectAreaLength=w,F.hemiLength=x,F.numDirectionalShadows=M,F.numPointShadows=R,F.numSpotShadows=N,F.numSpotMaps=B,F.numLightProbes=D,i.version=Mle++)}function l(u,c){let h=0,A=0,v=0,_=0,S=0;const w=c.matrixWorldInverse;for(let x=0,M=u.length;x<M;x++){const R=u[x];if(R.isDirectionalLight){const N=i.directional[h];N.direction.setFromMatrixPosition(R.matrixWorld),r.setFromMatrixPosition(R.target.matrixWorld),N.direction.sub(r),N.direction.transformDirection(w),h++}else if(R.isSpotLight){const N=i.spot[v];N.position.setFromMatrixPosition(R.matrixWorld),N.position.applyMatrix4(w),N.direction.setFromMatrixPosition(R.matrixWorld),r.setFromMatrixPosition(R.target.matrixWorld),N.direction.sub(r),N.direction.transformDirection(w),v++}else if(R.isRectAreaLight){const N=i.rectArea[_];N.position.setFromMatrixPosition(R.matrixWorld),N.position.applyMatrix4(w),o.identity(),s.copy(R.matrixWorld),s.premultiply(w),o.extractRotation(s),N.halfWidth.set(R.width*.5,0,0),N.halfHeight.set(0,R.height*.5,0),N.halfWidth.applyMatrix4(o),N.halfHeight.applyMatrix4(o),_++}else if(R.isPointLight){const N=i.point[A];N.position.setFromMatrixPosition(R.matrixWorld),N.position.applyMatrix4(w),A++}else if(R.isHemisphereLight){const N=i.hemi[S];N.direction.setFromMatrixPosition(R.matrixWorld),N.direction.transformDirection(w),S++}}}return{setup:a,setupView:l,state:i}}function Mk(n){const e=new Ple(n),t=[],i=[];function r(c){u.camera=c,t.length=0,i.length=0}function s(c){t.push(c)}function o(c){i.push(c)}function a(){e.setup(t)}function l(c){e.setupView(t,c)}const u={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:u,setupLights:a,setupLightsView:l,pushLight:s,pushShadow:o}}function Nle(n){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new Mk(n),e.set(r,[a])):s>=o.length?(a=new Mk(n),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:t,dispose:i}}class Ile extends ep{static get type(){return"MeshDepthMaterial"}constructor(e){super(),this.isMeshDepthMaterial=!0,this.depthPacking=pie,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Dle extends ep{static get type(){return"MeshDistanceMaterial"}constructor(e){super(),this.isMeshDistanceMaterial=!0,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const kle=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Lle=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Fle(n,e,t){let i=new WP;const r=new rt,s=new rt,o=new Ui,a=new Ile({depthPacking:Aie}),l=new Dle,u={},c=t.maxTextureSize,h={[Qh]:Ds,[Ds]:Qh,[Ks]:Ks},A=new ko({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new rt},radius:{value:4}},vertexShader:kle,fragmentShader:Lle}),v=A.clone();v.defines.HORIZONTAL_PASS=1;const _=new ur;_.setAttribute("position",new Qr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const S=new rr(_,A),w=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=pV;let x=this.type;this.render=function(T,D,F){if(w.enabled===!1||w.autoUpdate===!1&&w.needsUpdate===!1||T.length===0)return;const L=n.getRenderTarget(),O=n.getActiveCubeFace(),z=n.getActiveMipmapLevel(),Q=n.state;Q.setBlending(Yu),Q.buffers.color.setClear(1,1,1,1),Q.buffers.depth.setTest(!0),Q.setScissorTest(!1);const j=x!==Pu&&this.type===Pu,ee=x===Pu&&this.type!==Pu;for(let $=0,Z=T.length;$<Z;$++){const ce=T[$],ie=ce.shadow;if(ie===void 0){console.warn("THREE.WebGLShadowMap:",ce,"has no shadow.");continue}if(ie.autoUpdate===!1&&ie.needsUpdate===!1)continue;r.copy(ie.mapSize);const oe=ie.getFrameExtents();if(r.multiply(oe),s.copy(ie.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/oe.x),r.x=s.x*oe.x,ie.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/oe.y),r.y=s.y*oe.y,ie.mapSize.y=s.y)),ie.map===null||j===!0||ee===!0){const _e=this.type!==Pu?{minFilter:xl,magFilter:xl}:{};ie.map!==null&&ie.map.dispose(),ie.map=new Kh(r.x,r.y,_e),ie.map.texture.name=ce.name+".shadowMap",ie.camera.updateProjectionMatrix()}n.setRenderTarget(ie.map),n.clear();const me=ie.getViewportCount();for(let _e=0;_e<me;_e++){const Oe=ie.getViewport(_e);o.set(s.x*Oe.x,s.y*Oe.y,s.x*Oe.z,s.y*Oe.w),Q.viewport(o),ie.updateMatrices(ce,_e),i=ie.getFrustum(),N(D,F,ie.camera,ce,this.type)}ie.isPointLightShadow!==!0&&this.type===Pu&&M(ie,F),ie.needsUpdate=!1}x=this.type,w.needsUpdate=!1,n.setRenderTarget(L,O,z)};function M(T,D){const F=e.update(S);A.defines.VSM_SAMPLES!==T.blurSamples&&(A.defines.VSM_SAMPLES=T.blurSamples,v.defines.VSM_SAMPLES=T.blurSamples,A.needsUpdate=!0,v.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new Kh(r.x,r.y)),A.uniforms.shadow_pass.value=T.map.texture,A.uniforms.resolution.value=T.mapSize,A.uniforms.radius.value=T.radius,n.setRenderTarget(T.mapPass),n.clear(),n.renderBufferDirect(D,null,F,A,S,null),v.uniforms.shadow_pass.value=T.mapPass.texture,v.uniforms.resolution.value=T.mapSize,v.uniforms.radius.value=T.radius,n.setRenderTarget(T.map),n.clear(),n.renderBufferDirect(D,null,F,v,S,null)}function R(T,D,F,L){let O=null;const z=F.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(z!==void 0)O=z;else if(O=F.isPointLight===!0?l:a,n.localClippingEnabled&&D.clipShadows===!0&&Array.isArray(D.clippingPlanes)&&D.clippingPlanes.length!==0||D.displacementMap&&D.displacementScale!==0||D.alphaMap&&D.alphaTest>0||D.map&&D.alphaTest>0){const Q=O.uuid,j=D.uuid;let ee=u[Q];ee===void 0&&(ee={},u[Q]=ee);let $=ee[j];$===void 0&&($=O.clone(),ee[j]=$,D.addEventListener("dispose",B)),O=$}if(O.visible=D.visible,O.wireframe=D.wireframe,L===Pu?O.side=D.shadowSide!==null?D.shadowSide:D.side:O.side=D.shadowSide!==null?D.shadowSide:h[D.side],O.alphaMap=D.alphaMap,O.alphaTest=D.alphaTest,O.map=D.map,O.clipShadows=D.clipShadows,O.clippingPlanes=D.clippingPlanes,O.clipIntersection=D.clipIntersection,O.displacementMap=D.displacementMap,O.displacementScale=D.displacementScale,O.displacementBias=D.displacementBias,O.wireframeLinewidth=D.wireframeLinewidth,O.linewidth=D.linewidth,F.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const Q=n.properties.get(O);Q.light=F}return O}function N(T,D,F,L,O){if(T.visible===!1)return;if(T.layers.test(D.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&O===Pu)&&(!T.frustumCulled||i.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,T.matrixWorld);const j=e.update(T),ee=T.material;if(Array.isArray(ee)){const $=j.groups;for(let Z=0,ce=$.length;Z<ce;Z++){const ie=$[Z],oe=ee[ie.materialIndex];if(oe&&oe.visible){const me=R(T,oe,L,O);T.onBeforeShadow(n,T,D,F,j,me,ie),n.renderBufferDirect(F,null,j,me,T,ie),T.onAfterShadow(n,T,D,F,j,me,ie)}}}else if(ee.visible){const $=R(T,ee,L,O);T.onBeforeShadow(n,T,D,F,j,$,null),n.renderBufferDirect(F,null,j,$,T,null),T.onAfterShadow(n,T,D,F,j,$,null)}}const Q=T.children;for(let j=0,ee=Q.length;j<ee;j++)N(Q[j],D,F,L,O)}function B(T){T.target.removeEventListener("dispose",B);for(const F in u){const L=u[F],O=T.target.uuid;O in L&&(L[O].dispose(),delete L[O])}}}const Ble={[_M]:xM,[bM]:EM,[SM]:TM,[p0]:wM,[xM]:_M,[EM]:bM,[TM]:SM,[wM]:p0};function Ole(n,e){function t(){let ve=!1;const ft=new Ui;let Fe=null;const Ve=new Ui(0,0,0,0);return{setMask:function(Te){Fe!==Te&&!ve&&(n.colorMask(Te,Te,Te,Te),Fe=Te)},setLocked:function(Te){ve=Te},setClear:function(Te,Ye,an,bi,yr){yr===!0&&(Te*=bi,Ye*=bi,an*=bi),ft.set(Te,Ye,an,bi),Ve.equals(ft)===!1&&(n.clearColor(Te,Ye,an,bi),Ve.copy(ft))},reset:function(){ve=!1,Fe=null,Ve.set(-1,0,0,0)}}}function i(){let ve=!1,ft=!1,Fe=null,Ve=null,Te=null;return{setReversed:function(Ye){if(ft!==Ye){const an=e.get("EXT_clip_control");ft?an.clipControlEXT(an.LOWER_LEFT_EXT,an.ZERO_TO_ONE_EXT):an.clipControlEXT(an.LOWER_LEFT_EXT,an.NEGATIVE_ONE_TO_ONE_EXT);const bi=Te;Te=null,this.setClear(bi)}ft=Ye},getReversed:function(){return ft},setTest:function(Ye){Ye?tt(n.DEPTH_TEST):Ot(n.DEPTH_TEST)},setMask:function(Ye){Fe!==Ye&&!ve&&(n.depthMask(Ye),Fe=Ye)},setFunc:function(Ye){if(ft&&(Ye=Ble[Ye]),Ve!==Ye){switch(Ye){case _M:n.depthFunc(n.NEVER);break;case xM:n.depthFunc(n.ALWAYS);break;case bM:n.depthFunc(n.LESS);break;case p0:n.depthFunc(n.LEQUAL);break;case SM:n.depthFunc(n.EQUAL);break;case wM:n.depthFunc(n.GEQUAL);break;case EM:n.depthFunc(n.GREATER);break;case TM:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Ve=Ye}},setLocked:function(Ye){ve=Ye},setClear:function(Ye){Te!==Ye&&(ft&&(Ye=1-Ye),n.clearDepth(Ye),Te=Ye)},reset:function(){ve=!1,Fe=null,Ve=null,Te=null,ft=!1}}}function r(){let ve=!1,ft=null,Fe=null,Ve=null,Te=null,Ye=null,an=null,bi=null,yr=null;return{setTest:function(Fn){ve||(Fn?tt(n.STENCIL_TEST):Ot(n.STENCIL_TEST))},setMask:function(Fn){ft!==Fn&&!ve&&(n.stencilMask(Fn),ft=Fn)},setFunc:function(Fn,Xi,lo){(Fe!==Fn||Ve!==Xi||Te!==lo)&&(n.stencilFunc(Fn,Xi,lo),Fe=Fn,Ve=Xi,Te=lo)},setOp:function(Fn,Xi,lo){(Ye!==Fn||an!==Xi||bi!==lo)&&(n.stencilOp(Fn,Xi,lo),Ye=Fn,an=Xi,bi=lo)},setLocked:function(Fn){ve=Fn},setClear:function(Fn){yr!==Fn&&(n.clearStencil(Fn),yr=Fn)},reset:function(){ve=!1,ft=null,Fe=null,Ve=null,Te=null,Ye=null,an=null,bi=null,yr=null}}}const s=new t,o=new i,a=new r,l=new WeakMap,u=new WeakMap;let c={},h={},A=new WeakMap,v=[],_=null,S=!1,w=null,x=null,M=null,R=null,N=null,B=null,T=null,D=new fn(0,0,0),F=0,L=!1,O=null,z=null,Q=null,j=null,ee=null;const $=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Z=!1,ce=0;const ie=n.getParameter(n.VERSION);ie.indexOf("WebGL")!==-1?(ce=parseFloat(/^WebGL (\d)/.exec(ie)[1]),Z=ce>=1):ie.indexOf("OpenGL ES")!==-1&&(ce=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),Z=ce>=2);let oe=null,me={};const _e=n.getParameter(n.SCISSOR_BOX),Oe=n.getParameter(n.VIEWPORT),Ke=new Ui().fromArray(_e),Me=new Ui().fromArray(Oe);function ze(ve,ft,Fe,Ve){const Te=new Uint8Array(4),Ye=n.createTexture();n.bindTexture(ve,Ye),n.texParameteri(ve,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ve,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let an=0;an<Fe;an++)ve===n.TEXTURE_3D||ve===n.TEXTURE_2D_ARRAY?n.texImage3D(ft,0,n.RGBA,1,1,Ve,0,n.RGBA,n.UNSIGNED_BYTE,Te):n.texImage2D(ft+an,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Te);return Ye}const nt={};nt[n.TEXTURE_2D]=ze(n.TEXTURE_2D,n.TEXTURE_2D,1),nt[n.TEXTURE_CUBE_MAP]=ze(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),nt[n.TEXTURE_2D_ARRAY]=ze(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),nt[n.TEXTURE_3D]=ze(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),o.setClear(1),a.setClear(0),tt(n.DEPTH_TEST),o.setFunc(p0),st(!1),xt(ND),tt(n.CULL_FACE),ue(Yu);function tt(ve){c[ve]!==!0&&(n.enable(ve),c[ve]=!0)}function Ot(ve){c[ve]!==!1&&(n.disable(ve),c[ve]=!1)}function Ht(ve,ft){return h[ve]!==ft?(n.bindFramebuffer(ve,ft),h[ve]=ft,ve===n.DRAW_FRAMEBUFFER&&(h[n.FRAMEBUFFER]=ft),ve===n.FRAMEBUFFER&&(h[n.DRAW_FRAMEBUFFER]=ft),!0):!1}function Ct(ve,ft){let Fe=v,Ve=!1;if(ve){Fe=A.get(ft),Fe===void 0&&(Fe=[],A.set(ft,Fe));const Te=ve.textures;if(Fe.length!==Te.length||Fe[0]!==n.COLOR_ATTACHMENT0){for(let Ye=0,an=Te.length;Ye<an;Ye++)Fe[Ye]=n.COLOR_ATTACHMENT0+Ye;Fe.length=Te.length,Ve=!0}}else Fe[0]!==n.BACK&&(Fe[0]=n.BACK,Ve=!0);Ve&&n.drawBuffers(Fe)}function en(ve){return _!==ve?(n.useProgram(ve),_=ve,!0):!1}const Ze={[Zf]:n.FUNC_ADD,[Une]:n.FUNC_SUBTRACT,[zne]:n.FUNC_REVERSE_SUBTRACT};Ze[Vne]=n.MIN,Ze[Gne]=n.MAX;const at={[qne]:n.ZERO,[Hne]:n.ONE,[$ne]:n.SRC_COLOR,[vM]:n.SRC_ALPHA,[Kne]:n.SRC_ALPHA_SATURATE,[Yne]:n.DST_COLOR,[Wne]:n.DST_ALPHA,[jne]:n.ONE_MINUS_SRC_COLOR,[yM]:n.ONE_MINUS_SRC_ALPHA,[Qne]:n.ONE_MINUS_DST_COLOR,[Xne]:n.ONE_MINUS_DST_ALPHA,[Zne]:n.CONSTANT_COLOR,[Jne]:n.ONE_MINUS_CONSTANT_COLOR,[eie]:n.CONSTANT_ALPHA,[tie]:n.ONE_MINUS_CONSTANT_ALPHA};function ue(ve,ft,Fe,Ve,Te,Ye,an,bi,yr,Fn){if(ve===Yu){S===!0&&(Ot(n.BLEND),S=!1);return}if(S===!1&&(tt(n.BLEND),S=!0),ve!==One){if(ve!==w||Fn!==L){if((x!==Zf||N!==Zf)&&(n.blendEquation(n.FUNC_ADD),x=Zf,N=Zf),Fn)switch(ve){case Fh:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case ID:n.blendFunc(n.ONE,n.ONE);break;case DD:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case kD:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ve);break}else switch(ve){case Fh:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case ID:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case DD:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case kD:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ve);break}M=null,R=null,B=null,T=null,D.set(0,0,0),F=0,w=ve,L=Fn}return}Te=Te||ft,Ye=Ye||Fe,an=an||Ve,(ft!==x||Te!==N)&&(n.blendEquationSeparate(Ze[ft],Ze[Te]),x=ft,N=Te),(Fe!==M||Ve!==R||Ye!==B||an!==T)&&(n.blendFuncSeparate(at[Fe],at[Ve],at[Ye],at[an]),M=Fe,R=Ve,B=Ye,T=an),(bi.equals(D)===!1||yr!==F)&&(n.blendColor(bi.r,bi.g,bi.b,yr),D.copy(bi),F=yr),w=ve,L=!1}function zt(ve,ft){ve.side===Ks?Ot(n.CULL_FACE):tt(n.CULL_FACE);let Fe=ve.side===Ds;ft&&(Fe=!Fe),st(Fe),ve.blending===Fh&&ve.transparent===!1?ue(Yu):ue(ve.blending,ve.blendEquation,ve.blendSrc,ve.blendDst,ve.blendEquationAlpha,ve.blendSrcAlpha,ve.blendDstAlpha,ve.blendColor,ve.blendAlpha,ve.premultipliedAlpha),o.setFunc(ve.depthFunc),o.setTest(ve.depthTest),o.setMask(ve.depthWrite),s.setMask(ve.colorWrite);const Ve=ve.stencilWrite;a.setTest(Ve),Ve&&(a.setMask(ve.stencilWriteMask),a.setFunc(ve.stencilFunc,ve.stencilRef,ve.stencilFuncMask),a.setOp(ve.stencilFail,ve.stencilZFail,ve.stencilZPass)),Yt(ve.polygonOffset,ve.polygonOffsetFactor,ve.polygonOffsetUnits),ve.alphaToCoverage===!0?tt(n.SAMPLE_ALPHA_TO_COVERAGE):Ot(n.SAMPLE_ALPHA_TO_COVERAGE)}function st(ve){O!==ve&&(ve?n.frontFace(n.CW):n.frontFace(n.CCW),O=ve)}function xt(ve){ve!==Lne?(tt(n.CULL_FACE),ve!==z&&(ve===ND?n.cullFace(n.BACK):ve===Fne?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Ot(n.CULL_FACE),z=ve}function ht(ve){ve!==Q&&(Z&&n.lineWidth(ve),Q=ve)}function Yt(ve,ft,Fe){ve?(tt(n.POLYGON_OFFSET_FILL),(j!==ft||ee!==Fe)&&(n.polygonOffset(ft,Fe),j=ft,ee=Fe)):Ot(n.POLYGON_OFFSET_FILL)}function Nt(ve){ve?tt(n.SCISSOR_TEST):Ot(n.SCISSOR_TEST)}function re(ve){ve===void 0&&(ve=n.TEXTURE0+$-1),oe!==ve&&(n.activeTexture(ve),oe=ve)}function W(ve,ft,Fe){Fe===void 0&&(oe===null?Fe=n.TEXTURE0+$-1:Fe=oe);let Ve=me[Fe];Ve===void 0&&(Ve={type:void 0,texture:void 0},me[Fe]=Ve),(Ve.type!==ve||Ve.texture!==ft)&&(oe!==Fe&&(n.activeTexture(Fe),oe=Fe),n.bindTexture(ve,ft||nt[ve]),Ve.type=ve,Ve.texture=ft)}function Ne(){const ve=me[oe];ve!==void 0&&ve.type!==void 0&&(n.bindTexture(ve.type,null),ve.type=void 0,ve.texture=void 0)}function He(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function et(){try{n.compressedTexImage3D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Be(){try{n.texSubImage2D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function It(){try{n.texSubImage3D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function ut(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Dt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function _n(){try{n.texStorage2D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function ke(){try{n.texStorage3D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Lt(){try{n.texImage2D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function Zt(){try{n.texImage3D.apply(n,arguments)}catch(ve){console.error("THREE.WebGLState:",ve)}}function tn(ve){Ke.equals(ve)===!1&&(n.scissor(ve.x,ve.y,ve.z,ve.w),Ke.copy(ve))}function kt(ve){Me.equals(ve)===!1&&(n.viewport(ve.x,ve.y,ve.z,ve.w),Me.copy(ve))}function Mn(ve,ft){let Fe=u.get(ft);Fe===void 0&&(Fe=new WeakMap,u.set(ft,Fe));let Ve=Fe.get(ve);Ve===void 0&&(Ve=n.getUniformBlockIndex(ft,ve.name),Fe.set(ve,Ve))}function pn(ve,ft){const Ve=u.get(ft).get(ve);l.get(ft)!==Ve&&(n.uniformBlockBinding(ft,Ve,ve.__bindingPointIndex),l.set(ft,Ve))}function hi(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),o.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),c={},oe=null,me={},h={},A=new WeakMap,v=[],_=null,S=!1,w=null,x=null,M=null,R=null,N=null,B=null,T=null,D=new fn(0,0,0),F=0,L=!1,O=null,z=null,Q=null,j=null,ee=null,Ke.set(0,0,n.canvas.width,n.canvas.height),Me.set(0,0,n.canvas.width,n.canvas.height),s.reset(),o.reset(),a.reset()}return{buffers:{color:s,depth:o,stencil:a},enable:tt,disable:Ot,bindFramebuffer:Ht,drawBuffers:Ct,useProgram:en,setBlending:ue,setMaterial:zt,setFlipSided:st,setCullFace:xt,setLineWidth:ht,setPolygonOffset:Yt,setScissorTest:Nt,activeTexture:re,bindTexture:W,unbindTexture:Ne,compressedTexImage2D:He,compressedTexImage3D:et,texImage2D:Lt,texImage3D:Zt,updateUBOMapping:Mn,uniformBlockBinding:pn,texStorage2D:_n,texStorage3D:ke,texSubImage2D:Be,texSubImage3D:It,compressedTexSubImage2D:ut,compressedTexSubImage3D:Dt,scissor:tn,viewport:kt,reset:hi}}function Rk(n,e,t,i){const r=Ule(i);switch(t){case yV:return n*e;case xV:return n*e;case bV:return n*e*2;case SV:return n*e/r.components*r.byteLength;case VP:return n*e/r.components*r.byteLength;case wV:return n*e*2/r.components*r.byteLength;case GP:return n*e*2/r.components*r.byteLength;case _V:return n*e*3/r.components*r.byteLength;case dl:return n*e*4/r.components*r.byteLength;case qP:return n*e*4/r.components*r.byteLength;case P2:case N2:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case I2:case D2:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case IM:case kM:return Math.max(n,16)*Math.max(e,8)/4;case NM:case DM:return Math.max(n,8)*Math.max(e,8)/2;case LM:case FM:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case BM:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case OM:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case UM:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case zM:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case VM:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case GM:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case qM:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case HM:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case $M:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case jM:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case WM:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case XM:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case YM:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case QM:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case KM:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case k2:case ZM:case JM:return Math.ceil(n/4)*Math.ceil(e/4)*16;case EV:case e4:return Math.ceil(n/4)*Math.ceil(e/4)*8;case t4:case n4:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Ule(n){switch(n){case hc:case mV:return{byteLength:1,components:1};case S1:case gV:case W0:return{byteLength:2,components:1};case UP:case zP:return{byteLength:2,components:4};case Nd:case OP:case Vu:return{byteLength:4,components:1};case vV:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}function zle(n,e,t,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new rt,c=new WeakMap;let h;const A=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(re,W){return v?new OffscreenCanvas(re,W):E1("canvas")}function S(re,W,Ne){let He=1;const et=Nt(re);if((et.width>Ne||et.height>Ne)&&(He=Ne/Math.max(et.width,et.height)),He<1)if(typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&re instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&re instanceof ImageBitmap||typeof VideoFrame<"u"&&re instanceof VideoFrame){const Be=Math.floor(He*et.width),It=Math.floor(He*et.height);h===void 0&&(h=_(Be,It));const ut=W?_(Be,It):h;return ut.width=Be,ut.height=It,ut.getContext("2d").drawImage(re,0,0,Be,It),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+et.width+"x"+et.height+") to ("+Be+"x"+It+")."),ut}else return"data"in re&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+et.width+"x"+et.height+")."),re;return re}function w(re){return re.generateMipmaps}function x(re){n.generateMipmap(re)}function M(re){return re.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:re.isWebGL3DRenderTarget?n.TEXTURE_3D:re.isWebGLArrayRenderTarget||re.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function R(re,W,Ne,He,et=!1){if(re!==null){if(n[re]!==void 0)return n[re];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+re+"'")}let Be=W;if(W===n.RED&&(Ne===n.FLOAT&&(Be=n.R32F),Ne===n.HALF_FLOAT&&(Be=n.R16F),Ne===n.UNSIGNED_BYTE&&(Be=n.R8)),W===n.RED_INTEGER&&(Ne===n.UNSIGNED_BYTE&&(Be=n.R8UI),Ne===n.UNSIGNED_SHORT&&(Be=n.R16UI),Ne===n.UNSIGNED_INT&&(Be=n.R32UI),Ne===n.BYTE&&(Be=n.R8I),Ne===n.SHORT&&(Be=n.R16I),Ne===n.INT&&(Be=n.R32I)),W===n.RG&&(Ne===n.FLOAT&&(Be=n.RG32F),Ne===n.HALF_FLOAT&&(Be=n.RG16F),Ne===n.UNSIGNED_BYTE&&(Be=n.RG8)),W===n.RG_INTEGER&&(Ne===n.UNSIGNED_BYTE&&(Be=n.RG8UI),Ne===n.UNSIGNED_SHORT&&(Be=n.RG16UI),Ne===n.UNSIGNED_INT&&(Be=n.RG32UI),Ne===n.BYTE&&(Be=n.RG8I),Ne===n.SHORT&&(Be=n.RG16I),Ne===n.INT&&(Be=n.RG32I)),W===n.RGB_INTEGER&&(Ne===n.UNSIGNED_BYTE&&(Be=n.RGB8UI),Ne===n.UNSIGNED_SHORT&&(Be=n.RGB16UI),Ne===n.UNSIGNED_INT&&(Be=n.RGB32UI),Ne===n.BYTE&&(Be=n.RGB8I),Ne===n.SHORT&&(Be=n.RGB16I),Ne===n.INT&&(Be=n.RGB32I)),W===n.RGBA_INTEGER&&(Ne===n.UNSIGNED_BYTE&&(Be=n.RGBA8UI),Ne===n.UNSIGNED_SHORT&&(Be=n.RGBA16UI),Ne===n.UNSIGNED_INT&&(Be=n.RGBA32UI),Ne===n.BYTE&&(Be=n.RGBA8I),Ne===n.SHORT&&(Be=n.RGBA16I),Ne===n.INT&&(Be=n.RGBA32I)),W===n.RGB&&Ne===n.UNSIGNED_INT_5_9_9_9_REV&&(Be=n.RGB9_E5),W===n.RGBA){const It=et?$S:ni.getTransfer(He);Ne===n.FLOAT&&(Be=n.RGBA32F),Ne===n.HALF_FLOAT&&(Be=n.RGBA16F),Ne===n.UNSIGNED_BYTE&&(Be=It===wi?n.SRGB8_ALPHA8:n.RGBA8),Ne===n.UNSIGNED_SHORT_4_4_4_4&&(Be=n.RGBA4),Ne===n.UNSIGNED_SHORT_5_5_5_1&&(Be=n.RGB5_A1)}return(Be===n.R16F||Be===n.R32F||Be===n.RG16F||Be===n.RG32F||Be===n.RGBA16F||Be===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Be}function N(re,W){let Ne;return re?W===null||W===Nd||W===g0?Ne=n.DEPTH24_STENCIL8:W===Vu?Ne=n.DEPTH32F_STENCIL8:W===S1&&(Ne=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):W===null||W===Nd||W===g0?Ne=n.DEPTH_COMPONENT24:W===Vu?Ne=n.DEPTH_COMPONENT32F:W===S1&&(Ne=n.DEPTH_COMPONENT16),Ne}function B(re,W){return w(re)===!0||re.isFramebufferTexture&&re.minFilter!==xl&&re.minFilter!==$l?Math.log2(Math.max(W.width,W.height))+1:re.mipmaps!==void 0&&re.mipmaps.length>0?re.mipmaps.length:re.isCompressedTexture&&Array.isArray(re.image)?W.mipmaps.length:1}function T(re){const W=re.target;W.removeEventListener("dispose",T),F(W),W.isVideoTexture&&c.delete(W)}function D(re){const W=re.target;W.removeEventListener("dispose",D),O(W)}function F(re){const W=i.get(re);if(W.__webglInit===void 0)return;const Ne=re.source,He=A.get(Ne);if(He){const et=He[W.__cacheKey];et.usedTimes--,et.usedTimes===0&&L(re),Object.keys(He).length===0&&A.delete(Ne)}i.remove(re)}function L(re){const W=i.get(re);n.deleteTexture(W.__webglTexture);const Ne=re.source,He=A.get(Ne);delete He[W.__cacheKey],o.memory.textures--}function O(re){const W=i.get(re);if(re.depthTexture&&(re.depthTexture.dispose(),i.remove(re.depthTexture)),re.isWebGLCubeRenderTarget)for(let He=0;He<6;He++){if(Array.isArray(W.__webglFramebuffer[He]))for(let et=0;et<W.__webglFramebuffer[He].length;et++)n.deleteFramebuffer(W.__webglFramebuffer[He][et]);else n.deleteFramebuffer(W.__webglFramebuffer[He]);W.__webglDepthbuffer&&n.deleteRenderbuffer(W.__webglDepthbuffer[He])}else{if(Array.isArray(W.__webglFramebuffer))for(let He=0;He<W.__webglFramebuffer.length;He++)n.deleteFramebuffer(W.__webglFramebuffer[He]);else n.deleteFramebuffer(W.__webglFramebuffer);if(W.__webglDepthbuffer&&n.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&n.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer)for(let He=0;He<W.__webglColorRenderbuffer.length;He++)W.__webglColorRenderbuffer[He]&&n.deleteRenderbuffer(W.__webglColorRenderbuffer[He]);W.__webglDepthRenderbuffer&&n.deleteRenderbuffer(W.__webglDepthRenderbuffer)}const Ne=re.textures;for(let He=0,et=Ne.length;He<et;He++){const Be=i.get(Ne[He]);Be.__webglTexture&&(n.deleteTexture(Be.__webglTexture),o.memory.textures--),i.remove(Ne[He])}i.remove(re)}let z=0;function Q(){z=0}function j(){const re=z;return re>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+re+" texture units while this GPU supports only "+r.maxTextures),z+=1,re}function ee(re){const W=[];return W.push(re.wrapS),W.push(re.wrapT),W.push(re.wrapR||0),W.push(re.magFilter),W.push(re.minFilter),W.push(re.anisotropy),W.push(re.internalFormat),W.push(re.format),W.push(re.type),W.push(re.generateMipmaps),W.push(re.premultiplyAlpha),W.push(re.flipY),W.push(re.unpackAlignment),W.push(re.colorSpace),W.join()}function $(re,W){const Ne=i.get(re);if(re.isVideoTexture&&ht(re),re.isRenderTargetTexture===!1&&re.version>0&&Ne.__version!==re.version){const He=re.image;if(He===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(He.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Me(Ne,re,W);return}}t.bindTexture(n.TEXTURE_2D,Ne.__webglTexture,n.TEXTURE0+W)}function Z(re,W){const Ne=i.get(re);if(re.version>0&&Ne.__version!==re.version){Me(Ne,re,W);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Ne.__webglTexture,n.TEXTURE0+W)}function ce(re,W){const Ne=i.get(re);if(re.version>0&&Ne.__version!==re.version){Me(Ne,re,W);return}t.bindTexture(n.TEXTURE_3D,Ne.__webglTexture,n.TEXTURE0+W)}function ie(re,W){const Ne=i.get(re);if(re.version>0&&Ne.__version!==re.version){ze(Ne,re,W);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Ne.__webglTexture,n.TEXTURE0+W)}const oe={[RM]:n.REPEAT,[cd]:n.CLAMP_TO_EDGE,[PM]:n.MIRRORED_REPEAT},me={[xl]:n.NEAREST,[hie]:n.NEAREST_MIPMAP_NEAREST,[Ny]:n.NEAREST_MIPMAP_LINEAR,[$l]:n.LINEAR,[VE]:n.LINEAR_MIPMAP_NEAREST,[hd]:n.LINEAR_MIPMAP_LINEAR},_e={[gie]:n.NEVER,[Sie]:n.ALWAYS,[vie]:n.LESS,[TV]:n.LEQUAL,[yie]:n.EQUAL,[bie]:n.GEQUAL,[_ie]:n.GREATER,[xie]:n.NOTEQUAL};function Oe(re,W){if(W.type===Vu&&e.has("OES_texture_float_linear")===!1&&(W.magFilter===$l||W.magFilter===VE||W.magFilter===Ny||W.magFilter===hd||W.minFilter===$l||W.minFilter===VE||W.minFilter===Ny||W.minFilter===hd)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(re,n.TEXTURE_WRAP_S,oe[W.wrapS]),n.texParameteri(re,n.TEXTURE_WRAP_T,oe[W.wrapT]),(re===n.TEXTURE_3D||re===n.TEXTURE_2D_ARRAY)&&n.texParameteri(re,n.TEXTURE_WRAP_R,oe[W.wrapR]),n.texParameteri(re,n.TEXTURE_MAG_FILTER,me[W.magFilter]),n.texParameteri(re,n.TEXTURE_MIN_FILTER,me[W.minFilter]),W.compareFunction&&(n.texParameteri(re,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(re,n.TEXTURE_COMPARE_FUNC,_e[W.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(W.magFilter===xl||W.minFilter!==Ny&&W.minFilter!==hd||W.type===Vu&&e.has("OES_texture_float_linear")===!1)return;if(W.anisotropy>1||i.get(W).__currentAnisotropy){const Ne=e.get("EXT_texture_filter_anisotropic");n.texParameterf(re,Ne.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(W.anisotropy,r.getMaxAnisotropy())),i.get(W).__currentAnisotropy=W.anisotropy}}}function Ke(re,W){let Ne=!1;re.__webglInit===void 0&&(re.__webglInit=!0,W.addEventListener("dispose",T));const He=W.source;let et=A.get(He);et===void 0&&(et={},A.set(He,et));const Be=ee(W);if(Be!==re.__cacheKey){et[Be]===void 0&&(et[Be]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,Ne=!0),et[Be].usedTimes++;const It=et[re.__cacheKey];It!==void 0&&(et[re.__cacheKey].usedTimes--,It.usedTimes===0&&L(W)),re.__cacheKey=Be,re.__webglTexture=et[Be].texture}return Ne}function Me(re,W,Ne){let He=n.TEXTURE_2D;(W.isDataArrayTexture||W.isCompressedArrayTexture)&&(He=n.TEXTURE_2D_ARRAY),W.isData3DTexture&&(He=n.TEXTURE_3D);const et=Ke(re,W),Be=W.source;t.bindTexture(He,re.__webglTexture,n.TEXTURE0+Ne);const It=i.get(Be);if(Be.version!==It.__version||et===!0){t.activeTexture(n.TEXTURE0+Ne);const ut=ni.getPrimaries(ni.workingColorSpace),Dt=W.colorSpace===Ah?null:ni.getPrimaries(W.colorSpace),_n=W.colorSpace===Ah||ut===Dt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,W.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,W.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,_n);let ke=S(W.image,!1,r.maxTextureSize);ke=Yt(W,ke);const Lt=s.convert(W.format,W.colorSpace),Zt=s.convert(W.type);let tn=R(W.internalFormat,Lt,Zt,W.colorSpace,W.isVideoTexture);Oe(He,W);let kt;const Mn=W.mipmaps,pn=W.isVideoTexture!==!0,hi=It.__version===void 0||et===!0,ve=Be.dataReady,ft=B(W,ke);if(W.isDepthTexture)tn=N(W.format===v0,W.type),hi&&(pn?t.texStorage2D(n.TEXTURE_2D,1,tn,ke.width,ke.height):t.texImage2D(n.TEXTURE_2D,0,tn,ke.width,ke.height,0,Lt,Zt,null));else if(W.isDataTexture)if(Mn.length>0){pn&&hi&&t.texStorage2D(n.TEXTURE_2D,ft,tn,Mn[0].width,Mn[0].height);for(let Fe=0,Ve=Mn.length;Fe<Ve;Fe++)kt=Mn[Fe],pn?ve&&t.texSubImage2D(n.TEXTURE_2D,Fe,0,0,kt.width,kt.height,Lt,Zt,kt.data):t.texImage2D(n.TEXTURE_2D,Fe,tn,kt.width,kt.height,0,Lt,Zt,kt.data);W.generateMipmaps=!1}else pn?(hi&&t.texStorage2D(n.TEXTURE_2D,ft,tn,ke.width,ke.height),ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ke.width,ke.height,Lt,Zt,ke.data)):t.texImage2D(n.TEXTURE_2D,0,tn,ke.width,ke.height,0,Lt,Zt,ke.data);else if(W.isCompressedTexture)if(W.isCompressedArrayTexture){pn&&hi&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ft,tn,Mn[0].width,Mn[0].height,ke.depth);for(let Fe=0,Ve=Mn.length;Fe<Ve;Fe++)if(kt=Mn[Fe],W.format!==dl)if(Lt!==null)if(pn){if(ve)if(W.layerUpdates.size>0){const Te=Rk(kt.width,kt.height,W.format,W.type);for(const Ye of W.layerUpdates){const an=kt.data.subarray(Ye*Te/kt.data.BYTES_PER_ELEMENT,(Ye+1)*Te/kt.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Fe,0,0,Ye,kt.width,kt.height,1,Lt,an)}W.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Fe,0,0,0,kt.width,kt.height,ke.depth,Lt,kt.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Fe,tn,kt.width,kt.height,ke.depth,0,kt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else pn?ve&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Fe,0,0,0,kt.width,kt.height,ke.depth,Lt,Zt,kt.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Fe,tn,kt.width,kt.height,ke.depth,0,Lt,Zt,kt.data)}else{pn&&hi&&t.texStorage2D(n.TEXTURE_2D,ft,tn,Mn[0].width,Mn[0].height);for(let Fe=0,Ve=Mn.length;Fe<Ve;Fe++)kt=Mn[Fe],W.format!==dl?Lt!==null?pn?ve&&t.compressedTexSubImage2D(n.TEXTURE_2D,Fe,0,0,kt.width,kt.height,Lt,kt.data):t.compressedTexImage2D(n.TEXTURE_2D,Fe,tn,kt.width,kt.height,0,kt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pn?ve&&t.texSubImage2D(n.TEXTURE_2D,Fe,0,0,kt.width,kt.height,Lt,Zt,kt.data):t.texImage2D(n.TEXTURE_2D,Fe,tn,kt.width,kt.height,0,Lt,Zt,kt.data)}else if(W.isDataArrayTexture)if(pn){if(hi&&t.texStorage3D(n.TEXTURE_2D_ARRAY,ft,tn,ke.width,ke.height,ke.depth),ve)if(W.layerUpdates.size>0){const Fe=Rk(ke.width,ke.height,W.format,W.type);for(const Ve of W.layerUpdates){const Te=ke.data.subarray(Ve*Fe/ke.data.BYTES_PER_ELEMENT,(Ve+1)*Fe/ke.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Ve,ke.width,ke.height,1,Lt,Zt,Te)}W.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ke.width,ke.height,ke.depth,Lt,Zt,ke.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,tn,ke.width,ke.height,ke.depth,0,Lt,Zt,ke.data);else if(W.isData3DTexture)pn?(hi&&t.texStorage3D(n.TEXTURE_3D,ft,tn,ke.width,ke.height,ke.depth),ve&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ke.width,ke.height,ke.depth,Lt,Zt,ke.data)):t.texImage3D(n.TEXTURE_3D,0,tn,ke.width,ke.height,ke.depth,0,Lt,Zt,ke.data);else if(W.isFramebufferTexture){if(hi)if(pn)t.texStorage2D(n.TEXTURE_2D,ft,tn,ke.width,ke.height);else{let Fe=ke.width,Ve=ke.height;for(let Te=0;Te<ft;Te++)t.texImage2D(n.TEXTURE_2D,Te,tn,Fe,Ve,0,Lt,Zt,null),Fe>>=1,Ve>>=1}}else if(Mn.length>0){if(pn&&hi){const Fe=Nt(Mn[0]);t.texStorage2D(n.TEXTURE_2D,ft,tn,Fe.width,Fe.height)}for(let Fe=0,Ve=Mn.length;Fe<Ve;Fe++)kt=Mn[Fe],pn?ve&&t.texSubImage2D(n.TEXTURE_2D,Fe,0,0,Lt,Zt,kt):t.texImage2D(n.TEXTURE_2D,Fe,tn,Lt,Zt,kt);W.generateMipmaps=!1}else if(pn){if(hi){const Fe=Nt(ke);t.texStorage2D(n.TEXTURE_2D,ft,tn,Fe.width,Fe.height)}ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Lt,Zt,ke)}else t.texImage2D(n.TEXTURE_2D,0,tn,Lt,Zt,ke);w(W)&&x(He),It.__version=Be.version,W.onUpdate&&W.onUpdate(W)}re.__version=W.version}function ze(re,W,Ne){if(W.image.length!==6)return;const He=Ke(re,W),et=W.source;t.bindTexture(n.TEXTURE_CUBE_MAP,re.__webglTexture,n.TEXTURE0+Ne);const Be=i.get(et);if(et.version!==Be.__version||He===!0){t.activeTexture(n.TEXTURE0+Ne);const It=ni.getPrimaries(ni.workingColorSpace),ut=W.colorSpace===Ah?null:ni.getPrimaries(W.colorSpace),Dt=W.colorSpace===Ah||It===ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,W.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,W.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Dt);const _n=W.isCompressedTexture||W.image[0].isCompressedTexture,ke=W.image[0]&&W.image[0].isDataTexture,Lt=[];for(let Ve=0;Ve<6;Ve++)!_n&&!ke?Lt[Ve]=S(W.image[Ve],!0,r.maxCubemapSize):Lt[Ve]=ke?W.image[Ve].image:W.image[Ve],Lt[Ve]=Yt(W,Lt[Ve]);const Zt=Lt[0],tn=s.convert(W.format,W.colorSpace),kt=s.convert(W.type),Mn=R(W.internalFormat,tn,kt,W.colorSpace),pn=W.isVideoTexture!==!0,hi=Be.__version===void 0||He===!0,ve=et.dataReady;let ft=B(W,Zt);Oe(n.TEXTURE_CUBE_MAP,W);let Fe;if(_n){pn&&hi&&t.texStorage2D(n.TEXTURE_CUBE_MAP,ft,Mn,Zt.width,Zt.height);for(let Ve=0;Ve<6;Ve++){Fe=Lt[Ve].mipmaps;for(let Te=0;Te<Fe.length;Te++){const Ye=Fe[Te];W.format!==dl?tn!==null?pn?ve&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te,0,0,Ye.width,Ye.height,tn,Ye.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te,Mn,Ye.width,Ye.height,0,Ye.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pn?ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te,0,0,Ye.width,Ye.height,tn,kt,Ye.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te,Mn,Ye.width,Ye.height,0,tn,kt,Ye.data)}}}else{if(Fe=W.mipmaps,pn&&hi){Fe.length>0&&ft++;const Ve=Nt(Lt[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,ft,Mn,Ve.width,Ve.height)}for(let Ve=0;Ve<6;Ve++)if(ke){pn?ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,0,0,Lt[Ve].width,Lt[Ve].height,tn,kt,Lt[Ve].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,Mn,Lt[Ve].width,Lt[Ve].height,0,tn,kt,Lt[Ve].data);for(let Te=0;Te<Fe.length;Te++){const an=Fe[Te].image[Ve].image;pn?ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te+1,0,0,an.width,an.height,tn,kt,an.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te+1,Mn,an.width,an.height,0,tn,kt,an.data)}}else{pn?ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,0,0,tn,kt,Lt[Ve]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,0,Mn,tn,kt,Lt[Ve]);for(let Te=0;Te<Fe.length;Te++){const Ye=Fe[Te];pn?ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te+1,0,0,tn,kt,Ye.image[Ve]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ve,Te+1,Mn,tn,kt,Ye.image[Ve])}}}w(W)&&x(n.TEXTURE_CUBE_MAP),Be.__version=et.version,W.onUpdate&&W.onUpdate(W)}re.__version=W.version}function nt(re,W,Ne,He,et,Be){const It=s.convert(Ne.format,Ne.colorSpace),ut=s.convert(Ne.type),Dt=R(Ne.internalFormat,It,ut,Ne.colorSpace),_n=i.get(W),ke=i.get(Ne);if(ke.__renderTarget=W,!_n.__hasExternalTextures){const Lt=Math.max(1,W.width>>Be),Zt=Math.max(1,W.height>>Be);et===n.TEXTURE_3D||et===n.TEXTURE_2D_ARRAY?t.texImage3D(et,Be,Dt,Lt,Zt,W.depth,0,It,ut,null):t.texImage2D(et,Be,Dt,Lt,Zt,0,It,ut,null)}t.bindFramebuffer(n.FRAMEBUFFER,re),xt(W)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,He,et,ke.__webglTexture,0,st(W)):(et===n.TEXTURE_2D||et>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&et<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,He,et,ke.__webglTexture,Be),t.bindFramebuffer(n.FRAMEBUFFER,null)}function tt(re,W,Ne){if(n.bindRenderbuffer(n.RENDERBUFFER,re),W.depthBuffer){const He=W.depthTexture,et=He&&He.isDepthTexture?He.type:null,Be=N(W.stencilBuffer,et),It=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ut=st(W);xt(W)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ut,Be,W.width,W.height):Ne?n.renderbufferStorageMultisample(n.RENDERBUFFER,ut,Be,W.width,W.height):n.renderbufferStorage(n.RENDERBUFFER,Be,W.width,W.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,It,n.RENDERBUFFER,re)}else{const He=W.textures;for(let et=0;et<He.length;et++){const Be=He[et],It=s.convert(Be.format,Be.colorSpace),ut=s.convert(Be.type),Dt=R(Be.internalFormat,It,ut,Be.colorSpace),_n=st(W);Ne&&xt(W)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,_n,Dt,W.width,W.height):xt(W)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,_n,Dt,W.width,W.height):n.renderbufferStorage(n.RENDERBUFFER,Dt,W.width,W.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Ot(re,W){if(W&&W.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,re),!(W.depthTexture&&W.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const He=i.get(W.depthTexture);He.__renderTarget=W,(!He.__webglTexture||W.depthTexture.image.width!==W.width||W.depthTexture.image.height!==W.height)&&(W.depthTexture.image.width=W.width,W.depthTexture.image.height=W.height,W.depthTexture.needsUpdate=!0),$(W.depthTexture,0);const et=He.__webglTexture,Be=st(W);if(W.depthTexture.format===qA)xt(W)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,et,0,Be):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,et,0);else if(W.depthTexture.format===v0)xt(W)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,et,0,Be):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,et,0);else throw new Error("Unknown depthTexture format")}function Ht(re){const W=i.get(re),Ne=re.isWebGLCubeRenderTarget===!0;if(W.__boundDepthTexture!==re.depthTexture){const He=re.depthTexture;if(W.__depthDisposeCallback&&W.__depthDisposeCallback(),He){const et=()=>{delete W.__boundDepthTexture,delete W.__depthDisposeCallback,He.removeEventListener("dispose",et)};He.addEventListener("dispose",et),W.__depthDisposeCallback=et}W.__boundDepthTexture=He}if(re.depthTexture&&!W.__autoAllocateDepthBuffer){if(Ne)throw new Error("target.depthTexture not supported in Cube render targets");Ot(W.__webglFramebuffer,re)}else if(Ne){W.__webglDepthbuffer=[];for(let He=0;He<6;He++)if(t.bindFramebuffer(n.FRAMEBUFFER,W.__webglFramebuffer[He]),W.__webglDepthbuffer[He]===void 0)W.__webglDepthbuffer[He]=n.createRenderbuffer(),tt(W.__webglDepthbuffer[He],re,!1);else{const et=re.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Be=W.__webglDepthbuffer[He];n.bindRenderbuffer(n.RENDERBUFFER,Be),n.framebufferRenderbuffer(n.FRAMEBUFFER,et,n.RENDERBUFFER,Be)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,W.__webglFramebuffer),W.__webglDepthbuffer===void 0)W.__webglDepthbuffer=n.createRenderbuffer(),tt(W.__webglDepthbuffer,re,!1);else{const He=re.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,et=W.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,et),n.framebufferRenderbuffer(n.FRAMEBUFFER,He,n.RENDERBUFFER,et)}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ct(re,W,Ne){const He=i.get(re);W!==void 0&&nt(He.__webglFramebuffer,re,re.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Ne!==void 0&&Ht(re)}function en(re){const W=re.texture,Ne=i.get(re),He=i.get(W);re.addEventListener("dispose",D);const et=re.textures,Be=re.isWebGLCubeRenderTarget===!0,It=et.length>1;if(It||(He.__webglTexture===void 0&&(He.__webglTexture=n.createTexture()),He.__version=W.version,o.memory.textures++),Be){Ne.__webglFramebuffer=[];for(let ut=0;ut<6;ut++)if(W.mipmaps&&W.mipmaps.length>0){Ne.__webglFramebuffer[ut]=[];for(let Dt=0;Dt<W.mipmaps.length;Dt++)Ne.__webglFramebuffer[ut][Dt]=n.createFramebuffer()}else Ne.__webglFramebuffer[ut]=n.createFramebuffer()}else{if(W.mipmaps&&W.mipmaps.length>0){Ne.__webglFramebuffer=[];for(let ut=0;ut<W.mipmaps.length;ut++)Ne.__webglFramebuffer[ut]=n.createFramebuffer()}else Ne.__webglFramebuffer=n.createFramebuffer();if(It)for(let ut=0,Dt=et.length;ut<Dt;ut++){const _n=i.get(et[ut]);_n.__webglTexture===void 0&&(_n.__webglTexture=n.createTexture(),o.memory.textures++)}if(re.samples>0&&xt(re)===!1){Ne.__webglMultisampledFramebuffer=n.createFramebuffer(),Ne.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Ne.__webglMultisampledFramebuffer);for(let ut=0;ut<et.length;ut++){const Dt=et[ut];Ne.__webglColorRenderbuffer[ut]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Ne.__webglColorRenderbuffer[ut]);const _n=s.convert(Dt.format,Dt.colorSpace),ke=s.convert(Dt.type),Lt=R(Dt.internalFormat,_n,ke,Dt.colorSpace,re.isXRRenderTarget===!0),Zt=st(re);n.renderbufferStorageMultisample(n.RENDERBUFFER,Zt,Lt,re.width,re.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ut,n.RENDERBUFFER,Ne.__webglColorRenderbuffer[ut])}n.bindRenderbuffer(n.RENDERBUFFER,null),re.depthBuffer&&(Ne.__webglDepthRenderbuffer=n.createRenderbuffer(),tt(Ne.__webglDepthRenderbuffer,re,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(Be){t.bindTexture(n.TEXTURE_CUBE_MAP,He.__webglTexture),Oe(n.TEXTURE_CUBE_MAP,W);for(let ut=0;ut<6;ut++)if(W.mipmaps&&W.mipmaps.length>0)for(let Dt=0;Dt<W.mipmaps.length;Dt++)nt(Ne.__webglFramebuffer[ut][Dt],re,W,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,Dt);else nt(Ne.__webglFramebuffer[ut],re,W,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ut,0);w(W)&&x(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(It){for(let ut=0,Dt=et.length;ut<Dt;ut++){const _n=et[ut],ke=i.get(_n);t.bindTexture(n.TEXTURE_2D,ke.__webglTexture),Oe(n.TEXTURE_2D,_n),nt(Ne.__webglFramebuffer,re,_n,n.COLOR_ATTACHMENT0+ut,n.TEXTURE_2D,0),w(_n)&&x(n.TEXTURE_2D)}t.unbindTexture()}else{let ut=n.TEXTURE_2D;if((re.isWebGL3DRenderTarget||re.isWebGLArrayRenderTarget)&&(ut=re.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(ut,He.__webglTexture),Oe(ut,W),W.mipmaps&&W.mipmaps.length>0)for(let Dt=0;Dt<W.mipmaps.length;Dt++)nt(Ne.__webglFramebuffer[Dt],re,W,n.COLOR_ATTACHMENT0,ut,Dt);else nt(Ne.__webglFramebuffer,re,W,n.COLOR_ATTACHMENT0,ut,0);w(W)&&x(ut),t.unbindTexture()}re.depthBuffer&&Ht(re)}function Ze(re){const W=re.textures;for(let Ne=0,He=W.length;Ne<He;Ne++){const et=W[Ne];if(w(et)){const Be=M(re),It=i.get(et).__webglTexture;t.bindTexture(Be,It),x(Be),t.unbindTexture()}}}const at=[],ue=[];function zt(re){if(re.samples>0){if(xt(re)===!1){const W=re.textures,Ne=re.width,He=re.height;let et=n.COLOR_BUFFER_BIT;const Be=re.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,It=i.get(re),ut=W.length>1;if(ut)for(let Dt=0;Dt<W.length;Dt++)t.bindFramebuffer(n.FRAMEBUFFER,It.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Dt,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,It.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Dt,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,It.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,It.__webglFramebuffer);for(let Dt=0;Dt<W.length;Dt++){if(re.resolveDepthBuffer&&(re.depthBuffer&&(et|=n.DEPTH_BUFFER_BIT),re.stencilBuffer&&re.resolveStencilBuffer&&(et|=n.STENCIL_BUFFER_BIT)),ut){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,It.__webglColorRenderbuffer[Dt]);const _n=i.get(W[Dt]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,_n,0)}n.blitFramebuffer(0,0,Ne,He,0,0,Ne,He,et,n.NEAREST),l===!0&&(at.length=0,ue.length=0,at.push(n.COLOR_ATTACHMENT0+Dt),re.depthBuffer&&re.resolveDepthBuffer===!1&&(at.push(Be),ue.push(Be),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,ue)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,at))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ut)for(let Dt=0;Dt<W.length;Dt++){t.bindFramebuffer(n.FRAMEBUFFER,It.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Dt,n.RENDERBUFFER,It.__webglColorRenderbuffer[Dt]);const _n=i.get(W[Dt]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,It.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Dt,n.TEXTURE_2D,_n,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,It.__webglMultisampledFramebuffer)}else if(re.depthBuffer&&re.resolveDepthBuffer===!1&&l){const W=re.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[W])}}}function st(re){return Math.min(r.maxSamples,re.samples)}function xt(re){const W=i.get(re);return re.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&W.__useRenderToTexture!==!1}function ht(re){const W=o.render.frame;c.get(re)!==W&&(c.set(re,W),re.update())}function Yt(re,W){const Ne=re.colorSpace,He=re.format,et=re.type;return re.isCompressedTexture===!0||re.isVideoTexture===!0||Ne!==X0&&Ne!==Ah&&(ni.getTransfer(Ne)===wi?(He!==dl||et!==hc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ne)),W}function Nt(re){return typeof HTMLImageElement<"u"&&re instanceof HTMLImageElement?(u.width=re.naturalWidth||re.width,u.height=re.naturalHeight||re.height):typeof VideoFrame<"u"&&re instanceof VideoFrame?(u.width=re.displayWidth,u.height=re.displayHeight):(u.width=re.width,u.height=re.height),u}this.allocateTextureUnit=j,this.resetTextureUnits=Q,this.setTexture2D=$,this.setTexture2DArray=Z,this.setTexture3D=ce,this.setTextureCube=ie,this.rebindTextures=Ct,this.setupRenderTarget=en,this.updateRenderTargetMipmap=Ze,this.updateMultisampleRenderTarget=zt,this.setupDepthRenderbuffer=Ht,this.setupFrameBufferTexture=nt,this.useMultisampledRTT=xt}function Vle(n,e){function t(i,r=Ah){let s;const o=ni.getTransfer(r);if(i===hc)return n.UNSIGNED_BYTE;if(i===UP)return n.UNSIGNED_SHORT_4_4_4_4;if(i===zP)return n.UNSIGNED_SHORT_5_5_5_1;if(i===vV)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===mV)return n.BYTE;if(i===gV)return n.SHORT;if(i===S1)return n.UNSIGNED_SHORT;if(i===OP)return n.INT;if(i===Nd)return n.UNSIGNED_INT;if(i===Vu)return n.FLOAT;if(i===W0)return n.HALF_FLOAT;if(i===yV)return n.ALPHA;if(i===_V)return n.RGB;if(i===dl)return n.RGBA;if(i===xV)return n.LUMINANCE;if(i===bV)return n.LUMINANCE_ALPHA;if(i===qA)return n.DEPTH_COMPONENT;if(i===v0)return n.DEPTH_STENCIL;if(i===SV)return n.RED;if(i===VP)return n.RED_INTEGER;if(i===wV)return n.RG;if(i===GP)return n.RG_INTEGER;if(i===qP)return n.RGBA_INTEGER;if(i===P2||i===N2||i===I2||i===D2)if(o===wi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===P2)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===N2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===I2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===D2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===P2)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===N2)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===I2)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===D2)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===NM||i===IM||i===DM||i===kM)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===NM)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===IM)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===DM)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===kM)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===LM||i===FM||i===BM)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===LM||i===FM)return o===wi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===BM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===OM||i===UM||i===zM||i===VM||i===GM||i===qM||i===HM||i===$M||i===jM||i===WM||i===XM||i===YM||i===QM||i===KM)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===OM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===UM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===zM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===VM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===GM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===qM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===HM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===$M)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===jM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===WM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===XM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===YM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===QM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===KM)return o===wi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===k2||i===ZM||i===JM)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===k2)return o===wi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===ZM)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===JM)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===EV||i===e4||i===t4||i===n4)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===k2)return s.COMPRESSED_RED_RGTC1_EXT;if(i===e4)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===t4)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===n4)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===g0?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}class Gle extends Ta{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let Ia=class extends Fs{constructor(){super(),this.isGroup=!0,this.type="Group"}};const qle={type:"move"};class p3{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ia,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ia,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new le,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new le),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ia,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new le,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new le),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const S of e.hand.values()){const w=t.getJointPose(S,i),x=this._getHandJoint(u,S);w!==null&&(x.matrix.fromArray(w.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),x.matrixWorldNeedsUpdate=!0,x.jointRadius=w.radius),x.visible=w!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],A=c.position.distanceTo(h.position),v=.02,_=.005;u.inputState.pinching&&A>v+_?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&A<=v-_&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(qle)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Ia;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}const Hle=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,$le=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class jle{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const r=new Il,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new ko({vertexShader:Hle,fragmentShader:$le,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new rr(new QS(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Wle extends ff{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,c=null,h=null,A=null,v=null,_=null;const S=new jle,w=t.getContextAttributes();let x=null,M=null;const R=[],N=[],B=new rt;let T=null;const D=new Ta;D.viewport=new Ui;const F=new Ta;F.viewport=new Ui;const L=[D,F],O=new Gle;let z=null,Q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Me){let ze=R[Me];return ze===void 0&&(ze=new p3,R[Me]=ze),ze.getTargetRaySpace()},this.getControllerGrip=function(Me){let ze=R[Me];return ze===void 0&&(ze=new p3,R[Me]=ze),ze.getGripSpace()},this.getHand=function(Me){let ze=R[Me];return ze===void 0&&(ze=new p3,R[Me]=ze),ze.getHandSpace()};function j(Me){const ze=N.indexOf(Me.inputSource);if(ze===-1)return;const nt=R[ze];nt!==void 0&&(nt.update(Me.inputSource,Me.frame,u||o),nt.dispatchEvent({type:Me.type,data:Me.inputSource}))}function ee(){r.removeEventListener("select",j),r.removeEventListener("selectstart",j),r.removeEventListener("selectend",j),r.removeEventListener("squeeze",j),r.removeEventListener("squeezestart",j),r.removeEventListener("squeezeend",j),r.removeEventListener("end",ee),r.removeEventListener("inputsourceschange",$);for(let Me=0;Me<R.length;Me++){const ze=N[Me];ze!==null&&(N[Me]=null,R[Me].disconnect(ze))}z=null,Q=null,S.reset(),e.setRenderTarget(x),v=null,A=null,h=null,r=null,M=null,Ke.stop(),i.isPresenting=!1,e.setPixelRatio(T),e.setSize(B.width,B.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Me){s=Me,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Me){a=Me,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(Me){u=Me},this.getBaseLayer=function(){return A!==null?A:v},this.getBinding=function(){return h},this.getFrame=function(){return _},this.getSession=function(){return r},this.setSession=async function(Me){if(r=Me,r!==null){if(x=e.getRenderTarget(),r.addEventListener("select",j),r.addEventListener("selectstart",j),r.addEventListener("selectend",j),r.addEventListener("squeeze",j),r.addEventListener("squeezestart",j),r.addEventListener("squeezeend",j),r.addEventListener("end",ee),r.addEventListener("inputsourceschange",$),w.xrCompatible!==!0&&await t.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(B),r.renderState.layers===void 0){const ze={antialias:w.antialias,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,ze),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),M=new Kh(v.framebufferWidth,v.framebufferHeight,{format:dl,type:hc,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil})}else{let ze=null,nt=null,tt=null;w.depth&&(tt=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ze=w.stencil?v0:qA,nt=w.stencil?g0:Nd);const Ot={colorFormat:t.RGBA8,depthFormat:tt,scaleFactor:s};h=new XRWebGLBinding(r,t),A=h.createProjectionLayer(Ot),r.updateRenderState({layers:[A]}),e.setPixelRatio(1),e.setSize(A.textureWidth,A.textureHeight,!1),M=new Kh(A.textureWidth,A.textureHeight,{format:dl,type:hc,depthTexture:new HV(A.textureWidth,A.textureHeight,nt,void 0,void 0,void 0,void 0,void 0,void 0,ze),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0,resolveDepthBuffer:A.ignoreDepthValues===!1})}M.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),Ke.setContext(r),Ke.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return S.getDepthTexture()};function $(Me){for(let ze=0;ze<Me.removed.length;ze++){const nt=Me.removed[ze],tt=N.indexOf(nt);tt>=0&&(N[tt]=null,R[tt].disconnect(nt))}for(let ze=0;ze<Me.added.length;ze++){const nt=Me.added[ze];let tt=N.indexOf(nt);if(tt===-1){for(let Ht=0;Ht<R.length;Ht++)if(Ht>=N.length){N.push(nt),tt=Ht;break}else if(N[Ht]===null){N[Ht]=nt,tt=Ht;break}if(tt===-1)break}const Ot=R[tt];Ot&&Ot.connect(nt)}}const Z=new le,ce=new le;function ie(Me,ze,nt){Z.setFromMatrixPosition(ze.matrixWorld),ce.setFromMatrixPosition(nt.matrixWorld);const tt=Z.distanceTo(ce),Ot=ze.projectionMatrix.elements,Ht=nt.projectionMatrix.elements,Ct=Ot[14]/(Ot[10]-1),en=Ot[14]/(Ot[10]+1),Ze=(Ot[9]+1)/Ot[5],at=(Ot[9]-1)/Ot[5],ue=(Ot[8]-1)/Ot[0],zt=(Ht[8]+1)/Ht[0],st=Ct*ue,xt=Ct*zt,ht=tt/(-ue+zt),Yt=ht*-ue;if(ze.matrixWorld.decompose(Me.position,Me.quaternion,Me.scale),Me.translateX(Yt),Me.translateZ(ht),Me.matrixWorld.compose(Me.position,Me.quaternion,Me.scale),Me.matrixWorldInverse.copy(Me.matrixWorld).invert(),Ot[10]===-1)Me.projectionMatrix.copy(ze.projectionMatrix),Me.projectionMatrixInverse.copy(ze.projectionMatrixInverse);else{const Nt=Ct+ht,re=en+ht,W=st-Yt,Ne=xt+(tt-Yt),He=Ze*en/re*Nt,et=at*en/re*Nt;Me.projectionMatrix.makePerspective(W,Ne,He,et,Nt,re),Me.projectionMatrixInverse.copy(Me.projectionMatrix).invert()}}function oe(Me,ze){ze===null?Me.matrixWorld.copy(Me.matrix):Me.matrixWorld.multiplyMatrices(ze.matrixWorld,Me.matrix),Me.matrixWorldInverse.copy(Me.matrixWorld).invert()}this.updateCamera=function(Me){if(r===null)return;let ze=Me.near,nt=Me.far;S.texture!==null&&(S.depthNear>0&&(ze=S.depthNear),S.depthFar>0&&(nt=S.depthFar)),O.near=F.near=D.near=ze,O.far=F.far=D.far=nt,(z!==O.near||Q!==O.far)&&(r.updateRenderState({depthNear:O.near,depthFar:O.far}),z=O.near,Q=O.far),D.layers.mask=Me.layers.mask|2,F.layers.mask=Me.layers.mask|4,O.layers.mask=D.layers.mask|F.layers.mask;const tt=Me.parent,Ot=O.cameras;oe(O,tt);for(let Ht=0;Ht<Ot.length;Ht++)oe(Ot[Ht],tt);Ot.length===2?ie(O,D,F):O.projectionMatrix.copy(D.projectionMatrix),me(Me,O,tt)};function me(Me,ze,nt){nt===null?Me.matrix.copy(ze.matrixWorld):(Me.matrix.copy(nt.matrixWorld),Me.matrix.invert(),Me.matrix.multiply(ze.matrixWorld)),Me.matrix.decompose(Me.position,Me.quaternion,Me.scale),Me.updateMatrixWorld(!0),Me.projectionMatrix.copy(ze.projectionMatrix),Me.projectionMatrixInverse.copy(ze.projectionMatrixInverse),Me.isPerspectiveCamera&&(Me.fov=w1*2*Math.atan(1/Me.projectionMatrix.elements[5]),Me.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(A===null&&v===null))return l},this.setFoveation=function(Me){l=Me,A!==null&&(A.fixedFoveation=Me),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=Me)},this.hasDepthSensing=function(){return S.texture!==null},this.getDepthSensingMesh=function(){return S.getMesh(O)};let _e=null;function Oe(Me,ze){if(c=ze.getViewerPose(u||o),_=ze,c!==null){const nt=c.views;v!==null&&(e.setRenderTargetFramebuffer(M,v.framebuffer),e.setRenderTarget(M));let tt=!1;nt.length!==O.cameras.length&&(O.cameras.length=0,tt=!0);for(let Ht=0;Ht<nt.length;Ht++){const Ct=nt[Ht];let en=null;if(v!==null)en=v.getViewport(Ct);else{const at=h.getViewSubImage(A,Ct);en=at.viewport,Ht===0&&(e.setRenderTargetTextures(M,at.colorTexture,A.ignoreDepthValues?void 0:at.depthStencilTexture),e.setRenderTarget(M))}let Ze=L[Ht];Ze===void 0&&(Ze=new Ta,Ze.layers.enable(Ht),Ze.viewport=new Ui,L[Ht]=Ze),Ze.matrix.fromArray(Ct.transform.matrix),Ze.matrix.decompose(Ze.position,Ze.quaternion,Ze.scale),Ze.projectionMatrix.fromArray(Ct.projectionMatrix),Ze.projectionMatrixInverse.copy(Ze.projectionMatrix).invert(),Ze.viewport.set(en.x,en.y,en.width,en.height),Ht===0&&(O.matrix.copy(Ze.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),tt===!0&&O.cameras.push(Ze)}const Ot=r.enabledFeatures;if(Ot&&Ot.includes("depth-sensing")){const Ht=h.getDepthInformation(nt[0]);Ht&&Ht.isValid&&Ht.texture&&S.init(e,Ht,r.renderState)}}for(let nt=0;nt<R.length;nt++){const tt=N[nt],Ot=R[nt];tt!==null&&Ot!==void 0&&Ot.update(tt,ze,u||o)}_e&&_e(Me,ze),ze.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ze}),_=null}const Ke=new qV;Ke.setAnimationLoop(Oe),this.setAnimationLoop=function(Me){_e=Me},this.dispose=function(){}}}const Df=new la,Xle=new ki;function Yle(n,e){function t(w,x){w.matrixAutoUpdate===!0&&w.updateMatrix(),x.value.copy(w.matrix)}function i(w,x){x.color.getRGB(w.fogColor.value,zV(n)),x.isFog?(w.fogNear.value=x.near,w.fogFar.value=x.far):x.isFogExp2&&(w.fogDensity.value=x.density)}function r(w,x,M,R,N){x.isMeshBasicMaterial||x.isMeshLambertMaterial?s(w,x):x.isMeshToonMaterial?(s(w,x),h(w,x)):x.isMeshPhongMaterial?(s(w,x),c(w,x)):x.isMeshStandardMaterial?(s(w,x),A(w,x),x.isMeshPhysicalMaterial&&v(w,x,N)):x.isMeshMatcapMaterial?(s(w,x),_(w,x)):x.isMeshDepthMaterial?s(w,x):x.isMeshDistanceMaterial?(s(w,x),S(w,x)):x.isMeshNormalMaterial?s(w,x):x.isLineBasicMaterial?(o(w,x),x.isLineDashedMaterial&&a(w,x)):x.isPointsMaterial?l(w,x,M,R):x.isSpriteMaterial?u(w,x):x.isShadowMaterial?(w.color.value.copy(x.color),w.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function s(w,x){w.opacity.value=x.opacity,x.color&&w.diffuse.value.copy(x.color),x.emissive&&w.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(w.map.value=x.map,t(x.map,w.mapTransform)),x.alphaMap&&(w.alphaMap.value=x.alphaMap,t(x.alphaMap,w.alphaMapTransform)),x.bumpMap&&(w.bumpMap.value=x.bumpMap,t(x.bumpMap,w.bumpMapTransform),w.bumpScale.value=x.bumpScale,x.side===Ds&&(w.bumpScale.value*=-1)),x.normalMap&&(w.normalMap.value=x.normalMap,t(x.normalMap,w.normalMapTransform),w.normalScale.value.copy(x.normalScale),x.side===Ds&&w.normalScale.value.negate()),x.displacementMap&&(w.displacementMap.value=x.displacementMap,t(x.displacementMap,w.displacementMapTransform),w.displacementScale.value=x.displacementScale,w.displacementBias.value=x.displacementBias),x.emissiveMap&&(w.emissiveMap.value=x.emissiveMap,t(x.emissiveMap,w.emissiveMapTransform)),x.specularMap&&(w.specularMap.value=x.specularMap,t(x.specularMap,w.specularMapTransform)),x.alphaTest>0&&(w.alphaTest.value=x.alphaTest);const M=e.get(x),R=M.envMap,N=M.envMapRotation;R&&(w.envMap.value=R,Df.copy(N),Df.x*=-1,Df.y*=-1,Df.z*=-1,R.isCubeTexture&&R.isRenderTargetTexture===!1&&(Df.y*=-1,Df.z*=-1),w.envMapRotation.value.setFromMatrix4(Xle.makeRotationFromEuler(Df)),w.flipEnvMap.value=R.isCubeTexture&&R.isRenderTargetTexture===!1?-1:1,w.reflectivity.value=x.reflectivity,w.ior.value=x.ior,w.refractionRatio.value=x.refractionRatio),x.lightMap&&(w.lightMap.value=x.lightMap,w.lightMapIntensity.value=x.lightMapIntensity,t(x.lightMap,w.lightMapTransform)),x.aoMap&&(w.aoMap.value=x.aoMap,w.aoMapIntensity.value=x.aoMapIntensity,t(x.aoMap,w.aoMapTransform))}function o(w,x){w.diffuse.value.copy(x.color),w.opacity.value=x.opacity,x.map&&(w.map.value=x.map,t(x.map,w.mapTransform))}function a(w,x){w.dashSize.value=x.dashSize,w.totalSize.value=x.dashSize+x.gapSize,w.scale.value=x.scale}function l(w,x,M,R){w.diffuse.value.copy(x.color),w.opacity.value=x.opacity,w.size.value=x.size*M,w.scale.value=R*.5,x.map&&(w.map.value=x.map,t(x.map,w.uvTransform)),x.alphaMap&&(w.alphaMap.value=x.alphaMap,t(x.alphaMap,w.alphaMapTransform)),x.alphaTest>0&&(w.alphaTest.value=x.alphaTest)}function u(w,x){w.diffuse.value.copy(x.color),w.opacity.value=x.opacity,w.rotation.value=x.rotation,x.map&&(w.map.value=x.map,t(x.map,w.mapTransform)),x.alphaMap&&(w.alphaMap.value=x.alphaMap,t(x.alphaMap,w.alphaMapTransform)),x.alphaTest>0&&(w.alphaTest.value=x.alphaTest)}function c(w,x){w.specular.value.copy(x.specular),w.shininess.value=Math.max(x.shininess,1e-4)}function h(w,x){x.gradientMap&&(w.gradientMap.value=x.gradientMap)}function A(w,x){w.metalness.value=x.metalness,x.metalnessMap&&(w.metalnessMap.value=x.metalnessMap,t(x.metalnessMap,w.metalnessMapTransform)),w.roughness.value=x.roughness,x.roughnessMap&&(w.roughnessMap.value=x.roughnessMap,t(x.roughnessMap,w.roughnessMapTransform)),x.envMap&&(w.envMapIntensity.value=x.envMapIntensity)}function v(w,x,M){w.ior.value=x.ior,x.sheen>0&&(w.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),w.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(w.sheenColorMap.value=x.sheenColorMap,t(x.sheenColorMap,w.sheenColorMapTransform)),x.sheenRoughnessMap&&(w.sheenRoughnessMap.value=x.sheenRoughnessMap,t(x.sheenRoughnessMap,w.sheenRoughnessMapTransform))),x.clearcoat>0&&(w.clearcoat.value=x.clearcoat,w.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(w.clearcoatMap.value=x.clearcoatMap,t(x.clearcoatMap,w.clearcoatMapTransform)),x.clearcoatRoughnessMap&&(w.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap,t(x.clearcoatRoughnessMap,w.clearcoatRoughnessMapTransform)),x.clearcoatNormalMap&&(w.clearcoatNormalMap.value=x.clearcoatNormalMap,t(x.clearcoatNormalMap,w.clearcoatNormalMapTransform),w.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),x.side===Ds&&w.clearcoatNormalScale.value.negate())),x.dispersion>0&&(w.dispersion.value=x.dispersion),x.iridescence>0&&(w.iridescence.value=x.iridescence,w.iridescenceIOR.value=x.iridescenceIOR,w.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],w.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(w.iridescenceMap.value=x.iridescenceMap,t(x.iridescenceMap,w.iridescenceMapTransform)),x.iridescenceThicknessMap&&(w.iridescenceThicknessMap.value=x.iridescenceThicknessMap,t(x.iridescenceThicknessMap,w.iridescenceThicknessMapTransform))),x.transmission>0&&(w.transmission.value=x.transmission,w.transmissionSamplerMap.value=M.texture,w.transmissionSamplerSize.value.set(M.width,M.height),x.transmissionMap&&(w.transmissionMap.value=x.transmissionMap,t(x.transmissionMap,w.transmissionMapTransform)),w.thickness.value=x.thickness,x.thicknessMap&&(w.thicknessMap.value=x.thicknessMap,t(x.thicknessMap,w.thicknessMapTransform)),w.attenuationDistance.value=x.attenuationDistance,w.attenuationColor.value.copy(x.attenuationColor)),x.anisotropy>0&&(w.anisotropyVector.value.set(x.anisotropy*Math.cos(x.anisotropyRotation),x.anisotropy*Math.sin(x.anisotropyRotation)),x.anisotropyMap&&(w.anisotropyMap.value=x.anisotropyMap,t(x.anisotropyMap,w.anisotropyMapTransform))),w.specularIntensity.value=x.specularIntensity,w.specularColor.value.copy(x.specularColor),x.specularColorMap&&(w.specularColorMap.value=x.specularColorMap,t(x.specularColorMap,w.specularColorMapTransform)),x.specularIntensityMap&&(w.specularIntensityMap.value=x.specularIntensityMap,t(x.specularIntensityMap,w.specularIntensityMapTransform))}function _(w,x){x.matcap&&(w.matcap.value=x.matcap)}function S(w,x){const M=e.get(x).light;w.referencePosition.value.setFromMatrixPosition(M.matrixWorld),w.nearDistance.value=M.shadow.camera.near,w.farDistance.value=M.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Qle(n,e,t,i){let r={},s={},o=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(M,R){const N=R.program;i.uniformBlockBinding(M,N)}function u(M,R){let N=r[M.id];N===void 0&&(_(M),N=c(M),r[M.id]=N,M.addEventListener("dispose",w));const B=R.program;i.updateUBOMapping(M,B);const T=e.render.frame;s[M.id]!==T&&(A(M),s[M.id]=T)}function c(M){const R=h();M.__bindingPointIndex=R;const N=n.createBuffer(),B=M.__size,T=M.usage;return n.bindBuffer(n.UNIFORM_BUFFER,N),n.bufferData(n.UNIFORM_BUFFER,B,T),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,R,N),N}function h(){for(let M=0;M<a;M++)if(o.indexOf(M)===-1)return o.push(M),M;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function A(M){const R=r[M.id],N=M.uniforms,B=M.__cache;n.bindBuffer(n.UNIFORM_BUFFER,R);for(let T=0,D=N.length;T<D;T++){const F=Array.isArray(N[T])?N[T]:[N[T]];for(let L=0,O=F.length;L<O;L++){const z=F[L];if(v(z,T,L,B)===!0){const Q=z.__offset,j=Array.isArray(z.value)?z.value:[z.value];let ee=0;for(let $=0;$<j.length;$++){const Z=j[$],ce=S(Z);typeof Z=="number"||typeof Z=="boolean"?(z.__data[0]=Z,n.bufferSubData(n.UNIFORM_BUFFER,Q+ee,z.__data)):Z.isMatrix3?(z.__data[0]=Z.elements[0],z.__data[1]=Z.elements[1],z.__data[2]=Z.elements[2],z.__data[3]=0,z.__data[4]=Z.elements[3],z.__data[5]=Z.elements[4],z.__data[6]=Z.elements[5],z.__data[7]=0,z.__data[8]=Z.elements[6],z.__data[9]=Z.elements[7],z.__data[10]=Z.elements[8],z.__data[11]=0):(Z.toArray(z.__data,ee),ee+=ce.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Q,z.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(M,R,N,B){const T=M.value,D=R+"_"+N;if(B[D]===void 0)return typeof T=="number"||typeof T=="boolean"?B[D]=T:B[D]=T.clone(),!0;{const F=B[D];if(typeof T=="number"||typeof T=="boolean"){if(F!==T)return B[D]=T,!0}else if(F.equals(T)===!1)return F.copy(T),!0}return!1}function _(M){const R=M.uniforms;let N=0;const B=16;for(let D=0,F=R.length;D<F;D++){const L=Array.isArray(R[D])?R[D]:[R[D]];for(let O=0,z=L.length;O<z;O++){const Q=L[O],j=Array.isArray(Q.value)?Q.value:[Q.value];for(let ee=0,$=j.length;ee<$;ee++){const Z=j[ee],ce=S(Z),ie=N%B,oe=ie%ce.boundary,me=ie+oe;N+=oe,me!==0&&B-me<ce.storage&&(N+=B-me),Q.__data=new Float32Array(ce.storage/Float32Array.BYTES_PER_ELEMENT),Q.__offset=N,N+=ce.storage}}}const T=N%B;return T>0&&(N+=B-T),M.__size=N,M.__cache={},this}function S(M){const R={boundary:0,storage:0};return typeof M=="number"||typeof M=="boolean"?(R.boundary=4,R.storage=4):M.isVector2?(R.boundary=8,R.storage=8):M.isVector3||M.isColor?(R.boundary=16,R.storage=12):M.isVector4?(R.boundary=16,R.storage=16):M.isMatrix3?(R.boundary=48,R.storage=48):M.isMatrix4?(R.boundary=64,R.storage=64):M.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",M),R}function w(M){const R=M.target;R.removeEventListener("dispose",w);const N=o.indexOf(R.__bindingPointIndex);o.splice(N,1),n.deleteBuffer(r[R.id]),delete r[R.id],delete s[R.id]}function x(){for(const M in r)n.deleteBuffer(r[M]);o=[],r={},s={}}return{bind:l,update:u,dispose:x}}class Kle{constructor(e={}){const{canvas:t=zie(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:A=!1}=e;this.isWebGLRenderer=!0;let v;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=i.getContextAttributes().alpha}else v=o;const _=new Uint32Array(4),S=new Int32Array(4);let w=null,x=null;const M=[],R=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=vo,this.toneMapping=Bh,this.toneMappingExposure=1;const N=this;let B=!1,T=0,D=0,F=null,L=-1,O=null;const z=new Ui,Q=new Ui;let j=null;const ee=new fn(0);let $=0,Z=t.width,ce=t.height,ie=1,oe=null,me=null;const _e=new Ui(0,0,Z,ce),Oe=new Ui(0,0,Z,ce);let Ke=!1;const Me=new WP;let ze=!1,nt=!1;const tt=new ki,Ot=new ki,Ht=new le,Ct=new Ui,en={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Ze=!1;function at(){return F===null?ie:1}let ue=i;function zt(X,ye){return t.getContext(X,ye)}try{const X={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${GS}`),t.addEventListener("webglcontextlost",Ve,!1),t.addEventListener("webglcontextrestored",Te,!1),t.addEventListener("webglcontextcreationerror",Ye,!1),ue===null){const ye="webgl2";if(ue=zt(ye,X),ue===null)throw zt(ye)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(X){throw console.error("THREE.WebGLRenderer: "+X.message),X}let st,xt,ht,Yt,Nt,re,W,Ne,He,et,Be,It,ut,Dt,_n,ke,Lt,Zt,tn,kt,Mn,pn,hi,ve;function ft(){st=new nae(ue),st.init(),pn=new Vle(ue,st),xt=new Qoe(ue,st,e,pn),ht=new Ole(ue,st),xt.reverseDepthBuffer&&A&&ht.buffers.depth.setReversed(!0),Yt=new sae(ue),Nt=new Sle,re=new zle(ue,st,ht,Nt,xt,pn,Yt),W=new Zoe(N),Ne=new tae(N),He=new fre(ue),hi=new Xoe(ue,He),et=new iae(ue,He,Yt,hi),Be=new aae(ue,et,He,Yt),tn=new oae(ue,xt,re),ke=new Koe(Nt),It=new ble(N,W,Ne,st,xt,hi,ke),ut=new Yle(N,Nt),Dt=new Ele,_n=new Nle(st),Zt=new Woe(N,W,Ne,ht,Be,v,l),Lt=new Fle(N,Be,xt),ve=new Qle(ue,Yt,xt,ht),kt=new Yoe(ue,st,Yt),Mn=new rae(ue,st,Yt),Yt.programs=It.programs,N.capabilities=xt,N.extensions=st,N.properties=Nt,N.renderLists=Dt,N.shadowMap=Lt,N.state=ht,N.info=Yt}ft();const Fe=new Wle(N,ue);this.xr=Fe,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const X=st.get("WEBGL_lose_context");X&&X.loseContext()},this.forceContextRestore=function(){const X=st.get("WEBGL_lose_context");X&&X.restoreContext()},this.getPixelRatio=function(){return ie},this.setPixelRatio=function(X){X!==void 0&&(ie=X,this.setSize(Z,ce,!1))},this.getSize=function(X){return X.set(Z,ce)},this.setSize=function(X,ye,Ee=!0){if(Fe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Z=X,ce=ye,t.width=Math.floor(X*ie),t.height=Math.floor(ye*ie),Ee===!0&&(t.style.width=X+"px",t.style.height=ye+"px"),this.setViewport(0,0,X,ye)},this.getDrawingBufferSize=function(X){return X.set(Z*ie,ce*ie).floor()},this.setDrawingBufferSize=function(X,ye,Ee){Z=X,ce=ye,ie=Ee,t.width=Math.floor(X*Ee),t.height=Math.floor(ye*Ee),this.setViewport(0,0,X,ye)},this.getCurrentViewport=function(X){return X.copy(z)},this.getViewport=function(X){return X.copy(_e)},this.setViewport=function(X,ye,Ee,xe){X.isVector4?_e.set(X.x,X.y,X.z,X.w):_e.set(X,ye,Ee,xe),ht.viewport(z.copy(_e).multiplyScalar(ie).round())},this.getScissor=function(X){return X.copy(Oe)},this.setScissor=function(X,ye,Ee,xe){X.isVector4?Oe.set(X.x,X.y,X.z,X.w):Oe.set(X,ye,Ee,xe),ht.scissor(Q.copy(Oe).multiplyScalar(ie).round())},this.getScissorTest=function(){return Ke},this.setScissorTest=function(X){ht.setScissorTest(Ke=X)},this.setOpaqueSort=function(X){oe=X},this.setTransparentSort=function(X){me=X},this.getClearColor=function(X){return X.copy(Zt.getClearColor())},this.setClearColor=function(){Zt.setClearColor.apply(Zt,arguments)},this.getClearAlpha=function(){return Zt.getClearAlpha()},this.setClearAlpha=function(){Zt.setClearAlpha.apply(Zt,arguments)},this.clear=function(X=!0,ye=!0,Ee=!0){let xe=0;if(X){let ge=!1;if(F!==null){const ct=F.texture.format;ge=ct===qP||ct===GP||ct===VP}if(ge){const ct=F.texture.type,Mt=ct===hc||ct===Nd||ct===S1||ct===g0||ct===UP||ct===zP,Vt=Zt.getClearColor(),Rt=Zt.getClearAlpha(),Qt=Vt.r,Kt=Vt.g,$e=Vt.b;Mt?(_[0]=Qt,_[1]=Kt,_[2]=$e,_[3]=Rt,ue.clearBufferuiv(ue.COLOR,0,_)):(S[0]=Qt,S[1]=Kt,S[2]=$e,S[3]=Rt,ue.clearBufferiv(ue.COLOR,0,S))}else xe|=ue.COLOR_BUFFER_BIT}ye&&(xe|=ue.DEPTH_BUFFER_BIT),Ee&&(xe|=ue.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ue.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ve,!1),t.removeEventListener("webglcontextrestored",Te,!1),t.removeEventListener("webglcontextcreationerror",Ye,!1),Dt.dispose(),_n.dispose(),Nt.dispose(),W.dispose(),Ne.dispose(),Be.dispose(),hi.dispose(),ve.dispose(),It.dispose(),Fe.dispose(),Fe.removeEventListener("sessionstart",Ga),Fe.removeEventListener("sessionend",Vo),uo.stop()};function Ve(X){X.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function Te(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1;const X=Yt.autoReset,ye=Lt.enabled,Ee=Lt.autoUpdate,xe=Lt.needsUpdate,ge=Lt.type;ft(),Yt.autoReset=X,Lt.enabled=ye,Lt.autoUpdate=Ee,Lt.needsUpdate=xe,Lt.type=ge}function Ye(X){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",X.statusMessage)}function an(X){const ye=X.target;ye.removeEventListener("dispose",an),bi(ye)}function bi(X){yr(X),Nt.remove(X)}function yr(X){const ye=Nt.get(X).programs;ye!==void 0&&(ye.forEach(function(Ee){It.releaseProgram(Ee)}),X.isShaderMaterial&&It.releaseShaderCache(X))}this.renderBufferDirect=function(X,ye,Ee,xe,ge,ct){ye===null&&(ye=en);const Mt=ge.isMesh&&ge.matrixWorld.determinant()<0,Vt=Yn(X,ye,Ee,xe,ge);ht.setMaterial(xe,Mt);let Rt=Ee.index,Qt=1;if(xe.wireframe===!0){if(Rt=et.getWireframeAttribute(Ee),Rt===void 0)return;Qt=2}const Kt=Ee.drawRange,$e=Ee.attributes.position;let Dn=Kt.start*Qt,mn=(Kt.start+Kt.count)*Qt;ct!==null&&(Dn=Math.max(Dn,ct.start*Qt),mn=Math.min(mn,(ct.start+ct.count)*Qt)),Rt!==null?(Dn=Math.max(Dn,0),mn=Math.min(mn,Rt.count)):$e!=null&&(Dn=Math.max(Dn,0),mn=Math.min(mn,$e.count));const Ft=mn-Dn;if(Ft<0||Ft===1/0)return;hi.setup(ge,xe,Vt,Ee,Rt);let ne,_t=kt;if(Rt!==null&&(ne=He.get(Rt),_t=Mn,_t.setIndex(ne)),ge.isMesh)xe.wireframe===!0?(ht.setLineWidth(xe.wireframeLinewidth*at()),_t.setMode(ue.LINES)):_t.setMode(ue.TRIANGLES);else if(ge.isLine){let $t=xe.linewidth;$t===void 0&&($t=1),ht.setLineWidth($t*at()),ge.isLineSegments?_t.setMode(ue.LINES):ge.isLineLoop?_t.setMode(ue.LINE_LOOP):_t.setMode(ue.LINE_STRIP)}else ge.isPoints?_t.setMode(ue.POINTS):ge.isSprite&&_t.setMode(ue.TRIANGLES);if(ge.isBatchedMesh)if(ge._multiDrawInstances!==null)_t.renderMultiDrawInstances(ge._multiDrawStarts,ge._multiDrawCounts,ge._multiDrawCount,ge._multiDrawInstances);else if(st.get("WEBGL_multi_draw"))_t.renderMultiDraw(ge._multiDrawStarts,ge._multiDrawCounts,ge._multiDrawCount);else{const $t=ge._multiDrawStarts,ho=ge._multiDrawCounts,Qn=ge._multiDrawCount,ps=Rt?He.get(Rt).bytesPerElement:1,Gr=Nt.get(xe).currentProgram.getUniforms();for(let Y=0;Y<Qn;Y++)Gr.setValue(ue,"_gl_DrawID",Y),_t.render($t[Y]/ps,ho[Y])}else if(ge.isInstancedMesh)_t.renderInstances(Dn,Ft,ge.count);else if(Ee.isInstancedBufferGeometry){const $t=Ee._maxInstanceCount!==void 0?Ee._maxInstanceCount:1/0,ho=Math.min(Ee.instanceCount,$t);_t.renderInstances(Dn,Ft,ho)}else _t.render(Dn,Ft)};function Fn(X,ye,Ee){X.transparent===!0&&X.side===Ks&&X.forceSinglePass===!1?(X.side=Ds,X.needsUpdate=!0,p(X,ye,Ee),X.side=Qh,X.needsUpdate=!0,p(X,ye,Ee),X.side=Ks):p(X,ye,Ee)}this.compile=function(X,ye,Ee=null){Ee===null&&(Ee=X),x=_n.get(Ee),x.init(ye),R.push(x),Ee.traverseVisible(function(ge){ge.isLight&&ge.layers.test(ye.layers)&&(x.pushLight(ge),ge.castShadow&&x.pushShadow(ge))}),X!==Ee&&X.traverseVisible(function(ge){ge.isLight&&ge.layers.test(ye.layers)&&(x.pushLight(ge),ge.castShadow&&x.pushShadow(ge))}),x.setupLights();const xe=new Set;return X.traverse(function(ge){if(!(ge.isMesh||ge.isPoints||ge.isLine||ge.isSprite))return;const ct=ge.material;if(ct)if(Array.isArray(ct))for(let Mt=0;Mt<ct.length;Mt++){const Vt=ct[Mt];Fn(Vt,Ee,ge),xe.add(Vt)}else Fn(ct,Ee,ge),xe.add(ct)}),R.pop(),x=null,xe},this.compileAsync=function(X,ye,Ee=null){const xe=this.compile(X,ye,Ee);return new Promise(ge=>{function ct(){if(xe.forEach(function(Mt){Nt.get(Mt).currentProgram.isReady()&&xe.delete(Mt)}),xe.size===0){ge(X);return}setTimeout(ct,10)}st.get("KHR_parallel_shader_compile")!==null?ct():setTimeout(ct,10)})};let Xi=null;function lo(X){Xi&&Xi(X)}function Ga(){uo.stop()}function Vo(){uo.start()}const uo=new qV;uo.setAnimationLoop(lo),typeof self<"u"&&uo.setContext(self),this.setAnimationLoop=function(X){Xi=X,Fe.setAnimationLoop(X),X===null?uo.stop():uo.start()},Fe.addEventListener("sessionstart",Ga),Fe.addEventListener("sessionend",Vo),this.render=function(X,ye){if(ye!==void 0&&ye.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;if(X.matrixWorldAutoUpdate===!0&&X.updateMatrixWorld(),ye.parent===null&&ye.matrixWorldAutoUpdate===!0&&ye.updateMatrixWorld(),Fe.enabled===!0&&Fe.isPresenting===!0&&(Fe.cameraAutoUpdate===!0&&Fe.updateCamera(ye),ye=Fe.getCamera()),X.isScene===!0&&X.onBeforeRender(N,X,ye,F),x=_n.get(X,R.length),x.init(ye),R.push(x),Ot.multiplyMatrices(ye.projectionMatrix,ye.matrixWorldInverse),Me.setFromProjectionMatrix(Ot),nt=this.localClippingEnabled,ze=ke.init(this.clippingPlanes,nt),w=Dt.get(X,M.length),w.init(),M.push(w),Fe.enabled===!0&&Fe.isPresenting===!0){const ct=N.xr.getDepthSensingMesh();ct!==null&&co(ct,ye,-1/0,N.sortObjects)}co(X,ye,0,N.sortObjects),w.finish(),N.sortObjects===!0&&w.sort(oe,me),Ze=Fe.enabled===!1||Fe.isPresenting===!1||Fe.hasDepthSensing()===!1,Ze&&Zt.addToRenderList(w,X),this.info.render.frame++,ze===!0&&ke.beginShadows();const Ee=x.state.shadowsArray;Lt.render(Ee,X,ye),ze===!0&&ke.endShadows(),this.info.autoReset===!0&&this.info.reset();const xe=w.opaque,ge=w.transmissive;if(x.setupLights(),ye.isArrayCamera){const ct=ye.cameras;if(ge.length>0)for(let Mt=0,Vt=ct.length;Mt<Vt;Mt++){const Rt=ct[Mt];We(xe,ge,X,Rt)}Ze&&Zt.render(X);for(let Mt=0,Vt=ct.length;Mt<Vt;Mt++){const Rt=ct[Mt];Re(w,X,Rt,Rt.viewport)}}else ge.length>0&&We(xe,ge,X,ye),Ze&&Zt.render(X),Re(w,X,ye);F!==null&&(re.updateMultisampleRenderTarget(F),re.updateRenderTargetMipmap(F)),X.isScene===!0&&X.onAfterRender(N,X,ye),hi.resetDefaultState(),L=-1,O=null,R.pop(),R.length>0?(x=R[R.length-1],ze===!0&&ke.setGlobalState(N.clippingPlanes,x.state.camera)):x=null,M.pop(),M.length>0?w=M[M.length-1]:w=null};function co(X,ye,Ee,xe){if(X.visible===!1)return;if(X.layers.test(ye.layers)){if(X.isGroup)Ee=X.renderOrder;else if(X.isLOD)X.autoUpdate===!0&&X.update(ye);else if(X.isLight)x.pushLight(X),X.castShadow&&x.pushShadow(X);else if(X.isSprite){if(!X.frustumCulled||Me.intersectsSprite(X)){xe&&Ct.setFromMatrixPosition(X.matrixWorld).applyMatrix4(Ot);const Mt=Be.update(X),Vt=X.material;Vt.visible&&w.push(X,Mt,Vt,Ee,Ct.z,null)}}else if((X.isMesh||X.isLine||X.isPoints)&&(!X.frustumCulled||Me.intersectsObject(X))){const Mt=Be.update(X),Vt=X.material;if(xe&&(X.boundingSphere!==void 0?(X.boundingSphere===null&&X.computeBoundingSphere(),Ct.copy(X.boundingSphere.center)):(Mt.boundingSphere===null&&Mt.computeBoundingSphere(),Ct.copy(Mt.boundingSphere.center)),Ct.applyMatrix4(X.matrixWorld).applyMatrix4(Ot)),Array.isArray(Vt)){const Rt=Mt.groups;for(let Qt=0,Kt=Rt.length;Qt<Kt;Qt++){const $e=Rt[Qt],Dn=Vt[$e.materialIndex];Dn&&Dn.visible&&w.push(X,Mt,Dn,Ee,Ct.z,$e)}}else Vt.visible&&w.push(X,Mt,Vt,Ee,Ct.z,null)}}const ct=X.children;for(let Mt=0,Vt=ct.length;Mt<Vt;Mt++)co(ct[Mt],ye,Ee,xe)}function Re(X,ye,Ee,xe){const ge=X.opaque,ct=X.transmissive,Mt=X.transparent;x.setupLightsView(Ee),ze===!0&&ke.setGlobalState(N.clippingPlanes,Ee),xe&&ht.viewport(z.copy(xe)),ge.length>0&&dt(ge,ye,Ee),ct.length>0&&dt(ct,ye,Ee),Mt.length>0&&dt(Mt,ye,Ee),ht.buffers.depth.setTest(!0),ht.buffers.depth.setMask(!0),ht.buffers.color.setMask(!0),ht.setPolygonOffset(!1)}function We(X,ye,Ee,xe){if((Ee.isScene===!0?Ee.overrideMaterial:null)!==null)return;x.state.transmissionRenderTarget[xe.id]===void 0&&(x.state.transmissionRenderTarget[xe.id]=new Kh(1,1,{generateMipmaps:!0,type:st.has("EXT_color_buffer_half_float")||st.has("EXT_color_buffer_float")?W0:hc,minFilter:hd,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:ni.workingColorSpace}));const ct=x.state.transmissionRenderTarget[xe.id],Mt=xe.viewport||z;ct.setSize(Mt.z,Mt.w);const Vt=N.getRenderTarget();N.setRenderTarget(ct),N.getClearColor(ee),$=N.getClearAlpha(),$<1&&N.setClearColor(16777215,.5),N.clear(),Ze&&Zt.render(Ee);const Rt=N.toneMapping;N.toneMapping=Bh;const Qt=xe.viewport;if(xe.viewport!==void 0&&(xe.viewport=void 0),x.setupLightsView(xe),ze===!0&&ke.setGlobalState(N.clippingPlanes,xe),dt(X,Ee,xe),re.updateMultisampleRenderTarget(ct),re.updateRenderTargetMipmap(ct),st.has("WEBGL_multisampled_render_to_texture")===!1){let Kt=!1;for(let $e=0,Dn=ye.length;$e<Dn;$e++){const mn=ye[$e],Ft=mn.object,ne=mn.geometry,_t=mn.material,$t=mn.group;if(_t.side===Ks&&Ft.layers.test(xe.layers)){const ho=_t.side;_t.side=Ds,_t.needsUpdate=!0,jt(Ft,Ee,xe,ne,_t,$t),_t.side=ho,_t.needsUpdate=!0,Kt=!0}}Kt===!0&&(re.updateMultisampleRenderTarget(ct),re.updateRenderTargetMipmap(ct))}N.setRenderTarget(Vt),N.setClearColor(ee,$),Qt!==void 0&&(xe.viewport=Qt),N.toneMapping=Rt}function dt(X,ye,Ee){const xe=ye.isScene===!0?ye.overrideMaterial:null;for(let ge=0,ct=X.length;ge<ct;ge++){const Mt=X[ge],Vt=Mt.object,Rt=Mt.geometry,Qt=xe===null?Mt.material:xe,Kt=Mt.group;Vt.layers.test(Ee.layers)&&jt(Vt,ye,Ee,Rt,Qt,Kt)}}function jt(X,ye,Ee,xe,ge,ct){X.onBeforeRender(N,ye,Ee,xe,ge,ct),X.modelViewMatrix.multiplyMatrices(Ee.matrixWorldInverse,X.matrixWorld),X.normalMatrix.getNormalMatrix(X.modelViewMatrix),ge.onBeforeRender(N,ye,Ee,xe,X,ct),ge.transparent===!0&&ge.side===Ks&&ge.forceSinglePass===!1?(ge.side=Ds,ge.needsUpdate=!0,N.renderBufferDirect(Ee,ye,xe,ge,X,ct),ge.side=Qh,ge.needsUpdate=!0,N.renderBufferDirect(Ee,ye,xe,ge,X,ct),ge.side=Ks):N.renderBufferDirect(Ee,ye,xe,ge,X,ct),X.onAfterRender(N,ye,Ee,xe,ge,ct)}function p(X,ye,Ee){ye.isScene!==!0&&(ye=en);const xe=Nt.get(X),ge=x.state.lights,ct=x.state.shadowsArray,Mt=ge.state.version,Vt=It.getParameters(X,ge.state,ct,ye,Ee),Rt=It.getProgramCacheKey(Vt);let Qt=xe.programs;xe.environment=X.isMeshStandardMaterial?ye.environment:null,xe.fog=ye.fog,xe.envMap=(X.isMeshStandardMaterial?Ne:W).get(X.envMap||xe.environment),xe.envMapRotation=xe.environment!==null&&X.envMap===null?ye.environmentRotation:X.envMapRotation,Qt===void 0&&(X.addEventListener("dispose",an),Qt=new Map,xe.programs=Qt);let Kt=Qt.get(Rt);if(Kt!==void 0){if(xe.currentProgram===Kt&&xe.lightsStateVersion===Mt)return In(X,Vt),Kt}else Vt.uniforms=It.getUniforms(X),X.onBeforeCompile(Vt,N),Kt=It.acquireProgram(Vt,Rt),Qt.set(Rt,Kt),xe.uniforms=Vt.uniforms;const $e=xe.uniforms;return(!X.isShaderMaterial&&!X.isRawShaderMaterial||X.clipping===!0)&&($e.clippingPlanes=ke.uniform),In(X,Vt),xe.needsLights=An(X),xe.lightsStateVersion=Mt,xe.needsLights&&($e.ambientLightColor.value=ge.state.ambient,$e.lightProbe.value=ge.state.probe,$e.directionalLights.value=ge.state.directional,$e.directionalLightShadows.value=ge.state.directionalShadow,$e.spotLights.value=ge.state.spot,$e.spotLightShadows.value=ge.state.spotShadow,$e.rectAreaLights.value=ge.state.rectArea,$e.ltc_1.value=ge.state.rectAreaLTC1,$e.ltc_2.value=ge.state.rectAreaLTC2,$e.pointLights.value=ge.state.point,$e.pointLightShadows.value=ge.state.pointShadow,$e.hemisphereLights.value=ge.state.hemi,$e.directionalShadowMap.value=ge.state.directionalShadowMap,$e.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,$e.spotShadowMap.value=ge.state.spotShadowMap,$e.spotLightMatrix.value=ge.state.spotLightMatrix,$e.spotLightMap.value=ge.state.spotLightMap,$e.pointShadowMap.value=ge.state.pointShadowMap,$e.pointShadowMatrix.value=ge.state.pointShadowMatrix),xe.currentProgram=Kt,xe.uniformsList=null,Kt}function J(X){if(X.uniformsList===null){const ye=X.currentProgram.getUniforms();X.uniformsList=B2.seqWithValue(ye.seq,X.uniforms)}return X.uniformsList}function In(X,ye){const Ee=Nt.get(X);Ee.outputColorSpace=ye.outputColorSpace,Ee.batching=ye.batching,Ee.batchingColor=ye.batchingColor,Ee.instancing=ye.instancing,Ee.instancingColor=ye.instancingColor,Ee.instancingMorph=ye.instancingMorph,Ee.skinning=ye.skinning,Ee.morphTargets=ye.morphTargets,Ee.morphNormals=ye.morphNormals,Ee.morphColors=ye.morphColors,Ee.morphTargetsCount=ye.morphTargetsCount,Ee.numClippingPlanes=ye.numClippingPlanes,Ee.numIntersection=ye.numClipIntersection,Ee.vertexAlphas=ye.vertexAlphas,Ee.vertexTangents=ye.vertexTangents,Ee.toneMapping=ye.toneMapping}function Yn(X,ye,Ee,xe,ge){ye.isScene!==!0&&(ye=en),re.resetTextureUnits();const ct=ye.fog,Mt=xe.isMeshStandardMaterial?ye.environment:null,Vt=F===null?N.outputColorSpace:F.isXRRenderTarget===!0?F.texture.colorSpace:X0,Rt=(xe.isMeshStandardMaterial?Ne:W).get(xe.envMap||Mt),Qt=xe.vertexColors===!0&&!!Ee.attributes.color&&Ee.attributes.color.itemSize===4,Kt=!!Ee.attributes.tangent&&(!!xe.normalMap||xe.anisotropy>0),$e=!!Ee.morphAttributes.position,Dn=!!Ee.morphAttributes.normal,mn=!!Ee.morphAttributes.color;let Ft=Bh;xe.toneMapped&&(F===null||F.isXRRenderTarget===!0)&&(Ft=N.toneMapping);const ne=Ee.morphAttributes.position||Ee.morphAttributes.normal||Ee.morphAttributes.color,_t=ne!==void 0?ne.length:0,$t=Nt.get(xe),ho=x.state.lights;if(ze===!0&&(nt===!0||X!==O)){const As=X===O&&xe.id===L;ke.setState(xe,X,As)}let Qn=!1;xe.version===$t.__version?($t.needsLights&&$t.lightsStateVersion!==ho.state.version||$t.outputColorSpace!==Vt||ge.isBatchedMesh&&$t.batching===!1||!ge.isBatchedMesh&&$t.batching===!0||ge.isBatchedMesh&&$t.batchingColor===!0&&ge.colorTexture===null||ge.isBatchedMesh&&$t.batchingColor===!1&&ge.colorTexture!==null||ge.isInstancedMesh&&$t.instancing===!1||!ge.isInstancedMesh&&$t.instancing===!0||ge.isSkinnedMesh&&$t.skinning===!1||!ge.isSkinnedMesh&&$t.skinning===!0||ge.isInstancedMesh&&$t.instancingColor===!0&&ge.instanceColor===null||ge.isInstancedMesh&&$t.instancingColor===!1&&ge.instanceColor!==null||ge.isInstancedMesh&&$t.instancingMorph===!0&&ge.morphTexture===null||ge.isInstancedMesh&&$t.instancingMorph===!1&&ge.morphTexture!==null||$t.envMap!==Rt||xe.fog===!0&&$t.fog!==ct||$t.numClippingPlanes!==void 0&&($t.numClippingPlanes!==ke.numPlanes||$t.numIntersection!==ke.numIntersection)||$t.vertexAlphas!==Qt||$t.vertexTangents!==Kt||$t.morphTargets!==$e||$t.morphNormals!==Dn||$t.morphColors!==mn||$t.toneMapping!==Ft||$t.morphTargetsCount!==_t)&&(Qn=!0):(Qn=!0,$t.__version=xe.version);let ps=$t.currentProgram;Qn===!0&&(ps=p(xe,ye,ge));let Gr=!1,Y=!1,pu=!1;const fi=ps.getUniforms(),fo=$t.uniforms;if(ht.useProgram(ps.program)&&(Gr=!0,Y=!0,pu=!0),xe.id!==L&&(L=xe.id,Y=!0),Gr||O!==X){ht.buffers.depth.getReversed()?(tt.copy(X.projectionMatrix),Gie(tt),qie(tt),fi.setValue(ue,"projectionMatrix",tt)):fi.setValue(ue,"projectionMatrix",X.projectionMatrix),fi.setValue(ue,"viewMatrix",X.matrixWorldInverse);const pa=fi.map.cameraPosition;pa!==void 0&&pa.setValue(ue,Ht.setFromMatrixPosition(X.matrixWorld)),xt.logarithmicDepthBuffer&&fi.setValue(ue,"logDepthBufFC",2/(Math.log(X.far+1)/Math.LN2)),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&fi.setValue(ue,"isOrthographic",X.isOrthographicCamera===!0),O!==X&&(O=X,Y=!0,pu=!0)}if(ge.isSkinnedMesh){fi.setOptional(ue,ge,"bindMatrix"),fi.setOptional(ue,ge,"bindMatrixInverse");const As=ge.skeleton;As&&(As.boneTexture===null&&As.computeBoneTexture(),fi.setValue(ue,"boneTexture",As.boneTexture,re))}ge.isBatchedMesh&&(fi.setOptional(ue,ge,"batchingTexture"),fi.setValue(ue,"batchingTexture",ge._matricesTexture,re),fi.setOptional(ue,ge,"batchingIdTexture"),fi.setValue(ue,"batchingIdTexture",ge._indirectTexture,re),fi.setOptional(ue,ge,"batchingColorTexture"),ge._colorsTexture!==null&&fi.setValue(ue,"batchingColorTexture",ge._colorsTexture,re));const Au=Ee.morphAttributes;if((Au.position!==void 0||Au.normal!==void 0||Au.color!==void 0)&&tn.update(ge,Ee,ps),(Y||$t.receiveShadow!==ge.receiveShadow)&&($t.receiveShadow=ge.receiveShadow,fi.setValue(ue,"receiveShadow",ge.receiveShadow)),xe.isMeshGouraudMaterial&&xe.envMap!==null&&(fo.envMap.value=Rt,fo.flipEnvMap.value=Rt.isCubeTexture&&Rt.isRenderTargetTexture===!1?-1:1),xe.isMeshStandardMaterial&&xe.envMap===null&&ye.environment!==null&&(fo.envMapIntensity.value=ye.environmentIntensity),Y&&(fi.setValue(ue,"toneMappingExposure",N.toneMappingExposure),$t.needsLights&&Yi(fo,pu),ct&&xe.fog===!0&&ut.refreshFogUniforms(fo,ct),ut.refreshMaterialUniforms(fo,xe,ie,ce,x.state.transmissionRenderTarget[X.id]),B2.upload(ue,J($t),fo,re)),xe.isShaderMaterial&&xe.uniformsNeedUpdate===!0&&(B2.upload(ue,J($t),fo,re),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&fi.setValue(ue,"center",ge.center),fi.setValue(ue,"modelViewMatrix",ge.modelViewMatrix),fi.setValue(ue,"normalMatrix",ge.normalMatrix),fi.setValue(ue,"modelMatrix",ge.matrixWorld),xe.isShaderMaterial||xe.isRawShaderMaterial){const As=xe.uniformsGroups;for(let pa=0,ms=As.length;pa<ms;pa++){const kc=As[pa];ve.update(kc,ps),ve.bind(kc,ps)}}return ps}function Yi(X,ye){X.ambientLightColor.needsUpdate=ye,X.lightProbe.needsUpdate=ye,X.directionalLights.needsUpdate=ye,X.directionalLightShadows.needsUpdate=ye,X.pointLights.needsUpdate=ye,X.pointLightShadows.needsUpdate=ye,X.spotLights.needsUpdate=ye,X.spotLightShadows.needsUpdate=ye,X.rectAreaLights.needsUpdate=ye,X.hemisphereLights.needsUpdate=ye}function An(X){return X.isMeshLambertMaterial||X.isMeshToonMaterial||X.isMeshPhongMaterial||X.isMeshStandardMaterial||X.isShadowMaterial||X.isShaderMaterial&&X.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return F},this.setRenderTargetTextures=function(X,ye,Ee){Nt.get(X.texture).__webglTexture=ye,Nt.get(X.depthTexture).__webglTexture=Ee;const xe=Nt.get(X);xe.__hasExternalTextures=!0,xe.__autoAllocateDepthBuffer=Ee===void 0,xe.__autoAllocateDepthBuffer||st.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),xe.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(X,ye){const Ee=Nt.get(X);Ee.__webglFramebuffer=ye,Ee.__useDefaultFramebuffer=ye===void 0},this.setRenderTarget=function(X,ye=0,Ee=0){F=X,T=ye,D=Ee;let xe=!0,ge=null,ct=!1,Mt=!1;if(X){const Rt=Nt.get(X);if(Rt.__useDefaultFramebuffer!==void 0)ht.bindFramebuffer(ue.FRAMEBUFFER,null),xe=!1;else if(Rt.__webglFramebuffer===void 0)re.setupRenderTarget(X);else if(Rt.__hasExternalTextures)re.rebindTextures(X,Nt.get(X.texture).__webglTexture,Nt.get(X.depthTexture).__webglTexture);else if(X.depthBuffer){const $e=X.depthTexture;if(Rt.__boundDepthTexture!==$e){if($e!==null&&Nt.has($e)&&(X.width!==$e.image.width||X.height!==$e.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");re.setupDepthRenderbuffer(X)}}const Qt=X.texture;(Qt.isData3DTexture||Qt.isDataArrayTexture||Qt.isCompressedArrayTexture)&&(Mt=!0);const Kt=Nt.get(X).__webglFramebuffer;X.isWebGLCubeRenderTarget?(Array.isArray(Kt[ye])?ge=Kt[ye][Ee]:ge=Kt[ye],ct=!0):X.samples>0&&re.useMultisampledRTT(X)===!1?ge=Nt.get(X).__webglMultisampledFramebuffer:Array.isArray(Kt)?ge=Kt[Ee]:ge=Kt,z.copy(X.viewport),Q.copy(X.scissor),j=X.scissorTest}else z.copy(_e).multiplyScalar(ie).floor(),Q.copy(Oe).multiplyScalar(ie).floor(),j=Ke;if(ht.bindFramebuffer(ue.FRAMEBUFFER,ge)&&xe&&ht.drawBuffers(X,ge),ht.viewport(z),ht.scissor(Q),ht.setScissorTest(j),ct){const Rt=Nt.get(X.texture);ue.framebufferTexture2D(ue.FRAMEBUFFER,ue.COLOR_ATTACHMENT0,ue.TEXTURE_CUBE_MAP_POSITIVE_X+ye,Rt.__webglTexture,Ee)}else if(Mt){const Rt=Nt.get(X.texture),Qt=ye||0;ue.framebufferTextureLayer(ue.FRAMEBUFFER,ue.COLOR_ATTACHMENT0,Rt.__webglTexture,Ee||0,Qt)}L=-1},this.readRenderTargetPixels=function(X,ye,Ee,xe,ge,ct,Mt){if(!(X&&X.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Vt=Nt.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&Mt!==void 0&&(Vt=Vt[Mt]),Vt){ht.bindFramebuffer(ue.FRAMEBUFFER,Vt);try{const Rt=X.texture,Qt=Rt.format,Kt=Rt.type;if(!xt.textureFormatReadable(Qt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!xt.textureTypeReadable(Kt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ye>=0&&ye<=X.width-xe&&Ee>=0&&Ee<=X.height-ge&&ue.readPixels(ye,Ee,xe,ge,pn.convert(Qt),pn.convert(Kt),ct)}finally{const Rt=F!==null?Nt.get(F).__webglFramebuffer:null;ht.bindFramebuffer(ue.FRAMEBUFFER,Rt)}}},this.readRenderTargetPixelsAsync=async function(X,ye,Ee,xe,ge,ct,Mt){if(!(X&&X.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Vt=Nt.get(X).__webglFramebuffer;if(X.isWebGLCubeRenderTarget&&Mt!==void 0&&(Vt=Vt[Mt]),Vt){const Rt=X.texture,Qt=Rt.format,Kt=Rt.type;if(!xt.textureFormatReadable(Qt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!xt.textureTypeReadable(Kt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(ye>=0&&ye<=X.width-xe&&Ee>=0&&Ee<=X.height-ge){ht.bindFramebuffer(ue.FRAMEBUFFER,Vt);const $e=ue.createBuffer();ue.bindBuffer(ue.PIXEL_PACK_BUFFER,$e),ue.bufferData(ue.PIXEL_PACK_BUFFER,ct.byteLength,ue.STREAM_READ),ue.readPixels(ye,Ee,xe,ge,pn.convert(Qt),pn.convert(Kt),0);const Dn=F!==null?Nt.get(F).__webglFramebuffer:null;ht.bindFramebuffer(ue.FRAMEBUFFER,Dn);const mn=ue.fenceSync(ue.SYNC_GPU_COMMANDS_COMPLETE,0);return ue.flush(),await Vie(ue,mn,4),ue.bindBuffer(ue.PIXEL_PACK_BUFFER,$e),ue.getBufferSubData(ue.PIXEL_PACK_BUFFER,0,ct),ue.deleteBuffer($e),ue.deleteSync(mn),ct}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(X,ye=null,Ee=0){X.isTexture!==!0&&(pg("WebGLRenderer: copyFramebufferToTexture function signature has changed."),ye=arguments[0]||null,X=arguments[1]);const xe=Math.pow(2,-Ee),ge=Math.floor(X.image.width*xe),ct=Math.floor(X.image.height*xe),Mt=ye!==null?ye.x:0,Vt=ye!==null?ye.y:0;re.setTexture2D(X,0),ue.copyTexSubImage2D(ue.TEXTURE_2D,Ee,0,0,Mt,Vt,ge,ct),ht.unbindTexture()},this.copyTextureToTexture=function(X,ye,Ee=null,xe=null,ge=0){X.isTexture!==!0&&(pg("WebGLRenderer: copyTextureToTexture function signature has changed."),xe=arguments[0]||null,X=arguments[1],ye=arguments[2],ge=arguments[3]||0,Ee=null);let ct,Mt,Vt,Rt,Qt,Kt,$e,Dn,mn;const Ft=X.isCompressedTexture?X.mipmaps[ge]:X.image;Ee!==null?(ct=Ee.max.x-Ee.min.x,Mt=Ee.max.y-Ee.min.y,Vt=Ee.isBox3?Ee.max.z-Ee.min.z:1,Rt=Ee.min.x,Qt=Ee.min.y,Kt=Ee.isBox3?Ee.min.z:0):(ct=Ft.width,Mt=Ft.height,Vt=Ft.depth||1,Rt=0,Qt=0,Kt=0),xe!==null?($e=xe.x,Dn=xe.y,mn=xe.z):($e=0,Dn=0,mn=0);const ne=pn.convert(ye.format),_t=pn.convert(ye.type);let $t;ye.isData3DTexture?(re.setTexture3D(ye,0),$t=ue.TEXTURE_3D):ye.isDataArrayTexture||ye.isCompressedArrayTexture?(re.setTexture2DArray(ye,0),$t=ue.TEXTURE_2D_ARRAY):(re.setTexture2D(ye,0),$t=ue.TEXTURE_2D),ue.pixelStorei(ue.UNPACK_FLIP_Y_WEBGL,ye.flipY),ue.pixelStorei(ue.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),ue.pixelStorei(ue.UNPACK_ALIGNMENT,ye.unpackAlignment);const ho=ue.getParameter(ue.UNPACK_ROW_LENGTH),Qn=ue.getParameter(ue.UNPACK_IMAGE_HEIGHT),ps=ue.getParameter(ue.UNPACK_SKIP_PIXELS),Gr=ue.getParameter(ue.UNPACK_SKIP_ROWS),Y=ue.getParameter(ue.UNPACK_SKIP_IMAGES);ue.pixelStorei(ue.UNPACK_ROW_LENGTH,Ft.width),ue.pixelStorei(ue.UNPACK_IMAGE_HEIGHT,Ft.height),ue.pixelStorei(ue.UNPACK_SKIP_PIXELS,Rt),ue.pixelStorei(ue.UNPACK_SKIP_ROWS,Qt),ue.pixelStorei(ue.UNPACK_SKIP_IMAGES,Kt);const pu=X.isDataArrayTexture||X.isData3DTexture,fi=ye.isDataArrayTexture||ye.isData3DTexture;if(X.isRenderTargetTexture||X.isDepthTexture){const fo=Nt.get(X),Au=Nt.get(ye),As=Nt.get(fo.__renderTarget),pa=Nt.get(Au.__renderTarget);ht.bindFramebuffer(ue.READ_FRAMEBUFFER,As.__webglFramebuffer),ht.bindFramebuffer(ue.DRAW_FRAMEBUFFER,pa.__webglFramebuffer);for(let ms=0;ms<Vt;ms++)pu&&ue.framebufferTextureLayer(ue.READ_FRAMEBUFFER,ue.COLOR_ATTACHMENT0,Nt.get(X).__webglTexture,ge,Kt+ms),X.isDepthTexture?(fi&&ue.framebufferTextureLayer(ue.DRAW_FRAMEBUFFER,ue.COLOR_ATTACHMENT0,Nt.get(ye).__webglTexture,ge,mn+ms),ue.blitFramebuffer(Rt,Qt,ct,Mt,$e,Dn,ct,Mt,ue.DEPTH_BUFFER_BIT,ue.NEAREST)):fi?ue.copyTexSubImage3D($t,ge,$e,Dn,mn+ms,Rt,Qt,ct,Mt):ue.copyTexSubImage2D($t,ge,$e,Dn,mn+ms,Rt,Qt,ct,Mt);ht.bindFramebuffer(ue.READ_FRAMEBUFFER,null),ht.bindFramebuffer(ue.DRAW_FRAMEBUFFER,null)}else fi?X.isDataTexture||X.isData3DTexture?ue.texSubImage3D($t,ge,$e,Dn,mn,ct,Mt,Vt,ne,_t,Ft.data):ye.isCompressedArrayTexture?ue.compressedTexSubImage3D($t,ge,$e,Dn,mn,ct,Mt,Vt,ne,Ft.data):ue.texSubImage3D($t,ge,$e,Dn,mn,ct,Mt,Vt,ne,_t,Ft):X.isDataTexture?ue.texSubImage2D(ue.TEXTURE_2D,ge,$e,Dn,ct,Mt,ne,_t,Ft.data):X.isCompressedTexture?ue.compressedTexSubImage2D(ue.TEXTURE_2D,ge,$e,Dn,Ft.width,Ft.height,ne,Ft.data):ue.texSubImage2D(ue.TEXTURE_2D,ge,$e,Dn,ct,Mt,ne,_t,Ft);ue.pixelStorei(ue.UNPACK_ROW_LENGTH,ho),ue.pixelStorei(ue.UNPACK_IMAGE_HEIGHT,Qn),ue.pixelStorei(ue.UNPACK_SKIP_PIXELS,ps),ue.pixelStorei(ue.UNPACK_SKIP_ROWS,Gr),ue.pixelStorei(ue.UNPACK_SKIP_IMAGES,Y),ge===0&&ye.generateMipmaps&&ue.generateMipmap($t),ht.unbindTexture()},this.copyTextureToTexture3D=function(X,ye,Ee=null,xe=null,ge=0){return X.isTexture!==!0&&(pg("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Ee=arguments[0]||null,xe=arguments[1]||null,X=arguments[2],ye=arguments[3],ge=arguments[4]||0),pg('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(X,ye,Ee,xe,ge)},this.initRenderTarget=function(X){Nt.get(X).__webglFramebuffer===void 0&&re.setupRenderTarget(X)},this.initTexture=function(X){X.isCubeTexture?re.setTextureCube(X,0):X.isData3DTexture?re.setTexture3D(X,0):X.isDataArrayTexture||X.isCompressedArrayTexture?re.setTexture2DArray(X,0):re.setTexture2D(X,0),ht.unbindTexture()},this.resetState=function(){T=0,D=0,F=null,ht.reset(),hi.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Gu}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorspace=ni._getDrawingBufferColorSpace(e),t.unpackColorSpace=ni._getUnpackColorSpace()}}let Zle=class extends Fs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new la,this.environmentIntensity=1,this.environmentRotation=new la,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}},YV=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=i4,this.updateRanges=[],this.version=0,this.uuid=Kl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Kl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Kl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};const Vs=new le;let fd=class QV{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.applyMatrix4(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.applyNormalMatrix(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.transformDirection(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=ul(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=yi(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=yi(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=ul(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=ul(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=ul(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=ul(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=yi(t,this.array),i=yi(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=yi(t,this.array),i=yi(i,this.array),r=yi(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=yi(t,this.array),i=yi(i,this.array),r=yi(r,this.array),s=yi(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Qr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new QV(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},KV=class extends Qr{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},ZS=class extends ep{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new fn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};const Bx=new le,Ox=new le,Pk=new ki,Om=new jS,Zy=new Y0,A3=new le,Nk=new le;class JS extends Fs{constructor(e=new ur,t=new ZS){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)Bx.fromBufferAttribute(t,r-1),Ox.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Bx.distanceTo(Ox);e.setAttribute("lineDistance",new si(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Zy.copy(i.boundingSphere),Zy.applyMatrix4(r),Zy.radius+=s,e.ray.intersectsSphere(Zy)===!1)return;Pk.copy(r).invert(),Om.copy(e.ray).applyMatrix4(Pk);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=this.isLineSegments?2:1,c=i.index,A=i.attributes.position;if(c!==null){const v=Math.max(0,o.start),_=Math.min(c.count,o.start+o.count);for(let S=v,w=_-1;S<w;S+=u){const x=c.getX(S),M=c.getX(S+1),R=Jy(this,e,Om,l,x,M);R&&t.push(R)}if(this.isLineLoop){const S=c.getX(_-1),w=c.getX(v),x=Jy(this,e,Om,l,S,w);x&&t.push(x)}}else{const v=Math.max(0,o.start),_=Math.min(A.count,o.start+o.count);for(let S=v,w=_-1;S<w;S+=u){const x=Jy(this,e,Om,l,S,S+1);x&&t.push(x)}if(this.isLineLoop){const S=Jy(this,e,Om,l,_-1,v);S&&t.push(S)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function Jy(n,e,t,i,r,s){const o=n.geometry.attributes.position;if(Bx.fromBufferAttribute(o,r),Ox.fromBufferAttribute(o,s),t.distanceSqToSegment(Bx,Ox,A3,Nk)>i)return;A3.applyMatrix4(n.matrixWorld);const l=e.ray.origin.distanceTo(A3);if(!(l<e.near||l>e.far))return{distance:l,point:Nk.clone().applyMatrix4(n.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:n}}const Ik=new le,Dk=new le;class ZV extends JS{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)Ik.fromBufferAttribute(t,r),Dk.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Ik.distanceTo(Dk);e.setAttribute("lineDistance",new si(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Dl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,l=s-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-o,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const c=i[r],A=i[r+1]-c,v=(o-c)/A;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=t||(o.isVector2?new rt:new le);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new le,r=[],s=[],o=[],a=new le,l=new ki;for(let v=0;v<=e;v++){const _=v/e;r[v]=this.getTangentAt(_,new le)}s[0]=new le,o[0]=new le;let u=Number.MAX_VALUE;const c=Math.abs(r[0].x),h=Math.abs(r[0].y),A=Math.abs(r[0].z);c<=u&&(u=c,i.set(1,0,0)),h<=u&&(u=h,i.set(0,1,0)),A<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(r[v-1],r[v]),a.length()>Number.EPSILON){a.normalize();const _=Math.acos(Lr(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(l.makeRotationAxis(a,_))}o[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(Lr(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let _=1;_<=e;_++)s[_].applyMatrix4(l.makeRotationAxis(r[_],v*_)),o[_].crossVectors(r[_],s[_])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class QP extends Dl{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,t=new rt){const i=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),A=l-this.aX,v=u-this.aY;l=A*c-v*h+this.aX,u=A*h+v*c+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Jle extends QP{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function KP(){let n=0,e=0,t=0,i=0;function r(s,o,a,l){n=s,e=a,t=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){r(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,c,h){let A=(o-s)/u-(a-s)/(u+c)+(a-o)/c,v=(a-o)/c-(l-o)/(c+h)+(l-a)/h;A*=c,v*=c,r(o,a,A,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const e_=new le,m3=new KP,g3=new KP,v3=new KP;class eue extends Dl{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new le){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,c;this.closed||a>0?u=r[(a-1)%s]:(e_.subVectors(r[0],r[1]).add(r[0]),u=e_);const h=r[a%s],A=r[(a+1)%s];if(this.closed||a+2<s?c=r[(a+2)%s]:(e_.subVectors(r[s-1],r[s-2]).add(r[s-1]),c=e_),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let _=Math.pow(u.distanceToSquared(h),v),S=Math.pow(h.distanceToSquared(A),v),w=Math.pow(A.distanceToSquared(c),v);S<1e-4&&(S=1),_<1e-4&&(_=S),w<1e-4&&(w=S),m3.initNonuniformCatmullRom(u.x,h.x,A.x,c.x,_,S,w),g3.initNonuniformCatmullRom(u.y,h.y,A.y,c.y,_,S,w),v3.initNonuniformCatmullRom(u.z,h.z,A.z,c.z,_,S,w)}else this.curveType==="catmullrom"&&(m3.initCatmullRom(u.x,h.x,A.x,c.x,this.tension),g3.initCatmullRom(u.y,h.y,A.y,c.y,this.tension),v3.initCatmullRom(u.z,h.z,A.z,c.z,this.tension));return i.set(m3.calc(l),g3.calc(l),v3.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new le().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function kk(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,l=n*a;return(2*t-2*i+s+o)*l+(-3*t+3*i-2*s-o)*a+s*n+t}function tue(n,e){const t=1-n;return t*t*e}function nue(n,e){return 2*(1-n)*n*e}function iue(n,e){return n*n*e}function Bg(n,e,t,i){return tue(n,e)+nue(n,t)+iue(n,i)}function rue(n,e){const t=1-n;return t*t*t*e}function sue(n,e){const t=1-n;return 3*t*t*n*e}function oue(n,e){return 3*(1-n)*n*n*e}function aue(n,e){return n*n*n*e}function Og(n,e,t,i,r){return rue(n,e)+sue(n,t)+oue(n,i)+aue(n,r)}class JV extends Dl{constructor(e=new rt,t=new rt,i=new rt,r=new rt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new rt){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Og(e,r.x,s.x,o.x,a.x),Og(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class eG extends Dl{constructor(e=new le,t=new le,i=new le,r=new le){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new le){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Og(e,r.x,s.x,o.x,a.x),Og(e,r.y,s.y,o.y,a.y),Og(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class tG extends Dl{constructor(e=new rt,t=new rt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new rt){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new rt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lue extends Dl{constructor(e=new le,t=new le){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new le){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new le){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class nG extends Dl{constructor(e=new rt,t=new rt,i=new rt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new rt){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Bg(e,r.x,s.x,o.x),Bg(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ZP extends Dl{constructor(e=new le,t=new le,i=new le){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new le){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Bg(e,r.x,s.x,o.x),Bg(e,r.y,s.y,o.y),Bg(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class iG extends Dl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new rt){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],u=r[o],c=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(kk(a,l.x,u.x,c.x,h.x),kk(a,l.y,u.y,c.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new rt().fromArray(r))}return this}}var Ux=Object.freeze({__proto__:null,ArcCurve:Jle,CatmullRomCurve3:eue,CubicBezierCurve:JV,CubicBezierCurve3:eG,EllipseCurve:QP,LineCurve:tG,LineCurve3:lue,QuadraticBezierCurve:nG,QuadraticBezierCurve3:ZP,SplineCurve:iG});class uue extends Dl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Ux[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const c=l[u];i&&i.equals(c)||(t.push(c),i=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new Ux[r.type]().fromJSON(r))}return this}}let o4=class extends uue{constructor(e){super(),this.type="Path",this.currentPoint=new rt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new tG(this.currentPoint.clone(),new rt(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new nG(this.currentPoint.clone(),new rt(e,t),new rt(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new JV(this.currentPoint.clone(),new rt(e,t),new rt(i,r),new rt(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new iG(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,t+l,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,l){const u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,i,r,s,o,a,l),this}absellipse(e,t,i,r,s,o,a,l){const u=new QP(e,t,i,r,s,o,a,l);if(this.curves.length>0){const h=u.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(u);const c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class wv extends ur{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],l=[],u=new le,c=new rt;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let h=0,A=3;h<=t;h++,A+=3){const v=i+h/t*r;u.x=e*Math.cos(v),u.y=e*Math.sin(v),o.push(u.x,u.y,u.z),a.push(0,0,1),c.x=(o[A]/e+1)/2,c.y=(o[A+1]/e+1)/2,l.push(c.x,c.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new si(o,3)),this.setAttribute("normal",new si(a,3)),this.setAttribute("uv",new si(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wv(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class JP extends ur{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const c=[],h=[],A=[],v=[];let _=0;const S=[],w=i/2;let x=0;M(),o===!1&&(e>0&&R(!0),t>0&&R(!1)),this.setIndex(c),this.setAttribute("position",new si(h,3)),this.setAttribute("normal",new si(A,3)),this.setAttribute("uv",new si(v,2));function M(){const N=new le,B=new le;let T=0;const D=(t-e)/i;for(let F=0;F<=s;F++){const L=[],O=F/s,z=O*(t-e)+e;for(let Q=0;Q<=r;Q++){const j=Q/r,ee=j*l+a,$=Math.sin(ee),Z=Math.cos(ee);B.x=z*$,B.y=-O*i+w,B.z=z*Z,h.push(B.x,B.y,B.z),N.set($,D,Z).normalize(),A.push(N.x,N.y,N.z),v.push(j,1-O),L.push(_++)}S.push(L)}for(let F=0;F<r;F++)for(let L=0;L<s;L++){const O=S[L][F],z=S[L+1][F],Q=S[L+1][F+1],j=S[L][F+1];(e>0||L!==0)&&(c.push(O,z,j),T+=3),(t>0||L!==s-1)&&(c.push(z,Q,j),T+=3)}u.addGroup(x,T,0),x+=T}function R(N){const B=_,T=new rt,D=new le;let F=0;const L=N===!0?e:t,O=N===!0?1:-1;for(let Q=1;Q<=r;Q++)h.push(0,w*O,0),A.push(0,O,0),v.push(.5,.5),_++;const z=_;for(let Q=0;Q<=r;Q++){const ee=Q/r*l+a,$=Math.cos(ee),Z=Math.sin(ee);D.x=L*Z,D.y=w*O,D.z=L*$,h.push(D.x,D.y,D.z),A.push(0,O,0),T.x=$*.5+.5,T.y=Z*.5*O+.5,v.push(T.x,T.y),_++}for(let Q=0;Q<r;Q++){const j=B+Q,ee=z+Q;N===!0?c.push(ee,ee+1,j):c.push(ee+1,ee,j),F+=3}u.addGroup(x,F,N===!0?1:2),x+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new JP(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class O2 extends o4{constructor(e){super(e),this.uuid=Kl(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new o4().fromJSON(r))}return this}}const cue={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=rG(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,c,h,A,v;if(i&&(s=Aue(n,e,s,t)),n.length>80*t){a=u=n[0],l=c=n[1];for(let _=t;_<r;_+=t)h=n[_],A=n[_+1],h<a&&(a=h),A<l&&(l=A),h>u&&(u=h),A>c&&(c=A);v=Math.max(u-a,c-l),v=v!==0?32767/v:0}return T1(s,o,t,a,l,v,0),o}};function rG(n,e,t,i,r){let s,o;if(r===Tue(n,e,t,i)>0)for(s=e;s<t;s+=i)o=Lk(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=Lk(s,n[s],n[s+1],o);return o&&ew(o,o.next)&&(M1(o),o=o.next),o}function Id(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(ew(t,t.next)||nr(t.prev,t,t.next)===0)){if(M1(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function T1(n,e,t,i,r,s,o){if(!n)return;!o&&s&&_ue(n,i,r,s);let a=n,l,u;for(;n.prev!==n.next;){if(l=n.prev,u=n.next,s?fue(n,i,r,s):hue(n)){e.push(l.i/t|0),e.push(n.i/t|0),e.push(u.i/t|0),M1(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=due(Id(n),e,t),T1(n,e,t,i,r,s,2)):o===2&&pue(n,e,t,i,r,s):T1(Id(n),e,t,i,r,s,1);break}}}function hue(n){const e=n.prev,t=n,i=n.next;if(nr(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,c=r<s?r<o?r:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,A=r>s?r>o?r:o:s>o?s:o,v=a>l?a>u?a:u:l>u?l:u;let _=i.next;for(;_!==e;){if(_.x>=c&&_.x<=A&&_.y>=h&&_.y<=v&&_A(r,a,s,l,o,u,_.x,_.y)&&nr(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function fue(n,e,t,i){const r=n.prev,s=n,o=n.next;if(nr(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,c=r.y,h=s.y,A=o.y,v=a<l?a<u?a:u:l<u?l:u,_=c<h?c<A?c:A:h<A?h:A,S=a>l?a>u?a:u:l>u?l:u,w=c>h?c>A?c:A:h>A?h:A,x=a4(v,_,e,t,i),M=a4(S,w,e,t,i);let R=n.prevZ,N=n.nextZ;for(;R&&R.z>=x&&N&&N.z<=M;){if(R.x>=v&&R.x<=S&&R.y>=_&&R.y<=w&&R!==r&&R!==o&&_A(a,c,l,h,u,A,R.x,R.y)&&nr(R.prev,R,R.next)>=0||(R=R.prevZ,N.x>=v&&N.x<=S&&N.y>=_&&N.y<=w&&N!==r&&N!==o&&_A(a,c,l,h,u,A,N.x,N.y)&&nr(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;R&&R.z>=x;){if(R.x>=v&&R.x<=S&&R.y>=_&&R.y<=w&&R!==r&&R!==o&&_A(a,c,l,h,u,A,R.x,R.y)&&nr(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;N&&N.z<=M;){if(N.x>=v&&N.x<=S&&N.y>=_&&N.y<=w&&N!==r&&N!==o&&_A(a,c,l,h,u,A,N.x,N.y)&&nr(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function due(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!ew(r,s)&&sG(r,i,i.next,s)&&C1(r,s)&&C1(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),M1(i),M1(i.next),i=n=s),i=i.next}while(i!==n);return Id(i)}function pue(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Sue(o,a)){let l=oG(o,a);o=Id(o,o.next),l=Id(l,l.next),T1(o,e,t,i,r,s,0),T1(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function Aue(n,e,t,i){const r=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=rG(n,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(bue(u));for(r.sort(mue),s=0;s<r.length;s++)t=gue(r[s],t);return t}function mue(n,e){return n.x-e.x}function gue(n,e){const t=vue(n,e);if(!t)return e;const i=oG(t,n);return Id(i,i.next),Id(t,t.next)}function vue(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const A=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(A<=s&&A>i&&(i=A,r=t.x<t.next.x?t:t.next,A===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,l=r.x,u=r.y;let c=1/0,h;t=r;do s>=t.x&&t.x>=l&&s!==t.x&&_A(o<u?s:i,o,l,u,o<u?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),C1(t,n)&&(h<c||h===c&&(t.x>r.x||t.x===r.x&&yue(r,t)))&&(r=t,c=h)),t=t.next;while(t!==a);return r}function yue(n,e){return nr(n.prev,n,e.prev)<0&&nr(e.next,n,n.next)<0}function _ue(n,e,t,i){let r=n;do r.z===0&&(r.z=a4(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,xue(r)}function xue(n){let e,t,i,r,s,o,a,l,u=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,u*=2}while(o>1);return n}function a4(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function bue(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function _A(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Sue(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!wue(n,e)&&(C1(n,e)&&C1(e,n)&&Eue(n,e)&&(nr(n.prev,n,e.prev)||nr(n,e.prev,e))||ew(n,e)&&nr(n.prev,n,n.next)>0&&nr(e.prev,e,e.next)>0)}function nr(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function ew(n,e){return n.x===e.x&&n.y===e.y}function sG(n,e,t,i){const r=n_(nr(n,e,t)),s=n_(nr(n,e,i)),o=n_(nr(t,i,n)),a=n_(nr(t,i,e));return!!(r!==s&&o!==a||r===0&&t_(n,t,e)||s===0&&t_(n,i,e)||o===0&&t_(t,n,i)||a===0&&t_(t,e,i))}function t_(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function n_(n){return n>0?1:n<0?-1:0}function wue(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&sG(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function C1(n,e){return nr(n.prev,n,n.next)<0?nr(n,e,n.next)>=0&&nr(n,n.prev,e)>=0:nr(n,e,n.prev)<0||nr(n,n.next,e)<0}function Eue(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function oG(n,e){const t=new l4(n.i,n.x,n.y),i=new l4(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function Lk(n,e,t,i){const r=new l4(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function M1(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function l4(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Tue(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class $A{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return $A.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];Fk(e),Bk(i,e);let o=e.length;t.forEach(Fk);for(let l=0;l<t.length;l++)r.push(o),o+=t[l].length,Bk(i,t[l]);const a=cue.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Fk(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function Bk(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class e6 extends ur{constructor(e=new O2([new rt(.5,.5),new rt(-.5,.5),new rt(-.5,-.5),new rt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new si(r,3)),this.setAttribute("uv",new si(s,2)),this.computeVertexNormals();function o(a){const l=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1;let A=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,_=t.bevelSize!==void 0?t.bevelSize:v-.1,S=t.bevelOffset!==void 0?t.bevelOffset:0,w=t.bevelSegments!==void 0?t.bevelSegments:3;const x=t.extrudePath,M=t.UVGenerator!==void 0?t.UVGenerator:Cue;let R,N=!1,B,T,D,F;x&&(R=x.getSpacedPoints(c),N=!0,A=!1,B=x.computeFrenetFrames(c,!1),T=new le,D=new le,F=new le),A||(w=0,v=0,_=0,S=0);const L=a.extractPoints(u);let O=L.shape;const z=L.holes;if(!$A.isClockWise(O)){O=O.reverse();for(let Ze=0,at=z.length;Ze<at;Ze++){const ue=z[Ze];$A.isClockWise(ue)&&(z[Ze]=ue.reverse())}}const j=$A.triangulateShape(O,z),ee=O;for(let Ze=0,at=z.length;Ze<at;Ze++){const ue=z[Ze];O=O.concat(ue)}function $(Ze,at,ue){return at||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ze.clone().addScaledVector(at,ue)}const Z=O.length,ce=j.length;function ie(Ze,at,ue){let zt,st,xt;const ht=Ze.x-at.x,Yt=Ze.y-at.y,Nt=ue.x-Ze.x,re=ue.y-Ze.y,W=ht*ht+Yt*Yt,Ne=ht*re-Yt*Nt;if(Math.abs(Ne)>Number.EPSILON){const He=Math.sqrt(W),et=Math.sqrt(Nt*Nt+re*re),Be=at.x-Yt/He,It=at.y+ht/He,ut=ue.x-re/et,Dt=ue.y+Nt/et,_n=((ut-Be)*re-(Dt-It)*Nt)/(ht*re-Yt*Nt);zt=Be+ht*_n-Ze.x,st=It+Yt*_n-Ze.y;const ke=zt*zt+st*st;if(ke<=2)return new rt(zt,st);xt=Math.sqrt(ke/2)}else{let He=!1;ht>Number.EPSILON?Nt>Number.EPSILON&&(He=!0):ht<-Number.EPSILON?Nt<-Number.EPSILON&&(He=!0):Math.sign(Yt)===Math.sign(re)&&(He=!0),He?(zt=-Yt,st=ht,xt=Math.sqrt(W)):(zt=ht,st=Yt,xt=Math.sqrt(W/2))}return new rt(zt/xt,st/xt)}const oe=[];for(let Ze=0,at=ee.length,ue=at-1,zt=Ze+1;Ze<at;Ze++,ue++,zt++)ue===at&&(ue=0),zt===at&&(zt=0),oe[Ze]=ie(ee[Ze],ee[ue],ee[zt]);const me=[];let _e,Oe=oe.concat();for(let Ze=0,at=z.length;Ze<at;Ze++){const ue=z[Ze];_e=[];for(let zt=0,st=ue.length,xt=st-1,ht=zt+1;zt<st;zt++,xt++,ht++)xt===st&&(xt=0),ht===st&&(ht=0),_e[zt]=ie(ue[zt],ue[xt],ue[ht]);me.push(_e),Oe=Oe.concat(_e)}for(let Ze=0;Ze<w;Ze++){const at=Ze/w,ue=v*Math.cos(at*Math.PI/2),zt=_*Math.sin(at*Math.PI/2)+S;for(let st=0,xt=ee.length;st<xt;st++){const ht=$(ee[st],oe[st],zt);tt(ht.x,ht.y,-ue)}for(let st=0,xt=z.length;st<xt;st++){const ht=z[st];_e=me[st];for(let Yt=0,Nt=ht.length;Yt<Nt;Yt++){const re=$(ht[Yt],_e[Yt],zt);tt(re.x,re.y,-ue)}}}const Ke=_+S;for(let Ze=0;Ze<Z;Ze++){const at=A?$(O[Ze],Oe[Ze],Ke):O[Ze];N?(D.copy(B.normals[0]).multiplyScalar(at.x),T.copy(B.binormals[0]).multiplyScalar(at.y),F.copy(R[0]).add(D).add(T),tt(F.x,F.y,F.z)):tt(at.x,at.y,0)}for(let Ze=1;Ze<=c;Ze++)for(let at=0;at<Z;at++){const ue=A?$(O[at],Oe[at],Ke):O[at];N?(D.copy(B.normals[Ze]).multiplyScalar(ue.x),T.copy(B.binormals[Ze]).multiplyScalar(ue.y),F.copy(R[Ze]).add(D).add(T),tt(F.x,F.y,F.z)):tt(ue.x,ue.y,h/c*Ze)}for(let Ze=w-1;Ze>=0;Ze--){const at=Ze/w,ue=v*Math.cos(at*Math.PI/2),zt=_*Math.sin(at*Math.PI/2)+S;for(let st=0,xt=ee.length;st<xt;st++){const ht=$(ee[st],oe[st],zt);tt(ht.x,ht.y,h+ue)}for(let st=0,xt=z.length;st<xt;st++){const ht=z[st];_e=me[st];for(let Yt=0,Nt=ht.length;Yt<Nt;Yt++){const re=$(ht[Yt],_e[Yt],zt);N?tt(re.x,re.y+R[c-1].y,R[c-1].x+ue):tt(re.x,re.y,h+ue)}}}Me(),ze();function Me(){const Ze=r.length/3;if(A){let at=0,ue=Z*at;for(let zt=0;zt<ce;zt++){const st=j[zt];Ot(st[2]+ue,st[1]+ue,st[0]+ue)}at=c+w*2,ue=Z*at;for(let zt=0;zt<ce;zt++){const st=j[zt];Ot(st[0]+ue,st[1]+ue,st[2]+ue)}}else{for(let at=0;at<ce;at++){const ue=j[at];Ot(ue[2],ue[1],ue[0])}for(let at=0;at<ce;at++){const ue=j[at];Ot(ue[0]+Z*c,ue[1]+Z*c,ue[2]+Z*c)}}i.addGroup(Ze,r.length/3-Ze,0)}function ze(){const Ze=r.length/3;let at=0;nt(ee,at),at+=ee.length;for(let ue=0,zt=z.length;ue<zt;ue++){const st=z[ue];nt(st,at),at+=st.length}i.addGroup(Ze,r.length/3-Ze,1)}function nt(Ze,at){let ue=Ze.length;for(;--ue>=0;){const zt=ue;let st=ue-1;st<0&&(st=Ze.length-1);for(let xt=0,ht=c+w*2;xt<ht;xt++){const Yt=Z*xt,Nt=Z*(xt+1),re=at+zt+Yt,W=at+st+Yt,Ne=at+st+Nt,He=at+zt+Nt;Ht(re,W,Ne,He)}}}function tt(Ze,at,ue){l.push(Ze),l.push(at),l.push(ue)}function Ot(Ze,at,ue){Ct(Ze),Ct(at),Ct(ue);const zt=r.length/3,st=M.generateTopUV(i,r,zt-3,zt-2,zt-1);en(st[0]),en(st[1]),en(st[2])}function Ht(Ze,at,ue,zt){Ct(Ze),Ct(at),Ct(zt),Ct(at),Ct(ue),Ct(zt);const st=r.length/3,xt=M.generateSideWallUV(i,r,st-6,st-3,st-2,st-1);en(xt[0]),en(xt[1]),en(xt[3]),en(xt[1]),en(xt[2]),en(xt[3])}function Ct(Ze){r.push(l[Ze*3+0]),r.push(l[Ze*3+1]),r.push(l[Ze*3+2])}function en(Ze){s.push(Ze.x),s.push(Ze.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return Mue(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Ux[r.type]().fromJSON(r)),new e6(i,e.options)}}const Cue={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],l=e[i*3+1],u=e[r*3],c=e[r*3+1];return[new rt(s,o),new rt(a,l),new rt(u,c)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],l=e[t*3+2],u=e[i*3],c=e[i*3+1],h=e[i*3+2],A=e[r*3],v=e[r*3+1],_=e[r*3+2],S=e[s*3],w=e[s*3+1],x=e[s*3+2];return Math.abs(a-c)<Math.abs(o-u)?[new rt(o,1-l),new rt(u,1-h),new rt(A,1-_),new rt(S,1-x)]:[new rt(a,1-l),new rt(c,1-h),new rt(v,1-_),new rt(w,1-x)]}};function Mue(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}let Ev=class aG extends ur{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let u=0;const c=[],h=new le,A=new le,v=[],_=[],S=[],w=[];for(let x=0;x<=i;x++){const M=[],R=x/i;let N=0;x===0&&o===0?N=.5/t:x===i&&l===Math.PI&&(N=-.5/t);for(let B=0;B<=t;B++){const T=B/t;h.x=-e*Math.cos(r+T*s)*Math.sin(o+R*a),h.y=e*Math.cos(o+R*a),h.z=e*Math.sin(r+T*s)*Math.sin(o+R*a),_.push(h.x,h.y,h.z),A.copy(h).normalize(),S.push(A.x,A.y,A.z),w.push(T+N,1-R),M.push(u++)}c.push(M)}for(let x=0;x<i;x++)for(let M=0;M<t;M++){const R=c[x][M+1],N=c[x][M],B=c[x+1][M],T=c[x+1][M+1];(x!==0||o>0)&&v.push(R,N,T),(x!==i-1||l<Math.PI)&&v.push(N,B,T)}this.setIndex(v),this.setAttribute("position",new si(_,3)),this.setAttribute("normal",new si(S,3)),this.setAttribute("uv",new si(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new aG(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}};class t6 extends ur{constructor(e=new ZP(new le(-1,-1,0),new le(-1,1,0),new le(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new le,l=new le,u=new rt;let c=new le;const h=[],A=[],v=[],_=[];S(),this.setIndex(_),this.setAttribute("position",new si(h,3)),this.setAttribute("normal",new si(A,3)),this.setAttribute("uv",new si(v,2));function S(){for(let R=0;R<t;R++)w(R);w(s===!1?t:0),M(),x()}function w(R){c=e.getPointAt(R/t,c);const N=o.normals[R],B=o.binormals[R];for(let T=0;T<=r;T++){const D=T/r*Math.PI*2,F=Math.sin(D),L=-Math.cos(D);l.x=L*N.x+F*B.x,l.y=L*N.y+F*B.y,l.z=L*N.z+F*B.z,l.normalize(),A.push(l.x,l.y,l.z),a.x=c.x+i*l.x,a.y=c.y+i*l.y,a.z=c.z+i*l.z,h.push(a.x,a.y,a.z)}}function x(){for(let R=1;R<=t;R++)for(let N=1;N<=r;N++){const B=(r+1)*(R-1)+(N-1),T=(r+1)*R+(N-1),D=(r+1)*R+N,F=(r+1)*(R-1)+N;_.push(B,T,F),_.push(T,D,F)}}function M(){for(let R=0;R<=t;R++)for(let N=0;N<=r;N++)u.x=R/t,u.y=N/r,v.push(u.x,u.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new t6(new Ux[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Rue extends ur{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new le,s=new le;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,c=l.length;u<c;++u){const h=l[u],A=h.start,v=h.count;for(let _=A,S=A+v;_<S;_+=3)for(let w=0;w<3;w++){const x=a.getX(_+w),M=a.getX(_+(w+1)%3);r.fromBufferAttribute(o,x),s.fromBufferAttribute(o,M),Ok(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const c=3*a+u,h=3*a+(u+1)%3;r.fromBufferAttribute(o,c),s.fromBufferAttribute(o,h),Ok(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new si(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Ok(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}let Pue=class extends ep{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new fn(16777215),this.specular=new fn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=HP,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.combine=qS,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},df=class extends ep{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new fn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new fn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=HP,this.normalScale=new rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new la,this.combine=qS,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};const Uk={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Nue{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(c){a++,s===!1&&r.onStart!==void 0&&r.onStart(c,o,a),s=!0},this.itemEnd=function(c){o++,r.onProgress!==void 0&&r.onProgress(c,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(c){r.onError!==void 0&&r.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,A=u.length;h<A;h+=2){const v=u[h],_=u[h+1];if(v.global&&(v.lastIndex=0),v.test(c))return _}return null}}}const Iue=new Nue;class n6{constructor(e){this.manager=e!==void 0?e:Iue,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}n6.DEFAULT_MATERIAL_NAME="__DEFAULT";class Due extends n6{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Uk.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=E1("img");function l(){c(),Uk.add(e,this),t&&t(this),s.manager.itemEnd(e)}function u(h){c(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class lG extends n6{constructor(e){super(e)}load(e,t,i,r){const s=new Il,o=new Due(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}let uG=class extends Fs{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new fn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}};const y3=new ki,zk=new le,Vk=new le;let kue=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new rt(512,512),this.map=null,this.mapPass=null,this.matrix=new ki,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new WP,this._frameExtents=new rt(1,1),this._viewportCount=1,this._viewports=[new Ui(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;zk.setFromMatrixPosition(e.matrixWorld),t.position.copy(zk),Vk.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Vk),t.updateMatrixWorld(),y3.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(y3),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(y3)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Lue=class extends kue{constructor(){super(new XP(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Fue=class extends uG{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Fs.DEFAULT_UP),this.updateMatrix(),this.target=new Fs,this.shadow=new Lue}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Bue=class extends uG{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};class Oue extends ur{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class cG{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Gk(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Gk();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Gk(){return performance.now()}let u4=class extends YV{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}};const qk=new ki;class Uue{constructor(e,t,i=0,r=1/0){this.ray=new jS(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new jP,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return qk.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(qk),this}intersectObject(e,t=!0,i=[]){return c4(e,this,i,t),i.sort(Hk),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)c4(e[r],this,i,t);return i.sort(Hk),i}}function Hk(n,e){return n.distance-e.distance}function c4(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&i===!0){const s=n.children;for(let o=0,a=s.length;o<a;o++)c4(s[o],e,t,!0)}}class h4{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Lr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const $k=new le,i_=new le;class zue{constructor(e=new le,t=new le){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){$k.subVectors(e,this.start),i_.subVectors(this.end,this.start);const i=i_.dot(i_);let s=i_.dot($k)/i;return t&&(s=Lr(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}class Vue{constructor(){this.type="ShapePath",this.color=new fn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new o4,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(x){const M=[];for(let R=0,N=x.length;R<N;R++){const B=x[R],T=new O2;T.curves=B.curves,M.push(T)}return M}function i(x,M){const R=M.length;let N=!1;for(let B=R-1,T=0;T<R;B=T++){let D=M[B],F=M[T],L=F.x-D.x,O=F.y-D.y;if(Math.abs(O)>Number.EPSILON){if(O<0&&(D=M[T],L=-L,F=M[B],O=-O),x.y<D.y||x.y>F.y)continue;if(x.y===D.y){if(x.x===D.x)return!0}else{const z=O*(x.x-D.x)-L*(x.y-D.y);if(z===0)return!0;if(z<0)continue;N=!N}}else{if(x.y!==D.y)continue;if(F.x<=x.x&&x.x<=D.x||D.x<=x.x&&x.x<=F.x)return!0}}return N}const r=$A.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new O2,l.curves=a.curves,u.push(l),u;let c=!r(s[0].getPoints());c=e?!c:c;const h=[],A=[];let v=[],_=0,S;A[_]=void 0,v[_]=[];for(let x=0,M=s.length;x<M;x++)a=s[x],S=a.getPoints(),o=r(S),o=e?!o:o,o?(!c&&A[_]&&_++,A[_]={s:new O2,p:S},A[_].s.curves=a.curves,c&&_++,v[_]=[]):v[_].push({h:a,p:S[0]});if(!A[0])return t(s);if(A.length>1){let x=!1,M=0;for(let R=0,N=A.length;R<N;R++)h[R]=[];for(let R=0,N=A.length;R<N;R++){const B=v[R];for(let T=0;T<B.length;T++){const D=B[T];let F=!0;for(let L=0;L<A.length;L++)i(D.p,A[L].p)&&(R!==L&&M++,F?(F=!1,h[L].push(D)):x=!0);F&&h[R].push(D)}}M>0&&x===!1&&(v=h)}let w;for(let x=0,M=A.length;x<M;x++){l=A[x].s,u.push(l),w=v[x];for(let R=0,N=w.length;R<N;R++)l.holes.push(w[R].h)}return u}}class i6 extends ff{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:GS}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=GS);class Gue extends Fs{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new rt(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const Np=new le,jk=new ki,Wk=new ki,Xk=new le,Yk=new le;class que{constructor(e={}){const t=this;let i,r,s,o;const a={objects:new WeakMap},l=e.element!==void 0?e.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l,this.getSize=function(){return{width:i,height:r}},this.render=function(_,S){_.matrixWorldAutoUpdate===!0&&_.updateMatrixWorld(),S.parent===null&&S.matrixWorldAutoUpdate===!0&&S.updateMatrixWorld(),jk.copy(S.matrixWorldInverse),Wk.multiplyMatrices(S.projectionMatrix,jk),c(_,_,S),v(_)},this.setSize=function(_,S){i=_,r=S,s=i/2,o=r/2,l.style.width=_+"px",l.style.height=S+"px"};function u(_){_.isCSS2DObject&&(_.element.style.display="none");for(let S=0,w=_.children.length;S<w;S++)u(_.children[S])}function c(_,S,w){if(_.visible===!1){u(_);return}if(_.isCSS2DObject){Np.setFromMatrixPosition(_.matrixWorld),Np.applyMatrix4(Wk);const x=Np.z>=-1&&Np.z<=1&&_.layers.test(w.layers)===!0,M=_.element;M.style.display=x===!0?"":"none",x===!0&&(_.onBeforeRender(t,S,w),M.style.transform="translate("+-100*_.center.x+"%,"+-100*_.center.y+"%)translate("+(Np.x*s+s)+"px,"+(-Np.y*o+o)+"px)",M.parentNode!==l&&l.appendChild(M),_.onAfterRender(t,S,w));const R={distanceToCameraSquared:h(w,_)};a.objects.set(_,R)}for(let x=0,M=_.children.length;x<M;x++)c(_.children[x],S,w)}function h(_,S){return Xk.setFromMatrixPosition(_.matrixWorld),Yk.setFromMatrixPosition(S.matrixWorld),Xk.distanceToSquared(Yk)}function A(_){const S=[];return _.traverseVisible(function(w){w.isCSS2DObject&&S.push(w)}),S}function v(_){const S=A(_).sort(function(x,M){if(x.renderOrder!==M.renderOrder)return M.renderOrder-x.renderOrder;const R=a.objects.get(x).distanceToCameraSquared,N=a.objects.get(M).distanceToCameraSquared;return R-N}),w=S.length;for(let x=0,M=S.length;x<M;x++)S[x].element.style.zIndex=w-x}}}function f4(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Hue=typeof global=="object"&&global&&global.Object===Object&&global,$ue=typeof self=="object"&&self&&self.Object===Object&&self,hG=Hue||$ue||Function("return this")(),_3=function(){return hG.Date.now()},jue=/\s/;function Wue(n){for(var e=n.length;e--&&jue.test(n.charAt(e)););return e}var Xue=/^\s+/;function Yue(n){return n&&n.slice(0,Wue(n)+1).replace(Xue,"")}var zx=hG.Symbol,fG=Object.prototype,Que=fG.hasOwnProperty,Kue=fG.toString,Um=zx?zx.toStringTag:void 0;function Zue(n){var e=Que.call(n,Um),t=n[Um];try{n[Um]=void 0;var i=!0}catch{}var r=Kue.call(n);return i&&(e?n[Um]=t:delete n[Um]),r}var Jue=Object.prototype,ece=Jue.toString;function tce(n){return ece.call(n)}var nce="[object Null]",ice="[object Undefined]",Qk=zx?zx.toStringTag:void 0;function rce(n){return n==null?n===void 0?ice:nce:Qk&&Qk in Object(n)?Zue(n):tce(n)}function sce(n){return n!=null&&typeof n=="object"}var oce="[object Symbol]";function ace(n){return typeof n=="symbol"||sce(n)&&rce(n)==oce}var Kk=NaN,lce=/^[-+]0x[0-9a-f]+$/i,uce=/^0b[01]+$/i,cce=/^0o[0-7]+$/i,hce=parseInt;function Zk(n){if(typeof n=="number")return n;if(ace(n))return Kk;if(f4(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=f4(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=Yue(n);var t=uce.test(n);return t||cce.test(n)?hce(n.slice(2),t?2:8):lce.test(n)?Kk:+n}var fce="Expected a function",dce=Math.max,pce=Math.min;function Ace(n,e,t){var i,r,s,o,a,l,u=0,c=!1,h=!1,A=!0;if(typeof n!="function")throw new TypeError(fce);e=Zk(e)||0,f4(t)&&(c=!!t.leading,h="maxWait"in t,s=h?dce(Zk(t.maxWait)||0,e):s,A="trailing"in t?!!t.trailing:A);function v(T){var D=i,F=r;return i=r=void 0,u=T,o=n.apply(F,D),o}function _(T){return u=T,a=setTimeout(x,e),c?v(T):o}function S(T){var D=T-l,F=T-u,L=e-D;return h?pce(L,s-F):L}function w(T){var D=T-l,F=T-u;return l===void 0||D>=e||D<0||h&&F>=s}function x(){var T=_3();if(w(T))return M(T);a=setTimeout(x,S(T))}function M(T){return a=void 0,A&&i?v(T):(i=r=void 0,o)}function R(){a!==void 0&&clearTimeout(a),u=0,i=l=r=a=void 0}function N(){return a===void 0?o:M(_3())}function B(){var T=_3(),D=w(T);if(i=arguments,r=this,l=T,D){if(a===void 0)return _(l);if(h)return clearTimeout(a),a=setTimeout(x,e),v(l)}return a===void 0&&(a=setTimeout(x,e)),o}return B.cancel=R,B.flush=N,B}function Jk(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function mce(n){if(Array.isArray(n))return n}function gce(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function vce(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function yce(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function _ce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xce(n,e){return mce(n)||yce(n,e)||bce(n,e)||_ce()}function bce(n,e){if(n){if(typeof n=="string")return Jk(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Jk(n,e):void 0}}var Sce=vce(function n(e,t){var i=t.default,r=i===void 0?null:i,s=t.triggerUpdate,o=s===void 0?!0:s,a=t.onChange,l=a===void 0?function(u,c){}:a;gce(this,n),this.name=e,this.defaultVal=r,this.triggerUpdate=o,this.onChange=l});function hs(n){var e=n.stateInit,t=e===void 0?function(){return{}}:e,i=n.props,r=i===void 0?{}:i,s=n.methods,o=s===void 0?{}:s,a=n.aliases,l=a===void 0?{}:a,u=n.init,c=u===void 0?function(){}:u,h=n.update,A=h===void 0?function(){}:h,v=Object.keys(r).map(function(_){return new Sce(_,r[_])});return function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=Object.assign({},t instanceof Function?t(_):t,{initialised:!1}),w={};function x(N){return M(N,_),R(),x}var M=function(B,T){c.call(x,B,S,T),S.initialised=!0},R=Ace(function(){S.initialised&&(A.call(x,S,w),w={})},1);return v.forEach(function(N){x[N.name]=B(N);function B(T){var D=T.name,F=T.triggerUpdate,L=F===void 0?!1:F,O=T.onChange,z=O===void 0?function(ee,$){}:O,Q=T.defaultVal,j=Q===void 0?null:Q;return function(ee){var $=S[D];if(!arguments.length)return $;var Z=ee===void 0?j:ee;return S[D]=Z,z.call(x,Z,S,$),!w.hasOwnProperty(D)&&(w[D]=$),L&&R(),x}}}),Object.keys(o).forEach(function(N){x[N]=function(){for(var B,T=arguments.length,D=new Array(T),F=0;F<T;F++)D[F]=arguments[F];return(B=o[N]).call.apply(B,[x,S].concat(D))}}),Object.entries(l).forEach(function(N){var B=xce(N,2),T=B[0],D=B[1];return x[T]=x[D]}),x.resetProps=function(){return v.forEach(function(N){x[N.name](N.defaultVal)}),x},x.resetProps(),S._rerender=R,x}}var Rr=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return n},Out:function(n){return n},InOut:function(n){return n}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-Rr.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?Rr.Bounce.In(n*2)*.5:Rr.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),mg=function(){return performance.now()},tw=function(){function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,e)}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var r=0,s=t;r<s.length;r++){var o=s[r];(e=o._group)===null||e===void 0||e.remove(o),o._group=this,this._tweens[o.getId()]=o,this._tweensAddedDuringUpdate[o.getId()]=o}},n.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=0,r=e;i<r.length;i++){var s=r[i];s._group=void 0,delete this._tweens[s.getId()],delete this._tweensAddedDuringUpdate[s.getId()]}},n.prototype.allStopped=function(){return this.getAll().every(function(e){return!e.isPlaying()})},n.prototype.update=function(e,t){e===void 0&&(e=mg()),t===void 0&&(t=!0);var i=Object.keys(this._tweens);if(i.length!==0)for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<i.length;r++){var s=this._tweens[i[r]],o=!t;s&&s.update(e,o)===!1&&!t&&this.remove(s)}i=Object.keys(this._tweensAddedDuringUpdate)}},n}(),xA={Linear:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=xA.Utils.Linear;return e<0?s(n[0],n[1],i):e>1?s(n[t],n[t-1],t-i):s(n[r],n[r+1>t?t:r+1],i-r)},Bezier:function(n,e){for(var t=0,i=n.length-1,r=Math.pow,s=xA.Utils.Bernstein,o=0;o<=i;o++)t+=r(1-e,i-o)*r(e,o)*n[o]*s(i,o);return t},CatmullRom:function(n,e){var t=n.length-1,i=t*e,r=Math.floor(i),s=xA.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(r=Math.floor(i=t*(1+e))),s(n[(r-1+t)%t],n[r],n[(r+1)%t],n[(r+2)%t],i-r)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-i)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],i-t)-n[t]):s(n[r?r-1:0],n[r],n[t<r+1?t:r+1],n[t<r+2?t:r+2],i-r)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=xA.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var i=e;i>1;i--)t*=i;return n[e]=t,t}}(),CatmullRom:function(n,e,t,i,r){var s=(t-n)*.5,o=(i-e)*.5,a=r*r,l=r*a;return(2*e-2*t+s+o)*l+(-3*e+3*t-2*s-o)*a+s*r+e}}},wce=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),d4=new tw,Bs=function(){function n(e,t){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=Rr.Linear.None,this._interpolationFunction=xA.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=wce.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=e,typeof t=="object"?(this._group=t,t.add(this)):t===!0&&(this._group=d4,d4.add(this))}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=mg()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var s in this._valuesEnd)r[s]=this._valuesEnd[s];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,i,r,s){for(var o in i){var a=e[o],l=Array.isArray(a),u=l?"array":typeof a,c=!l&&Array.isArray(i[o]);if(!(u==="undefined"||u==="function")){if(c){var h=i[o];if(h.length===0)continue;for(var A=[a],v=0,_=h.length;v<_;v+=1){var S=this._handleRelativeValue(a,h[v]);if(isNaN(S)){c=!1,console.warn("Found invalid interpolation list. Skipping.");break}A.push(S)}c&&(i[o]=A)}if((u==="object"||l)&&a&&!c){t[o]=l?[]:{};var w=a;for(var x in w)t[o][x]=w[x];r[o]=l?[]:{};var h=i[o];if(!this._isDynamic){var M={};for(var x in h)M[x]=h[x];i[o]=h=M}this._setupProperties(w,t[o],h,r[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=a),l||(t[o]*=1),c?r[o]=i[o].slice().reverse():r[o]=t[o]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},n.prototype.pause=function(e){return e===void 0&&(e=mg()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this)},n.prototype.resume=function(e){return e===void 0&&(e=mg()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e?(e.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},n.prototype.remove=function(){var e;return(e=this._group)===null||e===void 0||e.remove(this),this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=Rr.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=xA.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var i=this,r;if(e===void 0&&(e=mg()),t===void 0&&(t=n.autoStartOnUpdate),this._isPaused)return!0;var s;if(!this._goToEnd&&!this._isPlaying)if(t)this.start(e,!0);else return!1;if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var o=e-this._startTime,a=this._duration+((r=this._repeatDelayTime)!==null&&r!==void 0?r:this._delayTime),l=this._duration+this._repeat*a,u=function(){if(i._duration===0||o>l)return 1;var S=Math.trunc(o/a),w=o-S*a,x=Math.min(w/i._duration,1);return x===0&&o===i._duration?1:x},c=u(),h=this._easingFunction(c);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,h),this._onUpdateCallback&&this._onUpdateCallback(this._object,c),this._duration===0||o>=this._duration)if(this._repeat>0){var A=Math.min(Math.trunc((o-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=A);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*A,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var v=0,_=this._chainedTweens.length;v<_;v++)this._chainedTweens[v].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,i,r){for(var s in i)if(t[s]!==void 0){var o=t[s]||0,a=i[s],l=Array.isArray(e[s]),u=Array.isArray(a),c=!l&&u;c?e[s]=this._interpolationFunction(a,r):typeof a=="object"&&a?this._updateProperties(e[s],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(e[s]=o+(a-o)*r))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],i=this._valuesEnd[e];typeof i=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(i):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n.autoStartOnUpdate=!1,n}(),iu=d4;iu.getAll.bind(iu);iu.removeAll.bind(iu);iu.add.bind(iu);iu.remove.bind(iu);iu.update.bind(iu);function Ece(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=dG(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u;if(i&&(s=Pce(n,e,s,t)),n.length>80*t){a=1/0,l=1/0;let c=-1/0,h=-1/0;for(let A=t;A<r;A+=t){const v=n[A],_=n[A+1];v<a&&(a=v),_<l&&(l=_),v>c&&(c=v),_>h&&(h=_)}u=Math.max(c-a,h-l),u=u!==0?32767/u:0}return R1(s,o,t,a,l,u,0),o}function dG(n,e,t,i,r){let s;if(r===Vce(n,e,t,i)>0)for(let o=e;o<t;o+=i)s=eL(o/i|0,n[o],n[o+1],s);else for(let o=t-i;o>=e;o-=i)s=eL(o/i|0,n[o],n[o+1],s);return s&&nw(s,s.next)&&(N1(s),s=s.next),s}function Dd(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(nw(t,t.next)||ir(t.prev,t,t.next)===0)){if(N1(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function R1(n,e,t,i,r,s,o){if(!n)return;!o&&s&&Lce(n,i,r,s);let a=n;for(;n.prev!==n.next;){const l=n.prev,u=n.next;if(s?Cce(n,i,r,s):Tce(n)){e.push(l.i,n.i,u.i),N1(n),n=u.next,a=u.next;continue}if(n=u,n===a){o?o===1?(n=Mce(Dd(n),e),R1(n,e,t,i,r,s,2)):o===2&&Rce(n,e,t,i,r,s):R1(Dd(n),e,t,i,r,s,1);break}}}function Tce(n){const e=n.prev,t=n,i=n.next;if(ir(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,l=t.y,u=i.y,c=r<s?r<o?r:o:s<o?s:o,h=a<l?a<u?a:u:l<u?l:u,A=r>s?r>o?r:o:s>o?s:o,v=a>l?a>u?a:u:l>u?l:u;let _=i.next;for(;_!==e;){if(_.x>=c&&_.x<=A&&_.y>=h&&_.y<=v&&bA(r,a,s,l,o,u,_.x,_.y)&&ir(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function Cce(n,e,t,i){const r=n.prev,s=n,o=n.next;if(ir(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,c=r.y,h=s.y,A=o.y,v=a<l?a<u?a:u:l<u?l:u,_=c<h?c<A?c:A:h<A?h:A,S=a>l?a>u?a:u:l>u?l:u,w=c>h?c>A?c:A:h>A?h:A,x=p4(v,_,e,t,i),M=p4(S,w,e,t,i);let R=n.prevZ,N=n.nextZ;for(;R&&R.z>=x&&N&&N.z<=M;){if(R.x>=v&&R.x<=S&&R.y>=_&&R.y<=w&&R!==r&&R!==o&&bA(a,c,l,h,u,A,R.x,R.y)&&ir(R.prev,R,R.next)>=0||(R=R.prevZ,N.x>=v&&N.x<=S&&N.y>=_&&N.y<=w&&N!==r&&N!==o&&bA(a,c,l,h,u,A,N.x,N.y)&&ir(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;R&&R.z>=x;){if(R.x>=v&&R.x<=S&&R.y>=_&&R.y<=w&&R!==r&&R!==o&&bA(a,c,l,h,u,A,R.x,R.y)&&ir(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;N&&N.z<=M;){if(N.x>=v&&N.x<=S&&N.y>=_&&N.y<=w&&N!==r&&N!==o&&bA(a,c,l,h,u,A,N.x,N.y)&&ir(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function Mce(n,e){let t=n;do{const i=t.prev,r=t.next.next;!nw(i,r)&&pG(i,t,t.next,r)&&P1(i,r)&&P1(r,i)&&(e.push(i.i,t.i,r.i),N1(t),N1(t.next),t=n=r),t=t.next}while(t!==n);return Dd(t)}function Rce(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Oce(o,a)){let l=AG(o,a);o=Dd(o,o.next),l=Dd(l,l.next),R1(o,e,t,i,r,s,0),R1(l,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function Pce(n,e,t,i){const r=[];for(let s=0,o=e.length;s<o;s++){const a=e[s]*i,l=s<o-1?e[s+1]*i:n.length,u=dG(n,a,l,i,!1);u===u.next&&(u.steiner=!0),r.push(Bce(u))}r.sort(Nce);for(let s=0;s<r.length;s++)t=Ice(r[s],t);return t}function Nce(n,e){return n.x-e.x}function Ice(n,e){const t=Dce(n,e);if(!t)return e;const i=AG(t,n);return Dd(i,i.next),Dd(t,t.next)}function Dce(n,e){let t=e;const i=n.x,r=n.y;let s=-1/0,o;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const h=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=i&&h>s&&(s=h,o=t.x<t.next.x?t:t.next,h===i))return o}t=t.next}while(t!==e);if(!o)return null;const a=o,l=o.x,u=o.y;let c=1/0;t=o;do{if(i>=t.x&&t.x>=l&&i!==t.x&&bA(r<u?i:s,r,l,u,r<u?s:i,r,t.x,t.y)){const h=Math.abs(r-t.y)/(i-t.x);P1(t,n)&&(h<c||h===c&&(t.x>o.x||t.x===o.x&&kce(o,t)))&&(o=t,c=h)}t=t.next}while(t!==a);return o}function kce(n,e){return ir(n.prev,n,e.prev)<0&&ir(e.next,n,n.next)<0}function Lce(n,e,t,i){let r=n;do r.z===0&&(r.z=p4(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,Fce(r)}function Fce(n){let e,t=1;do{let i=n,r;n=null;let s=null;for(e=0;i;){e++;let o=i,a=0;for(let u=0;u<t&&(a++,o=o.nextZ,!!o);u++);let l=t;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||i.z<=o.z)?(r=i,i=i.nextZ,a--):(r=o,o=o.nextZ,l--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;i=o}s.nextZ=null,t*=2}while(e>1);return n}function p4(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Bce(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function bA(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function Oce(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Uce(n,e)&&(P1(n,e)&&P1(e,n)&&zce(n,e)&&(ir(n.prev,n,e.prev)||ir(n,e.prev,e))||nw(n,e)&&ir(n.prev,n,n.next)>0&&ir(e.prev,e,e.next)>0)}function ir(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function nw(n,e){return n.x===e.x&&n.y===e.y}function pG(n,e,t,i){const r=s_(ir(n,e,t)),s=s_(ir(n,e,i)),o=s_(ir(t,i,n)),a=s_(ir(t,i,e));return!!(r!==s&&o!==a||r===0&&r_(n,t,e)||s===0&&r_(n,i,e)||o===0&&r_(t,n,i)||a===0&&r_(t,e,i))}function r_(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function s_(n){return n>0?1:n<0?-1:0}function Uce(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&pG(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function P1(n,e){return ir(n.prev,n,n.next)<0?ir(n,e,n.next)>=0&&ir(n,n.prev,e)>=0:ir(n,e,n.prev)<0||ir(n,n.next,e)<0}function zce(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function AG(n,e){const t=A4(n.i,n.x,n.y),i=A4(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function eL(n,e,t,i){const r=A4(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function N1(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function A4(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Vce(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}function Vx(n){const e=[],t=[],i=n[0][0].length;let r=0,s=0;for(const o of n){for(const a of o)for(let l=0;l<i;l++)e.push(a[l]);s&&(r+=s,t.push(r)),s=o.length}return{vertices:e,holes:t,dimensions:i}}function Tv(){return new Gx}function Gx(){this.reset()}Gx.prototype={constructor:Gx,reset:function(){this.s=this.t=0},add:function(n){tL(o_,n,this.t),tL(this,o_.s,this.s),this.s?this.t+=o_.t:this.s=o_.t},valueOf:function(){return this.s}};var o_=new Gx;function tL(n,e,t){var i=n.s=e+t,r=i-e,s=i-r;n.t=e-s+(t-r)}var mh=1e-6,Gce=1e-12,Ku=Math.PI,qx=Ku/2,Hx=Ku/4,$x=Ku*2,dd=180/Ku,Ns=Ku/180,_0=Math.abs,x0=Math.atan2,Is=Math.cos,gr=Math.sin,qce=Math.sign||function(n){return n>0?1:n<0?-1:0},jx=Math.sqrt;function r6(n){return n>1?qx:n<-1?-qx:Math.asin(n)}function nL(n){return(n=gr(n/2))*n}function ql(){}function Wx(n,e){n&&rL.hasOwnProperty(n.type)&&rL[n.type](n,e)}var iL={Feature:function(n,e){Wx(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)Wx(t[i].geometry,e)}},rL={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){m4(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)m4(t[i],e,0)},Polygon:function(n,e){sL(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)sL(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)Wx(t[i],e)}};function m4(n,e,t){var i=-1,r=n.length-t,s;for(e.lineStart();++i<r;)s=n[i],e.point(s[0],s[1],s[2]);e.lineEnd()}function sL(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)m4(n[t],e,1);e.polygonEnd()}function mG(n,e){n&&iL.hasOwnProperty(n.type)?iL[n.type](n,e):Wx(n,e)}var Xx=Tv(),oL=Tv(),gG,vG,g4,v4,y4,fc={point:ql,lineStart:ql,lineEnd:ql,polygonStart:function(){Xx.reset(),fc.lineStart=Hce,fc.lineEnd=$ce},polygonEnd:function(){var n=+Xx;oL.add(n<0?$x+n:n),this.lineStart=this.lineEnd=this.point=ql},sphere:function(){oL.add($x)}};function Hce(){fc.point=jce}function $ce(){yG(gG,vG)}function jce(n,e){fc.point=yG,gG=n,vG=e,n*=Ns,e*=Ns,g4=n,v4=Is(e=e/2+Hx),y4=gr(e)}function yG(n,e){n*=Ns,e*=Ns,e=e/2+Hx;var t=n-g4,i=t>=0?1:-1,r=i*t,s=Is(e),o=gr(e),a=y4*o,l=v4*s+a*Is(r),u=a*i*gr(r);Xx.add(x0(u,l)),g4=n,v4=s,y4=o}function Wce(n){return[x0(n[1],n[0]),r6(n[2])]}function _4(n){var e=n[0],t=n[1],i=Is(t);return[i*Is(e),i*gr(e),gr(t)]}function Yx(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function x4(n){var e=jx(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}var Zi,bo,hr,ea,$f,_G,xG,jA,Ug=Tv(),uh,dc,ku={point:b4,lineStart:aL,lineEnd:lL,polygonStart:function(){ku.point=SG,ku.lineStart=Xce,ku.lineEnd=Yce,Ug.reset(),fc.polygonStart()},polygonEnd:function(){fc.polygonEnd(),ku.point=b4,ku.lineStart=aL,ku.lineEnd=lL,Xx<0?(Zi=-(hr=180),bo=-(ea=90)):Ug>mh?ea=90:Ug<-mh&&(bo=-90),dc[0]=Zi,dc[1]=hr},sphere:function(){Zi=-(hr=180),bo=-(ea=90)}};function b4(n,e){uh.push(dc=[Zi=n,hr=n]),e<bo&&(bo=e),e>ea&&(ea=e)}function bG(n,e){var t=_4([n*Ns,e*Ns]);if(jA){var i=Yx(jA,t),r=[i[1],-i[0],0],s=Yx(r,i);x4(s),s=Wce(s);var o=n-$f,a=o>0?1:-1,l=s[0]*dd*a,u,c=_0(o)>180;c^(a*$f<l&&l<a*n)?(u=s[1]*dd,u>ea&&(ea=u)):(l=(l+360)%360-180,c^(a*$f<l&&l<a*n)?(u=-s[1]*dd,u<bo&&(bo=u)):(e<bo&&(bo=e),e>ea&&(ea=e))),c?n<$f?Ko(Zi,n)>Ko(Zi,hr)&&(hr=n):Ko(n,hr)>Ko(Zi,hr)&&(Zi=n):hr>=Zi?(n<Zi&&(Zi=n),n>hr&&(hr=n)):n>$f?Ko(Zi,n)>Ko(Zi,hr)&&(hr=n):Ko(n,hr)>Ko(Zi,hr)&&(Zi=n)}else uh.push(dc=[Zi=n,hr=n]);e<bo&&(bo=e),e>ea&&(ea=e),jA=t,$f=n}function aL(){ku.point=bG}function lL(){dc[0]=Zi,dc[1]=hr,ku.point=b4,jA=null}function SG(n,e){if(jA){var t=n-$f;Ug.add(_0(t)>180?t+(t>0?360:-360):t)}else _G=n,xG=e;fc.point(n,e),bG(n,e)}function Xce(){fc.lineStart()}function Yce(){SG(_G,xG),fc.lineEnd(),_0(Ug)>mh&&(Zi=-(hr=180)),dc[0]=Zi,dc[1]=hr,jA=null}function Ko(n,e){return(e-=n)<0?e+360:e}function Qce(n,e){return n[0]-e[0]}function uL(n,e){return n[0]<=n[1]?n[0]<=e&&e<=n[1]:e<n[0]||n[1]<e}function wG(n){var e,t,i,r,s,o,a;if(ea=hr=-(Zi=bo=1/0),uh=[],mG(n,ku),t=uh.length){for(uh.sort(Qce),e=1,i=uh[0],s=[i];e<t;++e)r=uh[e],uL(i,r[0])||uL(i,r[1])?(Ko(i[0],r[1])>Ko(i[0],i[1])&&(i[1]=r[1]),Ko(r[0],i[1])>Ko(i[0],i[1])&&(i[0]=r[0])):s.push(i=r);for(o=-1/0,t=s.length-1,e=0,i=s[t];e<=t;i=r,++e)r=s[e],(a=Ko(i[1],r[0]))>o&&(o=a,Zi=r[0],hr=i[1])}return uh=dc=null,Zi===1/0||bo===1/0?[[NaN,NaN],[NaN,NaN]]:[[Zi,bo],[hr,ea]]}var x3=Tv();function b3(n){return _0(n[0])<=Ku?n[0]:qce(n[0])*((_0(n[0])+Ku)%$x-Ku)}function Kce(n,e){var t=b3(e),i=e[1],r=gr(i),s=[gr(t),-Is(t),0],o=0,a=0;x3.reset(),r===1?i=qx+mh:r===-1&&(i=-qx-mh);for(var l=0,u=n.length;l<u;++l)if(h=(c=n[l]).length)for(var c,h,A=c[h-1],v=b3(A),_=A[1]/2+Hx,S=gr(_),w=Is(_),x=0;x<h;++x,v=R,S=B,w=T,A=M){var M=c[x],R=b3(M),N=M[1]/2+Hx,B=gr(N),T=Is(N),D=R-v,F=D>=0?1:-1,L=F*D,O=L>Ku,z=S*B;if(x3.add(x0(z*F*gr(L),w*T+z*Is(L))),o+=O?D+F*$x:D,O^v>=t^R>=t){var Q=Yx(_4(A),_4(M));x4(Q);var j=Yx(s,Q);x4(j);var ee=(O^D>=0?-1:1)*r6(j[2]);(i>ee||i===ee&&(Q[0]||Q[1]))&&(a+=O^D>=0?1:-1)}}return(o<-mh||o<mh&&x3<-mh)^a&1}function EG(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function Zce(n){return n.length===1&&(n=Jce(n)),{left:function(e,t,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var s=i+r>>>1;n(e[s],t)<0?i=s+1:r=s}return i},right:function(e,t,i,r){for(i==null&&(i=0),r==null&&(r=e.length);i<r;){var s=i+r>>>1;n(e[s],t)>0?r=s:i=s+1}return i}}}function Jce(n){return function(e,t){return EG(n(e),t)}}Zce(EG);function cL(n){return n===null?NaN:+n}function hL(n,e){var t=n.length,i=-1,r,s,o;if(e==null){for(;++i<t;)if((r=n[i])!=null&&r>=r)for(s=o=r;++i<t;)(r=n[i])!=null&&(s>r&&(s=r),o<r&&(o=r))}else for(;++i<t;)if((r=e(n[i],i,n))!=null&&r>=r)for(s=o=r;++i<t;)(r=e(n[i],i,n))!=null&&(s>r&&(s=r),o<r&&(o=r));return[s,o]}function ehe(n,e){var t=n.length,i=t,r=-1,s,o=0;if(e==null)for(;++r<t;)isNaN(s=cL(n[r]))?--i:o+=s;else for(;++r<t;)isNaN(s=cL(e(n[r],r,n)))?--i:o+=s;if(i)return o/i}function S4(n){for(var e=n.length,t,i=-1,r=0,s,o;++i<e;)r+=n[i].length;for(s=new Array(r);--e>=0;)for(o=n[e],t=o.length;--t>=0;)s[--r]=o[t];return s}var w4=Tv(),E4,U2,z2,b0={sphere:ql,point:ql,lineStart:the,lineEnd:ql,polygonStart:ql,polygonEnd:ql};function the(){b0.point=ihe,b0.lineEnd=nhe}function nhe(){b0.point=b0.lineEnd=ql}function ihe(n,e){n*=Ns,e*=Ns,E4=n,U2=gr(e),z2=Is(e),b0.point=rhe}function rhe(n,e){n*=Ns,e*=Ns;var t=gr(e),i=Is(e),r=_0(n-E4),s=Is(r),o=gr(r),a=i*o,l=z2*t-U2*i*s,u=U2*t+z2*i*s;w4.add(x0(jx(a*a+l*l),u)),E4=n,U2=t,z2=i}function she(n){return w4.reset(),mG(n,b0),+w4}var T4=[null,null],ohe={type:"LineString",coordinates:T4};function I1(n,e){return T4[0]=n,T4[1]=e,she(ohe)}var fL={Feature:function(n,e){return Qx(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)if(Qx(t[i].geometry,e))return!0;return!1}},dL={Sphere:function(){return!0},Point:function(n,e){return pL(n.coordinates,e)},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(pL(t[i],e))return!0;return!1},LineString:function(n,e){return AL(n.coordinates,e)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(AL(t[i],e))return!0;return!1},Polygon:function(n,e){return mL(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)if(mL(t[i],e))return!0;return!1},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)if(Qx(t[i],e))return!0;return!1}};function Qx(n,e){return n&&dL.hasOwnProperty(n.type)?dL[n.type](n,e):!1}function pL(n,e){return I1(n,e)===0}function AL(n,e){for(var t,i,r,s=0,o=n.length;s<o;s++){if(i=I1(n[s],e),i===0||s>0&&(r=I1(n[s],n[s-1]),r>0&&t<=r&&i<=r&&(t+i-r)*(1-Math.pow((t-i)/r,2))<Gce*r))return!0;t=i}return!1}function mL(n,e){return!!Kce(n.map(ahe),TG(e))}function ahe(n){return n=n.map(TG),n.pop(),n}function TG(n){return[n[0]*Ns,n[1]*Ns]}function lhe(n,e){return(n&&fL.hasOwnProperty(n.type)?fL[n.type]:Qx)(n,e)}function CG(n,e){var t=n[0]*Ns,i=n[1]*Ns,r=e[0]*Ns,s=e[1]*Ns,o=Is(i),a=gr(i),l=Is(s),u=gr(s),c=o*Is(t),h=o*gr(t),A=l*Is(r),v=l*gr(r),_=2*r6(jx(nL(s-i)+o*l*nL(r-t))),S=gr(_),w=_?function(x){var M=gr(x*=_)/S,R=gr(_-x)/S,N=R*c+M*A,B=R*h+M*v,T=R*a+M*u;return[x0(B,N)*dd,x0(T,jx(N*N+B*B))*dd]}:function(){return[t*dd,i*dd]};return w.distance=_,w}function gL(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function uhe(n){if(Array.isArray(n))return n}function che(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function hhe(n,e,t){return e=Kx(e),vhe(n,MG()?Reflect.construct(e,[],Kx(n).constructor):e.apply(n,t))}function fhe(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function dhe(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function phe(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=RG(n))||e){t&&(n=t);var i=0,r=function(){};return{s:r,n:function(){return i>=n.length?{done:!0}:{done:!1,value:n[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,o=!0,a=!1;return{s:function(){t=t.call(n)},n:function(){var l=t.next();return o=l.done,l},e:function(l){a=!0,s=l},f:function(){try{o||t.return==null||t.return()}finally{if(a)throw s}}}}function Kx(n){return Kx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kx(n)}function Ahe(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&C4(n,e)}function MG(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MG=function(){return!!n})()}function mhe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function ghe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vhe(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return che(n)}function C4(n,e){return C4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},C4(n,e)}function zm(n,e){return uhe(n)||mhe(n,e)||RG(n,e)||ghe()}function RG(n,e){if(n){if(typeof n=="string")return gL(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?gL(n,e):void 0}}var vL=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=[],r=null;return e.forEach(function(s){if(r){var o=I1(s,r)*180/Math.PI;if(o>t)for(var a=CG(r,s),l=1/Math.ceil(o/t),u=l;u<1;)i.push(a(u)),u+=l}i.push(r=s)}),i},M4=typeof window<"u"&&window.THREE?window.THREE:{BufferGeometry:ur,Float32BufferAttribute:si},yhe=new M4.BufferGeometry().setAttribute?"setAttribute":"addAttribute",PG=function(n){function e(t){var i,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;fhe(this,e),i=hhe(this,e),i.type="GeoJsonGeometry",i.parameters={geoJson:t,radius:r,resolution:s};var o=({Point:c,MultiPoint:h,LineString:A,MultiLineString:v,Polygon:_,MultiPolygon:S}[t.type]||function(){return[]})(t.coordinates,r),a=[],l=[],u=0;o.forEach(function(w){var x=a.length;Vm({indices:a,vertices:l},w),i.addGroup(x,a.length-x,u++)}),a.length&&i.setIndex(a),l.length&&i[yhe]("position",new M4.Float32BufferAttribute(l,3));function c(w,x){var M=S3(w[1],w[0],x),R=[];return[{vertices:M,indices:R}]}function h(w,x){var M={vertices:[],indices:[]};return w.map(function(R){return c(R,x)}).forEach(function(R){var N=zm(R,1),B=N[0];Vm(M,B)}),[M]}function A(w,x){for(var M=vL(w,s).map(function(F){var L=zm(F,2),O=L[0],z=L[1];return S3(z,O,x)}),R=Vx([M]),N=R.vertices,B=Math.round(N.length/3),T=[],D=1;D<B;D++)T.push(D-1,D);return[{vertices:N,indices:T}]}function v(w,x){var M={vertices:[],indices:[]};return w.map(function(R){return A(R,x)}).forEach(function(R){var N=zm(R,1),B=N[0];Vm(M,B)}),[M]}function _(w,x){for(var M=w.map(function($){return vL($,s).map(function(Z){var ce=zm(Z,2),ie=ce[0],oe=ce[1];return S3(oe,ie,x)})}),R=Vx(M),N=R.vertices,B=R.holes,T=B[0]||1/0,D=N.slice(0,T*3),F=N.slice(T*3),L=new Set(B),O=Math.round(N.length/3),z=[],Q=[],j=1;j<O;j++)L.has(j)||(j<T?z.push(j-1,j):Q.push(j-1-T,j-T));var ee=[{indices:z,vertices:D}];return B.length&&ee.push({indices:Q,vertices:F}),ee}function S(w,x){var M={vertices:[],indices:[]},R={vertices:[],indices:[]};w.map(function(B){return _(B,x)}).forEach(function(B){var T=zm(B,2),D=T[0],F=T[1];Vm(M,D),F&&Vm(R,F)});var N=[M];return R.vertices.length&&N.push(R),N}return i}return Ahe(e,n),dhe(e)}(M4.BufferGeometry);function Vm(n,e){var t=Math.round(n.vertices.length/3);yL(n.vertices,e.vertices),yL(n.indices,e.indices.map(function(i){return i+t}))}function yL(n,e){var t=phe(e),i;try{for(t.s();!(i=t.n()).done;){var r=i.value;n.push(r)}}catch(s){t.e(s)}finally{t.f()}}function S3(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(i)*Math.cos(r),t*Math.cos(i),t*Math.sin(i)*Math.sin(r)]}let _he=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=t[r],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[i++]=a),e=o}return t[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let t=this._n,i,r,s,o=0;if(t>0){for(o=e[--t];t>0&&(i=o,r=e[--t],o=i+r,s=r-(o-i),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}};function xhe(n,e){let t;for(const i of n)i!=null&&(t<i||t===void 0&&i>=i)&&(t=i);return t}function SA(n,e,t){n=+n,e=+e,t=(r=arguments.length)<2?(e=n,n=0,1):r<3?1:+t;for(var i=-1,r=Math.max(0,Math.ceil((e-n)/t))|0,s=new Array(r);++i<r;)s[i]=n+i*t;return s}function bhe(n,e){let t=0;for(let i of n)(i=+i)&&(t+=i);return t}var ch=1e-6,s6=Math.PI,_L=s6/2,a_=180/s6,Th=s6/180,R4=Math.abs,P4=Math.atan2,pd=Math.cos,l_=Math.ceil,sl=Math.sin,N4=Math.sqrt;function She(n){return n>1?_L:n<-1?-_L:Math.asin(n)}function xL(n){return(n=sl(n/2))*n}function rA(){}function Zx(n,e){n&&SL.hasOwnProperty(n.type)&&SL[n.type](n,e)}var bL={Feature:function(n,e){Zx(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)Zx(t[i].geometry,e)}},SL={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){I4(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)I4(t[i],e,0)},Polygon:function(n,e){wL(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)wL(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)Zx(t[i],e)}};function I4(n,e,t){var i=-1,r=n.length-t,s;for(e.lineStart();++i<r;)s=n[i],e.point(s[0],s[1],s[2]);e.lineEnd()}function wL(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)I4(n[t],e,1);e.polygonEnd()}function whe(n,e){n&&bL.hasOwnProperty(n.type)?bL[n.type](n,e):Zx(n,e)}var D4,k4,V2,G2,S0={sphere:rA,point:rA,lineStart:Ehe,lineEnd:rA,polygonStart:rA,polygonEnd:rA};function Ehe(){S0.point=Che,S0.lineEnd=The}function The(){S0.point=S0.lineEnd=rA}function Che(n,e){n*=Th,e*=Th,k4=n,V2=sl(e),G2=pd(e),S0.point=Mhe}function Mhe(n,e){n*=Th,e*=Th;var t=sl(e),i=pd(e),r=R4(n-k4),s=pd(r),o=sl(r),a=i*o,l=G2*t-V2*i*s,u=V2*t+G2*i*s;D4.add(P4(N4(a*a+l*l),u)),k4=n,V2=t,G2=i}function Rhe(n){return D4=new _he,whe(n,S0),+D4}var L4=[null,null],Phe={type:"LineString",coordinates:L4};function Nhe(n,e){return L4[0]=n,L4[1]=e,Rhe(Phe)}function EL(n,e,t){var i=SA(n,e-ch,t).concat(e);return function(r){return i.map(function(s){return[r,s]})}}function TL(n,e,t){var i=SA(n,e-ch,t).concat(e);return function(r){return i.map(function(s){return[s,r]})}}function Ihe(){var n,e,t,i,r,s,o,a,l=10,u=l,c=90,h=360,A,v,_,S,w=2.5;function x(){return{type:"MultiLineString",coordinates:M()}}function M(){return SA(l_(i/c)*c,t,c).map(_).concat(SA(l_(a/h)*h,o,h).map(S)).concat(SA(l_(e/l)*l,n,l).filter(function(R){return R4(R%c)>ch}).map(A)).concat(SA(l_(s/u)*u,r,u).filter(function(R){return R4(R%h)>ch}).map(v))}return x.lines=function(){return M().map(function(R){return{type:"LineString",coordinates:R}})},x.outline=function(){return{type:"Polygon",coordinates:[_(i).concat(S(o).slice(1),_(t).reverse().slice(1),S(a).reverse().slice(1))]}},x.extent=function(R){return arguments.length?x.extentMajor(R).extentMinor(R):x.extentMinor()},x.extentMajor=function(R){return arguments.length?(i=+R[0][0],t=+R[1][0],a=+R[0][1],o=+R[1][1],i>t&&(R=i,i=t,t=R),a>o&&(R=a,a=o,o=R),x.precision(w)):[[i,a],[t,o]]},x.extentMinor=function(R){return arguments.length?(e=+R[0][0],n=+R[1][0],s=+R[0][1],r=+R[1][1],e>n&&(R=e,e=n,n=R),s>r&&(R=s,s=r,r=R),x.precision(w)):[[e,s],[n,r]]},x.step=function(R){return arguments.length?x.stepMajor(R).stepMinor(R):x.stepMinor()},x.stepMajor=function(R){return arguments.length?(c=+R[0],h=+R[1],x):[c,h]},x.stepMinor=function(R){return arguments.length?(l=+R[0],u=+R[1],x):[l,u]},x.precision=function(R){return arguments.length?(w=+R,A=EL(s,r,90),v=TL(e,n,w),_=EL(a,o,90),S=TL(i,t,w),x):w},x.extentMajor([[-180,-90+ch],[180,90-ch]]).extentMinor([[-180,-80-ch],[180,80+ch]])}function Dhe(){return Ihe()()}function khe(n,e){var t=n[0]*Th,i=n[1]*Th,r=e[0]*Th,s=e[1]*Th,o=pd(i),a=sl(i),l=pd(s),u=sl(s),c=o*pd(t),h=o*sl(t),A=l*pd(r),v=l*sl(r),_=2*She(N4(xL(s-i)+o*l*xL(r-t))),S=sl(_),w=_?function(x){var M=sl(x*=_)/S,R=sl(_-x)/S,N=R*c+M*A,B=R*h+M*v,T=R*a+M*u;return[P4(B,N)*a_,P4(T,N4(N*N+B*B))*a_]}:function(){return[t*a_,i*a_]};return w.distance=_,w}function Lhe(n,e,t=!0){if(!e||!e.isReady)throw new Error("BufferGeometryUtils: Initialized MikkTSpace library required.");if(!n.hasAttribute("position")||!n.hasAttribute("normal")||!n.hasAttribute("uv"))throw new Error('BufferGeometryUtils: Tangents require "position", "normal", and "uv" attributes.');function i(o){if(o.normalized||o.isInterleavedBufferAttribute){const a=new Float32Array(o.count*o.itemSize);for(let l=0,u=0;l<o.count;l++)a[u++]=o.getX(l),a[u++]=o.getY(l),o.itemSize>2&&(a[u++]=o.getZ(l));return a}return o.array instanceof Float32Array?o.array:new Float32Array(o.array)}const r=n.index?n.toNonIndexed():n,s=e.generateTangents(i(r.attributes.position),i(r.attributes.normal),i(r.attributes.uv));if(t)for(let o=3;o<s.length;o+=4)s[o]*=-1;return r.setAttribute("tangent",new Qr(s,4)),n!==r&&n.copy(r),n}function Fhe(n,e=!1){const t=n[0].index!==null,i=new Set(Object.keys(n[0].attributes)),r=new Set(Object.keys(n[0].morphAttributes)),s={},o={},a=n[0].morphTargetsRelative,l=new ur;let u=0;for(let c=0;c<n.length;++c){const h=n[c];let A=0;if(t!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const v in h.attributes){if(!i.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;s[v]===void 0&&(s[v]=[]),s[v].push(h.attributes[v]),A++}if(A!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(a!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const v in h.morphAttributes){if(!r.has(v))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;o[v]===void 0&&(o[v]=[]),o[v].push(h.morphAttributes[v])}if(e){let v;if(t)v=h.index.count;else if(h.attributes.position!==void 0)v=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,v,c),u+=v}}if(t){let c=0;const h=[];for(let A=0;A<n.length;++A){const v=n[A].index;for(let _=0;_<v.count;++_)h.push(v.getX(_)+c);c+=n[A].attributes.position.count}l.setIndex(h)}for(const c in s){const h=F4(s[c]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,h)}for(const c in o){const h=o[c][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let A=0;A<h;++A){const v=[];for(let S=0;S<o[c].length;++S)v.push(o[c][S][A]);const _=F4(v);if(!_)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(_)}}return l}function F4(n){let e,t,i,r=-1,s=0;for(let u=0;u<n.length;++u){const c=n[u];if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=c.normalized),i!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=c.gpuType),r!==c.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=c.count*t}const o=new e(s),a=new Qr(o,t,i);let l=0;for(let u=0;u<n.length;++u){const c=n[u];if(c.isInterleavedBufferAttribute){const h=l/t;for(let A=0,v=c.count;A<v;A++)for(let _=0;_<t;_++){const S=c.getComponent(A,_);a.setComponent(A+h,_,S)}}else o.set(c.array,l);l+=c.count*t}return r!==void 0&&(a.gpuType=r),a}function Bhe(n){return n.isInstancedInterleavedBufferAttribute||n.isInterleavedBufferAttribute?Jx(n):n.isInstancedBufferAttribute?new KV().copy(n):new Qr().copy(n)}function Ohe(n){let e,t=0,i=0;for(let u=0,c=n.length;u<c;++u){const h=n[u];if(e===void 0&&(e=h.array.constructor),e!==h.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;t+=h.array.length,i+=h.itemSize}const r=new YV(new e(t),i);let s=0;const o=[],a=["getX","getY","getZ","getW"],l=["setX","setY","setZ","setW"];for(let u=0,c=n.length;u<c;u++){const h=n[u],A=h.itemSize,v=h.count,_=new fd(r,A,s,h.normalized);o.push(_),s+=A;for(let S=0;S<v;S++)for(let w=0;w<A;w++)_[l[w]](S,h[a[w]](S))}return o}function Jx(n){const e=n.data.array.constructor,t=n.count,i=n.itemSize,r=n.normalized,s=new e(t*i);let o;n.isInstancedInterleavedBufferAttribute?o=new KV(s,i,r,n.meshPerAttribute):o=new Qr(s,i,r);for(let a=0;a<t;a++)o.setX(a,n.getX(a)),i>=2&&o.setY(a,n.getY(a)),i>=3&&o.setZ(a,n.getZ(a)),i>=4&&o.setW(a,n.getW(a));return o}function Uhe(n){const e=n.attributes,t=n.morphTargets,i=new Map;for(const r in e){const s=e[r];s.isInterleavedBufferAttribute&&(i.has(s)||i.set(s,Jx(s)),e[r]=i.get(s))}for(const r in t){const s=t[r];s.isInterleavedBufferAttribute&&(i.has(s)||i.set(s,Jx(s)),t[r]=i.get(s))}}function zhe(n){let e=0;for(const i in n.attributes){const r=n.getAttribute(i);e+=r.count*r.itemSize*r.array.BYTES_PER_ELEMENT}const t=n.getIndex();return e+=t?t.count*t.itemSize*t.array.BYTES_PER_ELEMENT:0,e}function Vhe(n,e=1e-4){e=Math.max(e,Number.EPSILON);const t={},i=n.getIndex(),r=n.getAttribute("position"),s=i?i.count:r.count;let o=0;const a=Object.keys(n.attributes),l={},u={},c=[],h=["getX","getY","getZ","getW"],A=["setX","setY","setZ","setW"];for(let M=0,R=a.length;M<R;M++){const N=a[M],B=n.attributes[N];l[N]=new B.constructor(new B.array.constructor(B.count*B.itemSize),B.itemSize,B.normalized);const T=n.morphAttributes[N];T&&(u[N]||(u[N]=[]),T.forEach((D,F)=>{const L=new D.array.constructor(D.count*D.itemSize);u[N][F]=new D.constructor(L,D.itemSize,D.normalized)}))}const v=e*.5,_=Math.log10(1/e),S=Math.pow(10,_),w=v*S;for(let M=0;M<s;M++){const R=i?i.getX(M):M;let N="";for(let B=0,T=a.length;B<T;B++){const D=a[B],F=n.getAttribute(D),L=F.itemSize;for(let O=0;O<L;O++)N+=`${~~(F[h[O]](R)*S+w)},`}if(N in t)c.push(t[N]);else{for(let B=0,T=a.length;B<T;B++){const D=a[B],F=n.getAttribute(D),L=n.morphAttributes[D],O=F.itemSize,z=l[D],Q=u[D];for(let j=0;j<O;j++){const ee=h[j],$=A[j];if(z[$](o,F[ee](R)),L)for(let Z=0,ce=L.length;Z<ce;Z++)Q[Z][$](o,L[Z][ee](R))}}t[N]=o,c.push(o),o++}}const x=n.clone();for(const M in n.attributes){const R=l[M];if(x.setAttribute(M,new R.constructor(R.array.slice(0,o*R.itemSize),R.itemSize,R.normalized)),M in u)for(let N=0;N<u[M].length;N++){const B=u[M][N];x.morphAttributes[M][N]=new B.constructor(B.array.slice(0,o*B.itemSize),B.itemSize,B.normalized)}}return x.setIndex(c),x}function Ghe(n,e){if(e===fie)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===LD||e===die){let t=n.getIndex();if(t===null){const o=[],a=n.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===LD)for(let o=1;o<=i;o++)r.push(t.getX(0)),r.push(t.getX(o)),r.push(t.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(t.getX(o)),r.push(t.getX(o+1)),r.push(t.getX(o+2))):(r.push(t.getX(o+2)),r.push(t.getX(o+1)),r.push(t.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}function qhe(n){const e=new le,t=new le,i=new le,r=new le,s=new le,o=new le,a=new le,l=new le,u=new le;function c(oe,me,_e,Oe,Ke,Me,ze,nt){e.fromBufferAttribute(me,Ke),t.fromBufferAttribute(me,Me),i.fromBufferAttribute(me,ze);const tt=oe.morphTargetInfluences;if(_e&&tt){a.set(0,0,0),l.set(0,0,0),u.set(0,0,0);for(let Ot=0,Ht=_e.length;Ot<Ht;Ot++){const Ct=tt[Ot],en=_e[Ot];Ct!==0&&(r.fromBufferAttribute(en,Ke),s.fromBufferAttribute(en,Me),o.fromBufferAttribute(en,ze),Oe?(a.addScaledVector(r,Ct),l.addScaledVector(s,Ct),u.addScaledVector(o,Ct)):(a.addScaledVector(r.sub(e),Ct),l.addScaledVector(s.sub(t),Ct),u.addScaledVector(o.sub(i),Ct)))}e.add(a),t.add(l),i.add(u)}oe.isSkinnedMesh&&(oe.applyBoneTransform(Ke,e),oe.applyBoneTransform(Me,t),oe.applyBoneTransform(ze,i)),nt[Ke*3+0]=e.x,nt[Ke*3+1]=e.y,nt[Ke*3+2]=e.z,nt[Me*3+0]=t.x,nt[Me*3+1]=t.y,nt[Me*3+2]=t.z,nt[ze*3+0]=i.x,nt[ze*3+1]=i.y,nt[ze*3+2]=i.z}const h=n.geometry,A=n.material;let v,_,S;const w=h.index,x=h.attributes.position,M=h.morphAttributes.position,R=h.morphTargetsRelative,N=h.attributes.normal,B=h.morphAttributes.position,T=h.groups,D=h.drawRange;let F,L,O,z,Q,j,ee;const $=new Float32Array(x.count*x.itemSize),Z=new Float32Array(N.count*N.itemSize);if(w!==null)if(Array.isArray(A))for(F=0,O=T.length;F<O;F++)for(Q=T[F],j=Math.max(Q.start,D.start),ee=Math.min(Q.start+Q.count,D.start+D.count),L=j,z=ee;L<z;L+=3)v=w.getX(L),_=w.getX(L+1),S=w.getX(L+2),c(n,x,M,R,v,_,S,$),c(n,N,B,R,v,_,S,Z);else for(j=Math.max(0,D.start),ee=Math.min(w.count,D.start+D.count),F=j,O=ee;F<O;F+=3)v=w.getX(F),_=w.getX(F+1),S=w.getX(F+2),c(n,x,M,R,v,_,S,$),c(n,N,B,R,v,_,S,Z);else if(Array.isArray(A))for(F=0,O=T.length;F<O;F++)for(Q=T[F],j=Math.max(Q.start,D.start),ee=Math.min(Q.start+Q.count,D.start+D.count),L=j,z=ee;L<z;L+=3)v=L,_=L+1,S=L+2,c(n,x,M,R,v,_,S,$),c(n,N,B,R,v,_,S,Z);else for(j=Math.max(0,D.start),ee=Math.min(x.count,D.start+D.count),F=j,O=ee;F<O;F+=3)v=F,_=F+1,S=F+2,c(n,x,M,R,v,_,S,$),c(n,N,B,R,v,_,S,Z);const ce=new si($,3),ie=new si(Z,3);return{positionAttribute:x,normalAttribute:N,morphedPositionAttribute:ce,morphedNormalAttribute:ie}}function Hhe(n){if(n.groups.length===0)return console.warn("THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge."),n;let e=n.groups;if(e=e.sort((o,a)=>o.materialIndex!==a.materialIndex?o.materialIndex-a.materialIndex:o.start-a.start),n.getIndex()===null){const o=n.getAttribute("position"),a=[];for(let l=0;l<o.count;l+=3)a.push(l,l+1,l+2);n.setIndex(a)}const t=n.getIndex(),i=[];for(let o=0;o<e.length;o++){const a=e[o],l=a.start,u=l+a.count;for(let c=l;c<u;c++)i.push(t.getX(c))}n.dispose(),n.setIndex(i);let r=0;for(let o=0;o<e.length;o++){const a=e[o];a.start=r,r+=a.count}let s=e[0];n.groups=[s];for(let o=1;o<e.length;o++){const a=e[o];s.materialIndex===a.materialIndex?s.count+=a.count:(s=a,n.groups.push(s))}return n}function $he(n,e=Math.PI/3){const t=Math.cos(e),i=(1+1e-10)*100,r=[new le,new le,new le],s=new le,o=new le,a=new le,l=new le;function u(S){const w=~~(S.x*i),x=~~(S.y*i),M=~~(S.z*i);return`${w},${x},${M}`}const c=n.index?n.toNonIndexed():n,h=c.attributes.position,A={};for(let S=0,w=h.count/3;S<w;S++){const x=3*S,M=r[0].fromBufferAttribute(h,x+0),R=r[1].fromBufferAttribute(h,x+1),N=r[2].fromBufferAttribute(h,x+2);s.subVectors(N,R),o.subVectors(M,R);const B=new le().crossVectors(s,o).normalize();for(let T=0;T<3;T++){const D=r[T],F=u(D);F in A||(A[F]=[]),A[F].push(B)}}const v=new Float32Array(h.count*3),_=new Qr(v,3,!1);for(let S=0,w=h.count/3;S<w;S++){const x=3*S,M=r[0].fromBufferAttribute(h,x+0),R=r[1].fromBufferAttribute(h,x+1),N=r[2].fromBufferAttribute(h,x+2);s.subVectors(N,R),o.subVectors(M,R),a.crossVectors(s,o).normalize();for(let B=0;B<3;B++){const T=r[B],D=u(T),F=A[D];l.set(0,0,0);for(let L=0,O=F.length;L<O;L++){const z=F[L];a.dot(z)>t&&l.add(z)}l.normalize(),_.setXYZ(x+B,l.x,l.y,l.z)}}return c.setAttribute("normal",_),c}const o6=Object.freeze(Object.defineProperty({__proto__:null,computeMikkTSpaceTangents:Lhe,computeMorphedAttributes:qhe,deepCloneAttribute:Bhe,deinterleaveAttribute:Jx,deinterleaveGeometry:Uhe,estimateBytesUsed:zhe,interleaveAttributes:Ohe,mergeAttributes:F4,mergeGeometries:Fhe,mergeGroups:Hhe,mergeVertices:Vhe,toCreasedNormals:$he,toTrianglesDrawMode:Ghe},Symbol.toStringTag,{value:"Module"}));var ot=function(n){return typeof n=="function"?n:typeof n=="string"?function(e){return e[n]}:function(e){return n}};function a6(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function NG(n,e){var t=Object.create(n.prototype);for(var i in e)t[i]=e[i];return t}function Cv(){}var D1=.7,eb=1/D1,WA="\\s*([+-]?\\d+)\\s*",k1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",jhe=/^#([0-9a-f]{3,8})$/,Whe=new RegExp(`^rgb\\(${WA},${WA},${WA}\\)$`),Xhe=new RegExp(`^rgb\\(${Zl},${Zl},${Zl}\\)$`),Yhe=new RegExp(`^rgba\\(${WA},${WA},${WA},${k1}\\)$`),Qhe=new RegExp(`^rgba\\(${Zl},${Zl},${Zl},${k1}\\)$`),Khe=new RegExp(`^hsl\\(${k1},${Zl},${Zl}\\)$`),Zhe=new RegExp(`^hsla\\(${k1},${Zl},${Zl},${k1}\\)$`),CL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};a6(Cv,kd,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:ML,formatHex:ML,formatHex8:Jhe,formatHsl:efe,formatRgb:RL,toString:RL});function ML(){return this.rgb().formatHex()}function Jhe(){return this.rgb().formatHex8()}function efe(){return IG(this).formatHsl()}function RL(){return this.rgb().formatRgb()}function kd(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=jhe.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?PL(e):t===3?new wo(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?u_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?u_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Whe.exec(n))?new wo(e[1],e[2],e[3],1):(e=Xhe.exec(n))?new wo(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Yhe.exec(n))?u_(e[1],e[2],e[3],e[4]):(e=Qhe.exec(n))?u_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Khe.exec(n))?DL(e[1],e[2]/100,e[3]/100,1):(e=Zhe.exec(n))?DL(e[1],e[2]/100,e[3]/100,e[4]):CL.hasOwnProperty(n)?PL(CL[n]):n==="transparent"?new wo(NaN,NaN,NaN,0):null}function PL(n){return new wo(n>>16&255,n>>8&255,n&255,1)}function u_(n,e,t,i){return i<=0&&(n=e=t=NaN),new wo(n,e,t,i)}function tfe(n){return n instanceof Cv||(n=kd(n)),n?(n=n.rgb(),new wo(n.r,n.g,n.b,n.opacity)):new wo}function B4(n,e,t,i){return arguments.length===1?tfe(n):new wo(n,e,t,i??1)}function wo(n,e,t,i){this.r=+n,this.g=+e,this.b=+t,this.opacity=+i}a6(wo,B4,NG(Cv,{brighter(n){return n=n==null?eb:Math.pow(eb,n),new wo(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?D1:Math.pow(D1,n),new wo(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new wo(bd(this.r),bd(this.g),bd(this.b),tb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:NL,formatHex:NL,formatHex8:nfe,formatRgb:IL,toString:IL}));function NL(){return`#${Ad(this.r)}${Ad(this.g)}${Ad(this.b)}`}function nfe(){return`#${Ad(this.r)}${Ad(this.g)}${Ad(this.b)}${Ad((isNaN(this.opacity)?1:this.opacity)*255)}`}function IL(){const n=tb(this.opacity);return`${n===1?"rgb(":"rgba("}${bd(this.r)}, ${bd(this.g)}, ${bd(this.b)}${n===1?")":`, ${n})`}`}function tb(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function bd(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Ad(n){return n=bd(n),(n<16?"0":"")+n.toString(16)}function DL(n,e,t,i){return i<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new cl(n,e,t,i)}function IG(n){if(n instanceof cl)return new cl(n.h,n.s,n.l,n.opacity);if(n instanceof Cv||(n=kd(n)),!n)return new cl;if(n instanceof cl)return n;n=n.rgb();var e=n.r/255,t=n.g/255,i=n.b/255,r=Math.min(e,t,i),s=Math.max(e,t,i),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(t-i)/a+(t<i)*6:t===s?o=(i-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new cl(o,a,l,n.opacity)}function ife(n,e,t,i){return arguments.length===1?IG(n):new cl(n,e,t,i??1)}function cl(n,e,t,i){this.h=+n,this.s=+e,this.l=+t,this.opacity=+i}a6(cl,ife,NG(Cv,{brighter(n){return n=n==null?eb:Math.pow(eb,n),new cl(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?D1:Math.pow(D1,n),new cl(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*e,r=2*t-i;return new wo(w3(n>=240?n-240:n+120,r,i),w3(n,r,i),w3(n<120?n+240:n-120,r,i),this.opacity)},clamp(){return new cl(kL(this.h),c_(this.s),c_(this.l),tb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=tb(this.opacity);return`${n===1?"hsl(":"hsla("}${kL(this.h)}, ${c_(this.s)*100}%, ${c_(this.l)*100}%${n===1?")":`, ${n})`}`}}));function kL(n){return n=(n||0)%360,n<0?n+360:n}function c_(n){return Math.max(0,Math.min(1,n||0))}function w3(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}function nb(n){"@babel/helpers - typeof";return nb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nb(n)}var rfe=/^\s+/,sfe=/\s+$/;function Wt(n,e){if(n=n||"",e=e||{},n instanceof Wt)return n;if(!(this instanceof Wt))return new Wt(n,e);var t=ofe(n);this._originalInput=n,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}Wt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,i,r,s,o,a;return t=e.r/255,i=e.g/255,r=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=DG(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=FL(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=FL(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+i+"%, "+r+"%)":"hsva("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=LL(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=LL(this._r,this._g,this._b),t=Math.round(e.h*360),i=Math.round(e.s*100),r=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+i+"%, "+r+"%)":"hsla("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return BL(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return cfe(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Gi(this._r,255)*100)+"%",g:Math.round(Gi(this._g,255)*100)+"%",b:Math.round(Gi(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Gi(this._r,255)*100)+"%, "+Math.round(Gi(this._g,255)*100)+"%, "+Math.round(Gi(this._b,255)*100)+"%)":"rgba("+Math.round(Gi(this._r,255)*100)+"%, "+Math.round(Gi(this._g,255)*100)+"%, "+Math.round(Gi(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:bfe[BL(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+OL(this._r,this._g,this._b,this._a),i=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var s=Wt(e);i="#"+OL(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,r=this._a<1&&this._a>=0,s=!t&&r&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(i=this.toRgbString()),e==="prgb"&&(i=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(i=this.toHexString()),e==="hex3"&&(i=this.toHexString(!0)),e==="hex4"&&(i=this.toHex8String(!0)),e==="hex8"&&(i=this.toHex8String()),e==="name"&&(i=this.toName()),e==="hsl"&&(i=this.toHslString()),e==="hsv"&&(i=this.toHsvString()),i||this.toHexString())},clone:function(){return Wt(this.toString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(pfe,arguments)},brighten:function(){return this._applyModification(Afe,arguments)},darken:function(){return this._applyModification(mfe,arguments)},desaturate:function(){return this._applyModification(hfe,arguments)},saturate:function(){return this._applyModification(ffe,arguments)},greyscale:function(){return this._applyModification(dfe,arguments)},spin:function(){return this._applyModification(gfe,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(_fe,arguments)},complement:function(){return this._applyCombination(vfe,arguments)},monochromatic:function(){return this._applyCombination(xfe,arguments)},splitcomplement:function(){return this._applyCombination(yfe,arguments)},triad:function(){return this._applyCombination(UL,[3])},tetrad:function(){return this._applyCombination(UL,[4])}};Wt.fromRatio=function(n,e){if(nb(n)=="object"){var t={};for(var i in n)n.hasOwnProperty(i)&&(i==="a"?t[i]=n[i]:t[i]=gg(n[i]));n=t}return Wt(n,e)};function ofe(n){var e={r:0,g:0,b:0},t=1,i=null,r=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=Tfe(n)),nb(n)=="object"&&(bu(n.r)&&bu(n.g)&&bu(n.b)?(e=afe(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):bu(n.h)&&bu(n.s)&&bu(n.v)?(i=gg(n.s),r=gg(n.v),e=ufe(n.h,i,r),o=!0,a="hsv"):bu(n.h)&&bu(n.s)&&bu(n.l)&&(i=gg(n.s),s=gg(n.l),e=lfe(n.h,i,s),o=!0,a="hsl"),n.hasOwnProperty("a")&&(t=n.a)),t=DG(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function afe(n,e,t){return{r:Gi(n,255)*255,g:Gi(e,255)*255,b:Gi(t,255)*255}}function LL(n,e,t){n=Gi(n,255),e=Gi(e,255),t=Gi(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=(i+r)/2;if(i==r)s=o=0;else{var l=i-r;switch(o=a>.5?l/(2-i-r):l/(i+r),i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function lfe(n,e,t){var i,r,s;n=Gi(n,360),e=Gi(e,100),t=Gi(t,100);function o(u,c,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?u+(c-u)*6*h:h<1/2?c:h<2/3?u+(c-u)*(2/3-h)*6:u}if(e===0)i=r=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;i=o(l,a,n+1/3),r=o(l,a,n),s=o(l,a,n-1/3)}return{r:i*255,g:r*255,b:s*255}}function FL(n,e,t){n=Gi(n,255),e=Gi(e,255),t=Gi(t,255);var i=Math.max(n,e,t),r=Math.min(n,e,t),s,o,a=i,l=i-r;if(o=i===0?0:l/i,i==r)s=0;else{switch(i){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function ufe(n,e,t){n=Gi(n,360)*6,e=Gi(e,100),t=Gi(t,100);var i=Math.floor(n),r=n-i,s=t*(1-e),o=t*(1-r*e),a=t*(1-(1-r)*e),l=i%6,u=[t,o,s,s,a,t][l],c=[a,t,t,o,s,s][l],h=[s,s,a,t,t,o][l];return{r:u*255,g:c*255,b:h*255}}function BL(n,e,t,i){var r=[pl(Math.round(n).toString(16)),pl(Math.round(e).toString(16)),pl(Math.round(t).toString(16))];return i&&r[0].charAt(0)==r[0].charAt(1)&&r[1].charAt(0)==r[1].charAt(1)&&r[2].charAt(0)==r[2].charAt(1)?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function cfe(n,e,t,i,r){var s=[pl(Math.round(n).toString(16)),pl(Math.round(e).toString(16)),pl(Math.round(t).toString(16)),pl(kG(i))];return r&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function OL(n,e,t,i){var r=[pl(kG(i)),pl(Math.round(n).toString(16)),pl(Math.round(e).toString(16)),pl(Math.round(t).toString(16))];return r.join("")}Wt.equals=function(n,e){return!n||!e?!1:Wt(n).toRgbString()==Wt(e).toRgbString()};Wt.random=function(){return Wt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function hfe(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.s-=e/100,t.s=iw(t.s),Wt(t)}function ffe(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.s+=e/100,t.s=iw(t.s),Wt(t)}function dfe(n){return Wt(n).desaturate(100)}function pfe(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.l+=e/100,t.l=iw(t.l),Wt(t)}function Afe(n,e){e=e===0?0:e||10;var t=Wt(n).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),Wt(t)}function mfe(n,e){e=e===0?0:e||10;var t=Wt(n).toHsl();return t.l-=e/100,t.l=iw(t.l),Wt(t)}function gfe(n,e){var t=Wt(n).toHsl(),i=(t.h+e)%360;return t.h=i<0?360+i:i,Wt(t)}function vfe(n){var e=Wt(n).toHsl();return e.h=(e.h+180)%360,Wt(e)}function UL(n,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=Wt(n).toHsl(),i=[Wt(n)],r=360/e,s=1;s<e;s++)i.push(Wt({h:(t.h+s*r)%360,s:t.s,l:t.l}));return i}function yfe(n){var e=Wt(n).toHsl(),t=e.h;return[Wt(n),Wt({h:(t+72)%360,s:e.s,l:e.l}),Wt({h:(t+216)%360,s:e.s,l:e.l})]}function _fe(n,e,t){e=e||6,t=t||30;var i=Wt(n).toHsl(),r=360/t,s=[Wt(n)];for(i.h=(i.h-(r*e>>1)+720)%360;--e;)i.h=(i.h+r)%360,s.push(Wt(i));return s}function xfe(n,e){e=e||6;for(var t=Wt(n).toHsv(),i=t.h,r=t.s,s=t.v,o=[],a=1/e;e--;)o.push(Wt({h:i,s:r,v:s})),s=(s+a)%1;return o}Wt.mix=function(n,e,t){t=t===0?0:t||50;var i=Wt(n).toRgb(),r=Wt(e).toRgb(),s=t/100,o={r:(r.r-i.r)*s+i.r,g:(r.g-i.g)*s+i.g,b:(r.b-i.b)*s+i.b,a:(r.a-i.a)*s+i.a};return Wt(o)};Wt.readability=function(n,e){var t=Wt(n),i=Wt(e);return(Math.max(t.getLuminance(),i.getLuminance())+.05)/(Math.min(t.getLuminance(),i.getLuminance())+.05)};Wt.isReadable=function(n,e,t){var i=Wt.readability(n,e),r,s;switch(s=!1,r=Cfe(t),r.level+r.size){case"AAsmall":case"AAAlarge":s=i>=4.5;break;case"AAlarge":s=i>=3;break;case"AAAsmall":s=i>=7;break}return s};Wt.mostReadable=function(n,e,t){var i=null,r=0,s,o,a,l;t=t||{},o=t.includeFallbackColors,a=t.level,l=t.size;for(var u=0;u<e.length;u++)s=Wt.readability(n,e[u]),s>r&&(r=s,i=Wt(e[u]));return Wt.isReadable(n,i,{level:a,size:l})||!o?i:(t.includeFallbackColors=!1,Wt.mostReadable(n,["#fff","#000"],t))};var O4=Wt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},bfe=Wt.hexNames=Sfe(O4);function Sfe(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function DG(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function Gi(n,e){wfe(n)&&(n="100%");var t=Efe(n);return n=Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(n*e,10)/100),Math.abs(n-e)<1e-6?1:n%e/parseFloat(e)}function iw(n){return Math.min(1,Math.max(0,n))}function Xo(n){return parseInt(n,16)}function wfe(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function Efe(n){return typeof n=="string"&&n.indexOf("%")!=-1}function pl(n){return n.length==1?"0"+n:""+n}function gg(n){return n<=1&&(n=n*100+"%"),n}function kG(n){return Math.round(parseFloat(n)*255).toString(16)}function zL(n){return Xo(n)/255}var el=function(){var n="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+n+")",i="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+r),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+r),hsv:new RegExp("hsv"+i),hsva:new RegExp("hsva"+r),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function bu(n){return!!el.CSS_UNIT.exec(n)}function Tfe(n){n=n.replace(rfe,"").replace(sfe,"").toLowerCase();var e=!1;if(O4[n])n=O4[n],e=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=el.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=el.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=el.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=el.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=el.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=el.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=el.hex8.exec(n))?{r:Xo(t[1]),g:Xo(t[2]),b:Xo(t[3]),a:zL(t[4]),format:e?"name":"hex8"}:(t=el.hex6.exec(n))?{r:Xo(t[1]),g:Xo(t[2]),b:Xo(t[3]),format:e?"name":"hex"}:(t=el.hex4.exec(n))?{r:Xo(t[1]+""+t[1]),g:Xo(t[2]+""+t[2]),b:Xo(t[3]+""+t[3]),a:zL(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=el.hex3.exec(n))?{r:Xo(t[1]+""+t[1]),g:Xo(t[2]+""+t[2]),b:Xo(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function Cfe(n){var e,t;return n=n||{level:"AA",size:"small"},e=(n.level||"AA").toUpperCase(),t=(n.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function U4(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function Mfe(n){if(Array.isArray(n))return n}function Rfe(n){if(Array.isArray(n))return U4(n)}function Pfe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Nfe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Ife(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kfe(n,e){if(n==null)return{};var t,i,r=Lfe(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function Lfe(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function Ffe(n,e){return Mfe(n)||Nfe(n,e)||LG(n,e)||Ife()}function Bfe(n){return Rfe(n)||Pfe(n)||LG(n)||Dfe()}function Ofe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function Ufe(n){var e=Ofe(n,"string");return typeof e=="symbol"?e:e+""}function LG(n,e){if(n){if(typeof n=="string")return U4(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?U4(n,e):void 0}}var z4=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,r=(e instanceof Array?e.length?e:[void 0]:[e]).map(function(a){return{keyAccessor:a,isProp:!(a instanceof Function)}}),s=n.reduce(function(a,l){var u=a,c=l;return r.forEach(function(h,A){var v=h.keyAccessor,_=h.isProp,S;if(_){var w=c,x=w[v],M=kfe(w,[v].map(Ufe));S=x,c=M}else S=v(c,A);A+1<r.length?(u.hasOwnProperty(S)||(u[S]={}),u=u[S]):t?(u.hasOwnProperty(S)||(u[S]=[]),u[S].push(c)):u[S]=c}),a},{});t instanceof Function&&function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===r.length?Object.keys(l).forEach(function(c){return l[c]=t(l[c])}):Object.values(l).forEach(function(c){return a(c,u+1)})}(s);var o=s;return i&&(o=[],function a(l){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===r.length?o.push({keys:u,vals:l}):Object.entries(l).forEach(function(c){var h=Ffe(c,2),A=h[0],v=h[1];return a(v,[].concat(Bfe(u),[A]))})}(s),e instanceof Array&&e.length===0&&o.length===1&&(o[0].keys=[])),o};function zfe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function VL(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function Vfe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?VL(Object(t),!0).forEach(function(i){FG(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):VL(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function FG(n,e,t){return e=Qfe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Gfe(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function qfe(n,e){if(n==null)return{};var t=Gfe(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function BG(n,e){return $fe(n)||zfe(n,e)||OG(n,e)||Xfe()}function ib(n){return Hfe(n)||jfe(n)||OG(n)||Wfe()}function Hfe(n){if(Array.isArray(n))return V4(n)}function $fe(n){if(Array.isArray(n))return n}function jfe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function OG(n,e){if(n){if(typeof n=="string")return V4(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return V4(n,e)}}function V4(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function Wfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yfe(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Qfe(n){var e=Yfe(n,"string");return typeof e=="symbol"?e:String(e)}var Kfe=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function Zfe(n,e,t){var i={enter:[],update:[],exit:[]};if(t){var o=z4(n,t,!1),a=z4(e,t,!1),l=Object.assign({},o,a);Object.entries(l).forEach(function(u){var c=BG(u,2),h=c[0],A=c[1],v=o.hasOwnProperty(h)?a.hasOwnProperty(h)?"update":"exit":"enter";i[v].push(v==="update"?[o[h],a[h]]:A)})}else{var r=new Set(n),s=new Set(e);new Set([].concat(ib(r),ib(s))).forEach(function(u){var c=r.has(u)?s.has(u)?"update":"exit":"enter";i[c].push(c==="update"?[u,u]:u)})}return i}function Jfe(n,e,t){var i=t.objBindAttr,r=i===void 0?"__obj":i,s=t.dataBindAttr,o=s===void 0?"__data":s,a=t.idAccessor,l=t.purge,u=l===void 0?!1:l,c=function(w){return w.hasOwnProperty(o)},h=e.filter(function(S){return!c(S)}),A=e.filter(c).map(function(S){return S[o]}),v=n,_=u?{enter:v,exit:A,update:[]}:Zfe(A,v,a);return _.update=_.update.map(function(S){var w=BG(S,2),x=w[0],M=w[1];return x!==M&&(M[r]=x[r],M[r][o]=M),M}),_.exit=_.exit.concat(h.map(function(S){return FG({},r,S)})),_}function ede(n,e,t,i,r){var s=r.createObj,o=s===void 0?function(F){return{}}:s,a=r.updateObj,l=a===void 0?function(F,L){}:a,u=r.exitObj,c=u===void 0?function(F){}:u,h=r.objBindAttr,A=h===void 0?"__obj":h,v=r.dataBindAttr,_=v===void 0?"__data":v,S=qfe(r,Kfe),w=Jfe(n,e,Vfe({objBindAttr:A,dataBindAttr:_},S)),x=w.enter,M=w.update,R=w.exit;R.forEach(function(F){var L=F[A];delete F[A],c(L),i(L)});var N=T(x),B=[].concat(ib(x),ib(M));D(B),N.forEach(t);function T(F){var L=[];return F.forEach(function(O){var z=o(O);z&&(z[_]=O,O[A]=z,L.push(z))}),L}function D(F){F.forEach(function(L){var O=L[A];O&&(O[_]=L,l(O,L))})}}var UG={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(UK,function(){return function(t){function i(s){if(r[s])return r[s].exports;var o=r[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}var r={};return i.m=t,i.c=r,i.p="",i(0)}([function(t,i,r){var s=r(1),o=function(){function a(l,u,c){l===void 0&&(l=NaN),u===void 0&&(u=NaN),c===void 0&&(c=!1),this._minFPS=u,this._maxFPS=l,this._timeScale=1,this._currentTick=0,this._currentTime=0,this._tickDeltaTime=0,this._isRunning=!1,this._maxInterval=isNaN(this._minFPS)?NaN:1e3/this._minFPS,this._minInterval=isNaN(this._maxFPS)?NaN:1e3/this._maxFPS,this._onResume=new s.default,this._onPause=new s.default,this._onTick=new s.default,this._onTickOncePerFrame=new s.default,c||this.resume()}return a.prototype.updateOnce=function(l){l(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.resume=function(){this._isRunning||(this._isRunning=!0,this._lastTimeUpdated=this.getTimer(),this._onResume.dispatch(),this.animateOnce())},a.prototype.pause=function(){this._isRunning&&(this._isRunning=!1,this._onPause.dispatch(),window.cancelAnimationFrame(this._animationFrameHandle))},a.prototype.dispose=function(){this.pause(),this._onResume.removeAll(),this._onPause.removeAll(),this._onTick.removeAll()},Object.defineProperty(a.prototype,"currentTick",{get:function(){return this._currentTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"currentTimeSeconds",{get:function(){return this._currentTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"tickDeltaTimeSeconds",{get:function(){return this._tickDeltaTime/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"timeScale",{get:function(){return this._timeScale},set:function(l){this._timeScale!==l&&(this._timeScale=l)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onResume",{get:function(){return this._onResume},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onPause",{get:function(){return this._onPause},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTick",{get:function(){return this._onTick},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"onTickOncePerFrame",{get:function(){return this._onTickOncePerFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isRunning",{get:function(){return this._isRunning},enumerable:!0,configurable:!0}),a.prototype.animateOnce=function(){var l=this;this._animationFrameHandle=window.requestAnimationFrame(function(){return l.onFrame()})},a.prototype.onFrame=function(){if(this._now=this.getTimer(),this._frameDeltaTime=this._now-this._lastTimeUpdated,isNaN(this._minInterval)||this._frameDeltaTime>=this._minInterval)if(isNaN(this._maxInterval))this.update(this._frameDeltaTime*this._timeScale,!0),this._lastTimeUpdated=this._now;else for(this._interval=Math.min(this._frameDeltaTime,this._maxInterval);this._now>=this._lastTimeUpdated+this._interval;)this.update(this._interval*this._timeScale,this._now<=this._lastTimeUpdated+2*this._maxInterval),this._lastTimeUpdated+=this._interval;this._isRunning&&this.animateOnce()},a.prototype.update=function(l,u){u===void 0&&(u=!0),this._currentTick++,this._currentTime+=l,this._tickDeltaTime=l,this._onTick.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick),u&&this._onTickOncePerFrame.dispatch(this.currentTimeSeconds,this.tickDeltaTimeSeconds,this.currentTick)},a.prototype.getTimer=function(){return Date.now()},a}();Object.defineProperty(i,"__esModule",{value:!0}),i.default=o},function(t,i,r){(function(s,o){t.exports=o()})(this,function(){return function(s){function o(l){if(a[l])return a[l].exports;var u=a[l]={exports:{},id:l,loaded:!1};return s[l].call(u.exports,u,u.exports,o),u.loaded=!0,u.exports}var a={};return o.m=s,o.c=a,o.p="",o(0)}([function(s,o){var a=function(){function l(){this.functions=[]}return l.prototype.add=function(u){return this.functions.indexOf(u)===-1&&(this.functions.push(u),!0)},l.prototype.remove=function(u){var c=this.functions.indexOf(u);return c>-1&&(this.functions.splice(c,1),!0)},l.prototype.removeAll=function(){return this.functions.length>0&&(this.functions.length=0,!0)},l.prototype.dispatch=function(){for(var u=[],c=0;c<arguments.length;c++)u[c]=arguments[c];var h=this.functions.concat();h.forEach(function(A){A.apply(void 0,u)})},Object.defineProperty(l.prototype,"numItems",{get:function(){return this.functions.length},enumerable:!0,configurable:!0}),l}();Object.defineProperty(o,"__esModule",{value:!0}),o.default=a}])})}])})})(UG);var tde=UG.exports;const w0=G0(tde);function q2(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function nde(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function zG(n){let e,t,i;n.length!==2?(e=q2,t=(a,l)=>q2(n(a),l),i=(a,l)=>n(a)-l):(e=n===q2||n===nde?n:ide,t=n,i=n);function r(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;t(a[h],l)<0?u=h+1:c=h}while(u<c)}return u}function s(a,l,u=0,c=a.length){if(u<c){if(e(l,l)!==0)return c;do{const h=u+c>>>1;t(a[h],l)<=0?u=h+1:c=h}while(u<c)}return u}function o(a,l,u=0,c=a.length){const h=r(a,l,u,c-1);return h>u&&i(a[h-1],l)>-i(a[h],l)?h-1:h}return{left:r,center:o,right:s}}function ide(){return 0}function rde(n){return n===null?NaN:+n}const sde=zG(q2),ode=sde.right;zG(rde).center;const ade=Math.sqrt(50),lde=Math.sqrt(10),ude=Math.sqrt(2);function rb(n,e,t){const i=(e-n)/Math.max(0,t),r=Math.floor(Math.log10(i)),s=i/Math.pow(10,r),o=s>=ade?10:s>=lde?5:s>=ude?2:1;let a,l,u;return r<0?(u=Math.pow(10,-r)/o,a=Math.round(n*u),l=Math.round(e*u),a/u<n&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,r)*o,a=Math.round(n/u),l=Math.round(e/u),a*u<n&&++a,l*u>e&&--l),l<a&&.5<=t&&t<2?rb(n,e,t*2):[a,l,u]}function cde(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const i=e<n,[r,s,o]=i?rb(e,n,t):rb(n,e,t);if(!(s>=r))return[];const a=s-r+1,l=new Array(a);if(i)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(r+u)/-o;else for(let u=0;u<a;++u)l[u]=(r+u)*o;return l}function G4(n,e,t){return e=+e,n=+n,t=+t,rb(n,e,t)[2]}function hde(n,e,t){e=+e,n=+n,t=+t;const i=e<n,r=i?G4(e,n,t):G4(n,e,t);return(i?-1:1)*(r<0?1/-r:r)}function fde(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}const l6=n=>()=>n;function dde(n,e){return function(t){return n+t*e}}function pde(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(i){return Math.pow(n+i*e,t)}}function Ade(n){return(n=+n)==1?VG:function(e,t){return t-e?pde(e,t,n):l6(isNaN(e)?t:e)}}function VG(n,e){var t=e-n;return t?dde(n,t):l6(isNaN(n)?e:n)}const GL=function n(e){var t=Ade(e);function i(r,s){var o=t((r=B4(r)).r,(s=B4(s)).r),a=t(r.g,s.g),l=t(r.b,s.b),u=VG(r.opacity,s.opacity);return function(c){return r.r=o(c),r.g=a(c),r.b=l(c),r.opacity=u(c),r+""}}return i.gamma=n,i}(1);function GG(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,i=e.slice(),r;return function(s){for(r=0;r<t;++r)i[r]=n[r]*(1-s)+e[r]*s;return i}}function qG(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function mde(n,e){return(qG(e)?GG:HG)(n,e)}function HG(n,e){var t=e?e.length:0,i=n?Math.min(t,n.length):0,r=new Array(i),s=new Array(t),o;for(o=0;o<i;++o)r[o]=u6(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<i;++o)s[o]=r[o](a);return s}}function gde(n,e){var t=new Date;return n=+n,e=+e,function(i){return t.setTime(n*(1-i)+e*i),t}}function sb(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function vde(n,e){var t={},i={},r;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in n?t[r]=u6(n[r],e[r]):i[r]=e[r];return function(s){for(r in t)i[r]=t[r](s);return i}}var q4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,E3=new RegExp(q4.source,"g");function yde(n){return function(){return n}}function _de(n){return function(e){return n(e)+""}}function xde(n,e){var t=q4.lastIndex=E3.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(n=n+"",e=e+"";(i=q4.exec(n))&&(r=E3.exec(e));)(s=r.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:sb(i,r)})),t=E3.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?_de(l[0].x):yde(e):(e=l.length,function(u){for(var c=0,h;c<e;++c)a[(h=l[c]).i]=h.x(u);return a.join("")})}function u6(n,e){var t=typeof e,i;return e==null||t==="boolean"?l6(e):(t==="number"?sb:t==="string"?(i=kd(e))?(e=i,GL):xde:e instanceof kd?GL:e instanceof Date?gde:qG(e)?GG:Array.isArray(e)?HG:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?vde:sb)(n,e)}function bde(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}function Sde(n){return function(){return n}}function wde(n){return+n}var qL=[0,1];function wA(n){return n}function H4(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:Sde(isNaN(e)?NaN:.5)}function Ede(n,e){var t;return n>e&&(t=n,n=e,e=t),function(i){return Math.max(n,Math.min(e,i))}}function Tde(n,e,t){var i=n[0],r=n[1],s=e[0],o=e[1];return r<i?(i=H4(r,i),s=t(o,s)):(i=H4(i,r),s=t(s,o)),function(a){return s(i(a))}}function Cde(n,e,t){var i=Math.min(n.length,e.length)-1,r=new Array(i),s=new Array(i),o=-1;for(n[i]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=H4(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=ode(n,a,1,i)-1;return s[l](r[l](a))}}function Mde(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Rde(){var n=qL,e=qL,t=u6,i,r,s,o=wA,a,l,u;function c(){var A=Math.min(n.length,e.length);return o!==wA&&(o=Ede(n[0],n[A-1])),a=A>2?Cde:Tde,l=u=null,h}function h(A){return A==null||isNaN(A=+A)?s:(l||(l=a(n.map(i),e,t)))(i(o(A)))}return h.invert=function(A){return o(r((u||(u=a(e,n.map(i),sb)))(A)))},h.domain=function(A){return arguments.length?(n=Array.from(A,wde),c()):n.slice()},h.range=function(A){return arguments.length?(e=Array.from(A),c()):e.slice()},h.rangeRound=function(A){return e=Array.from(A),t=bde,c()},h.clamp=function(A){return arguments.length?(o=A?!0:wA,c()):o!==wA},h.interpolate=function(A){return arguments.length?(t=A,c()):t},h.unknown=function(A){return arguments.length?(s=A,h):s},function(A,v){return i=A,r=v,c()}}function Pde(){return Rde()(wA,wA)}function Nde(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function ob(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,i=n.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+n.slice(t+1)]}function E0(n){return n=ob(Math.abs(n)),n?n[1]:NaN}function Ide(n,e){return function(t,i){for(var r=t.length,s=[],o=0,a=n[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),s.push(t.substring(r-=a,r+a)),!((l+=a+1)>i));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function Dde(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var kde=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ab(n){if(!(e=kde.exec(n)))throw new Error("invalid format: "+n);var e;return new c6({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}ab.prototype=c6.prototype;function c6(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}c6.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Lde(n){e:for(var e=n.length,t=1,i=-1,r;t<e;++t)switch(n[t]){case".":i=r=t;break;case"0":i===0&&(i=t),r=t;break;default:if(!+n[t])break e;i>0&&(i=0);break}return i>0?n.slice(0,i)+n.slice(r+1):n}var $G;function Fde(n,e){var t=ob(n,e);if(!t)return n+"";var i=t[0],r=t[1],s=r-($G=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+ob(n,Math.max(0,e+s-1))[0]}function HL(n,e){var t=ob(n,e);if(!t)return n+"";var i=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const $L={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:Nde,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>HL(n*100,e),r:HL,s:Fde,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function jL(n){return n}var WL=Array.prototype.map,XL=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Bde(n){var e=n.grouping===void 0||n.thousands===void 0?jL:Ide(WL.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",i=n.currency===void 0?"":n.currency[1]+"",r=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?jL:Dde(WL.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function u(h){h=ab(h);var A=h.fill,v=h.align,_=h.sign,S=h.symbol,w=h.zero,x=h.width,M=h.comma,R=h.precision,N=h.trim,B=h.type;B==="n"?(M=!0,B="g"):$L[B]||(R===void 0&&(R=12),N=!0,B="g"),(w||A==="0"&&v==="=")&&(w=!0,A="0",v="=");var T=S==="$"?t:S==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",D=S==="$"?i:/[%p]/.test(B)?o:"",F=$L[B],L=/[defgprs%]/.test(B);R=R===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,R)):Math.max(0,Math.min(20,R));function O(z){var Q=T,j=D,ee,$,Z;if(B==="c")j=F(z)+j,z="";else{z=+z;var ce=z<0||1/z<0;if(z=isNaN(z)?l:F(Math.abs(z),R),N&&(z=Lde(z)),ce&&+z==0&&_!=="+"&&(ce=!1),Q=(ce?_==="("?_:a:_==="-"||_==="("?"":_)+Q,j=(B==="s"?XL[8+$G/3]:"")+j+(ce&&_==="("?")":""),L){for(ee=-1,$=z.length;++ee<$;)if(Z=z.charCodeAt(ee),48>Z||Z>57){j=(Z===46?r+z.slice(ee+1):z.slice(ee))+j,z=z.slice(0,ee);break}}}M&&!w&&(z=e(z,1/0));var ie=Q.length+z.length+j.length,oe=ie<x?new Array(x-ie+1).join(A):"";switch(M&&w&&(z=e(oe+z,oe.length?x-j.length:1/0),oe=""),v){case"<":z=Q+z+j+oe;break;case"=":z=Q+oe+z+j;break;case"^":z=oe.slice(0,ie=oe.length>>1)+Q+z+j+oe.slice(ie);break;default:z=oe+Q+z+j;break}return s(z)}return O.toString=function(){return h+""},O}function c(h,A){var v=u((h=ab(h),h.type="f",h)),_=Math.max(-8,Math.min(8,Math.floor(E0(A)/3)))*3,S=Math.pow(10,-_),w=XL[8+_/3];return function(x){return v(S*x)+w}}return{format:u,formatPrefix:c}}var h_,jG,WG;Ode({thousands:",",grouping:[3],currency:["$",""]});function Ode(n){return h_=Bde(n),jG=h_.format,WG=h_.formatPrefix,h_}function Ude(n){return Math.max(0,-E0(Math.abs(n)))}function zde(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(E0(e)/3)))*3-E0(Math.abs(n)))}function Vde(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,E0(e)-E0(n))+1}function Gde(n,e,t,i){var r=hde(n,e,t),s;switch(i=ab(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return i.precision==null&&!isNaN(s=zde(r,o))&&(i.precision=s),WG(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=Vde(r,Math.max(Math.abs(n),Math.abs(e))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=Ude(r))&&(i.precision=s-(i.type==="%")*2);break}}return jG(i)}function qde(n){var e=n.domain;return n.ticks=function(t){var i=e();return cde(i[0],i[i.length-1],t??10)},n.tickFormat=function(t,i){var r=e();return Gde(r[0],r[r.length-1],t??10,i)},n.nice=function(t){t==null&&(t=10);var i=e(),r=0,s=i.length-1,o=i[r],a=i[s],l,u,c=10;for(a<o&&(u=o,o=a,a=u,u=r,r=s,s=u);c-- >0;){if(u=G4(o,a,t),u===l)return i[r]=o,i[s]=a,e(i);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return n},n}function Ld(){var n=Pde();return n.copy=function(){return Mde(n,Ld())},fde.apply(n,arguments),qde(n)}const Zu=11102230246251565e-32,Ss=134217729,Hde=(3+8*Zu)*Zu;function T3(n,e,t,i,r){let s,o,a,l,u=e[0],c=i[0],h=0,A=0;c>u==c>-u?(s=u,u=e[++h]):(s=c,c=i[++A]);let v=0;if(h<n&&A<t)for(c>u==c>-u?(o=u+s,a=s-(o-u),u=e[++h]):(o=c+s,a=s-(o-c),c=i[++A]),s=o,a!==0&&(r[v++]=a);h<n&&A<t;)c>u==c>-u?(o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++h]):(o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++A]),s=o,a!==0&&(r[v++]=a);for(;h<n;)o=s+u,l=o-s,a=s-(o-l)+(u-l),u=e[++h],s=o,a!==0&&(r[v++]=a);for(;A<t;)o=s+c,l=o-s,a=s-(o-l)+(c-l),c=i[++A],s=o,a!==0&&(r[v++]=a);return(s!==0||v===0)&&(r[v++]=s),v}function $de(n,e){let t=e[0];for(let i=1;i<n;i++)t+=e[i];return t}function Mv(n){return new Float64Array(n)}const jde=(3+16*Zu)*Zu,Wde=(2+12*Zu)*Zu,Xde=(9+64*Zu)*Zu*Zu,Ip=Mv(4),YL=Mv(8),QL=Mv(12),KL=Mv(16),Gs=Mv(4);function Yde(n,e,t,i,r,s,o){let a,l,u,c,h,A,v,_,S,w,x,M,R,N,B,T,D,F;const L=n-r,O=t-r,z=e-s,Q=i-s;N=L*Q,A=Ss*L,v=A-(A-L),_=L-v,A=Ss*Q,S=A-(A-Q),w=Q-S,B=_*w-(N-v*S-_*S-v*w),T=z*O,A=Ss*z,v=A-(A-z),_=z-v,A=Ss*O,S=A-(A-O),w=O-S,D=_*w-(T-v*S-_*S-v*w),x=B-D,h=B-x,Ip[0]=B-(x+h)+(h-D),M=N+x,h=M-N,R=N-(M-h)+(x-h),x=R-T,h=R-x,Ip[1]=R-(x+h)+(h-T),F=M+x,h=F-M,Ip[2]=M-(F-h)+(x-h),Ip[3]=F;let j=$de(4,Ip),ee=Wde*o;if(j>=ee||-j>=ee||(h=n-L,a=n-(L+h)+(h-r),h=t-O,u=t-(O+h)+(h-r),h=e-z,l=e-(z+h)+(h-s),h=i-Q,c=i-(Q+h)+(h-s),a===0&&l===0&&u===0&&c===0)||(ee=Xde*o+Hde*Math.abs(j),j+=L*c+Q*a-(z*u+O*l),j>=ee||-j>=ee))return j;N=a*Q,A=Ss*a,v=A-(A-a),_=a-v,A=Ss*Q,S=A-(A-Q),w=Q-S,B=_*w-(N-v*S-_*S-v*w),T=l*O,A=Ss*l,v=A-(A-l),_=l-v,A=Ss*O,S=A-(A-O),w=O-S,D=_*w-(T-v*S-_*S-v*w),x=B-D,h=B-x,Gs[0]=B-(x+h)+(h-D),M=N+x,h=M-N,R=N-(M-h)+(x-h),x=R-T,h=R-x,Gs[1]=R-(x+h)+(h-T),F=M+x,h=F-M,Gs[2]=M-(F-h)+(x-h),Gs[3]=F;const $=T3(4,Ip,4,Gs,YL);N=L*c,A=Ss*L,v=A-(A-L),_=L-v,A=Ss*c,S=A-(A-c),w=c-S,B=_*w-(N-v*S-_*S-v*w),T=z*u,A=Ss*z,v=A-(A-z),_=z-v,A=Ss*u,S=A-(A-u),w=u-S,D=_*w-(T-v*S-_*S-v*w),x=B-D,h=B-x,Gs[0]=B-(x+h)+(h-D),M=N+x,h=M-N,R=N-(M-h)+(x-h),x=R-T,h=R-x,Gs[1]=R-(x+h)+(h-T),F=M+x,h=F-M,Gs[2]=M-(F-h)+(x-h),Gs[3]=F;const Z=T3($,YL,4,Gs,QL);N=a*c,A=Ss*a,v=A-(A-a),_=a-v,A=Ss*c,S=A-(A-c),w=c-S,B=_*w-(N-v*S-_*S-v*w),T=l*u,A=Ss*l,v=A-(A-l),_=l-v,A=Ss*u,S=A-(A-u),w=u-S,D=_*w-(T-v*S-_*S-v*w),x=B-D,h=B-x,Gs[0]=B-(x+h)+(h-D),M=N+x,h=M-N,R=N-(M-h)+(x-h),x=R-T,h=R-x,Gs[1]=R-(x+h)+(h-T),F=M+x,h=F-M,Gs[2]=M-(F-h)+(x-h),Gs[3]=F;const ce=T3(Z,QL,4,Gs,KL);return KL[ce-1]}function f_(n,e,t,i,r,s){const o=(e-s)*(t-r),a=(n-r)*(i-s),l=o-a,u=Math.abs(o+a);return Math.abs(l)>=jde*u?l:-Yde(n,e,t,i,r,s,u)}const ZL=Math.pow(2,-52),d_=new Uint32Array(512);class L1{static from(e,t=epe,i=tpe){const r=e.length,s=new Float64Array(r*2);for(let o=0;o<r;o++){const a=e[o];s[2*o]=t(a),s[2*o+1]=i(a)}return new L1(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*t-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:i,_hullTri:r,_hullHash:s}=this,o=e.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let L=0;L<o;L++){const O=e[2*L],z=e[2*L+1];O<a&&(a=O),z<l&&(l=z),O>u&&(u=O),z>c&&(c=z),this._ids[L]=L}const h=(a+u)/2,A=(l+c)/2;let v,_,S;for(let L=0,O=1/0;L<o;L++){const z=C3(h,A,e[2*L],e[2*L+1]);z<O&&(v=L,O=z)}const w=e[2*v],x=e[2*v+1];for(let L=0,O=1/0;L<o;L++){if(L===v)continue;const z=C3(w,x,e[2*L],e[2*L+1]);z<O&&z>0&&(_=L,O=z)}let M=e[2*_],R=e[2*_+1],N=1/0;for(let L=0;L<o;L++){if(L===v||L===_)continue;const O=Zde(w,x,M,R,e[2*L],e[2*L+1]);O<N&&(S=L,N=O)}let B=e[2*S],T=e[2*S+1];if(N===1/0){for(let z=0;z<o;z++)this._dists[z]=e[2*z]-e[0]||e[2*z+1]-e[1];EA(this._ids,this._dists,0,o-1);const L=new Uint32Array(o);let O=0;for(let z=0,Q=-1/0;z<o;z++){const j=this._ids[z],ee=this._dists[j];ee>Q&&(L[O++]=j,Q=ee)}this.hull=L.subarray(0,O),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(f_(w,x,M,R,B,T)<0){const L=_,O=M,z=R;_=S,M=B,R=T,S=L,B=O,T=z}const D=Jde(w,x,M,R,B,T);this._cx=D.x,this._cy=D.y;for(let L=0;L<o;L++)this._dists[L]=C3(e[2*L],e[2*L+1],D.x,D.y);EA(this._ids,this._dists,0,o-1),this._hullStart=v;let F=3;i[v]=t[S]=_,i[_]=t[v]=S,i[S]=t[_]=v,r[v]=0,r[_]=1,r[S]=2,s.fill(-1),s[this._hashKey(w,x)]=v,s[this._hashKey(M,R)]=_,s[this._hashKey(B,T)]=S,this.trianglesLen=0,this._addTriangle(v,_,S,-1,-1,-1);for(let L=0,O,z;L<this._ids.length;L++){const Q=this._ids[L],j=e[2*Q],ee=e[2*Q+1];if(L>0&&Math.abs(j-O)<=ZL&&Math.abs(ee-z)<=ZL||(O=j,z=ee,Q===v||Q===_||Q===S))continue;let $=0;for(let me=0,_e=this._hashKey(j,ee);me<this._hashSize&&($=s[(_e+me)%this._hashSize],!($!==-1&&$!==i[$]));me++);$=t[$];let Z=$,ce;for(;ce=i[Z],f_(j,ee,e[2*Z],e[2*Z+1],e[2*ce],e[2*ce+1])>=0;)if(Z=ce,Z===$){Z=-1;break}if(Z===-1)continue;let ie=this._addTriangle(Z,Q,i[Z],-1,-1,r[Z]);r[Q]=this._legalize(ie+2),r[Z]=ie,F++;let oe=i[Z];for(;ce=i[oe],f_(j,ee,e[2*oe],e[2*oe+1],e[2*ce],e[2*ce+1])<0;)ie=this._addTriangle(oe,Q,ce,r[Q],-1,r[oe]),r[Q]=this._legalize(ie+2),i[oe]=oe,F--,oe=ce;if(Z===$)for(;ce=t[Z],f_(j,ee,e[2*ce],e[2*ce+1],e[2*Z],e[2*Z+1])<0;)ie=this._addTriangle(ce,Q,Z,-1,r[Z],r[ce]),this._legalize(ie+2),r[ce]=ie,i[Z]=Z,F--,Z=ce;this._hullStart=t[Q]=Z,i[Z]=t[oe]=Q,i[Q]=oe,s[this._hashKey(j,ee)]=Q,s[this._hashKey(e[2*Z],e[2*Z+1])]=Z}this.hull=new Uint32Array(F);for(let L=0,O=this._hullStart;L<F;L++)this.hull[L]=O,O=i[O];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(Qde(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:i,coords:r}=this;let s=0,o=0;for(;;){const a=i[e],l=e-e%3;if(o=l+(e+2)%3,a===-1){if(s===0)break;e=d_[--s];continue}const u=a-a%3,c=l+(e+1)%3,h=u+(a+2)%3,A=t[o],v=t[e],_=t[c],S=t[h];if(Kde(r[2*A],r[2*A+1],r[2*v],r[2*v+1],r[2*_],r[2*_+1],r[2*S],r[2*S+1])){t[e]=S,t[a]=A;const x=i[h];if(x===-1){let R=this._hullStart;do{if(this._hullTri[R]===h){this._hullTri[R]=e;break}R=this._hullPrev[R]}while(R!==this._hullStart)}this._link(e,x),this._link(a,i[o]),this._link(o,h);const M=u+(a+1)%3;s<d_.length&&(d_[s++]=M)}else{if(s===0)break;e=d_[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,i,r,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=t,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function Qde(n,e){const t=n/(Math.abs(n)+Math.abs(e));return(e>0?3-t:1+t)/4}function C3(n,e,t,i){const r=n-t,s=e-i;return r*r+s*s}function Kde(n,e,t,i,r,s,o,a){const l=n-o,u=e-a,c=t-o,h=i-a,A=r-o,v=s-a,_=l*l+u*u,S=c*c+h*h,w=A*A+v*v;return l*(h*w-S*v)-u*(c*w-S*A)+_*(c*v-h*A)<0}function Zde(n,e,t,i,r,s){const o=t-n,a=i-e,l=r-n,u=s-e,c=o*o+a*a,h=l*l+u*u,A=.5/(o*u-a*l),v=(u*c-a*h)*A,_=(o*h-l*c)*A;return v*v+_*_}function Jde(n,e,t,i,r,s){const o=t-n,a=i-e,l=r-n,u=s-e,c=o*o+a*a,h=l*l+u*u,A=.5/(o*u-a*l),v=n+(u*c-a*h)*A,_=e+(o*h-l*c)*A;return{x:v,y:_}}function EA(n,e,t,i){if(i-t<=20)for(let r=t+1;r<=i;r++){const s=n[r],o=e[s];let a=r-1;for(;a>=t&&e[n[a]]>o;)n[a+1]=n[a--];n[a+1]=s}else{const r=t+i>>1;let s=t+1,o=i;Gm(n,r,s),e[n[t]]>e[n[i]]&&Gm(n,t,i),e[n[s]]>e[n[i]]&&Gm(n,s,i),e[n[t]]>e[n[s]]&&Gm(n,t,s);const a=n[s],l=e[a];for(;;){do s++;while(e[n[s]]<l);do o--;while(e[n[o]]>l);if(o<s)break;Gm(n,s,o)}n[t+1]=n[o],n[o]=a,i-s+1>=o-t?(EA(n,e,s,i),EA(n,e,t,o-1)):(EA(n,e,t,o-1),EA(n,e,s,i))}}function Gm(n,e,t){const i=n[e];n[e]=n[t],n[t]=i}function epe(n){return n[0]}function tpe(n){return n[1]}function npe(n,e){var t=0,i=0,r=0,s=0,o=0,a=0,l=0,u=0,c=null,h=null,A=n[0],v=n[1],_=e.length;for(t;t<_;t++){i=0;var S=e[t].length-1,w=e[t];if(c=w[0],c[0]!==w[S][0]&&c[1]!==w[S][1])throw new Error("First and last coordinates in a ring must be the same");for(o=c[0]-A,a=c[1]-v,i;i<S;i++){if(h=w[i+1],u=h[1]-v,a<0&&u<0||a>0&&u>0){c=h,a=u,o=c[0]-A;continue}if(l=h[0]-n[0],u>0&&a<=0){if(s=o*u-l*a,s>0)r=r+1;else if(s===0)return 0}else if(a>0&&u<=0){if(s=o*u-l*a,s<0)r=r+1;else if(s===0)return 0}else if(u===0&&a<0){if(s=o*u-l*a,s===0)return 0}else if(a===0&&u<0){if(s=o*u-l*a,s===0)return 0}else if(a===0&&u===0){if(l<=0&&o>=0)return 0;if(o<=0&&l>=0)return 0}c=h,a=u,o=l}}return r%2!==0}function ipe(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return[...n.geometry.coordinates];if(n.type==="Point")return[...n.coordinates]}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return[...n];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function rpe(n){return n.type==="Feature"?n.geometry:n}function spe(n,e,t={}){if(!n)throw new Error("point is required");if(!e)throw new Error("polygon is required");const i=ipe(n),r=rpe(e),s=r.type,o=e.bbox;let a=r.coordinates;if(o&&ope(i,o)===!1)return!1;s==="Polygon"&&(a=[a]);let l=!1;for(var u=0;u<a.length;++u){const c=npe(i,a[u]);if(c===0)return!t.ignoreBoundary;c&&(l=!0)}return l}function ope(n,e){return e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]}var ape=spe;const JL=1e-6;let md=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,i){e=+e,t=+t,i=+i;const r=e+i,s=t;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${s}`:(Math.abs(this._x1-r)>JL||Math.abs(this._y1-s)>JL)&&(this._+="L"+r+","+s),i&&(this._+=`A${i},${i},0,1,1,${e-i},${t}A${i},${i},0,1,1,${this._x1=r},${this._y1=s}`)}rect(e,t,i,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+i}v${+r}h${-i}Z`}value(){return this._||null}};class $4{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class lpe{constructor(e,[t,i,r,s]=[0,0,960,500]){if(!((r=+r)>=(t=+t))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=r,this.xmin=t,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:i},vectors:r}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let S=0,w=0,x=i.length,M,R;S<x;S+=3,w+=2){const N=i[S]*2,B=i[S+1]*2,T=i[S+2]*2,D=e[N],F=e[N+1],L=e[B],O=e[B+1],z=e[T],Q=e[T+1],j=L-D,ee=O-F,$=z-D,Z=Q-F,ce=(j*Z-ee*$)*2;if(Math.abs(ce)<1e-9){if(s===void 0){s=o=0;for(const oe of t)s+=e[oe*2],o+=e[oe*2+1];s/=t.length,o/=t.length}const ie=1e9*Math.sign((s-D)*Z-(o-F)*$);M=(D+z)/2-ie*Z,R=(F+Q)/2+ie*$}else{const ie=1/ce,oe=j*j+ee*ee,me=$*$+Z*Z;M=D+(Z*oe-ee*me)*ie,R=F+(j*me-$*oe)*ie}a[w]=M,a[w+1]=R}let l=t[t.length-1],u,c=l*4,h,A=e[2*l],v,_=e[2*l+1];r.fill(0);for(let S=0;S<t.length;++S)l=t[S],u=c,h=A,v=_,c=l*4,A=e[2*l],_=e[2*l+1],r[u+2]=r[c]=v-_,r[u+3]=r[c+1]=A-h}render(e){const t=e==null?e=new md:void 0,{delaunay:{halfedges:i,inedges:r,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let c=0,h=i.length;c<h;++c){const A=i[c];if(A<c)continue;const v=Math.floor(c/3)*2,_=Math.floor(A/3)*2,S=o[v],w=o[v+1],x=o[_],M=o[_+1];this._renderSegment(S,w,x,M,e)}let l,u=s[s.length-1];for(let c=0;c<s.length;++c){l=u,u=s[c];const h=Math.floor(r[u]/3)*2,A=o[h],v=o[h+1],_=l*4,S=this._project(A,v,a[_+2],a[_+3]);S&&this._renderSegment(A,v,S[0],S[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new md:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const i=t==null?t=new md:void 0,r=this._clip(e);if(r===null||!r.length)return;t.moveTo(r[0],r[1]);let s=r.length;for(;r[0]===r[s-2]&&r[1]===r[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&t.lineTo(r[o],r[o+1]);return t.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,i=e.length/2;t<i;++t){const r=this.cellPolygon(t);r&&(r.index=t,yield r)}}cellPolygon(e){const t=new $4;return this.renderCell(e,t),t.value()}_renderSegment(e,t,i,r,s){let o;const a=this._regioncode(e,t),l=this._regioncode(i,r);a===0&&l===0?(s.moveTo(e,t),s.lineTo(i,r)):(o=this._clipSegment(e,t,i,r,a,l))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,i){return t=+t,t!==t||(i=+i,i!==i)?!1:this.delaunay._step(e,t,i)===e}*neighbors(e){const t=this._clip(e);if(t)for(const i of this.delaunay.neighbors(e)){const r=this._clip(i);if(r){e:for(let s=0,o=t.length;s<o;s+=2)for(let a=0,l=r.length;a<l;a+=2)if(t[s]===r[a]&&t[s+1]===r[a+1]&&t[(s+2)%o]===r[(a+l-2)%l]&&t[(s+3)%o]===r[(a+l-1)%l]){yield i;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:i,halfedges:r,triangles:s}}=this,o=i[e];if(o===-1)return null;const a=[];let l=o;do{const u=Math.floor(l/3);if(a.push(t[u*2],t[u*2+1]),l=l%3===2?l-2:l+1,s[l]!==e)break;l=r[l]}while(l!==o&&l!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:i}=this,r=e*4;return this._simplify(i[r]||i[r+1]?this._clipInfinite(e,t,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(e,t))}_clipFinite(e,t){const i=t.length;let r=null,s,o,a=t[i-2],l=t[i-1],u,c=this._regioncode(a,l),h,A=0;for(let v=0;v<i;v+=2)if(s=a,o=l,a=t[v],l=t[v+1],u=c,c=this._regioncode(a,l),u===0&&c===0)h=A,A=0,r?r.push(a,l):r=[a,l];else{let _,S,w,x,M;if(u===0){if((_=this._clipSegment(s,o,a,l,u,c))===null)continue;[S,w,x,M]=_}else{if((_=this._clipSegment(a,l,s,o,c,u))===null)continue;[x,M,S,w]=_,h=A,A=this._edgecode(S,w),h&&A&&this._edge(e,h,A,r,r.length),r?r.push(S,w):r=[S,w]}h=A,A=this._edgecode(x,M),h&&A&&this._edge(e,h,A,r,r.length),r?r.push(x,M):r=[x,M]}if(r)h=A,A=this._edgecode(r[0],r[1]),h&&A&&this._edge(e,h,A,r,r.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(e,t,i,r,s,o){const a=s<o;for(a&&([e,t,i,r,s,o]=[i,r,e,t,o,s]);;){if(s===0&&o===0)return a?[i,r,e,t]:[e,t,i,r];if(s&o)return null;let l,u,c=s||o;c&8?(l=e+(i-e)*(this.ymax-t)/(r-t),u=this.ymax):c&4?(l=e+(i-e)*(this.ymin-t)/(r-t),u=this.ymin):c&2?(u=t+(r-t)*(this.xmax-e)/(i-e),l=this.xmax):(u=t+(r-t)*(this.xmin-e)/(i-e),l=this.xmin),s?(e=l,t=u,s=this._regioncode(e,t)):(i=l,r=u,o=this._regioncode(i,r))}}_clipInfinite(e,t,i,r,s,o){let a=Array.from(t),l;if((l=this._project(a[0],a[1],i,r))&&a.unshift(l[0],l[1]),(l=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(l[0],l[1]),a=this._clipFinite(e,a))for(let u=0,c=a.length,h,A=this._edgecode(a[c-2],a[c-1]);u<c;u+=2)h=A,A=this._edgecode(a[u],a[u+1]),h&&A&&(u=this._edge(e,h,A,a,u),c=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,t,i,r,s){for(;t!==i;){let o,a;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,a=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,a=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,a=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,a=this.ymin;break}(r[s]!==o||r[s+1]!==a)&&this.contains(e,o,a)&&(r.splice(s,0,o,a),s+=2)}return s}_project(e,t,i,r){let s=1/0,o,a,l;if(r<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/r)<s&&(l=this.ymin,a=e+(s=o)*i)}else if(r>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/r)<s&&(l=this.ymax,a=e+(s=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<s&&(a=this.xmax,l=t+(s=o)*r)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<s&&(a=this.xmin,l=t+(s=o)*r)}return[a,l]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const i=(t+2)%e.length,r=(t+4)%e.length;(e[t]===e[i]&&e[i]===e[r]||e[t+1]===e[i+1]&&e[i+1]===e[r+1])&&(e.splice(i,2),t-=2)}e.length||(e=null)}return e}}const upe=2*Math.PI,Dp=Math.pow;function cpe(n){return n[0]}function hpe(n){return n[1]}function fpe(n){const{triangles:e,coords:t}=n;for(let i=0;i<e.length;i+=3){const r=2*e[i],s=2*e[i+1],o=2*e[i+2];if((t[o]-t[r])*(t[s+1]-t[r+1])-(t[s]-t[r])*(t[o+1]-t[r+1])>1e-10)return!1}return!0}function dpe(n,e,t){return[n+Math.sin(n+e)*t,e+Math.cos(n-e)*t]}class h6{static from(e,t=cpe,i=hpe,r){return new h6("length"in e?ppe(e,t,i,r):Float64Array.from(Ape(e,t,i,r)))}constructor(e){this._delaunator=new L1(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&fpe(e)){this.collinear=Int32Array.from({length:t.length/2},(A,v)=>v).sort((A,v)=>t[2*A]-t[2*v]||t[2*A+1]-t[2*v+1]);const l=this.collinear[0],u=this.collinear[this.collinear.length-1],c=[t[2*l],t[2*l+1],t[2*u],t[2*u+1]],h=1e-8*Math.hypot(c[3]-c[1],c[2]-c[0]);for(let A=0,v=t.length/2;A<v;++A){const _=dpe(t[2*A],t[2*A+1],h);t[2*A]=_[0],t[2*A+1]=_[1]}this._delaunator=new L1(t)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let l=0,u=i.length;l<u;++l){const c=s[l%3===2?l-2:l+1];(i[l]===-1||o[c]===-1)&&(o[c]=l)}for(let l=0,u=r.length;l<u;++l)a[r[l]]=l;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,r.length===2&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(e){return new lpe(this,e)}*neighbors(e){const{inedges:t,hull:i,_hullIndex:r,halfedges:s,triangles:o,collinear:a}=this;if(a){const h=a.indexOf(e);h>0&&(yield a[h-1]),h<a.length-1&&(yield a[h+1]);return}const l=t[e];if(l===-1)return;let u=l,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=s[u],u===-1){const h=i[(r[e]+1)%i.length];h!==c&&(yield h);return}}while(u!==l)}find(e,t,i=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const r=i;let s;for(;(s=this._step(i,e,t))>=0&&s!==i&&s!==r;)i=s;return s}_step(e,t,i){const{inedges:r,hull:s,_hullIndex:o,halfedges:a,triangles:l,points:u}=this;if(r[e]===-1||!u.length)return(e+1)%(u.length>>1);let c=e,h=Dp(t-u[e*2],2)+Dp(i-u[e*2+1],2);const A=r[e];let v=A;do{let _=l[v];const S=Dp(t-u[_*2],2)+Dp(i-u[_*2+1],2);if(S<h&&(h=S,c=_),v=v%3===2?v-2:v+1,l[v]!==e)break;if(v=a[v],v===-1){if(v=s[(o[e]+1)%s.length],v!==_&&Dp(t-u[v*2],2)+Dp(i-u[v*2+1],2)<h)return v;break}}while(v!==A);return c}render(e){const t=e==null?e=new md:void 0,{points:i,halfedges:r,triangles:s}=this;for(let o=0,a=r.length;o<a;++o){const l=r[o];if(l<o)continue;const u=s[o]*2,c=s[l]*2;e.moveTo(i[u],i[u+1]),e.lineTo(i[c],i[c+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const i=e==null?e=new md:void 0,{points:r}=this;for(let s=0,o=r.length;s<o;s+=2){const a=r[s],l=r[s+1];e.moveTo(a+t,l),e.arc(a,l,t,0,upe)}return i&&i.value()}renderHull(e){const t=e==null?e=new md:void 0,{hull:i,points:r}=this,s=i[0]*2,o=i.length;e.moveTo(r[s],r[s+1]);for(let a=1;a<o;++a){const l=2*i[a];e.lineTo(r[l],r[l+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new $4;return this.renderHull(e),e.value()}renderTriangle(e,t){const i=t==null?t=new md:void 0,{points:r,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,l=s[e+2]*2;return t.moveTo(r[o],r[o+1]),t.lineTo(r[a],r[a+1]),t.lineTo(r[l],r[l+1]),t.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,i=e.length/3;t<i;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new $4;return this.renderTriangle(e,t),t.value()}}function ppe(n,e,t,i){const r=n.length,s=new Float64Array(r*2);for(let o=0;o<r;++o){const a=n[o];s[o*2]=e.call(i,a,o,n),s[o*2+1]=t.call(i,a,o,n)}return s}function*Ape(n,e,t,i){let r=0;for(const s of n)yield e.call(i,s,r,n),yield t.call(i,s,r,n),++r}function XG(n,e){let t,i;for(const r of n)r!=null&&(t===void 0?r>=r&&(t=i=r):(t>r&&(t=r),i<r&&(i=r)));return[t,i]}class zg{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const s=t[r],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(t[i++]=a),e=o}return t[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let t=this._n,i,r,s,o=0;if(t>0){for(o=e[--t];t>0&&(i=o,r=e[--t],o=i+r,s=r-(o-i),!s););t>0&&(s<0&&e[t-1]<0||s>0&&e[t-1]>0)&&(r=s*2,i=o+r,r==i-o&&(o=i))}return o}}function*mpe(n){for(const e of n)yield*e}function YG(n){return Array.from(mpe(n))}var Ri=1e-6,j4=1e-12,ii=Math.PI,Da=ii/2,eF=ii/4,Tl=ii*2,js=180/ii,Zn=ii/180,sr=Math.abs,QG=Math.atan,pc=Math.atan2,Vn=Math.cos,W4=Math.hypot,Gn=Math.sin,gpe=Math.sign||function(n){return n>0?1:n<0?-1:0},tp=Math.sqrt;function vpe(n){return n>1?0:n<-1?ii:Math.acos(n)}function Zh(n){return n>1?Da:n<-1?-Da:Math.asin(n)}function Ma(){}function lb(n,e){n&&nF.hasOwnProperty(n.type)&&nF[n.type](n,e)}var tF={Feature:function(n,e){lb(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,i=-1,r=t.length;++i<r;)lb(t[i].geometry,e)}},nF={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)n=t[i],e.point(n[0],n[1],n[2])},LineString:function(n,e){X4(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)X4(t[i],e,0)},Polygon:function(n,e){iF(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,i=-1,r=t.length;++i<r;)iF(t[i],e)},GeometryCollection:function(n,e){for(var t=n.geometries,i=-1,r=t.length;++i<r;)lb(t[i],e)}};function X4(n,e,t){var i=-1,r=n.length-t,s;for(e.lineStart();++i<r;)s=n[i],e.point(s[0],s[1],s[2]);e.lineEnd()}function iF(n,e){var t=-1,i=n.length;for(e.polygonStart();++t<i;)X4(n[t],e,1);e.polygonEnd()}function f6(n,e){n&&tF.hasOwnProperty(n.type)?tF[n.type](n,e):lb(n,e)}function Y4(n){return[pc(n[1],n[0]),Zh(n[2])]}function T0(n){var e=n[0],t=n[1],i=Vn(t);return[i*Vn(e),i*Gn(e),Gn(t)]}function p_(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function ub(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function M3(n,e){n[0]+=e[0],n[1]+=e[1],n[2]+=e[2]}function A_(n,e){return[n[0]*e,n[1]*e,n[2]*e]}function Q4(n){var e=tp(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=e,n[1]/=e,n[2]/=e}var vg,cb,hb,fb,db,pb,Ab,mb,K4,Z4,J4,KG,ZG,Ws,Xs,Ys,Al={sphere:Ma,point:d6,lineStart:rF,lineEnd:sF,polygonStart:function(){Al.lineStart=xpe,Al.lineEnd=bpe},polygonEnd:function(){Al.lineStart=rF,Al.lineEnd=sF}};function d6(n,e){n*=Zn,e*=Zn;var t=Vn(e);Rv(t*Vn(n),t*Gn(n),Gn(e))}function Rv(n,e,t){++vg,hb+=(n-hb)/vg,fb+=(e-fb)/vg,db+=(t-db)/vg}function rF(){Al.point=ype}function ype(n,e){n*=Zn,e*=Zn;var t=Vn(e);Ws=t*Vn(n),Xs=t*Gn(n),Ys=Gn(e),Al.point=_pe,Rv(Ws,Xs,Ys)}function _pe(n,e){n*=Zn,e*=Zn;var t=Vn(e),i=t*Vn(n),r=t*Gn(n),s=Gn(e),o=pc(tp((o=Xs*s-Ys*r)*o+(o=Ys*i-Ws*s)*o+(o=Ws*r-Xs*i)*o),Ws*i+Xs*r+Ys*s);cb+=o,pb+=o*(Ws+(Ws=i)),Ab+=o*(Xs+(Xs=r)),mb+=o*(Ys+(Ys=s)),Rv(Ws,Xs,Ys)}function sF(){Al.point=d6}function xpe(){Al.point=Spe}function bpe(){JG(KG,ZG),Al.point=d6}function Spe(n,e){KG=n,ZG=e,n*=Zn,e*=Zn,Al.point=JG;var t=Vn(e);Ws=t*Vn(n),Xs=t*Gn(n),Ys=Gn(e),Rv(Ws,Xs,Ys)}function JG(n,e){n*=Zn,e*=Zn;var t=Vn(e),i=t*Vn(n),r=t*Gn(n),s=Gn(e),o=Xs*s-Ys*r,a=Ys*i-Ws*s,l=Ws*r-Xs*i,u=W4(o,a,l),c=Zh(u),h=u&&-c/u;K4.add(h*o),Z4.add(h*a),J4.add(h*l),cb+=c,pb+=c*(Ws+(Ws=i)),Ab+=c*(Xs+(Xs=r)),mb+=c*(Ys+(Ys=s)),Rv(Ws,Xs,Ys)}function oF(n){vg=cb=hb=fb=db=pb=Ab=mb=0,K4=new zg,Z4=new zg,J4=new zg,f6(n,Al);var e=+K4,t=+Z4,i=+J4,r=W4(e,t,i);return r<j4&&(e=pb,t=Ab,i=mb,cb<Ri&&(e=hb,t=fb,i=db),r=W4(e,t,i),r<j4)?[NaN,NaN]:[pc(t,e)*js,Zh(i/r)*js]}function eR(n,e){function t(i,r){return i=n(i,r),e(i[0],i[1])}return n.invert&&e.invert&&(t.invert=function(i,r){return i=e.invert(i,r),i&&n.invert(i[0],i[1])}),t}function tR(n,e){return sr(n)>ii&&(n-=Math.round(n/Tl)*Tl),[n,e]}tR.invert=tR;function eq(n,e,t){return(n%=Tl)?e||t?eR(lF(n),uF(e,t)):lF(n):e||t?uF(e,t):tR}function aF(n){return function(e,t){return e+=n,sr(e)>ii&&(e-=Math.round(e/Tl)*Tl),[e,t]}}function lF(n){var e=aF(n);return e.invert=aF(-n),e}function uF(n,e){var t=Vn(n),i=Gn(n),r=Vn(e),s=Gn(e);function o(a,l){var u=Vn(l),c=Vn(a)*u,h=Gn(a)*u,A=Gn(l),v=A*t+c*i;return[pc(h*r-v*s,c*t-A*i),Zh(v*r+h*s)]}return o.invert=function(a,l){var u=Vn(l),c=Vn(a)*u,h=Gn(a)*u,A=Gn(l),v=A*r-h*s;return[pc(h*r+A*s,c*t+v*i),Zh(v*t-c*i)]},o}function wpe(n){n=eq(n[0]*Zn,n[1]*Zn,n.length>2?n[2]*Zn:0);function e(t){return t=n(t[0]*Zn,t[1]*Zn),t[0]*=js,t[1]*=js,t}return e.invert=function(t){return t=n.invert(t[0]*Zn,t[1]*Zn),t[0]*=js,t[1]*=js,t},e}function Epe(n,e,t,i,r,s){if(t){var o=Vn(e),a=Gn(e),l=i*t;r==null?(r=e+i*Tl,s=e-l/2):(r=cF(o,r),s=cF(o,s),(i>0?r<s:r>s)&&(r+=i*Tl));for(var u,c=r;i>0?c>s:c<s;c-=l)u=Y4([o,-a*Vn(c),-a*Gn(c)]),n.point(u[0],u[1])}}function cF(n,e){e=T0(e),e[0]-=n,Q4(e);var t=vpe(-e[1]);return((-e[2]<0?-t:t)+Tl-Ri)%Tl}function tq(){var n=[],e;return{point:function(t,i,r){e.push([t,i,r])},lineStart:function(){n.push(e=[])},lineEnd:Ma,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var t=n;return n=[],e=null,t}}}function H2(n,e){return sr(n[0]-e[0])<Ri&&sr(n[1]-e[1])<Ri}function m_(n,e,t,i){this.x=n,this.z=e,this.o=t,this.e=i,this.v=!1,this.n=this.p=null}function nq(n,e,t,i,r){var s=[],o=[],a,l;if(n.forEach(function(_){if(!((S=_.length-1)<=0)){var S,w=_[0],x=_[S],M;if(H2(w,x)){if(!w[2]&&!x[2]){for(r.lineStart(),a=0;a<S;++a)r.point((w=_[a])[0],w[1]);r.lineEnd();return}x[0]+=2*Ri}s.push(M=new m_(w,_,null,!0)),o.push(M.o=new m_(w,null,M,!1)),s.push(M=new m_(x,_,null,!1)),o.push(M.o=new m_(x,null,M,!0))}}),!!s.length){for(o.sort(e),hF(s),hF(o),a=0,l=o.length;a<l;++a)o[a].e=t=!t;for(var u=s[0],c,h;;){for(var A=u,v=!0;A.v;)if((A=A.n)===u)return;c=A.z,r.lineStart();do{if(A.v=A.o.v=!0,A.e){if(v)for(a=0,l=c.length;a<l;++a)r.point((h=c[a])[0],h[1]);else i(A.x,A.n.x,1,r);A=A.n}else{if(v)for(c=A.p.z,a=c.length-1;a>=0;--a)r.point((h=c[a])[0],h[1]);else i(A.x,A.p.x,-1,r);A=A.p}A=A.o,c=A.z,v=!v}while(!A.v);r.lineEnd()}}}function hF(n){if(e=n.length){for(var e,t=0,i=n[0],r;++t<e;)i.n=r=n[t],r.p=i,i=r;i.n=r=n[0],r.p=i}}function R3(n){return sr(n[0])<=ii?n[0]:gpe(n[0])*((sr(n[0])+ii)%Tl-ii)}function Tpe(n,e){var t=R3(e),i=e[1],r=Gn(i),s=[Gn(t),-Vn(t),0],o=0,a=0,l=new zg;r===1?i=Da+Ri:r===-1&&(i=-Da-Ri);for(var u=0,c=n.length;u<c;++u)if(A=(h=n[u]).length)for(var h,A,v=h[A-1],_=R3(v),S=v[1]/2+eF,w=Gn(S),x=Vn(S),M=0;M<A;++M,_=N,w=T,x=D,v=R){var R=h[M],N=R3(R),B=R[1]/2+eF,T=Gn(B),D=Vn(B),F=N-_,L=F>=0?1:-1,O=L*F,z=O>ii,Q=w*T;if(l.add(pc(Q*L*Gn(O),x*D+Q*Vn(O))),o+=z?F+L*Tl:F,z^_>=t^N>=t){var j=ub(T0(v),T0(R));Q4(j);var ee=ub(s,j);Q4(ee);var $=(z^F>=0?-1:1)*Zh(ee[2]);(i>$||i===$&&(j[0]||j[1]))&&(a+=z^F>=0?1:-1)}}return(o<-Ri||o<Ri&&l<-j4)^a&1}function iq(n,e,t,i){return function(r){var s=e(r),o=tq(),a=e(o),l=!1,u,c,h,A={point:v,lineStart:S,lineEnd:w,polygonStart:function(){A.point=x,A.lineStart=M,A.lineEnd=R,c=[],u=[]},polygonEnd:function(){A.point=v,A.lineStart=S,A.lineEnd=w,c=YG(c);var N=Tpe(u,i);c.length?(l||(r.polygonStart(),l=!0),nq(c,Mpe,N,t,r)):N&&(l||(r.polygonStart(),l=!0),r.lineStart(),t(null,null,1,r),r.lineEnd()),l&&(r.polygonEnd(),l=!1),c=u=null},sphere:function(){r.polygonStart(),r.lineStart(),t(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function v(N,B){n(N,B)&&r.point(N,B)}function _(N,B){s.point(N,B)}function S(){A.point=_,s.lineStart()}function w(){A.point=v,s.lineEnd()}function x(N,B){h.push([N,B]),a.point(N,B)}function M(){a.lineStart(),h=[]}function R(){x(h[0][0],h[0][1]),a.lineEnd();var N=a.clean(),B=o.result(),T,D=B.length,F,L,O;if(h.pop(),u.push(h),h=null,!!D){if(N&1){if(L=B[0],(F=L.length-1)>0){for(l||(r.polygonStart(),l=!0),r.lineStart(),T=0;T<F;++T)r.point((O=L[T])[0],O[1]);r.lineEnd()}return}D>1&&N&2&&B.push(B.pop().concat(B.shift())),c.push(B.filter(Cpe))}}return A}}function Cpe(n){return n.length>1}function Mpe(n,e){return((n=n.x)[0]<0?n[1]-Da-Ri:Da-n[1])-((e=e.x)[0]<0?e[1]-Da-Ri:Da-e[1])}const fF=iq(function(){return!0},Rpe,Npe,[-ii,-Da]);function Rpe(n){var e=NaN,t=NaN,i=NaN,r;return{lineStart:function(){n.lineStart(),r=1},point:function(s,o){var a=s>0?ii:-ii,l=sr(s-e);sr(l-ii)<Ri?(n.point(e,t=(t+o)/2>0?Da:-Da),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(a,t),n.point(s,t),r=0):i!==a&&l>=ii&&(sr(e-i)<Ri&&(e-=i*Ri),sr(s-a)<Ri&&(s-=a*Ri),t=Ppe(e,t,s,o),n.point(i,t),n.lineEnd(),n.lineStart(),n.point(a,t),r=0),n.point(e=s,t=o),i=a},lineEnd:function(){n.lineEnd(),e=t=NaN},clean:function(){return 2-r}}}function Ppe(n,e,t,i){var r,s,o=Gn(n-t);return sr(o)>Ri?QG((Gn(e)*(s=Vn(i))*Gn(t)-Gn(i)*(r=Vn(e))*Gn(n))/(r*s*o)):(e+i)/2}function Npe(n,e,t,i){var r;if(n==null)r=t*Da,i.point(-ii,r),i.point(0,r),i.point(ii,r),i.point(ii,0),i.point(ii,-r),i.point(0,-r),i.point(-ii,-r),i.point(-ii,0),i.point(-ii,r);else if(sr(n[0]-e[0])>Ri){var s=n[0]<e[0]?ii:-ii;r=t*s/2,i.point(-s,r),i.point(0,r),i.point(s,r)}else i.point(e[0],e[1])}function Ipe(n){var e=Vn(n),t=2*Zn,i=e>0,r=sr(e)>Ri;function s(c,h,A,v){Epe(v,n,t,A,c,h)}function o(c,h){return Vn(c)*Vn(h)>e}function a(c){var h,A,v,_,S;return{lineStart:function(){_=v=!1,S=1},point:function(w,x){var M=[w,x],R,N=o(w,x),B=i?N?0:u(w,x):N?u(w+(w<0?ii:-ii),x):0;if(!h&&(_=v=N)&&c.lineStart(),N!==v&&(R=l(h,M),(!R||H2(h,R)||H2(M,R))&&(M[2]=1)),N!==v)S=0,N?(c.lineStart(),R=l(M,h),c.point(R[0],R[1])):(R=l(h,M),c.point(R[0],R[1],2),c.lineEnd()),h=R;else if(r&&h&&i^N){var T;!(B&A)&&(T=l(M,h,!0))&&(S=0,i?(c.lineStart(),c.point(T[0][0],T[0][1]),c.point(T[1][0],T[1][1]),c.lineEnd()):(c.point(T[1][0],T[1][1]),c.lineEnd(),c.lineStart(),c.point(T[0][0],T[0][1],3)))}N&&(!h||!H2(h,M))&&c.point(M[0],M[1]),h=M,v=N,A=B},lineEnd:function(){v&&c.lineEnd(),h=null},clean:function(){return S|(_&&v)<<1}}}function l(c,h,A){var v=T0(c),_=T0(h),S=[1,0,0],w=ub(v,_),x=p_(w,w),M=w[0],R=x-M*M;if(!R)return!A&&c;var N=e*x/R,B=-e*M/R,T=ub(S,w),D=A_(S,N),F=A_(w,B);M3(D,F);var L=T,O=p_(D,L),z=p_(L,L),Q=O*O-z*(p_(D,D)-1);if(!(Q<0)){var j=tp(Q),ee=A_(L,(-O-j)/z);if(M3(ee,D),ee=Y4(ee),!A)return ee;var $=c[0],Z=h[0],ce=c[1],ie=h[1],oe;Z<$&&(oe=$,$=Z,Z=oe);var me=Z-$,_e=sr(me-ii)<Ri,Oe=_e||me<Ri;if(!_e&&ie<ce&&(oe=ce,ce=ie,ie=oe),Oe?_e?ce+ie>0^ee[1]<(sr(ee[0]-$)<Ri?ce:ie):ce<=ee[1]&&ee[1]<=ie:me>ii^($<=ee[0]&&ee[0]<=Z)){var Ke=A_(L,(-O+j)/z);return M3(Ke,D),[ee,Y4(Ke)]}}}function u(c,h){var A=i?n:ii-n,v=0;return c<-A?v|=1:c>A&&(v|=2),h<-A?v|=4:h>A&&(v|=8),v}return iq(o,a,s,i?[0,-n]:[-ii,n-ii])}function Dpe(n,e,t,i,r,s){var o=n[0],a=n[1],l=e[0],u=e[1],c=0,h=1,A=l-o,v=u-a,_;if(_=t-o,!(!A&&_>0)){if(_/=A,A<0){if(_<c)return;_<h&&(h=_)}else if(A>0){if(_>h)return;_>c&&(c=_)}if(_=r-o,!(!A&&_<0)){if(_/=A,A<0){if(_>h)return;_>c&&(c=_)}else if(A>0){if(_<c)return;_<h&&(h=_)}if(_=i-a,!(!v&&_>0)){if(_/=v,v<0){if(_<c)return;_<h&&(h=_)}else if(v>0){if(_>h)return;_>c&&(c=_)}if(_=s-a,!(!v&&_<0)){if(_/=v,v<0){if(_>h)return;_>c&&(c=_)}else if(v>0){if(_<c)return;_<h&&(h=_)}return c>0&&(n[0]=o+c*A,n[1]=a+c*v),h<1&&(e[0]=o+h*A,e[1]=a+h*v),!0}}}}}var yg=1e9,g_=-yg;function kpe(n,e,t,i){function r(u,c){return n<=u&&u<=t&&e<=c&&c<=i}function s(u,c,h,A){var v=0,_=0;if(u==null||(v=o(u,h))!==(_=o(c,h))||l(u,c)<0^h>0)do A.point(v===0||v===3?n:t,v>1?i:e);while((v=(v+h+4)%4)!==_);else A.point(c[0],c[1])}function o(u,c){return sr(u[0]-n)<Ri?c>0?0:3:sr(u[0]-t)<Ri?c>0?2:1:sr(u[1]-e)<Ri?c>0?1:0:c>0?3:2}function a(u,c){return l(u.x,c.x)}function l(u,c){var h=o(u,1),A=o(c,1);return h!==A?h-A:h===0?c[1]-u[1]:h===1?u[0]-c[0]:h===2?u[1]-c[1]:c[0]-u[0]}return function(u){var c=u,h=tq(),A,v,_,S,w,x,M,R,N,B,T,D={point:F,lineStart:Q,lineEnd:j,polygonStart:O,polygonEnd:z};function F($,Z){r($,Z)&&c.point($,Z)}function L(){for(var $=0,Z=0,ce=v.length;Z<ce;++Z)for(var ie=v[Z],oe=1,me=ie.length,_e=ie[0],Oe,Ke,Me=_e[0],ze=_e[1];oe<me;++oe)Oe=Me,Ke=ze,_e=ie[oe],Me=_e[0],ze=_e[1],Ke<=i?ze>i&&(Me-Oe)*(i-Ke)>(ze-Ke)*(n-Oe)&&++$:ze<=i&&(Me-Oe)*(i-Ke)<(ze-Ke)*(n-Oe)&&--$;return $}function O(){c=h,A=[],v=[],T=!0}function z(){var $=L(),Z=T&&$,ce=(A=YG(A)).length;(Z||ce)&&(u.polygonStart(),Z&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),ce&&nq(A,a,$,s,u),u.polygonEnd()),c=u,A=v=_=null}function Q(){D.point=ee,v&&v.push(_=[]),B=!0,N=!1,M=R=NaN}function j(){A&&(ee(S,w),x&&N&&h.rejoin(),A.push(h.result())),D.point=F,N&&c.lineEnd()}function ee($,Z){var ce=r($,Z);if(v&&_.push([$,Z]),B)S=$,w=Z,x=ce,B=!1,ce&&(c.lineStart(),c.point($,Z));else if(ce&&N)c.point($,Z);else{var ie=[M=Math.max(g_,Math.min(yg,M)),R=Math.max(g_,Math.min(yg,R))],oe=[$=Math.max(g_,Math.min(yg,$)),Z=Math.max(g_,Math.min(yg,Z))];Dpe(ie,oe,n,e,t,i)?(N||(c.lineStart(),c.point(ie[0],ie[1])),c.point(oe[0],oe[1]),ce||c.lineEnd(),T=!1):ce&&(c.lineStart(),c.point($,Z),T=!1)}M=$,R=Z,N=ce}return D}}var nR,iR,$2,j2,C0={sphere:Ma,point:Ma,lineStart:Lpe,lineEnd:Ma,polygonStart:Ma,polygonEnd:Ma};function Lpe(){C0.point=Bpe,C0.lineEnd=Fpe}function Fpe(){C0.point=C0.lineEnd=Ma}function Bpe(n,e){n*=Zn,e*=Zn,iR=n,$2=Gn(e),j2=Vn(e),C0.point=Ope}function Ope(n,e){n*=Zn,e*=Zn;var t=Gn(e),i=Vn(e),r=sr(n-iR),s=Vn(r),o=Gn(r),a=i*o,l=j2*t-$2*i*s,u=$2*t+j2*i*s;nR.add(pc(tp(a*a+l*l),u)),iR=n,$2=t,j2=i}function Upe(n){return nR=new zg,f6(n,C0),+nR}var rR=[null,null],zpe={type:"LineString",coordinates:rR};function dF(n,e){return rR[0]=n,rR[1]=e,Upe(zpe)}const pF=n=>n;var M0=1/0,gb=M0,F1=-M0,vb=F1,AF={point:Vpe,lineStart:Ma,lineEnd:Ma,polygonStart:Ma,polygonEnd:Ma,result:function(){var n=[[M0,gb],[F1,vb]];return F1=vb=-(gb=M0=1/0),n}};function Vpe(n,e){n<M0&&(M0=n),n>F1&&(F1=n),e<gb&&(gb=e),e>vb&&(vb=e)}function p6(n){return function(e){var t=new sR;for(var i in n)t[i]=n[i];return t.stream=e,t}}function sR(){}sR.prototype={constructor:sR,point:function(n,e){this.stream.point(n,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function A6(n,e,t){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),i!=null&&n.clipExtent(null),f6(t,n.stream(AF)),e(AF.result()),i!=null&&n.clipExtent(i),n}function rq(n,e,t){return A6(n,function(i){var r=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(r/(i[1][0]-i[0][0]),s/(i[1][1]-i[0][1])),a=+e[0][0]+(r-o*(i[1][0]+i[0][0]))/2,l=+e[0][1]+(s-o*(i[1][1]+i[0][1]))/2;n.scale(150*o).translate([a,l])},t)}function Gpe(n,e,t){return rq(n,[[0,0],e],t)}function qpe(n,e,t){return A6(n,function(i){var r=+e,s=r/(i[1][0]-i[0][0]),o=(r-s*(i[1][0]+i[0][0]))/2,a=-s*i[0][1];n.scale(150*s).translate([o,a])},t)}function Hpe(n,e,t){return A6(n,function(i){var r=+e,s=r/(i[1][1]-i[0][1]),o=-s*i[0][0],a=(r-s*(i[1][1]+i[0][1]))/2;n.scale(150*s).translate([o,a])},t)}var mF=16,$pe=Vn(30*Zn);function gF(n,e){return+e?Wpe(n,e):jpe(n)}function jpe(n){return p6({point:function(e,t){e=n(e,t),this.stream.point(e[0],e[1])}})}function Wpe(n,e){function t(i,r,s,o,a,l,u,c,h,A,v,_,S,w){var x=u-i,M=c-r,R=x*x+M*M;if(R>4*e&&S--){var N=o+A,B=a+v,T=l+_,D=tp(N*N+B*B+T*T),F=Zh(T/=D),L=sr(sr(T)-1)<Ri||sr(s-h)<Ri?(s+h)/2:pc(B,N),O=n(L,F),z=O[0],Q=O[1],j=z-i,ee=Q-r,$=M*j-x*ee;($*$/R>e||sr((x*j+M*ee)/R-.5)>.3||o*A+a*v+l*_<$pe)&&(t(i,r,s,o,a,l,z,Q,L,N/=D,B/=D,T,S,w),w.point(z,Q),t(z,Q,L,N,B,T,u,c,h,A,v,_,S,w))}}return function(i){var r,s,o,a,l,u,c,h,A,v,_,S,w={point:x,lineStart:M,lineEnd:N,polygonStart:function(){i.polygonStart(),w.lineStart=B},polygonEnd:function(){i.polygonEnd(),w.lineStart=M}};function x(F,L){F=n(F,L),i.point(F[0],F[1])}function M(){h=NaN,w.point=R,i.lineStart()}function R(F,L){var O=T0([F,L]),z=n(F,L);t(h,A,c,v,_,S,h=z[0],A=z[1],c=F,v=O[0],_=O[1],S=O[2],mF,i),i.point(h,A)}function N(){w.point=x,i.lineEnd()}function B(){M(),w.point=T,w.lineEnd=D}function T(F,L){R(r=F,L),s=h,o=A,a=v,l=_,u=S,w.point=R}function D(){t(h,A,c,v,_,S,s,o,r,a,l,u,mF,i),w.lineEnd=N,N()}return w}}var Xpe=p6({point:function(n,e){this.stream.point(n*Zn,e*Zn)}});function Ype(n){return p6({point:function(e,t){var i=n(e,t);return this.stream.point(i[0],i[1])}})}function Qpe(n,e,t,i,r){function s(o,a){return o*=i,a*=r,[e+n*o,t-n*a]}return s.invert=function(o,a){return[(o-e)/n*i,(t-a)/n*r]},s}function vF(n,e,t,i,r,s){if(!s)return Qpe(n,e,t,i,r);var o=Vn(s),a=Gn(s),l=o*n,u=a*n,c=o/n,h=a/n,A=(a*t-o*e)/n,v=(a*e+o*t)/n;function _(S,w){return S*=i,w*=r,[l*S-u*w+e,t-u*S-l*w]}return _.invert=function(S,w){return[i*(c*S-h*w+A),r*(v-h*S-c*w)]},_}function Kpe(n){return Zpe(function(){return n})()}function Zpe(n){var e,t=150,i=480,r=250,s=0,o=0,a=0,l=0,u=0,c,h=0,A=1,v=1,_=null,S=fF,w=null,x,M,R,N=pF,B=.5,T,D,F,L,O;function z($){return F($[0]*Zn,$[1]*Zn)}function Q($){return $=F.invert($[0],$[1]),$&&[$[0]*js,$[1]*js]}z.stream=function($){return L&&O===$?L:L=Xpe(Ype(c)(S(T(N(O=$)))))},z.preclip=function($){return arguments.length?(S=$,_=void 0,ee()):S},z.postclip=function($){return arguments.length?(N=$,w=x=M=R=null,ee()):N},z.clipAngle=function($){return arguments.length?(S=+$?Ipe(_=$*Zn):(_=null,fF),ee()):_*js},z.clipExtent=function($){return arguments.length?(N=$==null?(w=x=M=R=null,pF):kpe(w=+$[0][0],x=+$[0][1],M=+$[1][0],R=+$[1][1]),ee()):w==null?null:[[w,x],[M,R]]},z.scale=function($){return arguments.length?(t=+$,j()):t},z.translate=function($){return arguments.length?(i=+$[0],r=+$[1],j()):[i,r]},z.center=function($){return arguments.length?(s=$[0]%360*Zn,o=$[1]%360*Zn,j()):[s*js,o*js]},z.rotate=function($){return arguments.length?(a=$[0]%360*Zn,l=$[1]%360*Zn,u=$.length>2?$[2]%360*Zn:0,j()):[a*js,l*js,u*js]},z.angle=function($){return arguments.length?(h=$%360*Zn,j()):h*js},z.reflectX=function($){return arguments.length?(A=$?-1:1,j()):A<0},z.reflectY=function($){return arguments.length?(v=$?-1:1,j()):v<0},z.precision=function($){return arguments.length?(T=gF(D,B=$*$),ee()):tp(B)},z.fitExtent=function($,Z){return rq(z,$,Z)},z.fitSize=function($,Z){return Gpe(z,$,Z)},z.fitWidth=function($,Z){return qpe(z,$,Z)},z.fitHeight=function($,Z){return Hpe(z,$,Z)};function j(){var $=vF(t,0,0,A,v,h).apply(null,e(s,o)),Z=vF(t,i-$[0],r-$[1],A,v,h);return c=eq(a,l,u),D=eR(e,Z),F=eR(c,D),T=gF(D,B),ee()}function ee(){return L=O=null,z}return function(){return e=n.apply(this,arguments),z.invert=e.invert&&Q,j()}}function Jpe(n){return function(e,t){var i=tp(e*e+t*t),r=n(i),s=Gn(r),o=Vn(r);return[pc(e*s,i*o),Zh(i&&t*s/i)]}}function sq(n,e){var t=Vn(e),i=1+Vn(n)*t;return[t*Gn(n)/i,Gn(e)/i]}sq.invert=Jpe(function(n){return 2*QG(n)});function eAe(){return Kpe(sq).scale(250).clipAngle(142)}const m6=Math.PI,yF=m6/2,_F=180/m6,xF=m6/180,tAe=Math.atan2,bF=Math.cos,nAe=Math.max,iAe=Math.min,SF=Math.sin,rAe=Math.sign||function(n){return n>0?1:n<0?-1:0},oq=Math.sqrt;function sAe(n){return n>1?yF:n<-1?-yF:Math.asin(n)}function aq(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Zo(n,e){return[n[1]*e[2]-n[2]*e[1],n[2]*e[0]-n[0]*e[2],n[0]*e[1]-n[1]*e[0]]}function yb(n,e){return[n[0]+e[0],n[1]+e[1],n[2]+e[2]]}function _b(n){var e=oq(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);return[n[0]/e,n[1]/e,n[2]/e]}function g6(n){return[tAe(n[1],n[0])*_F,sAe(nAe(-1,iAe(1,n[2])))*_F]}function Jl(n){const e=n[0]*xF,t=n[1]*xF,i=bF(t);return[i*bF(e),i*SF(e),SF(t)]}function v6(n){return n=n.map(e=>Jl(e)),aq(n[0],Zo(n[2],n[1]))}function oAe(n){const e=lAe(n),t=cAe(e),i=uAe(t,n),r=fAe(t,n.length),s=aAe(r,n),o=hAe(t,n),{polygons:a,centers:l}=dAe(o,t,n),u=pAe(a),c=mAe(t,n),h=AAe(i,t);return{delaunay:e,edges:i,triangles:t,centers:l,neighbors:r,polygons:a,mesh:u,hull:c,urquhart:h,find:s}}function aAe(n,e){function t(i,r){let s=i[0]-r[0],o=i[1]-r[1],a=i[2]-r[2];return s*s+o*o+a*a}return function(r,s,o){o===void 0&&(o=0);let a,l,u=o;const c=Jl([r,s]);do a=o,o=null,l=t(c,Jl(e[a])),n[a].forEach(h=>{let A=t(c,Jl(e[h]));if(A<l){l=A,o=h,u=h;return}});while(o!==null);return u}}function lAe(n){if(n.length<2)return{};let e=0;for(;isNaN(n[e][0]+n[e][1])&&e++<n.length;);const t=wpe(n[e]),i=eAe().translate([0,0]).scale(1).rotate(t.invert([180,0]));n=n.map(i);const r=[];let s=1;for(let h=0,A=n.length;h<A;h++){let v=n[h][0]**2+n[h][1]**2;!isFinite(v)||v>1e32?r.push(h):v>s&&(s=v)}const o=1e6*oq(s);r.forEach(h=>n[h]=[o,0]),n.push([0,o]),n.push([-o,0]),n.push([0,-o]);const a=h6.from(n);a.projection=i;const{triangles:l,halfedges:u,inedges:c}=a;for(let h=0,A=u.length;h<A;h++)if(u[h]<0){const v=h%3==2?h-2:h+1,_=h%3==0?h+2:h-1,S=u[v],w=u[_];u[S]=w,u[w]=S,u[v]=u[_]=-1,l[h]=l[v]=l[_]=e,c[l[S]]=S%3==0?S+2:S-1,c[l[w]]=w%3==0?w+2:w-1,h+=2-h%3}else l[h]>n.length-3-1&&(l[h]=e);return a}function uAe(n,e){const t=new Set;return e.length===2?[[0,1]]:(n.forEach(i=>{if(i[0]!==i[1]&&!(v6(i.map(r=>e[r]))<0))for(let r=0,s;r<3;r++)s=(r+1)%3,t.add(XG([i[r],i[s]]).join("-"))}),Array.from(t,i=>i.split("-").map(Number)))}function cAe(n){const{triangles:e}=n;if(!e)return[];const t=[];for(let i=0,r=e.length/3;i<r;i++){const s=e[3*i],o=e[3*i+1],a=e[3*i+2];s!==o&&o!==a&&t.push([s,a,o])}return t}function hAe(n,e){return n.map(t=>{const i=t.map(s=>e[s]).map(Jl),r=yb(yb(Zo(i[1],i[0]),Zo(i[2],i[1])),Zo(i[0],i[2]));return g6(_b(r))})}function fAe(n,e){const t=[];return n.forEach(i=>{for(let r=0;r<3;r++){const s=i[r],o=i[(r+1)%3];t[s]=t[s]||[],t[s].push(o)}}),n.length===0&&(e===2?(t[0]=[1],t[1]=[0]):e===1&&(t[0]=[])),t}function dAe(n,e,t){const i=[],r=n.slice();if(e.length===0){if(t.length<2)return{polygons:i,centers:r};if(t.length===2){const a=Jl(t[0]),l=Jl(t[1]),u=_b(yb(a,l)),c=_b(Zo(a,l)),h=Zo(u,c),A=[u,Zo(u,h),Zo(Zo(u,h),h),Zo(Zo(Zo(u,h),h),h)].map(g6).map(o);return i.push(A),i.push(A.slice().reverse()),{polygons:i,centers:r}}}e.forEach((a,l)=>{for(let u=0;u<3;u++){const c=a[u],h=a[(u+1)%3],A=a[(u+2)%3];i[c]=i[c]||[],i[c].push([h,A,l,[c,h,A]])}});const s=i.map(a=>{const l=[a[0][2]];let u=a[0][1];for(let c=1;c<a.length;c++)for(let h=0;h<a.length;h++)if(a[h][0]==u){u=a[h][1],l.push(a[h][2]);break}if(l.length>2)return l;if(l.length==2){const c=wF(t[a[0][3][0]],t[a[0][3][1]],r[l[0]]),h=wF(t[a[0][3][2]],t[a[0][3][0]],r[l[0]]),A=o(c),v=o(h);return[l[0],v,l[1],A]}});function o(a){let l=-1;return r.slice(e.length,1/0).forEach((u,c)=>{u[0]===a[0]&&u[1]===a[1]&&(l=c+e.length)}),l<0&&(l=r.length,r.push(a)),l}return{polygons:s,centers:r}}function wF(n,e,t){n=Jl(n),e=Jl(e),t=Jl(t);const i=rAe(aq(Zo(e,n),t));return g6(_b(yb(n,e)).map(r=>i*r))}function pAe(n){const e=[];return n.forEach(t=>{if(!t)return;let i=t[t.length-1];for(let r of t)r>i&&e.push([i,r]),i=r}),e}function AAe(n,e){return function(t){const i=new Map,r=new Map;return n.forEach((s,o)=>{const a=s.join("-");i.set(a,t[o]),r.set(a,!0)}),e.forEach(s=>{let o=0,a=-1;for(let l=0;l<3;l++){let u=XG([s[l],s[(l+1)%3]]).join("-");i.get(u)>o&&(o=i.get(u),a=u)}r.set(a,!1)}),n.map(s=>r.get(s.join("-")))}}function mAe(n,e){const t=new Set,i=[];n.map(a=>{if(!(v6(a.map(l=>e[l>e.length?0:l]))>1e-12))for(let l=0;l<3;l++){let u=[a[l],a[(l+1)%3]],c=`${u[0]}-${u[1]}`;t.has(c)?t.delete(c):t.add(`${u[1]}-${u[0]}`)}});const r=new Map;let s;if(t.forEach(a=>{a=a.split("-").map(Number),r.set(a[0],a[1]),s=a[0]}),s===void 0)return i;let o=s;do{i.push(o);let a=r.get(o);r.set(o,-1),o=a}while(o>-1&&o!==s);return i}function gAe(n){const e=function(t){if(e.delaunay=null,e._data=t,typeof e._data=="object"&&e._data.type==="FeatureCollection"&&(e._data=e._data.features),typeof e._data=="object"){const i=e._data.map(r=>[e._vx(r),e._vy(r),r]).filter(r=>isFinite(r[0]+r[1]));e.points=i.map(r=>[r[0],r[1]]),e.valid=i.map(r=>r[2]),e.delaunay=oAe(e.points)}return e};return e._vx=function(t){if(typeof t=="object"&&"type"in t)return oF(t)[0];if(0 in t)return t[0]},e._vy=function(t){if(typeof t=="object"&&"type"in t)return oF(t)[1];if(1 in t)return t[1]},e.x=function(t){return t?(e._vx=t,e):e._vx},e.y=function(t){return t?(e._vy=t,e):e._vy},e.polygons=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const i={type:"FeatureCollection",features:[]};return e.valid.length===0||(e.delaunay.polygons.forEach((r,s)=>i.features.push({type:"Feature",geometry:r?{type:"Polygon",coordinates:[[...r,r[0]].map(o=>e.delaunay.centers[o])]}:null,properties:{site:e.valid[s],sitecoordinates:e.points[s],neighbours:e.delaunay.neighbors[s]}})),e.valid.length===1&&i.features.push({type:"Feature",geometry:{type:"Sphere"},properties:{site:e.valid[0],sitecoordinates:e.points[0],neighbours:[]}})),i},e.triangles=function(t){return t!==void 0&&e(t),e.delaunay?{type:"FeatureCollection",features:e.delaunay.triangles.map((i,r)=>(i=i.map(s=>e.points[s]),i.center=e.delaunay.centers[r],i)).filter(i=>v6(i)>0).map(i=>({type:"Feature",properties:{circumcenter:i.center},geometry:{type:"Polygon",coordinates:[[...i,i[0]]]}}))}:!1},e.links=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const i=e.delaunay.edges.map(s=>dF(e.points[s[0]],e.points[s[1]])),r=e.delaunay.urquhart(i);return{type:"FeatureCollection",features:e.delaunay.edges.map((s,o)=>({type:"Feature",properties:{source:e.valid[s[0]],target:e.valid[s[1]],length:i[o],urquhart:!!r[o]},geometry:{type:"LineString",coordinates:[e.points[s[0]],e.points[s[1]]]}}))}},e.mesh=function(t){return t!==void 0&&e(t),e.delaunay?{type:"MultiLineString",coordinates:e.delaunay.edges.map(i=>[e.points[i[0]],e.points[i[1]]])}:!1},e.cellMesh=function(t){if(t!==void 0&&e(t),!e.delaunay)return!1;const{centers:i,polygons:r}=e.delaunay,s=[];for(const o of r)if(o)for(let a=o.length,l=o[a-1],u=o[0],c=0;c<a;l=u,u=o[++c])u>l&&s.push([i[l],i[u]]);return{type:"MultiLineString",coordinates:s}},e._found=void 0,e.find=function(t,i,r){if(e._found=e.delaunay.find(t,i,e._found),!r||dF([t,i],e.points[e._found])<r)return e._found},e.hull=function(t){t!==void 0&&e(t);const i=e.delaunay.hull,r=e.points;return i.length===0?null:{type:"Polygon",coordinates:[[...i.map(s=>r[s]),r[i[0]]]]}},n?e(n):e}function oR(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function vAe(n){if(Array.isArray(n))return n}function yAe(n){if(Array.isArray(n))return oR(n)}function _Ae(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function xAe(n,e,t){return e=xb(e),RAe(n,lq()?Reflect.construct(e,[],xb(n).constructor):e.apply(n,t))}function bAe(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function SAe(n,e,t){return Object.defineProperty(n,"prototype",{writable:!1}),n}function xb(n){return xb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xb(n)}function wAe(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&aR(n,e)}function lq(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lq=function(){return!!n})()}function EAe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function TAe(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function CAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MAe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RAe(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _Ae(n)}function aR(n,e){return aR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},aR(n,e)}function Vl(n,e){return vAe(n)||TAe(n,e)||uq(n,e)||CAe()}function P3(n){return yAe(n)||EAe(n)||uq(n)||MAe()}function uq(n,e){if(n){if(typeof n=="string")return oR(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?oR(n,e):void 0}}function PAe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.resolution,i=t===void 0?1/0:t,r=NAe(n,i),s=S4(r),o=IAe(n,i),a=[].concat(P3(s),P3(o)),l={type:"Polygon",coordinates:n},u=wG(l),c=Vl(u,2),h=Vl(c[0],2),A=h[0],v=h[1],_=Vl(c[1],2),S=_[0],w=_[1],x=A>S||w>=89||v<=-89,M=[];if(x){var R=gAe(a).triangles(),N=new Map(a.map(function(ce,ie){var oe=Vl(ce,2),me=oe[0],_e=oe[1];return["".concat(me,"-").concat(_e),ie]}));R.features.forEach(function(ce){var ie,oe=ce.geometry.coordinates[0].slice(0,3).reverse(),me=[];if(oe.forEach(function(Oe){var Ke=Vl(Oe,2),Me=Ke[0],ze=Ke[1],nt="".concat(Me,"-").concat(ze);N.has(nt)&&me.push(N.get(nt))}),me.length===3){if(me.some(function(Oe){return Oe<s.length})){var _e=ce.properties.circumcenter;if(!lR(_e,l,x))return}(ie=M).push.apply(ie,me)}})}else if(o.length)for(var L=L1.from(a),O=function(ie){var oe,me=[2,1,0].map(function(Ke){return L.triangles[ie+Ke]}),_e=me.map(function(Ke){return a[Ke]});if(me.some(function(Ke){return Ke<s.length})){var Oe=[0,1].map(function(Ke){return ehe(_e,function(Me){return Me[Ke]})});if(!lR(Oe,l,x))return 1}(oe=M).push.apply(oe,P3(me))},z=0,Q=L.triangles.length;z<Q;z+=3)O(z);else{var B=Vx(r),T=B.vertices,D=B.holes,F=D===void 0?[]:D;M=Ece(T,F,2)}var j=Ld(hL(a,function(ce){return ce[0]}),[0,1]),ee=Ld(hL(a,function(ce){return ce[1]}),[0,1]),$=a.map(function(ce){var ie=Vl(ce,2),oe=ie[0],me=ie[1];return[j(oe),ee(me)]}),Z={points:a,indices:M,uvs:$};return{contour:r,triangles:Z}}function NAe(n,e){return n.map(function(t){var i=[],r;return t.forEach(function(s){if(r){var o=I1(s,r)*180/Math.PI;if(o>e)for(var a=CG(r,s),l=1/Math.ceil(o/e),u=l;u<1;)i.push(a(u)),u+=l}i.push(r=s)}),i})}function IAe(n,e){var t={type:"Polygon",coordinates:n},i=wG(t),r=Vl(i,2),s=Vl(r[0],2),o=s[0],a=s[1],l=Vl(r[1],2),u=l[0],c=l[1];if(Math.min(Math.abs(u-o),Math.abs(c-a))<e)return[];var h=o>u||c>=89||a<=-89;return DAe(e,{minLng:o,maxLng:u,minLat:a,maxLat:c}).filter(function(A){return lR(A,t,h)})}function DAe(n){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.minLng,i=e.maxLng,r=e.minLat,s=e.maxLat,o=Math.round(Math.pow(360/n,2)/Math.PI),a=(1+Math.sqrt(5))/2,l=function(x){return x/a*360%360-180},u=function(x){return Math.acos(2*x/o-1)/Math.PI*180-90},c=function(x){return o*(Math.cos((x+90)*Math.PI/180)+1)/2},h=[s!==void 0?Math.ceil(c(s)):0,r!==void 0?Math.floor(c(r)):o-1],A=t===void 0&&i===void 0?function(){return!0}:t===void 0?function(w){return w<=i}:i===void 0?function(w){return w>=t}:i>=t?function(w){return w>=t&&w<=i}:function(w){return w>=t||w<=i},v=[],_=h[0];_<=h[1];_++){var S=l(_);A(S)&&v.push([S,u(_)])}return v}function lR(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?lhe(e,n):ape(n,e)}var W2=window.THREE?window.THREE:{BufferGeometry:ur,Float32BufferAttribute:si},EF=new W2.BufferGeometry().setAttribute?"setAttribute":"addAttribute",y6=function(n){function e(t,i,r,s,o,a,l){var u;bAe(this,e),u=xAe(this,e),u.type="ConicPolygonBufferGeometry",u.parameters={polygonGeoJson:t,startHeight:i,endHeight:r,closedBottom:s,closedTop:o,includeSides:a,curvatureResolution:l},i=i||0,r=r||1,s=s!==void 0?s:!0,o=o!==void 0?o:!0,a=a!==void 0?a:!0,l=l||5;var c=PAe(t,{resolution:l}),h=c.contour,A=c.triangles,v=S4(A.uvs),_=[],S=[],w=[],x=0,M=function(D){var F=Math.round(_.length/3),L=w.length;_=_.concat(D.vertices),S=S.concat(D.uvs),w=w.concat(F?D.indices.map(function(O){return O+F}):D.indices),u.addGroup(L,w.length-L,x++)};a&&M(N()),s&&M(B(i,!1)),o&&M(B(r,!0)),u.setIndex(w),u[EF]("position",new W2.Float32BufferAttribute(_,3)),u[EF]("uv",new W2.Float32BufferAttribute(S,2)),u.computeVertexNormals();function R(T,D){var F=T.map(function(L){return L.map(function(O){var z=Vl(O,2),Q=z[0],j=z[1];return kAe(j,Q,D)})});return Vx(F)}function N(){for(var T=R(h,i),D=T.vertices,F=T.holes,L=R(h,r),O=L.vertices,z=S4([O,D]),Q=Math.round(O.length/3),j=new Set(F),ee=0,$=[],Z=0;Z<Q;Z++){var ce=Z+1;if(ce===Q)ce=ee;else if(j.has(ce)){var ie=ce;ce=ee,ee=ie}$.push(Z,Z+Q,ce+Q),$.push(ce+Q,ce,Z)}for(var oe=[],me=1;me>=0;me--)for(var _e=0;_e<Q;_e+=1)oe.push(_e/(Q-1),me);return{indices:$,vertices:z,uvs:oe}}function B(T){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{indices:D?A.indices:A.indices.slice().reverse(),vertices:R([A.points],T).vertices,uvs:v}}return u}return wAe(e,n),SAe(e)}(W2.BufferGeometry);function kAe(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180;return[t*Math.sin(i)*Math.cos(r),t*Math.cos(i),t*Math.sin(i)*Math.sin(r)]}var Hn=function(n){n=n||{};var e=typeof n<"u"?n:{},t={},i;for(i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);var r="";function s(Re){return e.locateFile?e.locateFile(Re,r):r+Re}var o;typeof document<"u"&&document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",o=function(We,dt,jt){var p=new XMLHttpRequest;p.open("GET",We,!0),p.responseType="arraybuffer",p.onload=function(){if(p.status==200||p.status==0&&p.response){dt(p.response);return}var In=ft(We);if(In){dt(In.buffer);return}jt()},p.onerror=jt,p.send(null)};var a=e.print||console.log.bind(console),l=e.printErr||console.warn.bind(console);for(i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);t=null,e.arguments&&e.arguments;var u=0,c=function(Re){u=Re},h=function(){return u},A=8;function v(Re,We,dt,jt){switch(dt=dt||"i8",dt.charAt(dt.length-1)==="*"&&(dt="i32"),dt){case"i1":Q[Re>>0]=We;break;case"i8":Q[Re>>0]=We;break;case"i16":ee[Re>>1]=We;break;case"i32":$[Re>>2]=We;break;case"i64":et=[We>>>0,(He=We,+at(He)>=1?He>0?(st(+zt(He/4294967296),4294967295)|0)>>>0:~~+ue((He-+(~~He>>>0))/4294967296)>>>0:0)],$[Re>>2]=et[0],$[Re+4>>2]=et[1];break;case"float":Z[Re>>2]=We;break;case"double":ce[Re>>3]=We;break;default:co("invalid type for setValue: "+dt)}}function _(Re,We,dt){switch(We=We||"i8",We.charAt(We.length-1)==="*"&&(We="i32"),We){case"i1":return Q[Re>>0];case"i8":return Q[Re>>0];case"i16":return ee[Re>>1];case"i32":return $[Re>>2];case"i64":return $[Re>>2];case"float":return Z[Re>>2];case"double":return ce[Re>>3];default:co("invalid type for getValue: "+We)}return null}var S=!1;function w(Re,We){Re||co("Assertion failed: "+We)}function x(Re){var We=e["_"+Re];return w(We,"Cannot call unknown function "+Re+", make sure it is exported"),We}function M(Re,We,dt,jt,p){var J={string:function(xe){var ge=0;if(xe!=null&&xe!==0){var ct=(xe.length<<2)+1;ge=an(ct),F(xe,ge,ct)}return ge},array:function(xe){var ge=an(xe.length);return L(xe,ge),ge}};function In(xe){return We==="string"?T(xe):We==="boolean"?!!xe:xe}var Yn=x(Re),Yi=[],An=0;if(jt)for(var X=0;X<jt.length;X++){var ye=J[dt[X]];ye?(An===0&&(An=yr()),Yi[X]=ye(jt[X])):Yi[X]=jt[X]}var Ee=Yn.apply(null,Yi);return Ee=In(Ee),An!==0&&bi(An),Ee}function R(Re,We,dt,jt){dt=dt||[];var p=dt.every(function(In){return In==="number"}),J=We!=="string";return J&&p&&!jt?x(Re):function(){return M(Re,We,dt,arguments)}}var N=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function B(Re,We,dt){for(var jt=We+dt,p=We;Re[p]&&!(p>=jt);)++p;if(p-We>16&&Re.subarray&&N)return N.decode(Re.subarray(We,p));for(var J="";We<p;){var In=Re[We++];if(!(In&128)){J+=String.fromCharCode(In);continue}var Yn=Re[We++]&63;if((In&224)==192){J+=String.fromCharCode((In&31)<<6|Yn);continue}var Yi=Re[We++]&63;if((In&240)==224?In=(In&15)<<12|Yn<<6|Yi:In=(In&7)<<18|Yn<<12|Yi<<6|Re[We++]&63,In<65536)J+=String.fromCharCode(In);else{var An=In-65536;J+=String.fromCharCode(55296|An>>10,56320|An&1023)}}return J}function T(Re,We){return Re?B(j,Re,We):""}function D(Re,We,dt,jt){if(!(jt>0))return 0;for(var p=dt,J=dt+jt-1,In=0;In<Re.length;++In){var Yn=Re.charCodeAt(In);if(Yn>=55296&&Yn<=57343){var Yi=Re.charCodeAt(++In);Yn=65536+((Yn&1023)<<10)|Yi&1023}if(Yn<=127){if(dt>=J)break;We[dt++]=Yn}else if(Yn<=2047){if(dt+1>=J)break;We[dt++]=192|Yn>>6,We[dt++]=128|Yn&63}else if(Yn<=65535){if(dt+2>=J)break;We[dt++]=224|Yn>>12,We[dt++]=128|Yn>>6&63,We[dt++]=128|Yn&63}else{if(dt+3>=J)break;We[dt++]=240|Yn>>18,We[dt++]=128|Yn>>12&63,We[dt++]=128|Yn>>6&63,We[dt++]=128|Yn&63}}return We[dt]=0,dt-p}function F(Re,We,dt){return D(Re,j,We,dt)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function L(Re,We){Q.set(Re,We)}function O(Re,We){return Re%We>0&&(Re+=We-Re%We),Re}var z,Q,j,ee,$,Z,ce;function ie(Re){z=Re,e.HEAP8=Q=new Int8Array(Re),e.HEAP16=ee=new Int16Array(Re),e.HEAP32=$=new Int32Array(Re),e.HEAPU8=j=new Uint8Array(Re),e.HEAPU16=new Uint16Array(Re),e.HEAPU32=new Uint32Array(Re),e.HEAPF32=Z=new Float32Array(Re),e.HEAPF64=ce=new Float64Array(Re)}var oe=5267040,me=24128,_e=e.TOTAL_MEMORY||33554432;e.buffer?z=e.buffer:z=new ArrayBuffer(_e),_e=z.byteLength,ie(z),$[me>>2]=oe;function Oe(Re){for(;Re.length>0;){var We=Re.shift();if(typeof We=="function"){We();continue}var dt=We.func;typeof dt=="number"?We.arg===void 0?e.dynCall_v(dt):e.dynCall_vi(dt,We.arg):dt(We.arg===void 0?null:We.arg)}}var Ke=[],Me=[],ze=[],nt=[];function tt(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)en(e.preRun.shift());Oe(Ke)}function Ot(){Oe(Me)}function Ht(){Oe(ze)}function Ct(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Ze(e.postRun.shift());Oe(nt)}function en(Re){Ke.unshift(Re)}function Ze(Re){nt.unshift(Re)}var at=Math.abs,ue=Math.ceil,zt=Math.floor,st=Math.min,xt=0,ht=null;function Yt(Re){xt++,e.monitorRunDependencies&&e.monitorRunDependencies(xt)}function Nt(Re){if(xt--,e.monitorRunDependencies&&e.monitorRunDependencies(xt),xt==0&&ht){var We=ht;ht=null,We()}}e.preloadedImages={},e.preloadedAudios={};var re=null,W="data:application/octet-stream;base64,";function Ne(Re){return String.prototype.startsWith?Re.startsWith(W):Re.indexOf(W)===0}var He,et;re="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var Be=24144;function It(Re){return Re}function ut(Re){var We=/\b__Z[\w\d_]+/g;return Re.replace(We,function(dt){var jt=dt;return dt===jt?dt:jt+" ["+dt+"]"})}function Dt(){var Re=new Error;if(!Re.stack){try{throw new Error(0)}catch(We){Re=We}if(!Re.stack)return"(no stack trace available)"}return Re.stack.toString()}function _n(){var Re=Dt();return e.extraStackTrace&&(Re+=`
`+e.extraStackTrace()),ut(Re)}function ke(Re,We,dt,jt){co("Assertion failed: "+T(Re)+", at: "+[We?T(We):"unknown filename",dt,jt?T(jt):"unknown function"])}function Lt(){return Q.length}function Zt(Re,We,dt){j.set(j.subarray(We,We+dt),Re)}function tn(Re){return e.___errno_location&&($[e.___errno_location()>>2]=Re),Re}function kt(Re){co("OOM")}function Mn(Re){try{var We=new ArrayBuffer(Re);return We.byteLength!=Re?void 0:(new Int8Array(We).set(Q),Ye(We),ie(We),1)}catch{}}function pn(Re){var We=Lt(),dt=16777216,jt=2147483648-dt;if(Re>jt)return!1;for(var p=16777216,J=Math.max(We,p);J<Re;)J<=536870912?J=O(2*J,dt):J=Math.min(O((3*J+2147483648)/4,dt),jt);var In=Mn(J);return!!In}var hi=typeof atob=="function"?atob:function(Re){var We="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",dt="",jt,p,J,In,Yn,Yi,An,X=0;Re=Re.replace(/[^A-Za-z0-9\+\/\=]/g,"");do In=We.indexOf(Re.charAt(X++)),Yn=We.indexOf(Re.charAt(X++)),Yi=We.indexOf(Re.charAt(X++)),An=We.indexOf(Re.charAt(X++)),jt=In<<2|Yn>>4,p=(Yn&15)<<4|Yi>>2,J=(Yi&3)<<6|An,dt=dt+String.fromCharCode(jt),Yi!==64&&(dt=dt+String.fromCharCode(p)),An!==64&&(dt=dt+String.fromCharCode(J));while(X<Re.length);return dt};function ve(Re){try{for(var We=hi(Re),dt=new Uint8Array(We.length),jt=0;jt<We.length;++jt)dt[jt]=We.charCodeAt(jt);return dt}catch{throw new Error("Converting base64 string to bytes failed.")}}function ft(Re){if(Ne(Re))return ve(Re.slice(W.length))}var Fe={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Ve={a:co,b:c,c:h,d:ke,e:tn,f:Lt,g:Zt,h:pn,i:kt,j:It,k:ut,l:Mn,m:Dt,n:_n,o:Be,p:me},Te=function(Re,We,dt){"almost asm";var jt=new Re.Int8Array(dt),p=new Re.Int32Array(dt);new Re.Uint8Array(dt),new Re.Float32Array(dt);var J=new Re.Float64Array(dt),In=We.o|0,Yn=We.p|0,Yi=Re.Math.floor,An=Re.Math.abs,X=Re.Math.sqrt,ye=Re.Math.pow,Ee=Re.Math.cos,xe=Re.Math.sin,ge=Re.Math.tan,ct=Re.Math.acos,Mt=Re.Math.asin,Vt=Re.Math.atan,Rt=Re.Math.atan2,Qt=Re.Math.ceil,Kt=Re.Math.imul,$e=Re.Math.min,Dn=Re.Math.max,mn=Re.Math.clz32,Ft=We.b,ne=We.c,_t=We.d,$t=We.e,ho=We.f,Qn=We.g,ps=We.h,Gr=We.i,Y=24160;function pu(d){return jt=new Int8Array(d),p=new Int32Array(d),J=new Float64Array(d),dt=d,!0}function fi(d){d=d|0;var f=0;return f=Y,Y=Y+d|0,Y=Y+15&-16,f|0}function fo(){return Y|0}function Au(d){d=d|0,Y=d}function As(d,f){d=d|0,Y=d}function pa(d,f){d=d|0,f=f|0;var m=0,g=0,b=0;return(d|0)<0?(f=2,f|0):(d|0)>13780509?(f=lE(15,f)|0,f|0):(m=((d|0)<0)<<31>>31,b=vs(d|0,m|0,3,0)|0,g=ne()|0,m=kn(d|0,m|0,1,0)|0,m=vs(b|0,g|0,m|0,ne()|0)|0,m=kn(m|0,ne()|0,1,0)|0,d=ne()|0,p[f>>2]=m,p[f+4>>2]=d,f=0,f|0)}function ms(d,f,m,g){return d=d|0,f=f|0,m=m|0,g=g|0,kc(d,f,m,g,0)|0}function kc(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0;if(k=Y,Y=Y+16|0,C=k,!(mm(d,f,m,g,b)|0))return g=0,Y=k,g|0;do if((m|0)>=0){if((m|0)>13780509){if(E=lE(15,C)|0,E|0)break;P=C,C=p[P>>2]|0,P=p[P+4>>2]|0}else E=((m|0)<0)<<31>>31,U=vs(m|0,E|0,3,0)|0,P=ne()|0,E=kn(m|0,E|0,1,0)|0,E=vs(U|0,P|0,E|0,ne()|0)|0,E=kn(E|0,ne()|0,1,0)|0,P=ne()|0,p[C>>2]=E,p[C+4>>2]=P,C=E;if(Tf(g|0,0,C<<3|0)|0,b|0){Tf(b|0,0,C<<2|0)|0,E=Aa(d,f,m,g,b,C,P,0)|0;break}E=Fl(C,4)|0,E?(U=Aa(d,f,m,g,E,C,P,0)|0,ln(E),E=U):E=13}else E=2;while(!1);return U=E,Y=k,U|0}function mm(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0;if(Se=Y,Y=Y+16|0,pe=Se,ae=Se+8|0,he=pe,p[he>>2]=d,p[he+4>>2]=f,(m|0)<0)return ae=2,Y=Se,ae|0;if(E=g,p[E>>2]=d,p[E+4>>2]=f,E=(b|0)!=0,E&&(p[b>>2]=0),Ni(d,f)|0)return ae=9,Y=Se,ae|0;p[ae>>2]=0;e:do if((m|0)>=1)if(E)for(q=1,U=0,te=0,he=1,E=d;;){if(!(U|te)){if(E=Qi(E,f,4,ae,pe)|0,E|0)break e;if(f=pe,E=p[f>>2]|0,f=p[f+4>>2]|0,Ni(E,f)|0){E=9;break e}}if(E=Qi(E,f,p[22384+(te<<2)>>2]|0,ae,pe)|0,E|0)break e;if(f=pe,E=p[f>>2]|0,f=p[f+4>>2]|0,d=g+(q<<3)|0,p[d>>2]=E,p[d+4>>2]=f,p[b+(q<<2)>>2]=he,d=U+1|0,C=(d|0)==(he|0),P=te+1|0,k=(P|0)==6,Ni(E,f)|0){E=9;break e}if(he=he+(k&C&1)|0,(he|0)>(m|0)){E=0;break}else q=q+1|0,U=C?0:d,te=C?k?0:P:te}else for(q=1,U=0,te=0,he=1,E=d;;){if(!(U|te)){if(E=Qi(E,f,4,ae,pe)|0,E|0)break e;if(f=pe,E=p[f>>2]|0,f=p[f+4>>2]|0,Ni(E,f)|0){E=9;break e}}if(E=Qi(E,f,p[22384+(te<<2)>>2]|0,ae,pe)|0,E|0)break e;if(f=pe,E=p[f>>2]|0,f=p[f+4>>2]|0,d=g+(q<<3)|0,p[d>>2]=E,p[d+4>>2]=f,d=U+1|0,C=(d|0)==(he|0),P=te+1|0,k=(P|0)==6,Ni(E,f)|0){E=9;break e}if(he=he+(k&C&1)|0,(he|0)>(m|0)){E=0;break}else q=q+1|0,U=C?0:d,te=C?k?0:P:te}else E=0;while(!1);return ae=E,Y=Se,ae|0}function Aa(d,f,m,g,b,E,C,P){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0,E=E|0,C=C|0,P=P|0;var k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0;if(Se=Y,Y=Y+16|0,pe=Se+8|0,ae=Se,k=pp(d|0,f|0,E|0,C|0)|0,q=ne()|0,te=g+(k<<3)|0,qe=te,Ue=p[qe>>2]|0,qe=p[qe+4>>2]|0,U=(Ue|0)==(d|0)&(qe|0)==(f|0),!((Ue|0)==0&(qe|0)==0|U))do k=kn(k|0,q|0,1,0)|0,k=ly(k|0,ne()|0,E|0,C|0)|0,q=ne()|0,te=g+(k<<3)|0,Ue=te,qe=p[Ue>>2]|0,Ue=p[Ue+4>>2]|0,U=(qe|0)==(d|0)&(Ue|0)==(f|0);while(!((qe|0)==0&(Ue|0)==0|U));if(k=b+(k<<2)|0,U&&(p[k>>2]|0)<=(P|0)||(Ue=te,p[Ue>>2]=d,p[Ue+4>>2]=f,p[k>>2]=P,(P|0)>=(m|0)))return Ue=0,Y=Se,Ue|0;switch(U=P+1|0,p[pe>>2]=0,k=Qi(d,f,2,pe,ae)|0,k|0){case 9:{he=9;break}case 0:{k=ae,k=Aa(p[k>>2]|0,p[k+4>>2]|0,m,g,b,E,C,U)|0,k||(he=9);break}}e:do if((he|0)==9){switch(p[pe>>2]=0,k=Qi(d,f,3,pe,ae)|0,k|0){case 9:break;case 0:{if(k=ae,k=Aa(p[k>>2]|0,p[k+4>>2]|0,m,g,b,E,C,U)|0,k|0)break e;break}default:break e}switch(p[pe>>2]=0,k=Qi(d,f,1,pe,ae)|0,k|0){case 9:break;case 0:{if(k=ae,k=Aa(p[k>>2]|0,p[k+4>>2]|0,m,g,b,E,C,U)|0,k|0)break e;break}default:break e}switch(p[pe>>2]=0,k=Qi(d,f,5,pe,ae)|0,k|0){case 9:break;case 0:{if(k=ae,k=Aa(p[k>>2]|0,p[k+4>>2]|0,m,g,b,E,C,U)|0,k|0)break e;break}default:break e}switch(p[pe>>2]=0,k=Qi(d,f,4,pe,ae)|0,k|0){case 9:break;case 0:{if(k=ae,k=Aa(p[k>>2]|0,p[k+4>>2]|0,m,g,b,E,C,U)|0,k|0)break e;break}default:break e}switch(p[pe>>2]=0,k=Qi(d,f,6,pe,ae)|0,k|0){case 9:break;case 0:{if(k=ae,k=Aa(p[k>>2]|0,p[k+4>>2]|0,m,g,b,E,C,U)|0,k|0)break e;break}default:break e}return Ue=0,Y=Se,Ue|0}while(!1);return Ue=k,Y=Se,Ue|0}function Qi(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0;if(m>>>0>6)return b=1,b|0;if(te=(p[g>>2]|0)%6|0,p[g>>2]=te,(te|0)>0){E=0;do m=Sf(m)|0,E=E+1|0;while((E|0)<(p[g>>2]|0))}if(te=it(d|0,f|0,45)|0,ne()|0,q=te&127,q>>>0>121)return b=5,b|0;k=Ao(d,f)|0,E=it(d|0,f|0,52)|0,ne()|0,E=E&15;e:do if(!E)U=8;else{for(;;){if(C=(15-E|0)*3|0,P=it(d|0,f|0,C|0)|0,ne()|0,P=P&7,(P|0)==7){f=5;break}if(ae=(ma(E)|0)==0,E=E+-1|0,he=vt(7,0,C|0)|0,f=f&~(ne()|0),pe=vt(p[(ae?432:16)+(P*28|0)+(m<<2)>>2]|0,0,C|0)|0,C=ne()|0,m=p[(ae?640:224)+(P*28|0)+(m<<2)>>2]|0,d=pe|d&~he,f=C|f,!m){m=0;break e}if(!E){U=8;break e}}return f|0}while(!1);(U|0)==8&&(ae=p[848+(q*28|0)+(m<<2)>>2]|0,pe=vt(ae|0,0,45)|0,d=pe|d,f=ne()|0|f&-1040385,m=p[4272+(q*28|0)+(m<<2)>>2]|0,(ae&127|0)==127&&(ae=vt(p[848+(q*28|0)+20>>2]|0,0,45)|0,f=ne()|0|f&-1040385,m=p[4272+(q*28|0)+20>>2]|0,d=wf(ae|d,f)|0,f=ne()|0,p[g>>2]=(p[g>>2]|0)+1)),P=it(d|0,f|0,45)|0,ne()|0,P=P&127;e:do if(Si(P)|0){t:do if((Ao(d,f)|0)==1){if((q|0)!=(P|0))if(Ce(P,p[7696+(q*28|0)>>2]|0)|0){d=sE(d,f)|0,C=1,f=ne()|0;break}else _t(23313,22416,436,22424);switch(k|0){case 3:{d=wf(d,f)|0,f=ne()|0,p[g>>2]=(p[g>>2]|0)+1,C=0;break t}case 5:{d=sE(d,f)|0,f=ne()|0,p[g>>2]=(p[g>>2]|0)+5,C=0;break t}case 0:return ae=9,ae|0;default:return ae=1,ae|0}}else C=0;while(!1);if((m|0)>0){E=0;do d=rE(d,f)|0,f=ne()|0,E=E+1|0;while((E|0)!=(m|0))}if((q|0)!=(P|0)){if(!(y(P)|0)){if((C|0)!=0|(Ao(d,f)|0)!=5)break;p[g>>2]=(p[g>>2]|0)+1;break}switch(te&127){case 8:case 118:break e}(Ao(d,f)|0)!=3&&(p[g>>2]=(p[g>>2]|0)+1)}}else if((m|0)>0){E=0;do d=wf(d,f)|0,f=ne()|0,E=E+1|0;while((E|0)!=(m|0))}while(!1);return p[g>>2]=((p[g>>2]|0)+m|0)%6|0,ae=b,p[ae>>2]=d,p[ae+4>>2]=f,ae=0,ae|0}function Rn(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0;for(P=Y,Y=Y+16|0,E=P,C=P+8|0,b=(Ni(d,f)|0)==0,b=b?1:2;;){if(p[C>>2]=0,U=(Qi(d,f,b,C,E)|0)==0,k=E,U&((p[k>>2]|0)==(m|0)?(p[k+4>>2]|0)==(g|0):0)){d=4;break}if(b=b+1|0,b>>>0>=7){b=7,d=4;break}}return(d|0)==4?(Y=P,b|0):0}function Yw(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0;if(ae=Y,Y=Y+16|0,he=ae,pe=ae+8|0,te=he,p[te>>2]=d,p[te+4>>2]=f,!m)return pe=g,p[pe>>2]=d,p[pe+4>>2]=f,pe=0,Y=ae,pe|0;p[pe>>2]=0;e:do if(Ni(d,f)|0)d=9;else{if(E=(m|0)>0,E){b=0,te=d;do{if(d=Qi(te,f,4,pe,he)|0,d|0)break e;if(f=he,te=p[f>>2]|0,f=p[f+4>>2]|0,b=b+1|0,Ni(te,f)|0){d=9;break e}}while((b|0)<(m|0));if(q=g,p[q>>2]=te,p[q+4>>2]=f,q=m+-1|0,E){U=0,d=1;do{if(b=22384+(U<<2)|0,(U|0)==5)for(C=p[b>>2]|0,E=0,b=d;;){if(d=he,d=Qi(p[d>>2]|0,p[d+4>>2]|0,C,pe,he)|0,d|0)break e;if((E|0)!=(q|0))if(k=he,P=p[k>>2]|0,k=p[k+4>>2]|0,d=g+(b<<3)|0,p[d>>2]=P,p[d+4>>2]=k,!(Ni(P,k)|0))d=b+1|0;else{d=9;break e}else d=b;if(E=E+1|0,(E|0)>=(m|0))break;b=d}else for(C=he,k=p[b>>2]|0,P=0,b=d,E=p[C>>2]|0,C=p[C+4>>2]|0;;){if(d=Qi(E,C,k,pe,he)|0,d|0)break e;if(C=he,E=p[C>>2]|0,C=p[C+4>>2]|0,d=g+(b<<3)|0,p[d>>2]=E,p[d+4>>2]=C,d=b+1|0,Ni(E,C)|0){d=9;break e}if(P=P+1|0,(P|0)>=(m|0))break;b=d}U=U+1|0}while(U>>>0<6);d=he,C=te,b=p[d>>2]|0,E=f,d=p[d+4>>2]|0}else C=te,b=te,E=f,d=f}else C=g,p[C>>2]=d,p[C+4>>2]=f,C=d,b=d,E=f,d=f;d=(C|0)==(b|0)&(E|0)==(d|0)?0:9}while(!1);return pe=d,Y=ae,pe|0}function ty(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0;if(P=Y,Y=Y+48|0,b=P+16|0,E=P+8|0,C=P,m|0)return C=15,Y=P,C|0;if(U=d,k=p[U+4>>2]|0,m=E,p[m>>2]=p[U>>2],p[m+4>>2]=k,W8(E,b),f=kl(b,f,C)|0,!f){if(m=p[E>>2]|0,E=p[d+8>>2]|0,(E|0)>0){b=p[d+12>>2]|0,f=0;do m=(p[b+(f<<3)>>2]|0)+m|0,f=f+1|0;while((f|0)<(E|0))}f=C,b=p[f>>2]|0,f=p[f+4>>2]|0,E=((m|0)<0)<<31>>31,(f|0)<(E|0)|(f|0)==(E|0)&b>>>0<m>>>0?(f=C,p[f>>2]=m,p[f+4>>2]=E,f=E):m=b,k=kn(m|0,f|0,12,0)|0,U=ne()|0,f=C,p[f>>2]=k,p[f+4>>2]=U,f=g,p[f>>2]=k,p[f+4>>2]=U,f=0}return U=f,Y=P,U|0}function gm(d,f,m,g,b,E,C){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0,E=E|0,C=C|0;var P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0,li=0,Wn=0,Kn=0,xn=0,gn=0,bn=0,vi=0,un=0,Ci=0,zs=0,rI=0;if(vi=Y,Y=Y+64|0,Kn=vi+48|0,xn=vi+32|0,gn=vi+24|0,St=vi+8|0,Bt=vi,k=p[d>>2]|0,(k|0)<=0)return bn=0,Y=vi,bn|0;for(mt=d+4|0,wt=Kn+8|0,li=xn+8|0,Wn=St+8|0,P=0,De=0;;){U=p[mt>>2]|0,Ie=U+(De<<4)|0,p[Kn>>2]=p[Ie>>2],p[Kn+4>>2]=p[Ie+4>>2],p[Kn+8>>2]=p[Ie+8>>2],p[Kn+12>>2]=p[Ie+12>>2],(De|0)==(k+-1|0)?(p[xn>>2]=p[U>>2],p[xn+4>>2]=p[U+4>>2],p[xn+8>>2]=p[U+8>>2],p[xn+12>>2]=p[U+12>>2]):(Ie=U+(De+1<<4)|0,p[xn>>2]=p[Ie>>2],p[xn+4>>2]=p[Ie+4>>2],p[xn+8>>2]=p[Ie+8>>2],p[xn+12>>2]=p[Ie+12>>2]),k=xf(Kn,xn,g,gn)|0;e:do if(k)U=0,P=k;else if(U=gn,k=p[U>>2]|0,U=p[U+4>>2]|0,(U|0)>0|(U|0)==0&k>>>0>0){Ue=0,Ie=0;t:for(;;){if(rI=+J[Kn>>3],qe=gs(k|0,U|0,Ue|0,Ie|0)|0,zs=+(qe>>>0)+4294967296*+(ne()|0),un=+(k>>>0)+4294967296*+(U|0),Ci=+(Ue>>>0)+4294967296*+(Ie|0),J[St>>3]=rI*zs/un+ +J[xn>>3]*Ci/un,J[Wn>>3]=+J[wt>>3]*zs/un+ +J[li>>3]*Ci/un,k=O8(St,g,Bt)|0,k|0){P=k;break}qe=Bt,Se=p[qe>>2]|0,qe=p[qe+4>>2]|0,he=pp(Se|0,qe|0,f|0,m|0)|0,q=ne()|0,k=C+(he<<3)|0,te=k,U=p[te>>2]|0,te=p[te+4>>2]|0;n:do if((U|0)==0&(te|0)==0)be=k,bn=16;else for(pe=0,ae=0;;){if((pe|0)>(m|0)|(pe|0)==(m|0)&ae>>>0>f>>>0){P=1;break t}if((U|0)==(Se|0)&(te|0)==(qe|0))break n;if(k=kn(he|0,q|0,1,0)|0,he=ly(k|0,ne()|0,f|0,m|0)|0,q=ne()|0,ae=kn(ae|0,pe|0,1,0)|0,pe=ne()|0,k=C+(he<<3)|0,te=k,U=p[te>>2]|0,te=p[te+4>>2]|0,(U|0)==0&(te|0)==0){be=k,bn=16;break}}while(!1);if((bn|0)==16&&(bn=0,!((Se|0)==0&(qe|0)==0))&&(ae=be,p[ae>>2]=Se,p[ae+4>>2]=qe,ae=E+(p[b>>2]<<3)|0,p[ae>>2]=Se,p[ae+4>>2]=qe,ae=b,ae=kn(p[ae>>2]|0,p[ae+4>>2]|0,1,0)|0,Se=ne()|0,qe=b,p[qe>>2]=ae,p[qe+4>>2]=Se),Ue=kn(Ue|0,Ie|0,1,0)|0,Ie=ne()|0,U=gn,k=p[U>>2]|0,U=p[U+4>>2]|0,!((U|0)>(Ie|0)|(U|0)==(Ie|0)&k>>>0>Ue>>>0)){U=1;break e}}U=0}else U=1;while(!1);if(De=De+1|0,!U){bn=21;break}if(k=p[d>>2]|0,(De|0)>=(k|0)){P=0,bn=21;break}}return(bn|0)==21?(Y=vi,P|0):0}function ny(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0,li=0,Wn=0,Kn=0,xn=0,gn=0,bn=0,vi=0,un=0,Ci=0,zs=0;if(zs=Y,Y=Y+112|0,bn=zs+80|0,k=zs+72|0,vi=zs,un=zs+56|0,m|0)return Ci=15,Y=zs,Ci|0;if(U=d+8|0,Ci=Ll((p[U>>2]<<5)+32|0)|0,!Ci)return Ci=13,Y=zs,Ci|0;if(pK(d,Ci),xn=d,gn=p[xn+4>>2]|0,m=k,p[m>>2]=p[xn>>2],p[m+4>>2]=gn,W8(k,bn),m=kl(bn,f,vi)|0,m)xn=0,gn=0;else{if(m=p[k>>2]|0,E=p[U>>2]|0,(E|0)>0){C=p[d+12>>2]|0,b=0;do m=(p[C+(b<<3)>>2]|0)+m|0,b=b+1|0;while((b|0)!=(E|0));b=m}else b=m;m=vi,E=p[m>>2]|0,m=p[m+4>>2]|0,C=((b|0)<0)<<31>>31,(m|0)<(C|0)|(m|0)==(C|0)&E>>>0<b>>>0?(m=vi,p[m>>2]=b,p[m+4>>2]=C,m=C):b=E,xn=kn(b|0,m|0,12,0)|0,gn=ne()|0,m=vi,p[m>>2]=xn,p[m+4>>2]=gn,m=0}if(m|0)return ln(Ci),Ci=m,Y=zs,Ci|0;if(b=Fl(xn,8)|0,!b)return ln(Ci),Ci=13,Y=zs,Ci|0;if(P=Fl(xn,8)|0,!P)return ln(Ci),ln(b),Ci=13,Y=zs,Ci|0;Wn=bn,p[Wn>>2]=0,p[Wn+4>>2]=0,Wn=d,Kn=p[Wn+4>>2]|0,m=k,p[m>>2]=p[Wn>>2],p[m+4>>2]=Kn,m=gm(k,xn,gn,f,bn,b,P)|0;e:do if(m)ln(b),ln(P),ln(Ci);else{t:do if((p[U>>2]|0)>0){for(C=d+12|0,E=0;m=gm((p[C>>2]|0)+(E<<3)|0,xn,gn,f,bn,b,P)|0,E=E+1|0,!(m|0);)if((E|0)>=(p[U>>2]|0))break t;ln(b),ln(P),ln(Ci);break e}while(!1);(gn|0)>0|(gn|0)==0&xn>>>0>0&&Tf(P|0,0,xn<<3|0)|0,Kn=bn,Wn=p[Kn+4>>2]|0;t:do if((Wn|0)>0|(Wn|0)==0&(p[Kn>>2]|0)>>>0>0){mt=b,wt=P,li=b,Wn=P,Kn=b,m=b,be=b,St=P,Bt=P,b=P;n:for(;;){for(qe=0,Ue=0,Ie=0,De=0,E=0,C=0;;){P=vi,k=P+56|0;do p[P>>2]=0,P=P+4|0;while((P|0)<(k|0));if(f=mt+(qe<<3)|0,U=p[f>>2]|0,f=p[f+4>>2]|0,mm(U,f,1,vi,0)|0){P=vi,k=P+56|0;do p[P>>2]=0,P=P+4|0;while((P|0)<(k|0));P=Fl(7,4)|0,P|0&&(Aa(U,f,1,vi,P,7,0,0)|0,ln(P))}for(Se=0;;){ae=vi+(Se<<3)|0,pe=p[ae>>2]|0,ae=p[ae+4>>2]|0;i:do if((pe|0)==0&(ae|0)==0)P=E,k=C;else{if(q=pp(pe|0,ae|0,xn|0,gn|0)|0,U=ne()|0,P=g+(q<<3)|0,f=P,k=p[f>>2]|0,f=p[f+4>>2]|0,!((k|0)==0&(f|0)==0)){te=0,he=0;do{if((te|0)>(gn|0)|(te|0)==(gn|0)&he>>>0>xn>>>0)break n;if((k|0)==(pe|0)&(f|0)==(ae|0)){P=E,k=C;break i}P=kn(q|0,U|0,1,0)|0,q=ly(P|0,ne()|0,xn|0,gn|0)|0,U=ne()|0,he=kn(he|0,te|0,1,0)|0,te=ne()|0,P=g+(q<<3)|0,f=P,k=p[f>>2]|0,f=p[f+4>>2]|0}while(!((k|0)==0&(f|0)==0))}(pe|0)==0&(ae|0)==0?(P=E,k=C):(ym(pe,ae,un)|0,AK(d,Ci,un)|0&&(he=kn(E|0,C|0,1,0)|0,C=ne()|0,te=P,p[te>>2]=pe,p[te+4>>2]=ae,E=wt+(E<<3)|0,p[E>>2]=pe,p[E+4>>2]=ae,E=he),P=E,k=C)}while(!1);if(Se=Se+1|0,Se>>>0>=7)break;E=P,C=k}if(qe=kn(qe|0,Ue|0,1,0)|0,Ue=ne()|0,Ie=kn(Ie|0,De|0,1,0)|0,De=ne()|0,C=bn,E=p[C>>2]|0,C=p[C+4>>2]|0,(De|0)<(C|0)|(De|0)==(C|0)&Ie>>>0<E>>>0)E=P,C=k;else break}if((C|0)>0|(C|0)==0&E>>>0>0){E=0,C=0;do De=mt+(E<<3)|0,p[De>>2]=0,p[De+4>>2]=0,E=kn(E|0,C|0,1,0)|0,C=ne()|0,De=bn,Ie=p[De+4>>2]|0;while((C|0)<(Ie|0)|((C|0)==(Ie|0)?E>>>0<(p[De>>2]|0)>>>0:0))}if(De=bn,p[De>>2]=P,p[De+4>>2]=k,(k|0)>0|(k|0)==0&P>>>0>0)Se=b,qe=Bt,Ue=Kn,Ie=St,De=wt,b=be,Bt=m,St=li,be=Se,m=qe,Kn=Wn,Wn=Ue,li=Ie,wt=mt,mt=De;else break t}ln(li),ln(Wn),ln(Ci),m=1;break e}else m=P;while(!1);ln(Ci),ln(b),ln(m),m=0}while(!1);return Ci=m,Y=zs,Ci|0}function Qw(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(q=Y,Y=Y+176|0,k=q,(f|0)<1)return Q8(m,0,0),U=0,Y=q,U|0;for(P=d,P=it(p[P>>2]|0,p[P+4>>2]|0,52)|0,ne()|0,Q8(m,(f|0)>6?f:6,P&15),P=0;g=d+(P<<3)|0,g=_m(p[g>>2]|0,p[g+4>>2]|0,k)|0,!(g|0);){if(g=p[k>>2]|0,(g|0)>0){C=0;do E=k+8+(C<<4)|0,C=C+1|0,g=k+8+(((C|0)%(g|0)|0)<<4)|0,b=NK(m,g,E)|0,b?J8(m,b)|0:PK(m,E,g)|0,g=p[k>>2]|0;while((C|0)<(g|0))}if(P=P+1|0,(P|0)>=(f|0)){g=0,U=13;break}}return(U|0)==13?(Y=q,g|0):(K8(m),U=g,Y=q,U|0)}function Kw(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0;if(E=Y,Y=Y+32|0,g=E,b=E+16|0,d=Qw(d,f,b)|0,d|0)return m=d,Y=E,m|0;if(p[m>>2]=0,p[m+4>>2]=0,p[m+8>>2]=0,d=Z8(b)|0,d|0)do{f=oK(m)|0;do aK(f,d)|0,C=d+16|0,p[g>>2]=p[C>>2],p[g+4>>2]=p[C+4>>2],p[g+8>>2]=p[C+8>>2],p[g+12>>2]=p[C+12>>2],J8(b,d)|0,d=IK(b,g)|0;while(d|0);d=Z8(b)|0}while(d|0);return K8(b),d=lK(m)|0,d?(q8(m),C=d,Y=E,C|0):(C=0,Y=E,C|0)}function Si(d){return d=d|0,d>>>0>121?(d=0,d|0):(d=p[7696+(d*28|0)+16>>2]|0,d|0)}function y(d){return d=d|0,(d|0)==4|(d|0)==117|0}function I(d){return d=d|0,p[11120+((p[d>>2]|0)*216|0)+((p[d+4>>2]|0)*72|0)+((p[d+8>>2]|0)*24|0)+(p[d+12>>2]<<3)>>2]|0}function G(d){return d=d|0,p[11120+((p[d>>2]|0)*216|0)+((p[d+4>>2]|0)*72|0)+((p[d+8>>2]|0)*24|0)+(p[d+12>>2]<<3)+4>>2]|0}function H(d,f){d=d|0,f=f|0,d=7696+(d*28|0)|0,p[f>>2]=p[d>>2],p[f+4>>2]=p[d+4>>2],p[f+8>>2]=p[d+8>>2],p[f+12>>2]=p[d+12>>2]}function se(d,f){d=d|0,f=f|0;var m=0,g=0;if(f>>>0>20)return f=-1,f|0;do if((p[11120+(f*216|0)>>2]|0)!=(d|0))if((p[11120+(f*216|0)+8>>2]|0)!=(d|0))if((p[11120+(f*216|0)+16>>2]|0)!=(d|0))if((p[11120+(f*216|0)+24>>2]|0)!=(d|0))if((p[11120+(f*216|0)+32>>2]|0)!=(d|0))if((p[11120+(f*216|0)+40>>2]|0)!=(d|0))if((p[11120+(f*216|0)+48>>2]|0)!=(d|0))if((p[11120+(f*216|0)+56>>2]|0)!=(d|0))if((p[11120+(f*216|0)+64>>2]|0)!=(d|0))if((p[11120+(f*216|0)+72>>2]|0)!=(d|0))if((p[11120+(f*216|0)+80>>2]|0)!=(d|0))if((p[11120+(f*216|0)+88>>2]|0)!=(d|0))if((p[11120+(f*216|0)+96>>2]|0)!=(d|0))if((p[11120+(f*216|0)+104>>2]|0)!=(d|0))if((p[11120+(f*216|0)+112>>2]|0)!=(d|0))if((p[11120+(f*216|0)+120>>2]|0)!=(d|0))if((p[11120+(f*216|0)+128>>2]|0)!=(d|0))if((p[11120+(f*216|0)+136>>2]|0)==(d|0))d=2,m=1,g=2;else{if((p[11120+(f*216|0)+144>>2]|0)==(d|0)){d=0,m=2,g=0;break}if((p[11120+(f*216|0)+152>>2]|0)==(d|0)){d=0,m=2,g=1;break}if((p[11120+(f*216|0)+160>>2]|0)==(d|0)){d=0,m=2,g=2;break}if((p[11120+(f*216|0)+168>>2]|0)==(d|0)){d=1,m=2,g=0;break}if((p[11120+(f*216|0)+176>>2]|0)==(d|0)){d=1,m=2,g=1;break}if((p[11120+(f*216|0)+184>>2]|0)==(d|0)){d=1,m=2,g=2;break}if((p[11120+(f*216|0)+192>>2]|0)==(d|0)){d=2,m=2,g=0;break}if((p[11120+(f*216|0)+200>>2]|0)==(d|0)){d=2,m=2,g=1;break}if((p[11120+(f*216|0)+208>>2]|0)==(d|0)){d=2,m=2,g=2;break}else d=-1;return d|0}else d=2,m=1,g=1;else d=2,m=1,g=0;else d=1,m=1,g=2;else d=1,m=1,g=1;else d=1,m=1,g=0;else d=0,m=1,g=2;else d=0,m=1,g=1;else d=0,m=1,g=0;else d=2,m=0,g=2;else d=2,m=0,g=1;else d=2,m=0,g=0;else d=1,m=0,g=2;else d=1,m=0,g=1;else d=1,m=0,g=0;else d=0,m=0,g=2;else d=0,m=0,g=1;else d=0,m=0,g=0;while(!1);return f=p[11120+(f*216|0)+(m*72|0)+(d*24|0)+(g<<3)+4>>2]|0,f|0}function Ce(d,f){return d=d|0,f=f|0,(p[7696+(d*28|0)+20>>2]|0)==(f|0)?(f=1,f|0):(f=(p[7696+(d*28|0)+24>>2]|0)==(f|0),f|0)}function Le(d,f){return d=d|0,f=f|0,p[848+(d*28|0)+(f<<2)>>2]|0}function At(d,f){return d=d|0,f=f|0,(p[848+(d*28|0)>>2]|0)==(f|0)?(f=0,f|0):(p[848+(d*28|0)+4>>2]|0)==(f|0)?(f=1,f|0):(p[848+(d*28|0)+8>>2]|0)==(f|0)?(f=2,f|0):(p[848+(d*28|0)+12>>2]|0)==(f|0)?(f=3,f|0):(p[848+(d*28|0)+16>>2]|0)==(f|0)?(f=4,f|0):(p[848+(d*28|0)+20>>2]|0)==(f|0)?(f=5,f|0):((p[848+(d*28|0)+24>>2]|0)==(f|0)?6:7)|0}function bt(){return 122}function yn(d){d=d|0;var f=0,m=0,g=0;f=0;do vt(f|0,0,45)|0,g=ne()|0|134225919,m=d+(f<<3)|0,p[m>>2]=-1,p[m+4>>2]=g,f=f+1|0;while((f|0)!=122);return 0}function nn(d){return d=d|0,+J[d+16>>3]<+J[d+24>>3]|0}function cr(d,f){d=d|0,f=f|0;var m=0,g=0,b=0;return m=+J[f>>3],!(m>=+J[d+8>>3])||!(m<=+J[d>>3])?(f=0,f|0):(g=+J[d+16>>3],m=+J[d+24>>3],b=+J[f+8>>3],f=b>=m,d=b<=g&1,g<m?f&&(d=1):f||(d=0),f=(d|0)!=0,f|0)}function kl(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0;ae=Y,Y=Y+288|0,q=ae+264|0,te=ae+96|0,U=ae,P=U,k=P+96|0;do p[P>>2]=0,P=P+4|0;while((P|0)<(k|0));return f=aE(f,U)|0,f|0?(pe=f,Y=ae,pe|0):(k=U,U=p[k>>2]|0,k=p[k+4>>2]|0,ym(U,k,q)|0,_m(U,k,te)|0,C=+bm(q,te+8|0),J[q>>3]=+J[d>>3],k=q+8|0,J[k>>3]=+J[d+16>>3],J[te>>3]=+J[d+8>>3],U=te+8|0,J[U>>3]=+J[d+24>>3],b=+bm(q,te),qe=+J[k>>3]-+J[U>>3],E=+An(+qe),Se=+J[q>>3]-+J[te>>3],g=+An(+Se),!(qe==0|Se==0)&&(qe=+nI(+E,+g),qe=+Qt(+(b*b/+hE(+(qe/+hE(+E,+g)),3)/(C*(C*2.59807621135)*.8))),J[In>>3]=qe,he=~~qe>>>0,pe=+An(qe)>=1?qe>0?~~+$e(+Yi(qe/4294967296),4294967295)>>>0:~~+Qt((qe-+(~~qe>>>0))/4294967296)>>>0:0,(p[In+4>>2]&2146435072|0)!=2146435072)?(te=(he|0)==0&(pe|0)==0,f=m,p[f>>2]=te?1:he,p[f+4>>2]=te?0:pe,f=0):f=1,pe=f,Y=ae,pe|0)}function xf(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0;U=Y,Y=Y+288|0,C=U+264|0,P=U+96|0,k=U,b=k,E=b+96|0;do p[b>>2]=0,b=b+4|0;while((b|0)<(E|0));return m=aE(m,k)|0,m|0?(g=m,Y=U,g|0):(m=k,b=p[m>>2]|0,m=p[m+4>>2]|0,ym(b,m,C)|0,_m(b,m,P)|0,q=+bm(C,P+8|0),q=+Qt(+(+bm(d,f)/(q*2))),J[In>>3]=q,m=~~q>>>0,b=+An(q)>=1?q>0?~~+$e(+Yi(q/4294967296),4294967295)>>>0:~~+Qt((q-+(~~q>>>0))/4294967296)>>>0:0,(p[In+4>>2]&2146435072|0)==2146435072?(g=1,Y=U,g|0):(k=(m|0)==0&(b|0)==0,p[g>>2]=k?1:m,p[g+4>>2]=k?0:b,g=0,Y=U,g|0))}function Lc(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0,p[d>>2]=f,p[d+4>>2]=m,p[d+8>>2]=g}function cp(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0;te=f+8|0,p[te>>2]=0,k=+J[d>>3],C=+An(+k),U=+J[d+8>>3],P=+An(+U)/.8660254037844386,C=C+P*.5,m=~~C,d=~~P,C=C-+(m|0),P=P-+(d|0);do if(C<.5)if(C<.3333333333333333)if(p[f>>2]=m,P<(C+1)*.5){p[f+4>>2]=d;break}else{d=d+1|0,p[f+4>>2]=d;break}else if(he=1-C,d=(!(P<he)&1)+d|0,p[f+4>>2]=d,he<=P&P<C*2){m=m+1|0,p[f>>2]=m;break}else{p[f>>2]=m;break}else{if(!(C<.6666666666666666))if(m=m+1|0,p[f>>2]=m,P<C*.5){p[f+4>>2]=d;break}else{d=d+1|0,p[f+4>>2]=d;break}if(P<1-C){if(p[f+4>>2]=d,C*2+-1<P){p[f>>2]=m;break}}else d=d+1|0,p[f+4>>2]=d;m=m+1|0,p[f>>2]=m}while(!1);do if(k<0)if(d&1){q=(d+1|0)/2|0,q=gs(m|0,((m|0)<0)<<31>>31|0,q|0,((q|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-((+(q>>>0)+4294967296*+(ne()|0))*2+1)),p[f>>2]=m;break}else{q=(d|0)/2|0,q=gs(m|0,((m|0)<0)<<31>>31|0,q|0,((q|0)<0)<<31>>31|0)|0,m=~~(+(m|0)-(+(q>>>0)+4294967296*+(ne()|0))*2),p[f>>2]=m;break}while(!1);q=f+4|0,U<0&&(m=m-((d<<1|1|0)/2|0)|0,p[f>>2]=m,d=0-d|0,p[q>>2]=d),g=d-m|0,(m|0)<0?(b=0-m|0,p[q>>2]=g,p[te>>2]=b,p[f>>2]=0,d=g,m=0):b=0,(d|0)<0&&(m=m-d|0,p[f>>2]=m,b=b-d|0,p[te>>2]=b,p[q>>2]=0,d=0),E=m-b|0,g=d-b|0,(b|0)<0&&(p[f>>2]=E,p[q>>2]=g,p[te>>2]=0,d=g,m=E,b=0),g=(d|0)<(m|0)?d:m,g=(b|0)<(g|0)?b:g,!((g|0)<=0)&&(p[f>>2]=m-g,p[q>>2]=d-g,p[te>>2]=b-g)}function Ki(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0;f=p[d>>2]|0,C=d+4|0,m=p[C>>2]|0,(f|0)<0&&(m=m-f|0,p[C>>2]=m,E=d+8|0,p[E>>2]=(p[E>>2]|0)-f,p[d>>2]=0,f=0),(m|0)<0?(f=f-m|0,p[d>>2]=f,E=d+8|0,b=(p[E>>2]|0)-m|0,p[E>>2]=b,p[C>>2]=0,m=0):(b=d+8|0,E=b,b=p[b>>2]|0),(b|0)<0&&(f=f-b|0,p[d>>2]=f,m=m-b|0,p[C>>2]=m,p[E>>2]=0,b=0),g=(m|0)<(f|0)?m:f,g=(b|0)<(g|0)?b:g,!((g|0)<=0)&&(p[d>>2]=f-g,p[C>>2]=m-g,p[E>>2]=b-g)}function po(d,f){d=d|0,f=f|0;var m=0,g=0;g=p[d+8>>2]|0,m=+((p[d+4>>2]|0)-g|0),J[f>>3]=+((p[d>>2]|0)-g|0)-m*.5,J[f+8>>3]=m*.8660254037844386}function Us(d,f,m){d=d|0,f=f|0,m=m|0,p[m>>2]=(p[f>>2]|0)+(p[d>>2]|0),p[m+4>>2]=(p[f+4>>2]|0)+(p[d+4>>2]|0),p[m+8>>2]=(p[f+8>>2]|0)+(p[d+8>>2]|0)}function Zw(d,f,m){d=d|0,f=f|0,m=m|0,p[m>>2]=(p[d>>2]|0)-(p[f>>2]|0),p[m+4>>2]=(p[d+4>>2]|0)-(p[f+4>>2]|0),p[m+8>>2]=(p[d+8>>2]|0)-(p[f+8>>2]|0)}function M8(d,f){d=d|0,f=f|0;var m=0,g=0;m=Kt(p[d>>2]|0,f)|0,p[d>>2]=m,m=d+4|0,g=Kt(p[m>>2]|0,f)|0,p[m>>2]=g,d=d+8|0,f=Kt(p[d>>2]|0,f)|0,p[d>>2]=f}function iy(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;C=p[d>>2]|0,P=(C|0)<0,g=(p[d+4>>2]|0)-(P?C:0)|0,E=(g|0)<0,b=(E?0-g|0:0)+((p[d+8>>2]|0)-(P?C:0))|0,m=(b|0)<0,d=m?0:b,f=(E?0:g)-(m?b:0)|0,b=(P?0:C)-(E?g:0)-(m?b:0)|0,m=(f|0)<(b|0)?f:b,m=(d|0)<(m|0)?d:m,g=(m|0)>0,d=d-(g?m:0)|0,f=f-(g?m:0)|0;e:do switch(b-(g?m:0)|0){case 0:switch(f|0){case 0:return P=d|0?(d|0)==1?1:7:0,P|0;case 1:return P=d|0?(d|0)==1?3:7:2,P|0;default:break e}case 1:switch(f|0){case 0:return P=d|0?(d|0)==1?5:7:4,P|0;case 1:{if(!d)d=6;else break e;return d|0}default:break e}}while(!1);return P=7,P|0}function AQ(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;C=d+8|0,b=p[C>>2]|0,E=(p[d>>2]|0)-b|0,P=d+4|0,b=(p[P>>2]|0)-b|0;do if(E>>>0>715827881|b>>>0>715827881){if(m=(E|0)>0,m){if((2147483647-E|0)<(E|0)||(2147483647-(E<<1)|0)<(E|0))return P=1,P|0}else if((-2147483648-E|0)>(E|0)||(-2147483648-(E<<1)|0)>(E|0))return P=1,P|0;if(f=E*3|0,(b|0)>0){if((2147483647-b|0)<(b|0))return P=1,P|0}else if((-2147483648-b|0)>(b|0))return P=1,P|0;if(g=b<<1,(E|0)>-1){if((f|-2147483648|0)>=(b|0))return P=1,P|0}else if((f^-2147483648|0)<(b|0))return P=1,P|0;if(m){if((2147483647-E|0)<(g|0))f=1;else{m=g;break}return f|0}else{if((-2147483648-E|0)>(g|0))f=1;else{m=g;break}return f|0}}else m=b<<1,f=E*3|0;while(!1);g=Oc(+(f-b|0)/7)|0,p[d>>2]=g,b=Oc(+(m+E|0)/7)|0,p[P>>2]=b,p[C>>2]=0,m=(b|0)<(g|0),f=m?g:b,m=m?b:g;do if((m|0)<0){if((f|0)>0){if((f|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-f|0)>=(m|0)))break;_t(23313,22444,355,22455)}if((m|0)==-2147483648|(-2147483648-f|0)>(m|0)&&_t(23313,22444,355,22455),(f|0)>-1){if((f|-2147483648|0)<(m|0))break;_t(23313,22444,355,22455)}else{if((f^-2147483648|0)>=(m|0))break;_t(23313,22444,355,22455)}}while(!1);return f=b-g|0,(g|0)<0?(m=0-g|0,p[P>>2]=f,p[C>>2]=m,p[d>>2]=0,g=0):(f=b,m=0),(f|0)<0&&(g=g-f|0,p[d>>2]=g,m=m-f|0,p[C>>2]=m,p[P>>2]=0,f=0),E=g-m|0,b=f-m|0,(m|0)<0?(p[d>>2]=E,p[P>>2]=b,p[C>>2]=0,f=b,b=E,m=0):b=g,g=(f|0)<(b|0)?f:b,g=(m|0)<(g|0)?m:g,(g|0)<=0?(P=0,P|0):(p[d>>2]=b-g,p[P>>2]=f-g,p[C>>2]=m-g,P=0,P|0)}function mQ(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;C=d+8|0,b=p[C>>2]|0,E=(p[d>>2]|0)-b|0,P=d+4|0,b=(p[P>>2]|0)-b|0;do if(E>>>0>715827881|b>>>0>715827881){if(m=(E|0)>0,m){if((2147483647-E|0)<(E|0))return P=1,P|0}else if((-2147483648-E|0)>(E|0))return P=1,P|0;if(f=E<<1,(b|0)>0){if((2147483647-b|0)<(b|0)||(2147483647-(b<<1)|0)<(b|0))return P=1,P|0}else if((-2147483648-b|0)>(b|0)||(-2147483648-(b<<1)|0)>(b|0))return P=1,P|0;if(g=b*3|0,m){if((2147483647-f|0)<(b|0))return P=1,P|0}else if((-2147483648-f|0)>(b|0))return P=1,P|0;if((b|0)>-1){if((g|-2147483648|0)<(E|0)){m=g;break}else f=1;return f|0}else{if((g^-2147483648|0)<(E|0))f=1;else{m=g;break}return f|0}}else m=b*3|0,f=E<<1;while(!1);g=Oc(+(f+b|0)/7)|0,p[d>>2]=g,b=Oc(+(m-E|0)/7)|0,p[P>>2]=b,p[C>>2]=0,m=(b|0)<(g|0),f=m?g:b,m=m?b:g;do if((m|0)<0){if((f|0)>0){if((f|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-f|0)>=(m|0)))break;_t(23313,22444,404,22469)}if((m|0)==-2147483648|(-2147483648-f|0)>(m|0)&&_t(23313,22444,404,22469),(f|0)>-1){if((f|-2147483648|0)<(m|0))break;_t(23313,22444,404,22469)}else{if((f^-2147483648|0)>=(m|0))break;_t(23313,22444,404,22469)}}while(!1);return f=b-g|0,(g|0)<0?(m=0-g|0,p[P>>2]=f,p[C>>2]=m,p[d>>2]=0,g=0):(f=b,m=0),(f|0)<0&&(g=g-f|0,p[d>>2]=g,m=m-f|0,p[C>>2]=m,p[P>>2]=0,f=0),E=g-m|0,b=f-m|0,(m|0)<0?(p[d>>2]=E,p[P>>2]=b,p[C>>2]=0,f=b,b=E,m=0):b=g,g=(f|0)<(b|0)?f:b,g=(m|0)<(g|0)?m:g,(g|0)<=0?(P=0,P|0):(p[d>>2]=b-g,p[P>>2]=f-g,p[C>>2]=m-g,P=0,P|0)}function gQ(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;C=d+8|0,m=p[C>>2]|0,f=(p[d>>2]|0)-m|0,P=d+4|0,m=(p[P>>2]|0)-m|0,g=Oc(+((f*3|0)-m|0)/7)|0,p[d>>2]=g,f=Oc(+((m<<1)+f|0)/7)|0,p[P>>2]=f,p[C>>2]=0,m=f-g|0,(g|0)<0?(E=0-g|0,p[P>>2]=m,p[C>>2]=E,p[d>>2]=0,f=m,g=0,m=E):m=0,(f|0)<0&&(g=g-f|0,p[d>>2]=g,m=m-f|0,p[C>>2]=m,p[P>>2]=0,f=0),E=g-m|0,b=f-m|0,(m|0)<0?(p[d>>2]=E,p[P>>2]=b,p[C>>2]=0,f=b,b=E,m=0):b=g,g=(f|0)<(b|0)?f:b,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[d>>2]=b-g,p[P>>2]=f-g,p[C>>2]=m-g)}function R8(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;C=d+8|0,m=p[C>>2]|0,f=(p[d>>2]|0)-m|0,P=d+4|0,m=(p[P>>2]|0)-m|0,g=Oc(+((f<<1)+m|0)/7)|0,p[d>>2]=g,f=Oc(+((m*3|0)-f|0)/7)|0,p[P>>2]=f,p[C>>2]=0,m=f-g|0,(g|0)<0?(E=0-g|0,p[P>>2]=m,p[C>>2]=E,p[d>>2]=0,f=m,g=0,m=E):m=0,(f|0)<0&&(g=g-f|0,p[d>>2]=g,m=m-f|0,p[C>>2]=m,p[P>>2]=0,f=0),E=g-m|0,b=f-m|0,(m|0)<0?(p[d>>2]=E,p[P>>2]=b,p[C>>2]=0,f=b,b=E,m=0):b=g,g=(f|0)<(b|0)?f:b,g=(m|0)<(g|0)?m:g,!((g|0)<=0)&&(p[d>>2]=b-g,p[P>>2]=f-g,p[C>>2]=m-g)}function ry(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;f=p[d>>2]|0,C=d+4|0,m=p[C>>2]|0,P=d+8|0,g=p[P>>2]|0,b=m+(f*3|0)|0,p[d>>2]=b,m=g+(m*3|0)|0,p[C>>2]=m,f=(g*3|0)+f|0,p[P>>2]=f,g=m-b|0,(b|0)<0?(f=f-b|0,p[C>>2]=g,p[P>>2]=f,p[d>>2]=0,m=g,g=0):g=b,(m|0)<0&&(g=g-m|0,p[d>>2]=g,f=f-m|0,p[P>>2]=f,p[C>>2]=0,m=0),E=g-f|0,b=m-f|0,(f|0)<0?(p[d>>2]=E,p[C>>2]=b,p[P>>2]=0,g=E,f=0):b=m,m=(b|0)<(g|0)?b:g,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=g-m,p[C>>2]=b-m,p[P>>2]=f-m)}function bf(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;b=p[d>>2]|0,C=d+4|0,f=p[C>>2]|0,P=d+8|0,m=p[P>>2]|0,g=(f*3|0)+b|0,b=m+(b*3|0)|0,p[d>>2]=b,p[C>>2]=g,f=(m*3|0)+f|0,p[P>>2]=f,m=g-b|0,(b|0)<0?(f=f-b|0,p[C>>2]=m,p[P>>2]=f,p[d>>2]=0,b=0):m=g,(m|0)<0&&(b=b-m|0,p[d>>2]=b,f=f-m|0,p[P>>2]=f,p[C>>2]=0,m=0),E=b-f|0,g=m-f|0,(f|0)<0?(p[d>>2]=E,p[C>>2]=g,p[P>>2]=0,b=E,f=0):g=m,m=(g|0)<(b|0)?g:b,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=b-m,p[C>>2]=g-m,p[P>>2]=f-m)}function P8(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0;(f+-1|0)>>>0>=6||(b=(p[15440+(f*12|0)>>2]|0)+(p[d>>2]|0)|0,p[d>>2]=b,P=d+4|0,g=(p[15440+(f*12|0)+4>>2]|0)+(p[P>>2]|0)|0,p[P>>2]=g,C=d+8|0,f=(p[15440+(f*12|0)+8>>2]|0)+(p[C>>2]|0)|0,p[C>>2]=f,m=g-b|0,(b|0)<0?(f=f-b|0,p[P>>2]=m,p[C>>2]=f,p[d>>2]=0,g=0):(m=g,g=b),(m|0)<0&&(g=g-m|0,p[d>>2]=g,f=f-m|0,p[C>>2]=f,p[P>>2]=0,m=0),E=g-f|0,b=m-f|0,(f|0)<0?(p[d>>2]=E,p[P>>2]=b,p[C>>2]=0,g=E,f=0):b=m,m=(b|0)<(g|0)?b:g,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=g-m,p[P>>2]=b-m,p[C>>2]=f-m))}function N8(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;b=p[d>>2]|0,C=d+4|0,f=p[C>>2]|0,P=d+8|0,m=p[P>>2]|0,g=f+b|0,b=m+b|0,p[d>>2]=b,p[C>>2]=g,f=m+f|0,p[P>>2]=f,m=g-b|0,(b|0)<0?(f=f-b|0,p[C>>2]=m,p[P>>2]=f,p[d>>2]=0,g=0):(m=g,g=b),(m|0)<0&&(g=g-m|0,p[d>>2]=g,f=f-m|0,p[P>>2]=f,p[C>>2]=0,m=0),E=g-f|0,b=m-f|0,(f|0)<0?(p[d>>2]=E,p[C>>2]=b,p[P>>2]=0,g=E,f=0):b=m,m=(b|0)<(g|0)?b:g,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=g-m,p[C>>2]=b-m,p[P>>2]=f-m)}function sy(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;f=p[d>>2]|0,C=d+4|0,g=p[C>>2]|0,P=d+8|0,m=p[P>>2]|0,b=g+f|0,p[d>>2]=b,g=m+g|0,p[C>>2]=g,f=m+f|0,p[P>>2]=f,m=g-b|0,(b|0)<0?(f=f-b|0,p[C>>2]=m,p[P>>2]=f,p[d>>2]=0,g=0):(m=g,g=b),(m|0)<0&&(g=g-m|0,p[d>>2]=g,f=f-m|0,p[P>>2]=f,p[C>>2]=0,m=0),E=g-f|0,b=m-f|0,(f|0)<0?(p[d>>2]=E,p[C>>2]=b,p[P>>2]=0,g=E,f=0):b=m,m=(b|0)<(g|0)?b:g,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=g-m,p[C>>2]=b-m,p[P>>2]=f-m)}function Sf(d){switch(d=d|0,d|0){case 1:{d=5;break}case 5:{d=4;break}case 4:{d=6;break}case 6:{d=2;break}case 2:{d=3;break}case 3:{d=1;break}}return d|0}function Fc(d){switch(d=d|0,d|0){case 1:{d=3;break}case 3:{d=2;break}case 2:{d=6;break}case 6:{d=4;break}case 4:{d=5;break}case 5:{d=1;break}}return d|0}function I8(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;f=p[d>>2]|0,C=d+4|0,m=p[C>>2]|0,P=d+8|0,g=p[P>>2]|0,b=m+(f<<1)|0,p[d>>2]=b,m=g+(m<<1)|0,p[C>>2]=m,f=(g<<1)+f|0,p[P>>2]=f,g=m-b|0,(b|0)<0?(f=f-b|0,p[C>>2]=g,p[P>>2]=f,p[d>>2]=0,m=g,g=0):g=b,(m|0)<0&&(g=g-m|0,p[d>>2]=g,f=f-m|0,p[P>>2]=f,p[C>>2]=0,m=0),E=g-f|0,b=m-f|0,(f|0)<0?(p[d>>2]=E,p[C>>2]=b,p[P>>2]=0,g=E,f=0):b=m,m=(b|0)<(g|0)?b:g,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=g-m,p[C>>2]=b-m,p[P>>2]=f-m)}function D8(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;b=p[d>>2]|0,C=d+4|0,f=p[C>>2]|0,P=d+8|0,m=p[P>>2]|0,g=(f<<1)+b|0,b=m+(b<<1)|0,p[d>>2]=b,p[C>>2]=g,f=(m<<1)+f|0,p[P>>2]=f,m=g-b|0,(b|0)<0?(f=f-b|0,p[C>>2]=m,p[P>>2]=f,p[d>>2]=0,b=0):m=g,(m|0)<0&&(b=b-m|0,p[d>>2]=b,f=f-m|0,p[P>>2]=f,p[C>>2]=0,m=0),E=b-f|0,g=m-f|0,(f|0)<0?(p[d>>2]=E,p[C>>2]=g,p[P>>2]=0,b=E,f=0):g=m,m=(g|0)<(b|0)?g:b,m=(f|0)<(m|0)?f:m,!((m|0)<=0)&&(p[d>>2]=b-m,p[C>>2]=g-m,p[P>>2]=f-m)}function Jw(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0;return C=(p[d>>2]|0)-(p[f>>2]|0)|0,P=(C|0)<0,g=(p[d+4>>2]|0)-(p[f+4>>2]|0)-(P?C:0)|0,E=(g|0)<0,b=(P?0-C|0:0)+(p[d+8>>2]|0)-(p[f+8>>2]|0)+(E?0-g|0:0)|0,d=(b|0)<0,f=d?0:b,m=(E?0:g)-(d?b:0)|0,b=(P?0:C)-(E?g:0)-(d?b:0)|0,d=(m|0)<(b|0)?m:b,d=(f|0)<(d|0)?f:d,g=(d|0)>0,f=f-(g?d:0)|0,m=m-(g?d:0)|0,d=b-(g?d:0)|0,d=(d|0)>-1?d:0-d|0,m=(m|0)>-1?m:0-m|0,f=(f|0)>-1?f:0-f|0,f=(m|0)>(f|0)?m:f,((d|0)>(f|0)?d:f)|0}function vQ(d,f){d=d|0,f=f|0;var m=0;m=p[d+8>>2]|0,p[f>>2]=(p[d>>2]|0)-m,p[f+4>>2]=(p[d+4>>2]|0)-m}function yQ(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0;g=p[d>>2]|0,p[f>>2]=g,b=p[d+4>>2]|0,C=f+4|0,p[C>>2]=b,P=f+8|0,p[P>>2]=0,m=(b|0)<(g|0),d=m?g:b,m=m?b:g;do if((m|0)<0){if((d|0)>0){if((d|-2147483648|0)<(m|0)&((m|0)!=-2147483648&(2147483647-d|0)>=(m|0)))break;return d=1,d|0}if((m|0)==-2147483648|(-2147483648-d|0)>(m|0))return f=1,f|0;if((d|0)>-1){if((d|-2147483648|0)<(m|0))break;return d=1,d|0}else{if((d^-2147483648|0)<(m|0))d=1;else break;return d|0}}while(!1);return d=b-g|0,(g|0)<0?(m=0-g|0,p[C>>2]=d,p[P>>2]=m,p[f>>2]=0,g=0):(d=b,m=0),(d|0)<0&&(g=g-d|0,p[f>>2]=g,m=m-d|0,p[P>>2]=m,p[C>>2]=0,d=0),E=g-m|0,b=d-m|0,(m|0)<0?(p[f>>2]=E,p[C>>2]=b,p[P>>2]=0,d=b,b=E,m=0):b=g,g=(d|0)<(b|0)?d:b,g=(m|0)<(g|0)?m:g,(g|0)<=0?(f=0,f|0):(p[f>>2]=b-g,p[C>>2]=d-g,p[P>>2]=m-g,f=0,f|0)}function k8(d){d=d|0;var f=0,m=0,g=0,b=0;f=d+8|0,b=p[f>>2]|0,m=b-(p[d>>2]|0)|0,p[d>>2]=m,g=d+4|0,d=(p[g>>2]|0)-b|0,p[g>>2]=d,p[f>>2]=0-(d+m)}function _Q(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;m=p[d>>2]|0,f=0-m|0,p[d>>2]=f,C=d+8|0,p[C>>2]=0,P=d+4|0,g=p[P>>2]|0,b=g+m|0,(m|0)>0?(p[P>>2]=b,p[C>>2]=m,p[d>>2]=0,f=0,g=b):m=0,(g|0)<0?(E=f-g|0,p[d>>2]=E,m=m-g|0,p[C>>2]=m,p[P>>2]=0,b=E-m|0,f=0-m|0,(m|0)<0?(p[d>>2]=b,p[P>>2]=f,p[C>>2]=0,g=f,m=0):(g=0,b=E)):b=f,f=(g|0)<(b|0)?g:b,f=(m|0)<(f|0)?m:f,!((f|0)<=0)&&(p[d>>2]=b-f,p[P>>2]=g-f,p[C>>2]=m-f)}function xQ(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0;if(te=Y,Y=Y+64|0,q=te,P=te+56|0,!(!0&(f&2013265920|0)==134217728&(!0&(g&2013265920|0)==134217728)))return b=5,Y=te,b|0;if((d|0)==(m|0)&(f|0)==(g|0))return p[b>>2]=0,b=0,Y=te,b|0;if(C=it(d|0,f|0,52)|0,ne()|0,C=C&15,U=it(m|0,g|0,52)|0,ne()|0,(C|0)!=(U&15|0))return b=12,Y=te,b|0;if(E=C+-1|0,C>>>0>1){iE(d,f,E,q)|0,iE(m,g,E,P)|0,U=q,k=p[U>>2]|0,U=p[U+4>>2]|0;e:do if((k|0)==(p[P>>2]|0)&&(U|0)==(p[P+4>>2]|0)){C=(C^15)*3|0,E=it(d|0,f|0,C|0)|0,ne()|0,E=E&7,C=it(m|0,g|0,C|0)|0,ne()|0,C=C&7;do if((E|0)==0|(C|0)==0)p[b>>2]=1,E=0;else if((E|0)==7)E=5;else{if((E|0)==1|(C|0)==1&&Ni(k,U)|0){E=5;break}if((p[15536+(E<<2)>>2]|0)!=(C|0)&&(p[15568+(E<<2)>>2]|0)!=(C|0))break e;p[b>>2]=1,E=0}while(!1);return b=E,Y=te,b|0}while(!1)}E=q,C=E+56|0;do p[E>>2]=0,E=E+4|0;while((E|0)<(C|0));return ms(d,f,1,q)|0,f=q,!((p[f>>2]|0)==(m|0)&&(p[f+4>>2]|0)==(g|0))&&(f=q+8|0,!((p[f>>2]|0)==(m|0)&&(p[f+4>>2]|0)==(g|0)))&&(f=q+16|0,!((p[f>>2]|0)==(m|0)&&(p[f+4>>2]|0)==(g|0)))&&(f=q+24|0,!((p[f>>2]|0)==(m|0)&&(p[f+4>>2]|0)==(g|0)))&&(f=q+32|0,!((p[f>>2]|0)==(m|0)&&(p[f+4>>2]|0)==(g|0)))&&(f=q+40|0,!((p[f>>2]|0)==(m|0)&&(p[f+4>>2]|0)==(g|0)))?(E=q+48|0,E=((p[E>>2]|0)==(m|0)?(p[E+4>>2]|0)==(g|0):0)&1):E=1,p[b>>2]=E,b=0,Y=te,b|0}function bQ(d,f,m,g,b){return d=d|0,f=f|0,m=m|0,g=g|0,b=b|0,m=Rn(d,f,m,g)|0,(m|0)==7?(b=11,b|0):(g=vt(m|0,0,56)|0,f=f&-2130706433|(ne()|0)|268435456,p[b>>2]=d|g,p[b+4>>2]=f,b=0,b|0)}function SQ(d,f,m){return d=d|0,f=f|0,m=m|0,!0&(f&2013265920|0)==268435456?(p[m>>2]=d,p[m+4>>2]=f&-2130706433|134217728,m=0,m|0):(m=6,m|0)}function wQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;return b=Y,Y=Y+16|0,g=b,p[g>>2]=0,!0&(f&2013265920|0)==268435456?(E=it(d|0,f|0,56)|0,ne()|0,g=Qi(d,f&-2130706433|134217728,E&7,g,m)|0,Y=b,g|0):(g=6,Y=b,g|0)}function EQ(d,f){d=d|0,f=f|0;var m=0;switch(m=it(d|0,f|0,56)|0,ne()|0,m&7){case 0:case 7:return m=0,m|0}return m=f&-2130706433|134217728,!(!0&(f&2013265920|0)==268435456)||!0&(f&117440512|0)==16777216&(Ni(d,m)|0)!=0?(m=0,m|0):(m=nE(d,m)|0,m|0)}function TQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0;return b=Y,Y=Y+16|0,g=b,!0&(f&2013265920|0)==268435456?(E=f&-2130706433|134217728,C=m,p[C>>2]=d,p[C+4>>2]=E,p[g>>2]=0,f=it(d|0,f|0,56)|0,ne()|0,g=Qi(d,E,f&7,g,m+8|0)|0,Y=b,g|0):(g=6,Y=b,g|0)}function CQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0;return b=(Ni(d,f)|0)==0,f=f&-2130706433,g=m,p[g>>2]=b?d:0,p[g+4>>2]=b?f|285212672:0,g=m+8|0,p[g>>2]=d,p[g+4>>2]=f|301989888,g=m+16|0,p[g>>2]=d,p[g+4>>2]=f|318767104,g=m+24|0,p[g>>2]=d,p[g+4>>2]=f|335544320,g=m+32|0,p[g>>2]=d,p[g+4>>2]=f|352321536,m=m+40|0,p[m>>2]=d,p[m+4>>2]=f|369098752,0}function oy(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0;return C=Y,Y=Y+16|0,b=C,E=f&-2130706433|134217728,!0&(f&2013265920|0)==268435456?(g=it(d|0,f|0,56)|0,ne()|0,g=TK(d,E,g&7)|0,(g|0)==-1?(p[m>>2]=0,E=6,Y=C,E|0):(fp(d,E,b)|0&&_t(23313,22484,282,22499),f=it(d|0,f|0,52)|0,ne()|0,f=f&15,Ni(d,E)|0?eE(b,f,g,2,m):tE(b,f,g,2,m),E=0,Y=C,E|0)):(E=6,Y=C,E|0)}function MQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0;g=Y,Y=Y+16|0,b=g,RQ(d,f,m,b),cp(b,m+4|0),Y=g}function RQ(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0;if(P=Y,Y=Y+16|0,k=P,PQ(d,m,k),E=+ct(+(1-+J[k>>3]*.5)),E<1e-16){p[g>>2]=0,p[g+4>>2]=0,p[g+8>>2]=0,p[g+12>>2]=0,Y=P;return}if(k=p[m>>2]|0,b=+J[15920+(k*24|0)>>3],b=+xm(b-+xm(+YQ(15600+(k<<4)|0,d))),ma(f)|0?C=+xm(b+-.3334731722518321):C=b,b=+ge(+E)/.381966011250105,(f|0)>0){d=0;do b=b*2.6457513110645907,d=d+1|0;while((d|0)!=(f|0))}E=+Ee(+C)*b,J[g>>3]=E,C=+xe(+C)*b,J[g+8>>3]=C,Y=P}function PQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;if(E=Y,Y=Y+32|0,b=E,EK(d,b),p[f>>2]=0,J[m>>3]=5,g=+_r(16400,b),g<+J[m>>3]&&(p[f>>2]=0,J[m>>3]=g),g=+_r(16424,b),g<+J[m>>3]&&(p[f>>2]=1,J[m>>3]=g),g=+_r(16448,b),g<+J[m>>3]&&(p[f>>2]=2,J[m>>3]=g),g=+_r(16472,b),g<+J[m>>3]&&(p[f>>2]=3,J[m>>3]=g),g=+_r(16496,b),g<+J[m>>3]&&(p[f>>2]=4,J[m>>3]=g),g=+_r(16520,b),g<+J[m>>3]&&(p[f>>2]=5,J[m>>3]=g),g=+_r(16544,b),g<+J[m>>3]&&(p[f>>2]=6,J[m>>3]=g),g=+_r(16568,b),g<+J[m>>3]&&(p[f>>2]=7,J[m>>3]=g),g=+_r(16592,b),g<+J[m>>3]&&(p[f>>2]=8,J[m>>3]=g),g=+_r(16616,b),g<+J[m>>3]&&(p[f>>2]=9,J[m>>3]=g),g=+_r(16640,b),g<+J[m>>3]&&(p[f>>2]=10,J[m>>3]=g),g=+_r(16664,b),g<+J[m>>3]&&(p[f>>2]=11,J[m>>3]=g),g=+_r(16688,b),g<+J[m>>3]&&(p[f>>2]=12,J[m>>3]=g),g=+_r(16712,b),g<+J[m>>3]&&(p[f>>2]=13,J[m>>3]=g),g=+_r(16736,b),g<+J[m>>3]&&(p[f>>2]=14,J[m>>3]=g),g=+_r(16760,b),g<+J[m>>3]&&(p[f>>2]=15,J[m>>3]=g),g=+_r(16784,b),g<+J[m>>3]&&(p[f>>2]=16,J[m>>3]=g),g=+_r(16808,b),g<+J[m>>3]&&(p[f>>2]=17,J[m>>3]=g),g=+_r(16832,b),g<+J[m>>3]&&(p[f>>2]=18,J[m>>3]=g),g=+_r(16856,b),!(g<+J[m>>3])){Y=E;return}p[f>>2]=19,J[m>>3]=g,Y=E}function vm(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0;if(E=+wK(d),E<1e-16){f=15600+(f<<4)|0,p[b>>2]=p[f>>2],p[b+4>>2]=p[f+4>>2],p[b+8>>2]=p[f+8>>2],p[b+12>>2]=p[f+12>>2];return}if(C=+Rt(+ +J[d+8>>3],+ +J[d>>3]),(m|0)>0){d=0;do E=E/2.6457513110645907,d=d+1|0;while((d|0)!=(m|0))}g?(E=E/3,m=(ma(m)|0)==0,E=+Vt(+((m?E:E/2.6457513110645907)*.381966011250105))):(E=+Vt(+(E*.381966011250105)),ma(m)|0&&(C=+xm(C+.3334731722518321))),QQ(15600+(f<<4)|0,+xm(+J[15920+(f*24|0)>>3]-C),E,b)}function NQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0;g=Y,Y=Y+16|0,b=g,po(d+4|0,b),vm(b,p[d>>2]|0,f,0,m),Y=g}function eE(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0,li=0,Wn=0,Kn=0,xn=0,gn=0,bn=0,vi=0,un=0;if(bn=Y,Y=Y+272|0,E=bn+256|0,Ie=bn+240|0,Kn=bn,xn=bn+224|0,gn=bn+208|0,De=bn+176|0,be=bn+160|0,St=bn+192|0,Bt=bn+144|0,mt=bn+128|0,wt=bn+112|0,li=bn+96|0,Wn=bn+80|0,p[E>>2]=f,p[Ie>>2]=p[d>>2],p[Ie+4>>2]=p[d+4>>2],p[Ie+8>>2]=p[d+8>>2],p[Ie+12>>2]=p[d+12>>2],L8(Ie,E,Kn),p[b>>2]=0,Ie=g+m+((g|0)==5&1)|0,(Ie|0)<=(m|0)){Y=bn;return}k=p[E>>2]|0,U=xn+4|0,q=De+4|0,te=m+5|0,he=16880+(k<<2)|0,pe=16960+(k<<2)|0,ae=mt+8|0,Se=wt+8|0,qe=li+8|0,Ue=gn+4|0,P=m;e:for(;;){C=Kn+(((P|0)%5|0)<<4)|0,p[gn>>2]=p[C>>2],p[gn+4>>2]=p[C+4>>2],p[gn+8>>2]=p[C+8>>2],p[gn+12>>2]=p[C+12>>2];do;while((hp(gn,k,0,1)|0)==2);if((P|0)>(m|0)&(ma(f)|0)!=0){if(p[De>>2]=p[gn>>2],p[De+4>>2]=p[gn+4>>2],p[De+8>>2]=p[gn+8>>2],p[De+12>>2]=p[gn+12>>2],po(U,be),g=p[De>>2]|0,E=p[17040+(g*80|0)+(p[xn>>2]<<2)>>2]|0,p[De>>2]=p[18640+(g*80|0)+(E*20|0)>>2],C=p[18640+(g*80|0)+(E*20|0)+16>>2]|0,(C|0)>0){d=0;do N8(q),d=d+1|0;while((d|0)<(C|0))}switch(C=18640+(g*80|0)+(E*20|0)+4|0,p[St>>2]=p[C>>2],p[St+4>>2]=p[C+4>>2],p[St+8>>2]=p[C+8>>2],M8(St,(p[he>>2]|0)*3|0),Us(q,St,q),Ki(q),po(q,Bt),vi=+(p[pe>>2]|0),J[mt>>3]=vi*3,J[ae>>3]=0,un=vi*-1.5,J[wt>>3]=un,J[Se>>3]=vi*2.598076211353316,J[li>>3]=un,J[qe>>3]=vi*-2.598076211353316,p[17040+((p[De>>2]|0)*80|0)+(p[gn>>2]<<2)>>2]|0){case 1:{d=wt,g=mt;break}case 3:{d=li,g=wt;break}case 2:{d=mt,g=li;break}default:{d=12;break e}}X8(be,Bt,g,d,Wn),vm(Wn,p[De>>2]|0,k,1,b+8+(p[b>>2]<<4)|0),p[b>>2]=(p[b>>2]|0)+1}if((P|0)<(te|0)&&(po(Ue,De),vm(De,p[gn>>2]|0,k,1,b+8+(p[b>>2]<<4)|0),p[b>>2]=(p[b>>2]|0)+1),p[xn>>2]=p[gn>>2],p[xn+4>>2]=p[gn+4>>2],p[xn+8>>2]=p[gn+8>>2],p[xn+12>>2]=p[gn+12>>2],P=P+1|0,(P|0)>=(Ie|0)){d=3;break}}if((d|0)==3){Y=bn;return}else(d|0)==12&&_t(22522,22569,571,22579)}function L8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0;k=Y,Y=Y+128|0,g=k+64|0,b=k,E=g,C=20240,P=E+60|0;do p[E>>2]=p[C>>2],E=E+4|0,C=C+4|0;while((E|0)<(P|0));E=b,C=20304,P=E+60|0;do p[E>>2]=p[C>>2],E=E+4|0,C=C+4|0;while((E|0)<(P|0));P=(ma(p[f>>2]|0)|0)==0,g=P?g:b,b=d+4|0,I8(b),D8(b),ma(p[f>>2]|0)|0&&(bf(b),p[f>>2]=(p[f>>2]|0)+1),p[m>>2]=p[d>>2],f=m+4|0,Us(b,g,f),Ki(f),p[m+16>>2]=p[d>>2],f=m+20|0,Us(b,g+12|0,f),Ki(f),p[m+32>>2]=p[d>>2],f=m+36|0,Us(b,g+24|0,f),Ki(f),p[m+48>>2]=p[d>>2],f=m+52|0,Us(b,g+36|0,f),Ki(f),p[m+64>>2]=p[d>>2],m=m+68|0,Us(b,g+48|0,m),Ki(m),Y=k}function hp(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0;if(ae=Y,Y=Y+32|0,he=ae+12|0,P=ae,pe=d+4|0,te=p[16960+(f<<2)>>2]|0,q=(g|0)!=0,te=q?te*3|0:te,b=p[pe>>2]|0,U=d+8|0,C=p[U>>2]|0,q){if(E=d+12|0,g=p[E>>2]|0,b=C+b+g|0,(b|0)==(te|0))return pe=1,Y=ae,pe|0;k=E}else k=d+12|0,g=p[k>>2]|0,b=C+b+g|0;if((b|0)<=(te|0))return pe=0,Y=ae,pe|0;do if((g|0)>0){if(g=p[d>>2]|0,(C|0)>0){E=18640+(g*80|0)+60|0,g=d;break}g=18640+(g*80|0)+40|0,m?(Lc(he,te,0,0),Zw(pe,he,P),sy(P),Us(P,he,pe),E=g,g=d):(E=g,g=d)}else E=18640+((p[d>>2]|0)*80|0)+20|0,g=d;while(!1);if(p[g>>2]=p[E>>2],b=E+16|0,(p[b>>2]|0)>0){g=0;do N8(pe),g=g+1|0;while((g|0)<(p[b>>2]|0))}return d=E+4|0,p[he>>2]=p[d>>2],p[he+4>>2]=p[d+4>>2],p[he+8>>2]=p[d+8>>2],f=p[16880+(f<<2)>>2]|0,M8(he,q?f*3|0:f),Us(pe,he,pe),Ki(pe),q?g=((p[U>>2]|0)+(p[pe>>2]|0)+(p[k>>2]|0)|0)==(te|0)?1:2:g=2,pe=g,Y=ae,pe|0}function IQ(d,f){d=d|0,f=f|0;var m=0;do m=hp(d,f,0,1)|0;while((m|0)==2);return m|0}function tE(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0,li=0,Wn=0,Kn=0;if(li=Y,Y=Y+240|0,E=li+224|0,St=li+208|0,Bt=li,mt=li+192|0,wt=li+176|0,qe=li+160|0,Ue=li+144|0,Ie=li+128|0,De=li+112|0,be=li+96|0,p[E>>2]=f,p[St>>2]=p[d>>2],p[St+4>>2]=p[d+4>>2],p[St+8>>2]=p[d+8>>2],p[St+12>>2]=p[d+12>>2],F8(St,E,Bt),p[b>>2]=0,Se=g+m+((g|0)==6&1)|0,(Se|0)<=(m|0)){Y=li;return}k=p[E>>2]|0,U=m+6|0,q=16960+(k<<2)|0,te=Ue+8|0,he=Ie+8|0,pe=De+8|0,ae=mt+4|0,C=0,P=m,g=-1;e:for(;;){if(E=(P|0)%6|0,d=Bt+(E<<4)|0,p[mt>>2]=p[d>>2],p[mt+4>>2]=p[d+4>>2],p[mt+8>>2]=p[d+8>>2],p[mt+12>>2]=p[d+12>>2],d=C,C=hp(mt,k,0,1)|0,(P|0)>(m|0)&(ma(f)|0)!=0&&(d|0)!=1&&(p[mt>>2]|0)!=(g|0)){switch(po(Bt+(((E+5|0)%6|0)<<4)+4|0,wt),po(Bt+(E<<4)+4|0,qe),Wn=+(p[q>>2]|0),J[Ue>>3]=Wn*3,J[te>>3]=0,Kn=Wn*-1.5,J[Ie>>3]=Kn,J[he>>3]=Wn*2.598076211353316,J[De>>3]=Kn,J[pe>>3]=Wn*-2.598076211353316,E=p[St>>2]|0,p[17040+(E*80|0)+(((g|0)==(E|0)?p[mt>>2]|0:g)<<2)>>2]|0){case 1:{d=Ie,g=Ue;break}case 3:{d=De,g=Ie;break}case 2:{d=Ue,g=De;break}default:{d=8;break e}}X8(wt,qe,g,d,be),!(Y8(wt,be)|0)&&!(Y8(qe,be)|0)&&(vm(be,p[St>>2]|0,k,1,b+8+(p[b>>2]<<4)|0),p[b>>2]=(p[b>>2]|0)+1)}if((P|0)<(U|0)&&(po(ae,wt),vm(wt,p[mt>>2]|0,k,1,b+8+(p[b>>2]<<4)|0),p[b>>2]=(p[b>>2]|0)+1),P=P+1|0,(P|0)>=(Se|0)){d=3;break}else g=p[mt>>2]|0}if((d|0)==3){Y=li;return}else(d|0)==8&&_t(22606,22569,736,22651)}function F8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0;k=Y,Y=Y+160|0,g=k+80|0,b=k,E=g,C=20368,P=E+72|0;do p[E>>2]=p[C>>2],E=E+4|0,C=C+4|0;while((E|0)<(P|0));E=b,C=20448,P=E+72|0;do p[E>>2]=p[C>>2],E=E+4|0,C=C+4|0;while((E|0)<(P|0));P=(ma(p[f>>2]|0)|0)==0,g=P?g:b,b=d+4|0,I8(b),D8(b),ma(p[f>>2]|0)|0&&(bf(b),p[f>>2]=(p[f>>2]|0)+1),p[m>>2]=p[d>>2],f=m+4|0,Us(b,g,f),Ki(f),p[m+16>>2]=p[d>>2],f=m+20|0,Us(b,g+12|0,f),Ki(f),p[m+32>>2]=p[d>>2],f=m+36|0,Us(b,g+24|0,f),Ki(f),p[m+48>>2]=p[d>>2],f=m+52|0,Us(b,g+36|0,f),Ki(f),p[m+64>>2]=p[d>>2],f=m+68|0,Us(b,g+48|0,f),Ki(f),p[m+80>>2]=p[d>>2],m=m+84|0,Us(b,g+60|0,m),Ki(m),Y=k}function DQ(d,f){return d=d|0,f=f|0,f=it(d|0,f|0,52)|0,ne()|0,f&15|0}function B8(d,f){return d=d|0,f=f|0,f=it(d|0,f|0,45)|0,ne()|0,f&127|0}function nE(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0;if(!(!0&(f&-16777216|0)==134217728)||(C=it(d|0,f|0,45)|0,ne()|0,C=C&127,C>>>0>121))return f=0,f|0;m=it(d|0,f|0,52)|0,ne()|0,m=m&15;do if(m|0){for(b=1,g=0;;){if(E=it(d|0,f|0,(15-b|0)*3|0)|0,ne()|0,E=E&7,(E|0)!=0&(g^1))if((E|0)==1&(Si(C)|0)!=0){P=0,g=13;break}else g=1;if((E|0)==7){P=0,g=13;break}if(b>>>0<m>>>0)b=b+1|0;else{g=9;break}}if((g|0)==9){if((m|0)==15)P=1;else break;return P|0}else if((g|0)==13)return P|0}while(!1);for(;;){if(P=it(d|0,f|0,(14-m|0)*3|0)|0,ne()|0,!((P&7|0)==7&!0)){P=0,g=13;break}if(m>>>0<14)m=m+1|0;else{P=1,g=13;break}}return(g|0)==13?P|0:0}function iE(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0;if(E=it(d|0,f|0,52)|0,ne()|0,E=E&15,m>>>0>15)return g=4,g|0;if((E|0)<(m|0))return g=12,g|0;if((E|0)==(m|0))return p[g>>2]=d,p[g+4>>2]=f,g=0,g|0;if(b=vt(m|0,0,52)|0,b=b|d,d=ne()|0|f&-15728641,(E|0)>(m|0))do f=vt(7,0,(14-m|0)*3|0)|0,m=m+1|0,b=f|b,d=ne()|0|d;while((m|0)<(E|0));return p[g>>2]=b,p[g+4>>2]=d,g=0,g|0}function ay(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0;if(E=it(d|0,f|0,52)|0,ne()|0,E=E&15,!((m|0)<16&(E|0)<=(m|0)))return g=4,g|0;b=m-E|0,m=it(d|0,f|0,45)|0,ne()|0;e:do if(!(Si(m&127)|0))m=Bc(7,0,b,((b|0)<0)<<31>>31)|0,b=ne()|0;else{t:do if(E|0){for(m=1;C=vt(7,0,(15-m|0)*3|0)|0,!!((C&d|0)==0&((ne()|0)&f|0)==0);)if(m>>>0<E>>>0)m=m+1|0;else break t;m=Bc(7,0,b,((b|0)<0)<<31>>31)|0,b=ne()|0;break e}while(!1);m=Bc(7,0,b,((b|0)<0)<<31>>31)|0,m=vs(m|0,ne()|0,5,0)|0,m=kn(m|0,ne()|0,-5,-1)|0,m=Ef(m|0,ne()|0,6,0)|0,m=kn(m|0,ne()|0,1,0)|0,b=ne()|0}while(!1);return C=g,p[C>>2]=m,p[C+4>>2]=b,C=0,C|0}function Ni(d,f){d=d|0,f=f|0;var m=0,g=0,b=0;if(b=it(d|0,f|0,45)|0,ne()|0,!(Si(b&127)|0))return b=0,b|0;b=it(d|0,f|0,52)|0,ne()|0,b=b&15;e:do if(!b)m=0;else for(g=1;;){if(m=it(d|0,f|0,(15-g|0)*3|0)|0,ne()|0,m=m&7,m|0)break e;if(g>>>0<b>>>0)g=g+1|0;else{m=0;break}}while(!1);return b=(m|0)==0&1,b|0}function kQ(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0;if(C=Y,Y=Y+16|0,E=C,z8(E,d,f,m),f=E,d=p[f>>2]|0,f=p[f+4>>2]|0,(d|0)==0&(f|0)==0)return Y=C,0;b=0,m=0;do P=g+(b<<3)|0,p[P>>2]=d,p[P+4>>2]=f,b=kn(b|0,m|0,1,0)|0,m=ne()|0,V8(E),P=E,d=p[P>>2]|0,f=p[P+4>>2]|0;while(!((d|0)==0&(f|0)==0));return Y=C,0}function LQ(d,f,m,g){return d=d|0,f=f|0,m=m|0,g=g|0,(g|0)<(m|0)?(m=f,g=d,Ft(m|0),g|0):(m=vt(-1,-1,((g-m|0)*3|0)+3|0)|0,g=vt(~m|0,~(ne()|0)|0,(15-g|0)*3|0)|0,m=~(ne()|0)&f,g=~g&d,Ft(m|0),g|0)}function FQ(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0;return b=it(d|0,f|0,52)|0,ne()|0,b=b&15,(m|0)<16&(b|0)<=(m|0)?((b|0)<(m|0)&&(b=vt(-1,-1,((m+-1-b|0)*3|0)+3|0)|0,b=vt(~b|0,~(ne()|0)|0,(15-m|0)*3|0)|0,f=~(ne()|0)&f,d=~b&d),b=vt(m|0,0,52)|0,m=f&-15728641|(ne()|0),p[g>>2]=d|b,p[g+4>>2]=m,g=0,g|0):(g=4,g|0)}function BQ(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0;if((m|0)==0&(g|0)==0)return mt=0,mt|0;if(b=d,E=p[b>>2]|0,b=p[b+4>>2]|0,!0&(b&15728640|0)==0){if(!((g|0)>0|(g|0)==0&m>>>0>0)||(mt=f,p[mt>>2]=E,p[mt+4>>2]=b,(m|0)==1&(g|0)==0))return mt=0,mt|0;b=1;do St=d+(b<<3)|0,Bt=p[St+4>>2]|0,mt=f+(b<<3)|0,p[mt>>2]=p[St>>2],p[mt+4>>2]=Bt,b=b+1|0;while(0<(g|0)|(g|0)==0&b>>>0<m>>>0);return b=0,b|0}if(be=m<<3,Bt=Ll(be)|0,!Bt)return mt=13,mt|0;if(cy(Bt|0,d|0,be|0)|0,St=Fl(m,8)|0,!St)return ln(Bt),mt=13,mt|0;e:do if(m|0){t:for(;;){b=Bt,Ue=p[b>>2]|0,b=p[b+4>>2]|0,Ie=it(Ue|0,b|0,52)|0,ne()|0,Ie=Ie&15,De=Ie+-1|0,qe=(m|0)>0;n:do if((Ie|0)!=0&qe){if(pe=((m|0)<0)<<31>>31,ae=vt(De|0,0,52)|0,Se=ne()|0,De>>>0>15){if(!((Ue|0)==0&(b|0)==0)){mt=17;break t}for(E=0;;){if(E=E+1|0,(E|0)>=(m|0))break n;if(g=Bt+(E<<3)|0,Se=p[g>>2]|0,g=p[g+4>>2]|0,!((Se|0)==0&(g|0)==0)){b=g,mt=17;break t}}}for(E=0,d=Ue,g=b;;){if(!((d|0)==0&(g|0)==0)){if(!(!0&(g&117440512|0)==0)){mt=22;break t}if(P=it(d|0,g|0,52)|0,ne()|0,P=P&15,(P|0)<(De|0)){b=12,mt=28;break t}if((P|0)!=(De|0)&&(d=d|ae,g=g&-15728641|Se,P>>>0>=Ie>>>0)){C=De;do he=vt(7,0,(14-C|0)*3|0)|0,C=C+1|0,d=he|d,g=ne()|0|g;while(C>>>0<P>>>0)}if(C=pp(d|0,g|0,m|0,pe|0)|0,ne()|0,U=St+(C<<3)|0,P=U,k=p[P>>2]|0,P=p[P+4>>2]|0,(k|0)==0&(P|0)==0)C=U;else for(he=0;;){if((he|0)>(m|0)){mt=32;break t}if((k|0)==(d|0)&(P&-117440513|0)==(g|0)){q=it(k|0,P|0,56)|0,ne()|0,q=q&7,te=q+1|0,wt=it(k|0,P|0,45)|0,ne()|0;i:do if(!(Si(wt&127)|0))P=7;else{if(k=it(k|0,P|0,52)|0,ne()|0,k=k&15,!k){P=6;break}for(P=1;;){if(wt=vt(7,0,(15-P|0)*3|0)|0,!((wt&d|0)==0&((ne()|0)&g|0)==0)){P=7;break i}if(P>>>0<k>>>0)P=P+1|0;else{P=6;break}}}while(!1);if((q+2|0)>>>0>P>>>0){mt=42;break t}wt=vt(te|0,0,56)|0,g=ne()|0|g&-117440513,te=U,p[te>>2]=0,p[te+4>>2]=0,d=wt|d}else C=(C+1|0)%(m|0)|0;if(U=St+(C<<3)|0,P=U,k=p[P>>2]|0,P=p[P+4>>2]|0,(k|0)==0&(P|0)==0){C=U;break}else he=he+1|0}wt=C,p[wt>>2]=d,p[wt+4>>2]=g}if(E=E+1|0,(E|0)>=(m|0))break n;g=Bt+(E<<3)|0,d=p[g>>2]|0,g=p[g+4>>2]|0}}while(!1);if((m+5|0)>>>0<11){mt=85;break}if(Se=Fl((m|0)/6|0,8)|0,!Se){mt=49;break}n:do if(qe){he=0,te=0;do{if(P=St+(he<<3)|0,g=P,E=p[g>>2]|0,g=p[g+4>>2]|0,!((E|0)==0&(g|0)==0)){k=it(E|0,g|0,56)|0,ne()|0,k=k&7,d=k+1|0,U=g&-117440513,wt=it(E|0,g|0,45)|0,ne()|0;i:do if(Si(wt&127)|0){if(q=it(E|0,g|0,52)|0,ne()|0,q=q&15,q|0)for(C=1;;){if(wt=vt(7,0,(15-C|0)*3|0)|0,!((E&wt|0)==0&(U&(ne()|0)|0)==0))break i;if(C>>>0<q>>>0)C=C+1|0;else break}g=vt(d|0,0,56)|0,E=g|E,g=ne()|0|U,d=P,p[d>>2]=E,p[d+4>>2]=g,d=k+2|0}while(!1);(d|0)==7&&(wt=Se+(te<<3)|0,p[wt>>2]=E,p[wt+4>>2]=g&-117440513,te=te+1|0)}he=he+1|0}while((he|0)!=(m|0));if(qe){if(he=((m|0)<0)<<31>>31,pe=vt(De|0,0,52)|0,ae=ne()|0,De>>>0>15){if(!((Ue|0)==0&(b|0)==0)){b=4,mt=84;break t}for(b=0;;){if(b=b+1|0,(b|0)>=(m|0)){E=0,b=te;break n}if(wt=Bt+(b<<3)|0,!((p[wt>>2]|0)==0&(p[wt+4>>2]|0)==0)){b=4,mt=84;break t}}}for(q=0,E=0,U=Ue;;){do if(!((U|0)==0&(b|0)==0)){if(P=it(U|0,b|0,52)|0,ne()|0,P=P&15,(P|0)<(De|0)){b=12,mt=84;break t}do if((P|0)==(De|0))g=U,P=b;else{if(g=U|pe,d=b&-15728641|ae,P>>>0<Ie>>>0){P=d;break}C=De;do wt=vt(7,0,(14-C|0)*3|0)|0,C=C+1|0,g=wt|g,d=ne()|0|d;while(C>>>0<P>>>0);P=d}while(!1);for(C=pp(g|0,P|0,m|0,he|0)|0,ne()|0,d=0;;){if((d|0)>(m|0)){mt=77;break t}if(wt=St+(C<<3)|0,k=p[wt+4>>2]|0,(k&-117440513|0)==(P|0)&&(p[wt>>2]|0)==(g|0)){mt=79;break}if(C=(C+1|0)%(m|0)|0,wt=St+(C<<3)|0,(p[wt>>2]|0)==(g|0)&&(p[wt+4>>2]|0)==(P|0))break;d=d+1|0}if((mt|0)==79&&(mt=0,!0&(k&117440512|0)==100663296))break;wt=f+(E<<3)|0,p[wt>>2]=U,p[wt+4>>2]=b,E=E+1|0}while(!1);if(b=q+1|0,(b|0)>=(m|0)){b=te;break n}wt=Bt+(b<<3)|0,q=b,U=p[wt>>2]|0,b=p[wt+4>>2]|0}}else E=0,b=te}else E=0,b=0;while(!1);if(Tf(St|0,0,be|0)|0,cy(Bt|0,Se|0,b<<3|0)|0,ln(Se),b)f=f+(E<<3)|0,m=b;else break e}if((mt|0)==17)!0&(b&117440512|0)==0?(b=4,mt=28):mt=22;else if((mt|0)==32)_t(23313,22674,362,22684);else{if((mt|0)==42)return ln(Bt),ln(St),wt=10,wt|0;if((mt|0)==49)return ln(Bt),ln(St),wt=13,wt|0;if((mt|0)==77)_t(23313,22674,462,22684);else{if((mt|0)==84)return ln(Se),ln(Bt),ln(St),wt=b,wt|0;if((mt|0)==85){cy(f|0,Bt|0,m<<3|0)|0;break}}}if((mt|0)==22)return ln(Bt),ln(St),wt=5,wt|0;if((mt|0)==28)return ln(Bt),ln(St),wt=b,wt|0}while(!1);return ln(Bt),ln(St),wt=0,wt|0}function OQ(d,f,m,g,b,E,C){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0,E=E|0,C=C|0;var P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0;if(Se=Y,Y=Y+16|0,ae=Se,!((m|0)>0|(m|0)==0&f>>>0>0))return ae=0,Y=Se,ae|0;if((C|0)>=16)return ae=12,Y=Se,ae|0;he=0,pe=0,te=0,P=0;e:for(;;){if(U=d+(he<<3)|0,k=p[U>>2]|0,U=p[U+4>>2]|0,q=it(k|0,U|0,52)|0,ne()|0,(q&15|0)>(C|0)){P=12,k=11;break}if(z8(ae,k,U,C),q=ae,U=p[q>>2]|0,q=p[q+4>>2]|0,(U|0)==0&(q|0)==0)k=te;else{k=te;do{if(!((P|0)<(E|0)|(P|0)==(E|0)&k>>>0<b>>>0)){k=10;break e}te=g+(k<<3)|0,p[te>>2]=U,p[te+4>>2]=q,k=kn(k|0,P|0,1,0)|0,P=ne()|0,V8(ae),te=ae,U=p[te>>2]|0,q=p[te+4>>2]|0}while(!((U|0)==0&(q|0)==0))}if(he=kn(he|0,pe|0,1,0)|0,pe=ne()|0,(pe|0)<(m|0)|(pe|0)==(m|0)&he>>>0<f>>>0)te=k;else{P=0,k=11;break}}return(k|0)==10?(ae=14,Y=Se,ae|0):(k|0)==11?(Y=Se,P|0):0}function UQ(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0;he=Y,Y=Y+16|0,te=he;e:do if((m|0)>0|(m|0)==0&f>>>0>0){for(U=0,C=0,E=0,q=0;;){if(k=d+(U<<3)|0,P=p[k>>2]|0,k=p[k+4>>2]|0,!((P|0)==0&(k|0)==0)&&(k=(ay(P,k,g,te)|0)==0,P=te,C=kn(p[P>>2]|0,p[P+4>>2]|0,C|0,E|0)|0,E=ne()|0,!k)){E=12;break}if(U=kn(U|0,q|0,1,0)|0,q=ne()|0,!((q|0)<(m|0)|(q|0)==(m|0)&U>>>0<f>>>0))break e}return Y=he,E|0}else C=0,E=0;while(!1);return p[b>>2]=C,p[b+4>>2]=E,b=0,Y=he,b|0}function zQ(d,f){return d=d|0,f=f|0,f=it(d|0,f|0,52)|0,ne()|0,f&1|0}function Ao(d,f){d=d|0,f=f|0;var m=0,g=0,b=0;if(b=it(d|0,f|0,52)|0,ne()|0,b=b&15,!b)return b=0,b|0;for(g=1;;){if(m=it(d|0,f|0,(15-g|0)*3|0)|0,ne()|0,m=m&7,m|0){g=5;break}if(g>>>0<b>>>0)g=g+1|0;else{m=0,g=5;break}}return(g|0)==5?m|0:0}function rE(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0;if(k=it(d|0,f|0,52)|0,ne()|0,k=k&15,!k)return P=f,k=d,Ft(P|0),k|0;for(P=1,m=0;;){E=(15-P|0)*3|0,g=vt(7,0,E|0)|0,b=ne()|0,C=it(d|0,f|0,E|0)|0,ne()|0,E=vt(Sf(C&7)|0,0,E|0)|0,C=ne()|0,d=E|d&~g,f=C|f&~b;e:do if(!m)if((E&g|0)==0&(C&b|0)==0)m=0;else if(g=it(d|0,f|0,52)|0,ne()|0,g=g&15,!g)m=1;else{m=1;t:for(;;){switch(C=it(d|0,f|0,(15-m|0)*3|0)|0,ne()|0,C&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<g>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(C=(15-m|0)*3|0,b=it(d|0,f|0,C|0)|0,ne()|0,E=vt(7,0,C|0)|0,f=f&~(ne()|0),C=vt(Sf(b&7)|0,0,C|0)|0,d=d&~E|C,f=f|(ne()|0),m>>>0<g>>>0)m=m+1|0;else{m=1;break}}while(!1);if(P>>>0<k>>>0)P=P+1|0;else break}return Ft(f|0),d|0}function wf(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0;if(g=it(d|0,f|0,52)|0,ne()|0,g=g&15,!g)return m=f,g=d,Ft(m|0),g|0;for(m=1;E=(15-m|0)*3|0,C=it(d|0,f|0,E|0)|0,ne()|0,b=vt(7,0,E|0)|0,f=f&~(ne()|0),E=vt(Sf(C&7)|0,0,E|0)|0,d=E|d&~b,f=ne()|0|f,m>>>0<g>>>0;)m=m+1|0;return Ft(f|0),d|0}function VQ(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0;if(k=it(d|0,f|0,52)|0,ne()|0,k=k&15,!k)return P=f,k=d,Ft(P|0),k|0;for(P=1,m=0;;){E=(15-P|0)*3|0,g=vt(7,0,E|0)|0,b=ne()|0,C=it(d|0,f|0,E|0)|0,ne()|0,E=vt(Fc(C&7)|0,0,E|0)|0,C=ne()|0,d=E|d&~g,f=C|f&~b;e:do if(!m)if((E&g|0)==0&(C&b|0)==0)m=0;else if(g=it(d|0,f|0,52)|0,ne()|0,g=g&15,!g)m=1;else{m=1;t:for(;;){switch(C=it(d|0,f|0,(15-m|0)*3|0)|0,ne()|0,C&7){case 1:break t;case 0:break;default:{m=1;break e}}if(m>>>0<g>>>0)m=m+1|0;else{m=1;break e}}for(m=1;;)if(b=(15-m|0)*3|0,E=vt(7,0,b|0)|0,C=f&~(ne()|0),f=it(d|0,f|0,b|0)|0,ne()|0,f=vt(Fc(f&7)|0,0,b|0)|0,d=d&~E|f,f=C|(ne()|0),m>>>0<g>>>0)m=m+1|0;else{m=1;break}}while(!1);if(P>>>0<k>>>0)P=P+1|0;else break}return Ft(f|0),d|0}function sE(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0;if(g=it(d|0,f|0,52)|0,ne()|0,g=g&15,!g)return m=f,g=d,Ft(m|0),g|0;for(m=1;C=(15-m|0)*3|0,E=vt(7,0,C|0)|0,b=f&~(ne()|0),f=it(d|0,f|0,C|0)|0,ne()|0,f=vt(Fc(f&7)|0,0,C|0)|0,d=f|d&~E,f=ne()|0|b,m>>>0<g>>>0;)m=m+1|0;return Ft(f|0),d|0}function GQ(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(k=Y,Y=Y+64|0,P=k+40|0,g=k+24|0,b=k+12|0,E=k,vt(f|0,0,52)|0,m=ne()|0|134225919,!f)return(p[d+4>>2]|0)>2||(p[d+8>>2]|0)>2||(p[d+12>>2]|0)>2?(C=0,P=0,Ft(C|0),Y=k,P|0):(vt(I(d)|0,0,45)|0,C=ne()|0|m,P=-1,Ft(C|0),Y=k,P|0);if(p[P>>2]=p[d>>2],p[P+4>>2]=p[d+4>>2],p[P+8>>2]=p[d+8>>2],p[P+12>>2]=p[d+12>>2],C=P+4|0,(f|0)>0)for(d=-1;p[g>>2]=p[C>>2],p[g+4>>2]=p[C+4>>2],p[g+8>>2]=p[C+8>>2],f&1?(gQ(C),p[b>>2]=p[C>>2],p[b+4>>2]=p[C+4>>2],p[b+8>>2]=p[C+8>>2],ry(b)):(R8(C),p[b>>2]=p[C>>2],p[b+4>>2]=p[C+4>>2],p[b+8>>2]=p[C+8>>2],bf(b)),Zw(g,b,E),Ki(E),q=(15-f|0)*3|0,U=vt(7,0,q|0)|0,m=m&~(ne()|0),q=vt(iy(E)|0,0,q|0)|0,d=q|d&~U,m=ne()|0|m,(f|0)>1;)f=f+-1|0;else d=-1;e:do if((p[C>>2]|0)<=2&&(p[P+8>>2]|0)<=2&&(p[P+12>>2]|0)<=2){if(g=I(P)|0,f=vt(g|0,0,45)|0,f=f|d,d=ne()|0|m&-1040385,E=G(P)|0,!(Si(g)|0)){if((E|0)<=0)break;for(b=0;;){if(g=it(f|0,d|0,52)|0,ne()|0,g=g&15,g)for(m=1;q=(15-m|0)*3|0,P=it(f|0,d|0,q|0)|0,ne()|0,U=vt(7,0,q|0)|0,d=d&~(ne()|0),q=vt(Sf(P&7)|0,0,q|0)|0,f=f&~U|q,d=d|(ne()|0),m>>>0<g>>>0;)m=m+1|0;if(b=b+1|0,(b|0)==(E|0))break e}}b=it(f|0,d|0,52)|0,ne()|0,b=b&15;t:do if(b){m=1;n:for(;;){switch(q=it(f|0,d|0,(15-m|0)*3|0)|0,ne()|0,q&7){case 1:break n;case 0:break;default:break t}if(m>>>0<b>>>0)m=m+1|0;else break t}if(Ce(g,p[P>>2]|0)|0)for(m=1;P=(15-m|0)*3|0,U=vt(7,0,P|0)|0,q=d&~(ne()|0),d=it(f|0,d|0,P|0)|0,ne()|0,d=vt(Fc(d&7)|0,0,P|0)|0,f=f&~U|d,d=q|(ne()|0),m>>>0<b>>>0;)m=m+1|0;else for(m=1;q=(15-m|0)*3|0,P=it(f|0,d|0,q|0)|0,ne()|0,U=vt(7,0,q|0)|0,d=d&~(ne()|0),q=vt(Sf(P&7)|0,0,q|0)|0,f=f&~U|q,d=d|(ne()|0),m>>>0<b>>>0;)m=m+1|0}while(!1);if((E|0)>0){m=0;do f=rE(f,d)|0,d=ne()|0,m=m+1|0;while((m|0)!=(E|0))}}else f=0,d=0;while(!1);return U=d,q=f,Ft(U|0),Y=k,q|0}function ma(d){return d=d|0,(d|0)%2|0|0}function O8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0;return b=Y,Y=Y+16|0,g=b,f>>>0>15?(g=4,Y=b,g|0):(p[d+4>>2]&2146435072|0)==2146435072||(p[d+8+4>>2]&2146435072|0)==2146435072?(g=3,Y=b,g|0):(MQ(d,f,g),f=GQ(g,f)|0,g=ne()|0,p[m>>2]=f,p[m+4>>2]=g,(f|0)==0&(g|0)==0&&_t(23313,22674,786,22697),g=0,Y=b,g|0)}function oE(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0;if(b=m+4|0,E=it(d|0,f|0,52)|0,ne()|0,E=E&15,C=it(d|0,f|0,45)|0,ne()|0,g=(E|0)==0,Si(C&127)|0){if(g)return C=1,C|0;g=1}else{if(g)return C=0,C|0;!(p[b>>2]|0)&&!(p[m+8>>2]|0)?g=(p[m+12>>2]|0)!=0&1:g=1}for(m=1;m&1?ry(b):bf(b),C=it(d|0,f|0,(15-m|0)*3|0)|0,ne()|0,P8(b,C&7),m>>>0<E>>>0;)m=m+1|0;return g|0}function fp(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(q=Y,Y=Y+16|0,k=q,U=it(d|0,f|0,45)|0,ne()|0,U=U&127,U>>>0>121)return p[m>>2]=0,p[m+4>>2]=0,p[m+8>>2]=0,p[m+12>>2]=0,U=5,Y=q,U|0;e:do if(Si(U)|0&&(E=it(d|0,f|0,52)|0,ne()|0,E=E&15,(E|0)!=0)){g=1;t:for(;;){switch(P=it(d|0,f|0,(15-g|0)*3|0)|0,ne()|0,P&7){case 5:break t;case 0:break;default:{g=f;break e}}if(g>>>0<E>>>0)g=g+1|0;else{g=f;break e}}for(b=1,g=f;f=(15-b|0)*3|0,C=vt(7,0,f|0)|0,P=g&~(ne()|0),g=it(d|0,g|0,f|0)|0,ne()|0,g=vt(Fc(g&7)|0,0,f|0)|0,d=d&~C|g,g=P|(ne()|0),b>>>0<E>>>0;)b=b+1|0}else g=f;while(!1);if(P=7696+(U*28|0)|0,p[m>>2]=p[P>>2],p[m+4>>2]=p[P+4>>2],p[m+8>>2]=p[P+8>>2],p[m+12>>2]=p[P+12>>2],!(oE(d,g,m)|0))return U=0,Y=q,U|0;if(C=m+4|0,p[k>>2]=p[C>>2],p[k+4>>2]=p[C+4>>2],p[k+8>>2]=p[C+8>>2],E=it(d|0,g|0,52)|0,ne()|0,P=E&15,E&1?(bf(C),E=P+1|0):E=P,!(Si(U)|0))g=0;else{e:do if(!P)g=0;else for(f=1;;){if(b=it(d|0,g|0,(15-f|0)*3|0)|0,ne()|0,b=b&7,b|0){g=b;break e}if(f>>>0<P>>>0)f=f+1|0;else{g=0;break}}while(!1);g=(g|0)==4&1}if(!(hp(m,E,g,0)|0))(E|0)!=(P|0)&&(p[C>>2]=p[k>>2],p[C+4>>2]=p[k+4>>2],p[C+8>>2]=p[k+8>>2]);else{if(Si(U)|0)do;while(hp(m,E,0,0)|0);(E|0)!=(P|0)&&R8(C)}return U=0,Y=q,U|0}function ym(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;return E=Y,Y=Y+16|0,g=E,b=fp(d,f,g)|0,b|0?(Y=E,b|0):(b=it(d|0,f|0,52)|0,ne()|0,NQ(g,b&15,m),b=0,Y=E,b|0)}function _m(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0;if(C=Y,Y=Y+16|0,E=C,g=fp(d,f,E)|0,g|0)return E=g,Y=C,E|0;g=it(d|0,f|0,45)|0,ne()|0,g=(Si(g&127)|0)==0,b=it(d|0,f|0,52)|0,ne()|0,b=b&15;e:do if(!g){if(b|0)for(g=1;;){if(P=vt(7,0,(15-g|0)*3|0)|0,!((P&d|0)==0&((ne()|0)&f|0)==0))break e;if(g>>>0<b>>>0)g=g+1|0;else break}return eE(E,b,0,5,m),P=0,Y=C,P|0}while(!1);return tE(E,b,0,6,m),P=0,Y=C,P|0}function qQ(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;if(b=it(d|0,f|0,45)|0,ne()|0,!(Si(b&127)|0))return b=2,p[m>>2]=b,0;if(b=it(d|0,f|0,52)|0,ne()|0,b=b&15,!b)return b=5,p[m>>2]=b,0;for(g=1;;){if(E=vt(7,0,(15-g|0)*3|0)|0,!((E&d|0)==0&((ne()|0)&f|0)==0)){g=2,d=6;break}if(g>>>0<b>>>0)g=g+1|0;else{g=5,d=6;break}}return(d|0)==6&&(p[m>>2]=g),0}function U8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0;te=Y,Y=Y+128|0,U=te+112|0,E=te+96|0,q=te,b=it(d|0,f|0,52)|0,ne()|0,P=b&15,p[U>>2]=P,C=it(d|0,f|0,45)|0,ne()|0,C=C&127;e:do if(Si(C)|0){if(P|0)for(g=1;;){if(k=vt(7,0,(15-g|0)*3|0)|0,!((k&d|0)==0&((ne()|0)&f|0)==0)){b=0;break e}if(g>>>0<P>>>0)g=g+1|0;else break}if(b&1)b=1;else return k=vt(P+1|0,0,52)|0,q=ne()|0|f&-15728641,U=vt(7,0,(14-P|0)*3|0)|0,q=U8((k|d)&~U,q&~(ne()|0),m)|0,Y=te,q|0}else b=0;while(!1);if(g=fp(d,f,E)|0,!g){b?(L8(E,U,q),k=5):(F8(E,U,q),k=6);e:do if(Si(C)|0)if(!P)d=5;else for(g=1;;){if(C=vt(7,0,(15-g|0)*3|0)|0,!((C&d|0)==0&((ne()|0)&f|0)==0)){d=2;break e}if(g>>>0<P>>>0)g=g+1|0;else{d=5;break}}else d=2;while(!1);Tf(m|0,-1,d<<2|0)|0;e:do if(b)for(E=0;;){if(C=q+(E<<4)|0,IQ(C,p[U>>2]|0)|0,C=p[C>>2]|0,P=p[m>>2]|0,(P|0)==-1|(P|0)==(C|0))g=m;else{b=0;do{if(b=b+1|0,b>>>0>=d>>>0){g=1;break e}g=m+(b<<2)|0,P=p[g>>2]|0}while(!((P|0)==-1|(P|0)==(C|0)))}if(p[g>>2]=C,E=E+1|0,E>>>0>=k>>>0){g=0;break}}else for(E=0;;){if(C=q+(E<<4)|0,hp(C,p[U>>2]|0,0,1)|0,C=p[C>>2]|0,P=p[m>>2]|0,(P|0)==-1|(P|0)==(C|0))g=m;else{b=0;do{if(b=b+1|0,b>>>0>=d>>>0){g=1;break e}g=m+(b<<2)|0,P=p[g>>2]|0}while(!((P|0)==-1|(P|0)==(C|0)))}if(p[g>>2]=C,E=E+1|0,E>>>0>=k>>>0){g=0;break}}while(!1)}return q=g,Y=te,q|0}function HQ(){return 12}function aE(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0;if(d>>>0>15)return P=4,P|0;if(vt(d|0,0,52)|0,P=ne()|0|134225919,!d){m=0,g=0;do Si(g)|0&&(vt(g|0,0,45)|0,C=P|(ne()|0),d=f+(m<<3)|0,p[d>>2]=-1,p[d+4>>2]=C,m=m+1|0),g=g+1|0;while((g|0)!=122);return m=0,m|0}m=0,C=0;do{if(Si(C)|0){for(vt(C|0,0,45)|0,g=1,b=-1,E=P|(ne()|0);k=vt(7,0,(15-g|0)*3|0)|0,b=b&~k,E=E&~(ne()|0),(g|0)!=(d|0);)g=g+1|0;k=f+(m<<3)|0,p[k>>2]=b,p[k+4>>2]=E,m=m+1|0}C=C+1|0}while((C|0)!=122);return m=0,m|0}function $Q(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0;if(Ie=Y,Y=Y+16|0,qe=Ie,Ue=it(d|0,f|0,52)|0,ne()|0,Ue=Ue&15,m>>>0>15)return Ue=4,Y=Ie,Ue|0;if((Ue|0)<(m|0))return Ue=12,Y=Ie,Ue|0;if((Ue|0)!=(m|0))if(E=vt(m|0,0,52)|0,E=E|d,P=ne()|0|f&-15728641,(Ue|0)>(m|0)){k=m;do Se=vt(7,0,(14-k|0)*3|0)|0,k=k+1|0,E=Se|E,P=ne()|0|P;while((k|0)<(Ue|0));Se=E}else Se=E;else Se=d,P=f;ae=it(Se|0,P|0,45)|0,ne()|0;e:do if(Si(ae&127)|0){if(k=it(Se|0,P|0,52)|0,ne()|0,k=k&15,k|0)for(E=1;;){if(ae=vt(7,0,(15-E|0)*3|0)|0,!((ae&Se|0)==0&((ne()|0)&P|0)==0)){U=33;break e}if(E>>>0<k>>>0)E=E+1|0;else break}if(ae=g,p[ae>>2]=0,p[ae+4>>2]=0,(Ue|0)>(m|0)){for(ae=f&-15728641,pe=Ue;;){if(he=pe,pe=pe+-1|0,pe>>>0>15|(Ue|0)<(pe|0)){U=19;break}if((Ue|0)!=(pe|0))if(E=vt(pe|0,0,52)|0,E=E|d,k=ne()|0|ae,(Ue|0)<(he|0))te=E;else{U=pe;do te=vt(7,0,(14-U|0)*3|0)|0,U=U+1|0,E=te|E,k=ne()|0|k;while((U|0)<(Ue|0));te=E}else te=d,k=f;if(q=it(te|0,k|0,45)|0,ne()|0,!(Si(q&127)|0))E=0;else{q=it(te|0,k|0,52)|0,ne()|0,q=q&15;t:do if(!q)E=0;else for(U=1;;){if(E=it(te|0,k|0,(15-U|0)*3|0)|0,ne()|0,E=E&7,E|0)break t;if(U>>>0<q>>>0)U=U+1|0;else{E=0;break}}while(!1);E=(E|0)==0&1}if(k=it(d|0,f|0,(15-he|0)*3|0)|0,ne()|0,k=k&7,(k|0)==7){b=5,U=42;break}if(E=(E|0)!=0,(k|0)==1&E){b=5,U=42;break}if(te=k+(((k|0)!=0&E)<<31>>31)|0,te|0&&(U=Ue-he|0,U=Bc(7,0,U,((U|0)<0)<<31>>31)|0,q=ne()|0,E?(E=vs(U|0,q|0,5,0)|0,E=kn(E|0,ne()|0,-5,-1)|0,E=Ef(E|0,ne()|0,6,0)|0,E=kn(E|0,ne()|0,1,0)|0,k=ne()|0):(E=U,k=q),he=te+-1|0,he=vs(U|0,q|0,he|0,((he|0)<0)<<31>>31|0)|0,he=kn(E|0,k|0,he|0,ne()|0)|0,te=ne()|0,q=g,q=kn(he|0,te|0,p[q>>2]|0,p[q+4>>2]|0)|0,te=ne()|0,he=g,p[he>>2]=q,p[he+4>>2]=te),(pe|0)<=(m|0)){U=37;break}}if((U|0)==19)_t(23313,22674,1099,22710);else if((U|0)==37){C=g,b=p[C+4>>2]|0,C=p[C>>2]|0;break}else if((U|0)==42)return Y=Ie,b|0}else b=0,C=0}else U=33;while(!1);e:do if((U|0)==33)if(ae=g,p[ae>>2]=0,p[ae+4>>2]=0,(Ue|0)>(m|0)){for(E=Ue;;){if(b=it(d|0,f|0,(15-E|0)*3|0)|0,ne()|0,b=b&7,(b|0)==7){b=5;break}if(C=Ue-E|0,C=Bc(7,0,C,((C|0)<0)<<31>>31)|0,b=vs(C|0,ne()|0,b|0,0)|0,C=ne()|0,ae=g,C=kn(p[ae>>2]|0,p[ae+4>>2]|0,b|0,C|0)|0,b=ne()|0,ae=g,p[ae>>2]=C,p[ae+4>>2]=b,E=E+-1|0,(E|0)<=(m|0))break e}return Y=Ie,b|0}else b=0,C=0;while(!1);return ay(Se,P,Ue,qe)|0&&_t(23313,22674,1063,22725),Ue=qe,qe=p[Ue+4>>2]|0,((b|0)>-1|(b|0)==-1&C>>>0>4294967295)&((qe|0)>(b|0)|((qe|0)==(b|0)?(p[Ue>>2]|0)>>>0>C>>>0:0))?(Ue=0,Y=Ie,Ue|0):(_t(23313,22674,1139,22710),0)}function jQ(d,f,m,g,b,E){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0,E=E|0;var C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0;if(te=Y,Y=Y+16|0,C=te,b>>>0>15)return E=4,Y=te,E|0;if(P=it(m|0,g|0,52)|0,ne()|0,P=P&15,(P|0)>(b|0))return E=12,Y=te,E|0;if(ay(m,g,b,C)|0&&_t(23313,22674,1063,22725),q=C,U=p[q+4>>2]|0,!(((f|0)>-1|(f|0)==-1&d>>>0>4294967295)&((U|0)>(f|0)|((U|0)==(f|0)?(p[q>>2]|0)>>>0>d>>>0:0))))return E=2,Y=te,E|0;q=b-P|0,b=vt(b|0,0,52)|0,k=ne()|0|g&-15728641,U=E,p[U>>2]=b|m,p[U+4>>2]=k,U=it(m|0,g|0,45)|0,ne()|0;e:do if(Si(U&127)|0){if(P|0)for(C=1;;){if(U=vt(7,0,(15-C|0)*3|0)|0,!((U&m|0)==0&((ne()|0)&g|0)==0))break e;if(C>>>0<P>>>0)C=C+1|0;else break}if((q|0)<1)return E=0,Y=te,E|0;for(U=P^15,g=-1,k=1,C=1;;){P=q-k|0,P=Bc(7,0,P,((P|0)<0)<<31>>31)|0,m=ne()|0;do if(C)if(C=vs(P|0,m|0,5,0)|0,C=kn(C|0,ne()|0,-5,-1)|0,C=Ef(C|0,ne()|0,6,0)|0,b=ne()|0,(f|0)>(b|0)|(f|0)==(b|0)&d>>>0>C>>>0){f=kn(d|0,f|0,-1,-1)|0,f=gs(f|0,ne()|0,C|0,b|0)|0,C=ne()|0,he=E,ae=p[he>>2]|0,he=p[he+4>>2]|0,Se=(U+g|0)*3|0,pe=vt(7,0,Se|0)|0,he=he&~(ne()|0),g=Ef(f|0,C|0,P|0,m|0)|0,d=ne()|0,b=kn(g|0,d|0,2,0)|0,Se=vt(b|0,ne()|0,Se|0)|0,he=ne()|0|he,b=E,p[b>>2]=Se|ae&~pe,p[b+4>>2]=he,d=vs(g|0,d|0,P|0,m|0)|0,d=gs(f|0,C|0,d|0,ne()|0)|0,C=0,f=ne()|0;break}else{Se=E,pe=p[Se>>2]|0,Se=p[Se+4>>2]|0,ae=vt(7,0,(U+g|0)*3|0)|0,Se=Se&~(ne()|0),C=E,p[C>>2]=pe&~ae,p[C+4>>2]=Se,C=1;break}else pe=E,b=p[pe>>2]|0,pe=p[pe+4>>2]|0,g=(U+g|0)*3|0,he=vt(7,0,g|0)|0,pe=pe&~(ne()|0),Se=Ef(d|0,f|0,P|0,m|0)|0,C=ne()|0,g=vt(Se|0,C|0,g|0)|0,pe=ne()|0|pe,ae=E,p[ae>>2]=g|b&~he,p[ae+4>>2]=pe,C=vs(Se|0,C|0,P|0,m|0)|0,d=gs(d|0,f|0,C|0,ne()|0)|0,C=0,f=ne()|0;while(!1);if((q|0)>(k|0))g=~k,k=k+1|0;else{f=0;break}}return Y=te,f|0}while(!1);if((q|0)<1)return Se=0,Y=te,Se|0;for(b=P^15,C=1;;)if(ae=q-C|0,ae=Bc(7,0,ae,((ae|0)<0)<<31>>31)|0,Se=ne()|0,k=E,m=p[k>>2]|0,k=p[k+4>>2]|0,P=(b-C|0)*3|0,g=vt(7,0,P|0)|0,k=k&~(ne()|0),he=Ef(d|0,f|0,ae|0,Se|0)|0,pe=ne()|0,P=vt(he|0,pe|0,P|0)|0,k=ne()|0|k,U=E,p[U>>2]=P|m&~g,p[U+4>>2]=k,Se=vs(he|0,pe|0,ae|0,Se|0)|0,d=gs(d|0,f|0,Se|0,ne()|0)|0,f=ne()|0,(q|0)<=(C|0)){f=0;break}else C=C+1|0;return Y=te,f|0}function z8(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0;b=it(f|0,m|0,52)|0,ne()|0,b=b&15,(f|0)==0&(m|0)==0|((g|0)>15|(b|0)>(g|0))?(g=-1,b=-1,f=0,m=0):(E=LQ(f,m,b+1|0,g)|0,m=(ne()|0)&-15728641,f=vt(g|0,0,52)|0,f=E|f,m=m|(ne()|0),E=(Ni(f,m)|0)==0,g=E?-1:g),E=d,p[E>>2]=f,p[E+4>>2]=m,p[d+8>>2]=b,p[d+12>>2]=g}function V8(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0;if(m=d,f=p[m>>2]|0,m=p[m+4>>2]|0,!((f|0)==0&(m|0)==0)&&(g=it(f|0,m|0,52)|0,ne()|0,g=g&15,P=vt(1,0,(g^15)*3|0)|0,f=kn(P|0,ne()|0,f|0,m|0)|0,m=ne()|0,P=d,p[P>>2]=f,p[P+4>>2]=m,P=d+8|0,C=p[P>>2]|0,!((g|0)<(C|0)))){for(k=d+12|0,E=g;;){if((E|0)==(C|0)){g=5;break}if(U=(E|0)==(p[k>>2]|0),b=(15-E|0)*3|0,g=it(f|0,m|0,b|0)|0,ne()|0,g=g&7,U&((g|0)==1&!0)){g=7;break}if(!((g|0)==7&!0)){g=10;break}if(U=vt(1,0,b|0)|0,f=kn(f|0,m|0,U|0,ne()|0)|0,m=ne()|0,U=d,p[U>>2]=f,p[U+4>>2]=m,(E|0)>(C|0))E=E+-1|0;else{g=10;break}}if((g|0)==5){U=d,p[U>>2]=0,p[U+4>>2]=0,p[P>>2]=-1,p[k>>2]=-1;return}else if((g|0)==7){C=vt(1,0,b|0)|0,C=kn(f|0,m|0,C|0,ne()|0)|0,P=ne()|0,U=d,p[U>>2]=C,p[U+4>>2]=P,p[k>>2]=E+-1;return}else if((g|0)==10)return}}function xm(d){d=+d;var f=0;return f=d<0?d+6.283185307179586:d,+(d>=6.283185307179586?f+-6.283185307179586:f)}function dp(d,f){return d=d|0,f=f|0,+An(+(+J[d>>3]-+J[f>>3]))<17453292519943298e-27?(f=+An(+(+J[d+8>>3]-+J[f+8>>3]))<17453292519943298e-27,f|0):(f=0,f|0)}function WQ(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0;return b=+J[f>>3],g=+J[d>>3],E=+xe(+((b-g)*.5)),m=+xe(+((+J[f+8>>3]-+J[d+8>>3])*.5)),m=E*E+m*(+Ee(+b)*+Ee(+g)*m),+(+Rt(+ +X(+m),+ +X(+(1-m)))*2)}function bm(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0;return b=+J[f>>3],g=+J[d>>3],E=+xe(+((b-g)*.5)),m=+xe(+((+J[f+8>>3]-+J[d+8>>3])*.5)),m=E*E+m*(+Ee(+b)*+Ee(+g)*m),+(+Rt(+ +X(+m),+ +X(+(1-m)))*2*6371.007180918475)}function XQ(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0;return b=+J[f>>3],g=+J[d>>3],E=+xe(+((b-g)*.5)),m=+xe(+((+J[f+8>>3]-+J[d+8>>3])*.5)),m=E*E+m*(+Ee(+b)*+Ee(+g)*m),+(+Rt(+ +X(+m),+ +X(+(1-m)))*2*6371.007180918475*1e3)}function YQ(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0;return E=+J[f>>3],g=+Ee(+E),b=+J[f+8>>3]-+J[d+8>>3],C=g*+xe(+b),m=+J[d>>3],+ +Rt(+C,+(+xe(+E)*+Ee(+m)-+Ee(+b)*(g*+xe(+m))))}function QQ(d,f,m,g){d=d|0,f=+f,m=+m,g=g|0;var b=0,E=0,C=0,P=0;if(m<1e-16){p[g>>2]=p[d>>2],p[g+4>>2]=p[d+4>>2],p[g+8>>2]=p[d+8>>2],p[g+12>>2]=p[d+12>>2];return}E=f<0?f+6.283185307179586:f,E=f>=6.283185307179586?E+-6.283185307179586:E;do if(E<1e-16)f=+J[d>>3]+m,J[g>>3]=f,b=g;else{if(b=+An(+(E+-3.141592653589793))<1e-16,f=+J[d>>3],b){f=f-m,J[g>>3]=f,b=g;break}if(C=+Ee(+m),m=+xe(+m),f=C*+xe(+f)+ +Ee(+E)*(m*+Ee(+f)),f=f>1?1:f,f=+Mt(+(f<-1?-1:f)),J[g>>3]=f,+An(+(f+-1.5707963267948966))<1e-16){J[g>>3]=1.5707963267948966,J[g+8>>3]=0;return}if(+An(+(f+1.5707963267948966))<1e-16){J[g>>3]=-1.5707963267948966,J[g+8>>3]=0;return}if(P=+Ee(+f),E=m*+xe(+E)/P,m=+J[d>>3],f=(C-+xe(+f)*+xe(+m))/+Ee(+m)/P,C=E>1?1:E,f=f>1?1:f,f=+J[d+8>>3]+ +Rt(+(C<-1?-1:C),+(f<-1?-1:f)),f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);J[g+8>>3]=f;return}while(!1);if(+An(+(f+-1.5707963267948966))<1e-16){J[b>>3]=1.5707963267948966,J[g+8>>3]=0;return}if(+An(+(f+1.5707963267948966))<1e-16){J[b>>3]=-1.5707963267948966,J[g+8>>3]=0;return}if(f=+J[d+8>>3],f>3.141592653589793)do f=f+-6.283185307179586;while(f>3.141592653589793);if(f<-3.141592653589793)do f=f+6.283185307179586;while(f<-3.141592653589793);J[g+8>>3]=f}function KQ(d,f){return d=d|0,f=f|0,d>>>0>15?(f=4,f|0):(J[f>>3]=+J[20528+(d<<3)>>3],f=0,f|0)}function ZQ(d,f){return d=d|0,f=f|0,d>>>0>15?(f=4,f|0):(J[f>>3]=+J[20656+(d<<3)>>3],f=0,f|0)}function JQ(d,f){return d=d|0,f=f|0,d>>>0>15?(f=4,f|0):(J[f>>3]=+J[20784+(d<<3)>>3],f=0,f|0)}function eK(d,f){return d=d|0,f=f|0,d>>>0>15?(f=4,f|0):(J[f>>3]=+J[20912+(d<<3)>>3],f=0,f|0)}function lE(d,f){d=d|0,f=f|0;var m=0;return d>>>0>15?(f=4,f|0):(m=Bc(7,0,d,((d|0)<0)<<31>>31)|0,m=vs(m|0,ne()|0,120,0)|0,d=ne()|0,p[f>>2]=m|2,p[f+4>>2]=d,f=0,f|0)}function G8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0;return he=+J[f>>3],q=+J[d>>3],k=+xe(+((he-q)*.5)),E=+J[f+8>>3],U=+J[d+8>>3],C=+xe(+((E-U)*.5)),P=+Ee(+q),te=+Ee(+he),C=k*k+C*(te*P*C),C=+Rt(+ +X(+C),+ +X(+(1-C)))*2,k=+J[m>>3],he=+xe(+((k-he)*.5)),g=+J[m+8>>3],E=+xe(+((g-E)*.5)),b=+Ee(+k),E=he*he+E*(te*b*E),E=+Rt(+ +X(+E),+ +X(+(1-E)))*2,k=+xe(+((q-k)*.5)),g=+xe(+((U-g)*.5)),g=k*k+g*(P*b*g),g=+Rt(+ +X(+g),+ +X(+(1-g)))*2,b=(C+E+g)*.5,+(+Vt(+ +X(+(+ge(+(b*.5))*+ge(+((b-C)*.5))*+ge(+((b-E)*.5))*+ge(+((b-g)*.5)))))*4)}function uE(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0;if(P=Y,Y=Y+192|0,E=P+168|0,C=P,b=ym(d,f,E)|0,b|0)return m=b,Y=P,m|0;if(_m(d,f,C)|0&&_t(23313,22742,386,22751),f=p[C>>2]|0,(f|0)>0){if(g=+G8(C+8|0,C+8+(((f|0)!=1&1)<<4)|0,E)+0,(f|0)!=1){d=1;do b=d,d=d+1|0,g=g+ +G8(C+8+(b<<4)|0,C+8+(((d|0)%(f|0)|0)<<4)|0,E);while((d|0)<(f|0))}}else g=0;return J[m>>3]=g,m=0,Y=P,m|0}function tK(d,f,m){return d=d|0,f=f|0,m=m|0,d=uE(d,f,m)|0,d|0||(J[m>>3]=+J[m>>3]*6371.007180918475*6371.007180918475),d|0}function nK(d,f,m){return d=d|0,f=f|0,m=m|0,d=uE(d,f,m)|0,d|0||(J[m>>3]=+J[m>>3]*6371.007180918475*6371.007180918475*1e3*1e3),d|0}function iK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(P=Y,Y=Y+176|0,C=P,d=oy(d,f,C)|0,d|0)return C=d,Y=P,C|0;if(J[m>>3]=0,d=p[C>>2]|0,(d|0)<=1)return C=0,Y=P,C|0;f=d+-1|0,d=0,g=+J[C+8>>3],b=+J[C+16>>3],E=0;do d=d+1|0,U=g,g=+J[C+8+(d<<4)>>3],q=+xe(+((g-U)*.5)),k=b,b=+J[C+8+(d<<4)+8>>3],k=+xe(+((b-k)*.5)),k=q*q+k*(+Ee(+g)*+Ee(+U)*k),E=E+ +Rt(+ +X(+k),+ +X(+(1-k)))*2;while((d|0)<(f|0));return J[m>>3]=E,C=0,Y=P,C|0}function rK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(P=Y,Y=Y+176|0,C=P,d=oy(d,f,C)|0,d|0)return C=d,E=+J[m>>3],E=E*6371.007180918475,J[m>>3]=E,Y=P,C|0;if(J[m>>3]=0,d=p[C>>2]|0,(d|0)<=1)return C=0,E=0,E=E*6371.007180918475,J[m>>3]=E,Y=P,C|0;f=d+-1|0,d=0,g=+J[C+8>>3],b=+J[C+16>>3],E=0;do d=d+1|0,U=g,g=+J[C+8+(d<<4)>>3],q=+xe(+((g-U)*.5)),k=b,b=+J[C+8+(d<<4)+8>>3],k=+xe(+((b-k)*.5)),k=q*q+k*(+Ee(+U)*+Ee(+g)*k),E=E+ +Rt(+ +X(+k),+ +X(+(1-k)))*2;while((d|0)!=(f|0));return J[m>>3]=E,C=0,q=E,q=q*6371.007180918475,J[m>>3]=q,Y=P,C|0}function sK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(P=Y,Y=Y+176|0,C=P,d=oy(d,f,C)|0,d|0)return C=d,E=+J[m>>3],E=E*6371.007180918475,E=E*1e3,J[m>>3]=E,Y=P,C|0;if(J[m>>3]=0,d=p[C>>2]|0,(d|0)<=1)return C=0,E=0,E=E*6371.007180918475,E=E*1e3,J[m>>3]=E,Y=P,C|0;f=d+-1|0,d=0,g=+J[C+8>>3],b=+J[C+16>>3],E=0;do d=d+1|0,U=g,g=+J[C+8+(d<<4)>>3],q=+xe(+((g-U)*.5)),k=b,b=+J[C+8+(d<<4)+8>>3],k=+xe(+((b-k)*.5)),k=q*q+k*(+Ee(+U)*+Ee(+g)*k),E=E+ +Rt(+ +X(+k),+ +X(+(1-k)))*2;while((d|0)!=(f|0));return J[m>>3]=E,C=0,q=E,q=q*6371.007180918475,q=q*1e3,J[m>>3]=q,Y=P,C|0}function oK(d){d=d|0;var f=0,m=0,g=0;return f=Fl(1,12)|0,f||_t(22832,22787,49,22845),m=d+4|0,g=p[m>>2]|0,g|0?(g=g+8|0,p[g>>2]=f,p[m>>2]=f,f|0):(p[d>>2]|0&&_t(22862,22787,61,22885),g=d,p[g>>2]=f,p[m>>2]=f,f|0)}function aK(d,f){d=d|0,f=f|0;var m=0,g=0;return g=Ll(24)|0,g||_t(22899,22787,78,22913),p[g>>2]=p[f>>2],p[g+4>>2]=p[f+4>>2],p[g+8>>2]=p[f+8>>2],p[g+12>>2]=p[f+12>>2],p[g+16>>2]=0,f=d+4|0,m=p[f>>2]|0,m|0?(p[m+16>>2]=g,p[f>>2]=g,g|0):(p[d>>2]|0&&_t(22928,22787,82,22913),p[d>>2]=g,p[f>>2]=g,g|0)}function q8(d){d=d|0;var f=0,m=0,g=0,b=0;if(d)for(g=1;;){if(f=p[d>>2]|0,f|0)do{if(m=p[f>>2]|0,m|0)do b=m,m=p[m+16>>2]|0,ln(b);while(m|0);b=f,f=p[f+8>>2]|0,ln(b)}while(f|0);if(f=d,d=p[d+8>>2]|0,g||ln(f),d)g=0;else break}}function lK(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0,li=0,Wn=0,Kn=0,xn=0,gn=0,bn=0,vi=0,un=0;if(b=d+8|0,p[b>>2]|0)return un=1,un|0;if(g=p[d>>2]|0,!g)return un=0,un|0;f=g,m=0;do m=m+1|0,f=p[f+8>>2]|0;while(f|0);if(m>>>0<2)return un=0,un|0;bn=Ll(m<<2)|0,bn||_t(22948,22787,317,22967),gn=Ll(m<<5)|0,gn||_t(22989,22787,321,22967),p[d>>2]=0,Bt=d+4|0,p[Bt>>2]=0,p[b>>2]=0,m=0,xn=0,St=0,te=0;e:for(;;){if(q=p[g>>2]|0,q){E=0,C=q;do{if(k=+J[C+8>>3],f=C,C=p[C+16>>2]|0,U=(C|0)==0,b=U?q:C,P=+J[b+8>>3],+An(+(k-P))>3.141592653589793){un=14;break}E=E+(P-k)*(+J[f>>3]+ +J[b>>3])}while(!U);if((un|0)==14){un=0,E=0,f=q;do be=+J[f+8>>3],Kn=f+16|0,Wn=p[Kn>>2]|0,Wn=Wn|0?Wn:q,De=+J[Wn+8>>3],E=E+(+J[f>>3]+ +J[Wn>>3])*((De<0?De+6.283185307179586:De)-(be<0?be+6.283185307179586:be)),f=p[(f|0?Kn:g)>>2]|0;while(f|0)}E>0?(p[bn+(xn<<2)>>2]=g,xn=xn+1|0,b=St,f=te):un=19}else un=19;if((un|0)==19){un=0;do if(m){if(f=m+8|0,p[f>>2]|0){un=21;break e}if(m=Fl(1,12)|0,!m){un=23;break e}p[f>>2]=m,b=m+4|0,C=m,f=te}else if(te){b=Bt,C=te+8|0,f=g,m=d;break}else if(p[d>>2]|0){un=27;break e}else{b=Bt,C=d,f=g,m=d;break}while(!1);if(p[C>>2]=g,p[b>>2]=g,C=gn+(St<<5)|0,U=p[g>>2]|0,U){for(q=gn+(St<<5)+8|0,J[q>>3]=17976931348623157e292,te=gn+(St<<5)+24|0,J[te>>3]=17976931348623157e292,J[C>>3]=-17976931348623157e292,he=gn+(St<<5)+16|0,J[he>>3]=-17976931348623157e292,Ue=17976931348623157e292,Ie=-17976931348623157e292,b=0,pe=U,k=17976931348623157e292,Se=17976931348623157e292,qe=-17976931348623157e292,P=-17976931348623157e292;E=+J[pe>>3],be=+J[pe+8>>3],pe=p[pe+16>>2]|0,ae=(pe|0)==0,De=+J[(ae?U:pe)+8>>3],E<k&&(J[q>>3]=E,k=E),be<Se&&(J[te>>3]=be,Se=be),E>qe?J[C>>3]=E:E=qe,be>P&&(J[he>>3]=be,P=be),Ue=be>0&be<Ue?be:Ue,Ie=be<0&be>Ie?be:Ie,b=b|+An(+(be-De))>3.141592653589793,!ae;)qe=E;b&&(J[he>>3]=Ie,J[te>>3]=Ue)}else p[C>>2]=0,p[C+4>>2]=0,p[C+8>>2]=0,p[C+12>>2]=0,p[C+16>>2]=0,p[C+20>>2]=0,p[C+24>>2]=0,p[C+28>>2]=0;b=St+1|0}if(Kn=g+8|0,g=p[Kn>>2]|0,p[Kn>>2]=0,g)St=b,te=f;else{un=45;break}}if((un|0)==21)_t(22765,22787,35,22799);else if((un|0)==23)_t(22819,22787,37,22799);else if((un|0)==27)_t(22862,22787,61,22885);else if((un|0)==45){e:do if((xn|0)>0){for(Kn=(b|0)==0,li=b<<2,Wn=(d|0)==0,wt=0,f=0;;){if(mt=p[bn+(wt<<2)>>2]|0,Kn)un=73;else{if(St=Ll(li)|0,!St){un=50;break}if(Bt=Ll(li)|0,!Bt){un=52;break}t:do if(Wn)m=0;else{for(b=0,m=0,C=d;g=gn+(b<<5)|0,H8(p[C>>2]|0,g,p[mt>>2]|0)|0?(p[St+(m<<2)>>2]=C,p[Bt+(m<<2)>>2]=g,ae=m+1|0):ae=m,C=p[C+8>>2]|0,C;)b=b+1|0,m=ae;if((ae|0)>0)if(g=p[St>>2]|0,(ae|0)==1)m=g;else for(he=0,pe=-1,m=g,te=g;;){for(U=p[te>>2]|0,g=0,C=0;b=p[p[St+(C<<2)>>2]>>2]|0,(b|0)==(U|0)?q=g:q=g+((H8(b,p[Bt+(C<<2)>>2]|0,p[U>>2]|0)|0)&1)|0,C=C+1|0,(C|0)!=(ae|0);)g=q;if(b=(q|0)>(pe|0),m=b?te:m,g=he+1|0,(g|0)==(ae|0))break t;he=g,pe=b?q:pe,te=p[St+(g<<2)>>2]|0}else m=0}while(!1);if(ln(St),ln(Bt),m){if(b=m+4|0,g=p[b>>2]|0,g)m=g+8|0;else if(p[m>>2]|0){un=70;break}p[m>>2]=mt,p[b>>2]=mt}else un=73}if((un|0)==73){if(un=0,f=p[mt>>2]|0,f|0)do Bt=f,f=p[f+16>>2]|0,ln(Bt);while(f|0);ln(mt),f=1}if(wt=wt+1|0,(wt|0)>=(xn|0)){vi=f;break e}}(un|0)==50?_t(23004,22787,249,23023):(un|0)==52?_t(23042,22787,252,23023):(un|0)==70&&_t(22862,22787,61,22885)}else vi=0;while(!1);return ln(bn),ln(gn),un=vi,un|0}return 0}function H8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0;if(!(cr(f,m)|0)||(f=nn(f)|0,g=+J[m>>3],b=+J[m+8>>3],b=f&b<0?b+6.283185307179586:b,d=p[d>>2]|0,!d))return d=0,d|0;if(f){f=0,U=b,m=d;e:for(;;){for(;C=+J[m>>3],b=+J[m+8>>3],m=m+16|0,q=p[m>>2]|0,q=q|0?q:d,E=+J[q>>3],P=+J[q+8>>3],C>E?(k=C,C=P):(k=E,E=C,C=b,b=P),g=g==E|g==k?g+2220446049250313e-31:g,!!(g<E|g>k);)if(m=p[m>>2]|0,!m){m=22;break e}if(P=C<0?C+6.283185307179586:C,C=b<0?b+6.283185307179586:b,U=P==U|C==U?U+-2220446049250313e-31:U,k=P+(C-P)*((g-E)/(k-E)),(k<0?k+6.283185307179586:k)>U&&(f=f^1),m=p[m>>2]|0,!m){m=22;break}}if((m|0)==22)return f|0}else{f=0,U=b,m=d;e:for(;;){for(;C=+J[m>>3],b=+J[m+8>>3],m=m+16|0,q=p[m>>2]|0,q=q|0?q:d,E=+J[q>>3],P=+J[q+8>>3],C>E?(k=C,C=P):(k=E,E=C,C=b,b=P),g=g==E|g==k?g+2220446049250313e-31:g,!!(g<E|g>k);)if(m=p[m>>2]|0,!m){m=22;break e}if(U=C==U|b==U?U+-2220446049250313e-31:U,C+(b-C)*((g-E)/(k-E))>U&&(f=f^1),m=p[m>>2]|0,!m){m=22;break}}if((m|0)==22)return f|0}return 0}function mu(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0;if(Ie=Y,Y=Y+32|0,Ue=Ie+16|0,qe=Ie,E=it(d|0,f|0,52)|0,ne()|0,E=E&15,pe=it(m|0,g|0,52)|0,ne()|0,(E|0)!=(pe&15|0))return Ue=12,Y=Ie,Ue|0;if(U=it(d|0,f|0,45)|0,ne()|0,U=U&127,q=it(m|0,g|0,45)|0,ne()|0,q=q&127,U>>>0>121|q>>>0>121)return Ue=5,Y=Ie,Ue|0;if(pe=(U|0)!=(q|0),pe){if(P=At(U,q)|0,(P|0)==7)return Ue=1,Y=Ie,Ue|0;k=At(q,U)|0,(k|0)==7?_t(23066,23090,161,23100):(ae=P,C=k)}else ae=0,C=0;te=Si(U)|0,he=Si(q)|0,p[Ue>>2]=0,p[Ue+4>>2]=0,p[Ue+8>>2]=0,p[Ue+12>>2]=0;do if(ae){if(q=p[4272+(U*28|0)+(ae<<2)>>2]|0,P=(q|0)>0,he)if(P){U=0,k=m,P=g;do k=VQ(k,P)|0,P=ne()|0,C=Fc(C)|0,(C|0)==1&&(C=Fc(1)|0),U=U+1|0;while((U|0)!=(q|0));q=C,U=k,k=P}else q=C,U=m,k=g;else if(P){U=0,k=m,P=g;do k=sE(k,P)|0,P=ne()|0,C=Fc(C)|0,U=U+1|0;while((U|0)!=(q|0));q=C,U=k,k=P}else q=C,U=m,k=g;if(oE(U,k,Ue)|0,pe||_t(23115,23090,191,23100),P=(te|0)!=0,C=(he|0)!=0,P&C&&_t(23142,23090,192,23100),P){if(C=Ao(d,f)|0,(C|0)==7){E=5;break}if(jt[21872+(C*7|0)+ae>>0]|0){E=1;break}k=p[21040+(C*28|0)+(ae<<2)>>2]|0,U=k}else if(C){if(C=Ao(U,k)|0,(C|0)==7){E=5;break}if(jt[21872+(C*7|0)+q>>0]|0){E=1;break}U=0,k=p[21040+(q*28|0)+(C<<2)>>2]|0}else U=0,k=0;if((U|k|0)<0)E=5;else{if((k|0)>0){P=Ue+4|0,C=0;do sy(P),C=C+1|0;while((C|0)!=(k|0))}if(p[qe>>2]=0,p[qe+4>>2]=0,p[qe+8>>2]=0,P8(qe,ae),E|0)for(;ma(E)|0?ry(qe):bf(qe),(E|0)>1;)E=E+-1|0;if((U|0)>0){E=0;do sy(qe),E=E+1|0;while((E|0)!=(U|0))}Se=Ue+4|0,Us(Se,qe,Se),Ki(Se),Se=51}}else if(oE(m,g,Ue)|0,(te|0)!=0&(he|0)!=0)if((q|0)!=(U|0)&&_t(23173,23090,261,23100),C=Ao(d,f)|0,E=Ao(m,g)|0,(C|0)==7|(E|0)==7)E=5;else if(jt[21872+(C*7|0)+E>>0]|0)E=1;else if(C=p[21040+(C*28|0)+(E<<2)>>2]|0,(C|0)>0){P=Ue+4|0,E=0;do sy(P),E=E+1|0;while((E|0)!=(C|0));Se=51}else Se=51;else Se=51;while(!1);return(Se|0)==51&&(E=Ue+4|0,p[b>>2]=p[E>>2],p[b+4>>2]=p[E+4>>2],p[b+8>>2]=p[E+8>>2],E=0),Ue=E,Y=Ie,Ue|0}function $8(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0;if(Se=Y,Y=Y+48|0,U=Se+36|0,C=Se+24|0,P=Se+12|0,k=Se,b=it(d|0,f|0,52)|0,ne()|0,b=b&15,he=it(d|0,f|0,45)|0,ne()|0,he=he&127,he>>>0>121)return g=5,Y=Se,g|0;if(q=Si(he)|0,vt(b|0,0,52)|0,qe=ne()|0|134225919,E=g,p[E>>2]=-1,p[E+4>>2]=qe,!b)return b=iy(m)|0,(b|0)==7||(b=Le(he,b)|0,(b|0)==127)?(qe=1,Y=Se,qe|0):(pe=vt(b|0,0,45)|0,ae=ne()|0,he=g,ae=p[he+4>>2]&-1040385|ae,qe=g,p[qe>>2]=p[he>>2]|pe,p[qe+4>>2]=ae,qe=0,Y=Se,qe|0);for(p[U>>2]=p[m>>2],p[U+4>>2]=p[m+4>>2],p[U+8>>2]=p[m+8>>2],m=b;;){if(E=m,m=m+-1|0,p[C>>2]=p[U>>2],p[C+4>>2]=p[U+4>>2],p[C+8>>2]=p[U+8>>2],ma(E)|0){if(b=AQ(U)|0,b|0){m=13;break}p[P>>2]=p[U>>2],p[P+4>>2]=p[U+4>>2],p[P+8>>2]=p[U+8>>2],ry(P)}else{if(b=mQ(U)|0,b|0){m=13;break}p[P>>2]=p[U>>2],p[P+4>>2]=p[U+4>>2],p[P+8>>2]=p[U+8>>2],bf(P)}if(Zw(C,P,k),Ki(k),b=g,Ie=p[b>>2]|0,b=p[b+4>>2]|0,De=(15-E|0)*3|0,Ue=vt(7,0,De|0)|0,b=b&~(ne()|0),De=vt(iy(k)|0,0,De|0)|0,b=ne()|0|b,qe=g,p[qe>>2]=De|Ie&~Ue,p[qe+4>>2]=b,(E|0)<=1){m=14;break}}e:do if((m|0)!=13&&(m|0)==14)if((p[U>>2]|0)<=1&&(p[U+4>>2]|0)<=1&&(p[U+8>>2]|0)<=1){m=iy(U)|0,b=Le(he,m)|0,(b|0)==127?k=0:k=Si(b)|0;t:do if(m){if(q){if(b=Ao(d,f)|0,(b|0)==7){b=5;break e}if(E=p[21248+(b*28|0)+(m<<2)>>2]|0,(E|0)>0){b=m,m=0;do b=Sf(b)|0,m=m+1|0;while((m|0)!=(E|0))}else b=m;if((b|0)==1){b=9;break e}m=Le(he,b)|0,(m|0)==127&&_t(23200,23090,411,23230),Si(m)|0?_t(23245,23090,412,23230):(ae=m,pe=E,te=b)}else ae=b,pe=0,te=m;if(P=p[4272+(he*28|0)+(te<<2)>>2]|0,(P|0)<=-1&&_t(23276,23090,419,23230),!k){if((pe|0)<0){b=5;break e}if(pe|0){E=g,b=0,m=p[E>>2]|0,E=p[E+4>>2]|0;do m=wf(m,E)|0,E=ne()|0,De=g,p[De>>2]=m,p[De+4>>2]=E,b=b+1|0;while((b|0)<(pe|0))}if((P|0)<=0){b=ae,m=58;break}for(E=g,b=0,m=p[E>>2]|0,E=p[E+4>>2]|0;;)if(m=wf(m,E)|0,E=ne()|0,De=g,p[De>>2]=m,p[De+4>>2]=E,b=b+1|0,(b|0)==(P|0)){b=ae,m=58;break t}}if(C=At(ae,he)|0,(C|0)==7&&_t(23066,23090,428,23230),b=g,m=p[b>>2]|0,b=p[b+4>>2]|0,(P|0)>0){E=0;do m=wf(m,b)|0,b=ne()|0,De=g,p[De>>2]=m,p[De+4>>2]=b,E=E+1|0;while((E|0)!=(P|0))}if(b=Ao(m,b)|0,(b|0)==7&&_t(23313,23090,440,23230),m=y(ae)|0,m=p[(m?21664:21456)+(C*28|0)+(b<<2)>>2]|0,(m|0)<0&&_t(23313,23090,454,23230),!m)b=ae,m=58;else{C=g,b=0,E=p[C>>2]|0,C=p[C+4>>2]|0;do E=rE(E,C)|0,C=ne()|0,De=g,p[De>>2]=E,p[De+4>>2]=C,b=b+1|0;while((b|0)<(m|0));b=ae,m=58}}else if((q|0)!=0&(k|0)!=0){if(m=Ao(d,f)|0,E=g,E=Ao(p[E>>2]|0,p[E+4>>2]|0)|0,(m|0)==7|(E|0)==7){b=5;break e}if(E=p[21248+(m*28|0)+(E<<2)>>2]|0,(E|0)<0){b=5;break e}if(!E)m=59;else{P=g,m=0,C=p[P>>2]|0,P=p[P+4>>2]|0;do C=wf(C,P)|0,P=ne()|0,De=g,p[De>>2]=C,p[De+4>>2]=P,m=m+1|0;while((m|0)<(E|0));m=58}}else m=58;while(!1);if((m|0)==58&&k&&(m=59),(m|0)==59&&(De=g,(Ao(p[De>>2]|0,p[De+4>>2]|0)|0)==1)){b=9;break}De=g,Ue=p[De>>2]|0,De=p[De+4>>2]&-1040385,Ie=vt(b|0,0,45)|0,De=De|(ne()|0),b=g,p[b>>2]=Ue|Ie,p[b+4>>2]=De,b=0}else b=1;while(!1);return De=b,Y=Se,De|0}function uK(d,f,m,g,b,E){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0,E=E|0;var C=0,P=0;return P=Y,Y=Y+16|0,C=P,b?d=15:(d=mu(d,f,m,g,C)|0,d||(vQ(C,E),d=0)),Y=P,d|0}function cK(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0;return C=Y,Y=Y+16|0,E=C,g?m=15:(m=yQ(m,E)|0,m||(m=$8(d,f,E,b)|0)),Y=C,m|0}function hK(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0;return k=Y,Y=Y+32|0,C=k+12|0,P=k,E=mu(d,f,d,f,C)|0,E|0?(P=E,Y=k,P|0):(d=mu(d,f,m,g,P)|0,d|0?(P=d,Y=k,P|0):(C=Jw(C,P)|0,P=b,p[P>>2]=C,p[P+4>>2]=((C|0)<0)<<31>>31,P=0,Y=k,P|0))}function fK(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0;return k=Y,Y=Y+32|0,C=k+12|0,P=k,E=mu(d,f,d,f,C)|0,!E&&(E=mu(d,f,m,g,P)|0,!E)?(g=Jw(C,P)|0,g=kn(g|0,((g|0)<0)<<31>>31|0,1,0)|0,C=ne()|0,P=b,p[P>>2]=g,p[P+4>>2]=C,P=0,Y=k,P|0):(P=E,Y=k,P|0)}function dK(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0,wt=0;if(mt=Y,Y=Y+48|0,C=mt+24|0,P=mt+12|0,Bt=mt,E=mu(d,f,d,f,C)|0,!E&&(E=mu(d,f,m,g,P)|0,!E)){be=Jw(C,P)|0,St=((be|0)<0)<<31>>31,p[C>>2]=0,p[C+4>>2]=0,p[C+8>>2]=0,p[P>>2]=0,p[P+4>>2]=0,p[P+8>>2]=0,mu(d,f,d,f,C)|0&&_t(23313,23090,691,23299),mu(d,f,m,g,P)|0&&_t(23313,23090,696,23299),k8(C),k8(P),be?(te=p[C>>2]|0,ae=+(be|0),Ue=C+4|0,he=p[Ue>>2]|0,Ie=C+8|0,pe=p[Ie>>2]|0,De=C,g=te,E=he,m=pe,Se=+((p[P>>2]|0)-te|0)/ae,qe=+((p[P+4>>2]|0)-he|0)/ae,ae=+((p[P+8>>2]|0)-pe|0)/ae):(E=C+4|0,m=C+8|0,Ue=E,Ie=m,De=C,g=p[C>>2]|0,E=p[E>>2]|0,m=p[m>>2]|0,Se=0,qe=0,ae=0),p[Bt>>2]=g,pe=Bt+4|0,p[pe>>2]=E,he=Bt+8|0,p[he>>2]=m;e:do if((be|0)<0)E=0;else for(q=0,te=0,E=g;;){U=+(te>>>0)+4294967296*+(q|0),wt=Se*U+ +(E|0),k=qe*U+ +(p[Ue>>2]|0),U=ae*U+ +(p[Ie>>2]|0),m=~~+uy(+wt),C=~~+uy(+k),E=~~+uy(+U),wt=+An(+(+(m|0)-wt)),k=+An(+(+(C|0)-k)),U=+An(+(+(E|0)-U));do if(wt>k&wt>U)m=0-(C+E)|0,g=C;else if(P=0-m|0,k>U){g=P-E|0;break}else{g=C,E=P-C|0;break}while(!1);if(p[Bt>>2]=m,p[pe>>2]=g,p[he>>2]=E,_Q(Bt),E=$8(d,f,Bt,b+(te<<3)|0)|0,E|0)break e;if(!((q|0)<(St|0)|(q|0)==(St|0)&te>>>0<be>>>0)){E=0;break e}E=kn(te|0,q|0,1,0)|0,P=ne()|0,q=P,te=E,E=p[De>>2]|0}while(!1);return Bt=E,Y=mt,Bt|0}return Bt=E,Y=mt,Bt|0}function Bc(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0;if((m|0)==0&(g|0)==0)return b=0,E=1,Ft(b|0),E|0;E=d,b=f,d=1,f=0;do C=(m&1|0)==0&!0,d=vs((C?1:E)|0,(C?0:b)|0,d|0,f|0)|0,f=ne()|0,m=tI(m|0,g|0,1)|0,g=ne()|0,E=vs(E|0,b|0,E|0,b|0)|0,b=ne()|0;while(!((m|0)==0&(g|0)==0));return Ft(f|0),d|0}function j8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0;if(!(cr(f,m)|0)||(f=nn(f)|0,g=+J[m>>3],b=+J[m+8>>3],b=f&b<0?b+6.283185307179586:b,he=p[d>>2]|0,(he|0)<=0))return he=0,he|0;if(te=p[d+4>>2]|0,f){f=0,q=b,m=-1,d=0;e:for(;;){for(U=d;C=+J[te+(U<<4)>>3],b=+J[te+(U<<4)+8>>3],d=(m+2|0)%(he|0)|0,E=+J[te+(d<<4)>>3],P=+J[te+(d<<4)+8>>3],C>E?(k=C,C=P):(k=E,E=C,C=b,b=P),g=g==E|g==k?g+2220446049250313e-31:g,!!(g<E|g>k);)if(m=U+1|0,(m|0)>=(he|0)){m=22;break e}else d=U,U=m,m=d;if(P=C<0?C+6.283185307179586:C,C=b<0?b+6.283185307179586:b,q=P==q|C==q?q+-2220446049250313e-31:q,k=P+(C-P)*((g-E)/(k-E)),(k<0?k+6.283185307179586:k)>q&&(f=f^1),d=U+1|0,(d|0)>=(he|0)){m=22;break}else m=U}if((m|0)==22)return f|0}else{f=0,q=b,m=-1,d=0;e:for(;;){for(U=d;C=+J[te+(U<<4)>>3],b=+J[te+(U<<4)+8>>3],d=(m+2|0)%(he|0)|0,E=+J[te+(d<<4)>>3],P=+J[te+(d<<4)+8>>3],C>E?(k=C,C=P):(k=E,E=C,C=b,b=P),g=g==E|g==k?g+2220446049250313e-31:g,!!(g<E|g>k);)if(m=U+1|0,(m|0)>=(he|0)){m=22;break e}else d=U,U=m,m=d;if(q=C==q|b==q?q+-2220446049250313e-31:q,C+(b-C)*((g-E)/(k-E))>q&&(f=f^1),d=U+1|0,(d|0)>=(he|0)){m=22;break}else m=U}if((m|0)==22)return f|0}return 0}function W8(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0;if(ae=p[d>>2]|0,!ae){p[f>>2]=0,p[f+4>>2]=0,p[f+8>>2]=0,p[f+12>>2]=0,p[f+16>>2]=0,p[f+20>>2]=0,p[f+24>>2]=0,p[f+28>>2]=0;return}if(Se=f+8|0,J[Se>>3]=17976931348623157e292,qe=f+24|0,J[qe>>3]=17976931348623157e292,J[f>>3]=-17976931348623157e292,Ue=f+16|0,J[Ue>>3]=-17976931348623157e292,!((ae|0)<=0)){for(he=p[d+4>>2]|0,U=17976931348623157e292,q=-17976931348623157e292,te=0,d=-1,E=17976931348623157e292,C=17976931348623157e292,k=-17976931348623157e292,g=-17976931348623157e292,pe=0;m=+J[he+(pe<<4)>>3],P=+J[he+(pe<<4)+8>>3],d=d+2|0,b=+J[he+(((d|0)==(ae|0)?0:d)<<4)+8>>3],m<E&&(J[Se>>3]=m,E=m),P<C&&(J[qe>>3]=P,C=P),m>k?J[f>>3]=m:m=k,P>g&&(J[Ue>>3]=P,g=P),U=P>0&P<U?P:U,q=P<0&P>q?P:q,te=te|+An(+(P-b))>3.141592653589793,d=pe+1|0,(d|0)!=(ae|0);)Ie=pe,k=m,pe=d,d=Ie;te&&(J[Ue>>3]=q,J[qe>>3]=U)}}function pK(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0,Bt=0,mt=0;if(ae=p[d>>2]|0,ae){if(Se=f+8|0,J[Se>>3]=17976931348623157e292,qe=f+24|0,J[qe>>3]=17976931348623157e292,J[f>>3]=-17976931348623157e292,Ue=f+16|0,J[Ue>>3]=-17976931348623157e292,(ae|0)>0){for(b=p[d+4>>2]|0,he=17976931348623157e292,pe=-17976931348623157e292,g=0,m=-1,k=17976931348623157e292,U=17976931348623157e292,te=-17976931348623157e292,C=-17976931348623157e292,Ie=0;E=+J[b+(Ie<<4)>>3],q=+J[b+(Ie<<4)+8>>3],Bt=m+2|0,P=+J[b+(((Bt|0)==(ae|0)?0:Bt)<<4)+8>>3],E<k&&(J[Se>>3]=E,k=E),q<U&&(J[qe>>3]=q,U=q),E>te?J[f>>3]=E:E=te,q>C&&(J[Ue>>3]=q,C=q),he=q>0&q<he?q:he,pe=q<0&q>pe?q:pe,g=g|+An(+(q-P))>3.141592653589793,m=Ie+1|0,(m|0)!=(ae|0);)Bt=Ie,te=E,Ie=m,m=Bt;g&&(J[Ue>>3]=pe,J[qe>>3]=he)}}else p[f>>2]=0,p[f+4>>2]=0,p[f+8>>2]=0,p[f+12>>2]=0,p[f+16>>2]=0,p[f+20>>2]=0,p[f+24>>2]=0,p[f+28>>2]=0;if(Bt=d+8|0,m=p[Bt>>2]|0,!((m|0)<=0)){St=d+12|0,be=0;do if(b=p[St>>2]|0,g=be,be=be+1|0,qe=f+(be<<5)|0,Ue=p[b+(g<<3)>>2]|0,Ue){if(Ie=f+(be<<5)+8|0,J[Ie>>3]=17976931348623157e292,d=f+(be<<5)+24|0,J[d>>3]=17976931348623157e292,J[qe>>3]=-17976931348623157e292,De=f+(be<<5)+16|0,J[De>>3]=-17976931348623157e292,(Ue|0)>0){for(ae=p[b+(g<<3)+4>>2]|0,he=17976931348623157e292,pe=-17976931348623157e292,b=0,g=-1,Se=0,k=17976931348623157e292,U=17976931348623157e292,q=-17976931348623157e292,C=-17976931348623157e292;E=+J[ae+(Se<<4)>>3],te=+J[ae+(Se<<4)+8>>3],g=g+2|0,P=+J[ae+(((g|0)==(Ue|0)?0:g)<<4)+8>>3],E<k&&(J[Ie>>3]=E,k=E),te<U&&(J[d>>3]=te,U=te),E>q?J[qe>>3]=E:E=q,te>C&&(J[De>>3]=te,C=te),he=te>0&te<he?te:he,pe=te<0&te>pe?te:pe,b=b|+An(+(te-P))>3.141592653589793,g=Se+1|0,(g|0)!=(Ue|0);)mt=Se,Se=g,q=E,g=mt;b&&(J[De>>3]=pe,J[d>>3]=he)}}else p[qe>>2]=0,p[qe+4>>2]=0,p[qe+8>>2]=0,p[qe+12>>2]=0,p[qe+16>>2]=0,p[qe+20>>2]=0,p[qe+24>>2]=0,p[qe+28>>2]=0,m=p[Bt>>2]|0;while((be|0)<(m|0))}}function AK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;if(!(j8(d,f,m)|0))return b=0,b|0;if(b=d+8|0,(p[b>>2]|0)<=0)return b=1,b|0;for(g=d+12|0,d=0;;){if(E=d,d=d+1|0,j8((p[g>>2]|0)+(E<<3)|0,f+(d<<5)|0,m)|0){d=0,g=6;break}if((d|0)>=(p[b>>2]|0)){d=1,g=6;break}}return(g|0)==6?d|0:0}function mK(){return 8}function gK(){return 16}function vK(){return 168}function yK(){return 8}function _K(){return 16}function xK(){return 12}function bK(){return 8}function SK(d){return d=d|0,+(+((p[d>>2]|0)>>>0)+4294967296*+(p[d+4>>2]|0))}function wK(d){d=d|0;var f=0,m=0;return m=+J[d>>3],f=+J[d+8>>3],+ +X(+(m*m+f*f))}function X8(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0;U=+J[d>>3],k=+J[f>>3]-U,P=+J[d+8>>3],C=+J[f+8>>3]-P,te=+J[m>>3],E=+J[g>>3]-te,he=+J[m+8>>3],q=+J[g+8>>3]-he,E=(E*(P-he)-(U-te)*q)/(k*q-C*E),J[b>>3]=U+k*E,J[b+8>>3]=P+C*E}function Y8(d,f){return d=d|0,f=f|0,+An(+(+J[d>>3]-+J[f>>3]))<11920928955078125e-23?(f=+An(+(+J[d+8>>3]-+J[f+8>>3]))<11920928955078125e-23,f|0):(f=0,f|0)}function _r(d,f){d=d|0,f=f|0;var m=0,g=0,b=0;return b=+J[d>>3]-+J[f>>3],g=+J[d+8>>3]-+J[f+8>>3],m=+J[d+16>>3]-+J[f+16>>3],+(b*b+g*g+m*m)}function EK(d,f){d=d|0,f=f|0;var m=0,g=0,b=0;m=+J[d>>3],g=+Ee(+m),m=+xe(+m),J[f+16>>3]=m,m=+J[d+8>>3],b=g*+Ee(+m),J[f>>3]=b,m=g*+xe(+m),J[f+8>>3]=m}function TK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;if(E=Y,Y=Y+16|0,b=E,g=Ni(d,f)|0,(m+-1|0)>>>0>5||(g=(g|0)!=0,(m|0)==1&g))return b=-1,Y=E,b|0;do if(Sm(d,f,b)|0)g=-1;else if(g){g=((p[21936+(m<<2)>>2]|0)+5-(p[b>>2]|0)|0)%5|0;break}else{g=((p[21968+(m<<2)>>2]|0)+6-(p[b>>2]|0)|0)%6|0;break}while(!1);return b=g,Y=E,b|0}function Sm(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0,U=0;if(U=Y,Y=Y+32|0,C=U+16|0,P=U,g=fp(d,f,C)|0,g|0)return m=g,Y=U,m|0;E=B8(d,f)|0,k=Ao(d,f)|0,H(E,P),g=se(E,p[C>>2]|0)|0;e:do if(Si(E)|0){do switch(E|0){case 4:{d=0;break}case 14:{d=1;break}case 24:{d=2;break}case 38:{d=3;break}case 49:{d=4;break}case 58:{d=5;break}case 63:{d=6;break}case 72:{d=7;break}case 83:{d=8;break}case 97:{d=9;break}case 107:{d=10;break}case 117:{d=11;break}default:{g=1;break e}}while(!1);if(b=p[22e3+(d*24|0)+8>>2]|0,f=p[22e3+(d*24|0)+16>>2]|0,d=p[C>>2]|0,(d|0)!=(p[P>>2]|0)&&(P=y(E)|0,d=p[C>>2]|0,P|(d|0)==(f|0)&&(g=(g+1|0)%6|0)),(k|0)==3&(d|0)==(f|0)){g=(g+5|0)%6|0,b=22;break}(k|0)==5&(d|0)==(b|0)&&(g=(g+1|0)%6|0),b=22}else b=22;while(!1);return(b|0)==22&&(p[m>>2]=g,g=0),m=g,Y=U,m|0}function ga(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0;if(De=Y,Y=Y+32|0,Ie=De+24|0,qe=De+20|0,ae=De+8|0,pe=De+16|0,he=De,k=(Ni(d,f)|0)==0,k=k?6:5,q=it(d|0,f|0,52)|0,ne()|0,q=q&15,k>>>0<=m>>>0)return g=2,Y=De,g|0;te=(q|0)==0,!te&&(Se=vt(7,0,(q^15)*3|0)|0,(Se&d|0)==0&((ne()|0)&f|0)==0)?b=m:E=4;e:do if((E|0)==4){if(b=(Ni(d,f)|0)!=0,((b?4:5)|0)<(m|0)||Sm(d,f,Ie)|0||(E=(p[Ie>>2]|0)+m|0,b?b=22288+(((E|0)%5|0)<<2)|0:b=22320+(((E|0)%6|0)<<2)|0,Se=p[b>>2]|0,(Se|0)==7))return g=1,Y=De,g|0;p[qe>>2]=0,b=Qi(d,f,Se,qe,ae)|0;do if(!b){if(P=ae,U=p[P>>2]|0,P=p[P+4>>2]|0,C=P>>>0<f>>>0|(P|0)==(f|0)&U>>>0<d>>>0,E=C?U:d,C=C?P:f,!te&&(te=vt(7,0,(q^15)*3|0)|0,(U&te|0)==0&(P&(ne()|0)|0)==0))b=m;else{if(P=(m+-1+k|0)%(k|0)|0,b=Ni(d,f)|0,(P|0)<0&&_t(23313,23315,245,23324),k=(b|0)!=0,((k?4:5)|0)<(P|0)&&_t(23313,23315,245,23324),Sm(d,f,Ie)|0&&_t(23313,23315,245,23324),b=(p[Ie>>2]|0)+P|0,k?b=22288+(((b|0)%5|0)<<2)|0:b=22320+(((b|0)%6|0)<<2)|0,P=p[b>>2]|0,(P|0)==7&&_t(23313,23315,245,23324),p[pe>>2]=0,b=Qi(d,f,P,pe,he)|0,b|0)break;U=he,k=p[U>>2]|0,U=p[U+4>>2]|0;do if(U>>>0<C>>>0|(U|0)==(C|0)&k>>>0<E>>>0){if(Ni(k,U)|0?E=Rn(k,U,d,f)|0:E=p[22384+((((p[pe>>2]|0)+(p[22352+(P<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,b=Ni(k,U)|0,(E+-1|0)>>>0>5){b=-1,E=k,C=U;break}if(b=(b|0)!=0,(E|0)==1&b){b=-1,E=k,C=U;break}do if(Sm(k,U,Ie)|0)b=-1;else if(b){b=((p[21936+(E<<2)>>2]|0)+5-(p[Ie>>2]|0)|0)%5|0;break}else{b=((p[21968+(E<<2)>>2]|0)+6-(p[Ie>>2]|0)|0)%6|0;break}while(!1);E=k,C=U}else b=m;while(!1);P=ae,U=p[P>>2]|0,P=p[P+4>>2]|0}if((E|0)==(U|0)&(C|0)==(P|0)){if(k=(Ni(U,P)|0)!=0,k?d=Rn(U,P,d,f)|0:d=p[22384+((((p[qe>>2]|0)+(p[22352+(Se<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,b=Ni(U,P)|0,(d+-1|0)>>>0<=5&&(Ue=(b|0)!=0,!((d|0)==1&Ue)))do if(Sm(U,P,Ie)|0)b=-1;else if(Ue){b=((p[21936+(d<<2)>>2]|0)+5-(p[Ie>>2]|0)|0)%5|0;break}else{b=((p[21968+(d<<2)>>2]|0)+6-(p[Ie>>2]|0)|0)%6|0;break}while(!1);else b=-1;b=b+1|0,b=(b|0)==6|k&(b|0)==5?0:b}f=C,d=E;break e}while(!1);return g=b,Y=De,g|0}while(!1);return Ue=vt(b|0,0,56)|0,Ie=ne()|0|f&-2130706433|536870912,p[g>>2]=Ue|d,p[g+4>>2]=Ie,g=0,Y=De,g|0}function CK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;return E=(Ni(d,f)|0)==0,g=ga(d,f,0,m)|0,b=(g|0)==0,E?!b||(g=ga(d,f,1,m+8|0)|0,g|0)||(g=ga(d,f,2,m+16|0)|0,g|0)||(g=ga(d,f,3,m+24|0)|0,g|0)||(g=ga(d,f,4,m+32|0)|0,g)?(E=g,E|0):ga(d,f,5,m+40|0)|0:!b||(g=ga(d,f,1,m+8|0)|0,g|0)||(g=ga(d,f,2,m+16|0)|0,g|0)||(g=ga(d,f,3,m+24|0)|0,g|0)||(g=ga(d,f,4,m+32|0)|0,g|0)?(E=g,E|0):(E=m+40|0,p[E>>2]=0,p[E+4>>2]=0,E=0,E|0)}function MK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0,P=0,k=0;return k=Y,Y=Y+192|0,b=k,E=k+168|0,C=it(d|0,f|0,56)|0,ne()|0,C=C&7,P=f&-2130706433|134217728,g=fp(d,P,E)|0,g|0?(P=g,Y=k,P|0):(f=it(d|0,f|0,52)|0,ne()|0,f=f&15,Ni(d,P)|0?eE(E,f,C,1,b):tE(E,f,C,1,b),P=b+8|0,p[m>>2]=p[P>>2],p[m+4>>2]=p[P+4>>2],p[m+8>>2]=p[P+8>>2],p[m+12>>2]=p[P+12>>2],P=0,Y=k,P|0)}function RK(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0;return b=Y,Y=Y+16|0,m=b,!(!0&(f&2013265920|0)==536870912)||(g=f&-2130706433|134217728,!(nE(d,g)|0))?(g=0,Y=b,g|0):(E=it(d|0,f|0,56)|0,ne()|0,E=(ga(d,g,E&7,m)|0)==0,g=m,g=E&((p[g>>2]|0)==(d|0)?(p[g+4>>2]|0)==(f|0):0)&1,Y=b,g|0)}function Q8(d,f,m){d=d|0,f=f|0,m=m|0;var g=0;(f|0)>0?(g=Fl(f,4)|0,p[d>>2]=g,g||_t(23337,23360,40,23374)):p[d>>2]=0,p[d+4>>2]=f,p[d+8>>2]=0,p[d+12>>2]=m}function K8(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0;b=d+4|0,E=d+12|0,C=d+8|0;e:for(;;){for(m=p[b>>2]|0,f=0;;){if((f|0)>=(m|0))break e;if(g=p[d>>2]|0,P=p[g+(f<<2)>>2]|0,!P)f=f+1|0;else break}f=g+(~~(+An(+(+ye(10,+ +(15-(p[E>>2]|0)|0))*(+J[P>>3]+ +J[P+8>>3])))%+(m|0))>>>0<<2)|0,m=p[f>>2]|0;t:do if(m|0){if(g=P+32|0,(m|0)==(P|0))p[f>>2]=p[g>>2];else{if(m=m+32|0,f=p[m>>2]|0,!f)break;for(;(f|0)!=(P|0);)if(m=f+32|0,f=p[m>>2]|0,!f)break t;p[m>>2]=p[g>>2]}ln(P),p[C>>2]=(p[C>>2]|0)+-1}while(!1)}ln(p[d>>2]|0)}function Z8(d){d=d|0;var f=0,m=0,g=0;for(g=p[d+4>>2]|0,m=0;;){if((m|0)>=(g|0)){f=0,m=4;break}if(f=p[(p[d>>2]|0)+(m<<2)>>2]|0,!f)m=m+1|0;else{m=4;break}}return(m|0)==4?f|0:0}function J8(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0;if(m=~~(+An(+(+ye(10,+ +(15-(p[d+12>>2]|0)|0))*(+J[f>>3]+ +J[f+8>>3])))%+(p[d+4>>2]|0))>>>0,m=(p[d>>2]|0)+(m<<2)|0,g=p[m>>2]|0,!g)return E=1,E|0;E=f+32|0;do if((g|0)!=(f|0)){if(m=p[g+32>>2]|0,!m)return E=1,E|0;for(b=m;;){if((b|0)==(f|0)){b=8;break}if(m=p[b+32>>2]|0,m)g=b,b=m;else{m=1,b=10;break}}if((b|0)==8){p[g+32>>2]=p[E>>2];break}else if((b|0)==10)return m|0}else p[m>>2]=p[E>>2];while(!1);return ln(f),E=d+8|0,p[E>>2]=(p[E>>2]|0)+-1,E=0,E|0}function PK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0;E=Ll(40)|0,E||_t(23390,23360,98,23403),p[E>>2]=p[f>>2],p[E+4>>2]=p[f+4>>2],p[E+8>>2]=p[f+8>>2],p[E+12>>2]=p[f+12>>2],b=E+16|0,p[b>>2]=p[m>>2],p[b+4>>2]=p[m+4>>2],p[b+8>>2]=p[m+8>>2],p[b+12>>2]=p[m+12>>2],p[E+32>>2]=0,b=~~(+An(+(+ye(10,+ +(15-(p[d+12>>2]|0)|0))*(+J[f>>3]+ +J[f+8>>3])))%+(p[d+4>>2]|0))>>>0,b=(p[d>>2]|0)+(b<<2)|0,g=p[b>>2]|0;do if(!g)p[b>>2]=E;else{for(;!(dp(g,f)|0&&dp(g+16|0,m)|0);)if(b=p[g+32>>2]|0,g=b|0?b:g,!(p[g+32>>2]|0)){C=10;break}if((C|0)==10){p[g+32>>2]=E;break}return ln(E),C=g,C|0}while(!1);return C=d+8|0,p[C>>2]=(p[C>>2]|0)+1,C=E,C|0}function NK(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0;if(b=~~(+An(+(+ye(10,+ +(15-(p[d+12>>2]|0)|0))*(+J[f>>3]+ +J[f+8>>3])))%+(p[d+4>>2]|0))>>>0,b=p[(p[d>>2]|0)+(b<<2)>>2]|0,!b)return m=0,m|0;if(!m){for(d=b;;){if(dp(d,f)|0){g=10;break}if(d=p[d+32>>2]|0,!d){d=0,g=10;break}}if((g|0)==10)return d|0}for(d=b;;){if(dp(d,f)|0&&dp(d+16|0,m)|0){g=10;break}if(d=p[d+32>>2]|0,!d){d=0,g=10;break}}return(g|0)==10?d|0:0}function IK(d,f){d=d|0,f=f|0;var m=0;if(m=~~(+An(+(+ye(10,+ +(15-(p[d+12>>2]|0)|0))*(+J[f>>3]+ +J[f+8>>3])))%+(p[d+4>>2]|0))>>>0,d=p[(p[d>>2]|0)+(m<<2)>>2]|0,!d)return m=0,m|0;for(;;){if(dp(d,f)|0){f=5;break}if(d=p[d+32>>2]|0,!d){d=0,f=5;break}}return(f|0)==5?d|0:0}function DK(){return 23424}function kK(d){return d=+d,+ +iI(+d)}function Oc(d){return d=+d,~~+kK(d)|0}function Ll(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0,Se=0,qe=0,Ue=0,Ie=0,De=0,be=0,St=0;St=Y,Y=Y+16|0,he=St;do if(d>>>0<245){if(U=d>>>0<11?16:d+11&-8,d=U>>>3,te=p[5857]|0,m=te>>>d,m&3|0)return f=(m&1^1)+d|0,d=23468+(f<<1<<2)|0,m=d+8|0,g=p[m>>2]|0,b=g+8|0,E=p[b>>2]|0,(E|0)==(d|0)?p[5857]=te&~(1<<f):(p[E+12>>2]=d,p[m>>2]=E),be=f<<3,p[g+4>>2]=be|3,be=g+be+4|0,p[be>>2]=p[be>>2]|1,be=b,Y=St,be|0;if(q=p[5859]|0,U>>>0>q>>>0){if(m|0)return f=2<<d,f=m<<d&(f|0-f),f=(f&0-f)+-1|0,P=f>>>12&16,f=f>>>P,m=f>>>5&8,f=f>>>m,E=f>>>2&4,f=f>>>E,d=f>>>1&2,f=f>>>d,g=f>>>1&1,g=(m|P|E|d|g)+(f>>>g)|0,f=23468+(g<<1<<2)|0,d=f+8|0,E=p[d>>2]|0,P=E+8|0,m=p[P>>2]|0,(m|0)==(f|0)?(d=te&~(1<<g),p[5857]=d):(p[m+12>>2]=f,p[d>>2]=m,d=te),be=g<<3,C=be-U|0,p[E+4>>2]=U|3,b=E+U|0,p[b+4>>2]=C|1,p[E+be>>2]=C,q|0&&(g=p[5862]|0,f=q>>>3,m=23468+(f<<1<<2)|0,f=1<<f,d&f?(d=m+8|0,f=p[d>>2]|0):(p[5857]=d|f,f=m,d=m+8|0),p[d>>2]=g,p[f+12>>2]=g,p[g+8>>2]=f,p[g+12>>2]=m),p[5859]=C,p[5862]=b,be=P,Y=St,be|0;if(E=p[5858]|0,E){for(m=(E&0-E)+-1|0,b=m>>>12&16,m=m>>>b,g=m>>>5&8,m=m>>>g,C=m>>>2&4,m=m>>>C,P=m>>>1&2,m=m>>>P,k=m>>>1&1,k=p[23732+((g|b|C|P|k)+(m>>>k)<<2)>>2]|0,m=k,P=k,k=(p[k+4>>2]&-8)-U|0;d=p[m+16>>2]|0,!(!d&&(d=p[m+20>>2]|0,!d));)C=(p[d+4>>2]&-8)-U|0,b=C>>>0<k>>>0,m=d,P=b?d:P,k=b?C:k;if(C=P+U|0,C>>>0>P>>>0){b=p[P+24>>2]|0,f=p[P+12>>2]|0;do if((f|0)==(P|0)){if(d=P+20|0,f=p[d>>2]|0,!f&&(d=P+16|0,f=p[d>>2]|0,!f)){m=0;break}for(;;)if(g=f+20|0,m=p[g>>2]|0,m)f=m,d=g;else if(g=f+16|0,m=p[g>>2]|0,m)f=m,d=g;else break;p[d>>2]=0,m=f}else m=p[P+8>>2]|0,p[m+12>>2]=f,p[f+8>>2]=m,m=f;while(!1);do if(b|0){if(f=p[P+28>>2]|0,d=23732+(f<<2)|0,(P|0)==(p[d>>2]|0)){if(p[d>>2]=m,!m){p[5858]=E&~(1<<f);break}}else if(be=b+16|0,p[((p[be>>2]|0)==(P|0)?be:b+20|0)>>2]=m,!m)break;p[m+24>>2]=b,f=p[P+16>>2]|0,f|0&&(p[m+16>>2]=f,p[f+24>>2]=m),f=p[P+20>>2]|0,f|0&&(p[m+20>>2]=f,p[f+24>>2]=m)}while(!1);return k>>>0<16?(be=k+U|0,p[P+4>>2]=be|3,be=P+be+4|0,p[be>>2]=p[be>>2]|1):(p[P+4>>2]=U|3,p[C+4>>2]=k|1,p[C+k>>2]=k,q|0&&(g=p[5862]|0,f=q>>>3,m=23468+(f<<1<<2)|0,f=1<<f,f&te?(d=m+8|0,f=p[d>>2]|0):(p[5857]=f|te,f=m,d=m+8|0),p[d>>2]=g,p[f+12>>2]=g,p[g+8>>2]=f,p[g+12>>2]=m),p[5859]=k,p[5862]=C),be=P+8|0,Y=St,be|0}else te=U}else te=U}else te=U}else if(d>>>0<=4294967231)if(d=d+11|0,U=d&-8,g=p[5858]|0,g){b=0-U|0,d=d>>>8,d?U>>>0>16777215?k=31:(te=(d+1048320|0)>>>16&8,Se=d<<te,P=(Se+520192|0)>>>16&4,Se=Se<<P,k=(Se+245760|0)>>>16&2,k=14-(P|te|k)+(Se<<k>>>15)|0,k=U>>>(k+7|0)&1|k<<1):k=0,m=p[23732+(k<<2)>>2]|0;e:do if(!m)m=0,d=0,Se=61;else for(d=0,P=U<<((k|0)==31?0:25-(k>>>1)|0),E=0;;){if(C=(p[m+4>>2]&-8)-U|0,C>>>0<b>>>0)if(C)d=m,b=C;else{d=m,b=0,Se=65;break e}if(Se=p[m+20>>2]|0,m=p[m+16+(P>>>31<<2)>>2]|0,E=(Se|0)==0|(Se|0)==(m|0)?E:Se,m)P=P<<1;else{m=E,Se=61;break}}while(!1);if((Se|0)==61){if((m|0)==0&(d|0)==0){if(d=2<<k,d=(d|0-d)&g,!d){te=U;break}te=(d&0-d)+-1|0,C=te>>>12&16,te=te>>>C,E=te>>>5&8,te=te>>>E,P=te>>>2&4,te=te>>>P,k=te>>>1&2,te=te>>>k,m=te>>>1&1,d=0,m=p[23732+((E|C|P|k|m)+(te>>>m)<<2)>>2]|0}m?Se=65:(P=d,C=b)}if((Se|0)==65)for(E=m;;)if(te=(p[E+4>>2]&-8)-U|0,m=te>>>0<b>>>0,b=m?te:b,d=m?E:d,m=p[E+16>>2]|0,m||(m=p[E+20>>2]|0),m)E=m;else{P=d,C=b;break}if(P|0&&C>>>0<((p[5859]|0)-U|0)>>>0&&(q=P+U|0,q>>>0>P>>>0)){E=p[P+24>>2]|0,f=p[P+12>>2]|0;do if((f|0)==(P|0)){if(d=P+20|0,f=p[d>>2]|0,!f&&(d=P+16|0,f=p[d>>2]|0,!f)){f=0;break}for(;;)if(b=f+20|0,m=p[b>>2]|0,m)f=m,d=b;else if(b=f+16|0,m=p[b>>2]|0,m)f=m,d=b;else break;p[d>>2]=0}else be=p[P+8>>2]|0,p[be+12>>2]=f,p[f+8>>2]=be;while(!1);do if(E){if(d=p[P+28>>2]|0,m=23732+(d<<2)|0,(P|0)==(p[m>>2]|0)){if(p[m>>2]=f,!f){g=g&~(1<<d),p[5858]=g;break}}else if(be=E+16|0,p[((p[be>>2]|0)==(P|0)?be:E+20|0)>>2]=f,!f)break;p[f+24>>2]=E,d=p[P+16>>2]|0,d|0&&(p[f+16>>2]=d,p[d+24>>2]=f),d=p[P+20>>2]|0,d&&(p[f+20>>2]=d,p[d+24>>2]=f)}while(!1);e:do if(C>>>0<16)be=C+U|0,p[P+4>>2]=be|3,be=P+be+4|0,p[be>>2]=p[be>>2]|1;else{if(p[P+4>>2]=U|3,p[q+4>>2]=C|1,p[q+C>>2]=C,f=C>>>3,C>>>0<256){m=23468+(f<<1<<2)|0,d=p[5857]|0,f=1<<f,d&f?(d=m+8|0,f=p[d>>2]|0):(p[5857]=d|f,f=m,d=m+8|0),p[d>>2]=q,p[f+12>>2]=q,p[q+8>>2]=f,p[q+12>>2]=m;break}if(f=C>>>8,f?C>>>0>16777215?m=31:(De=(f+1048320|0)>>>16&8,be=f<<De,Ie=(be+520192|0)>>>16&4,be=be<<Ie,m=(be+245760|0)>>>16&2,m=14-(Ie|De|m)+(be<<m>>>15)|0,m=C>>>(m+7|0)&1|m<<1):m=0,f=23732+(m<<2)|0,p[q+28>>2]=m,d=q+16|0,p[d+4>>2]=0,p[d>>2]=0,d=1<<m,!(g&d)){p[5858]=g|d,p[f>>2]=q,p[q+24>>2]=f,p[q+12>>2]=q,p[q+8>>2]=q;break}f=p[f>>2]|0;t:do if((p[f+4>>2]&-8|0)!=(C|0)){for(g=C<<((m|0)==31?0:25-(m>>>1)|0);m=f+16+(g>>>31<<2)|0,d=p[m>>2]|0,!!d;)if((p[d+4>>2]&-8|0)==(C|0)){f=d;break t}else g=g<<1,f=d;p[m>>2]=q,p[q+24>>2]=f,p[q+12>>2]=q,p[q+8>>2]=q;break e}while(!1);De=f+8|0,be=p[De>>2]|0,p[be+12>>2]=q,p[De>>2]=q,p[q+8>>2]=be,p[q+12>>2]=f,p[q+24>>2]=0}while(!1);return be=P+8|0,Y=St,be|0}else te=U}else te=U;else te=-1;while(!1);if(m=p[5859]|0,m>>>0>=te>>>0)return f=m-te|0,d=p[5862]|0,f>>>0>15?(be=d+te|0,p[5862]=be,p[5859]=f,p[be+4>>2]=f|1,p[d+m>>2]=f,p[d+4>>2]=te|3):(p[5859]=0,p[5862]=0,p[d+4>>2]=m|3,be=d+m+4|0,p[be>>2]=p[be>>2]|1),be=d+8|0,Y=St,be|0;if(C=p[5860]|0,C>>>0>te>>>0)return Ie=C-te|0,p[5860]=Ie,be=p[5863]|0,De=be+te|0,p[5863]=De,p[De+4>>2]=Ie|1,p[be+4>>2]=te|3,be=be+8|0,Y=St,be|0;if(p[5975]|0?d=p[5977]|0:(p[5977]=4096,p[5976]=4096,p[5978]=-1,p[5979]=-1,p[5980]=0,p[5968]=0,p[5975]=he&-16^1431655768,d=4096),P=te+48|0,k=te+47|0,E=d+k|0,b=0-d|0,U=E&b,U>>>0<=te>>>0||(d=p[5967]|0,d|0&&(q=p[5965]|0,he=q+U|0,he>>>0<=q>>>0|he>>>0>d>>>0)))return be=0,Y=St,be|0;e:do if(p[5968]&4)f=0,Se=143;else{m=p[5863]|0;t:do if(m){for(g=23876;he=p[g>>2]|0,!(he>>>0<=m>>>0&&(he+(p[g+4>>2]|0)|0)>>>0>m>>>0);)if(d=p[g+8>>2]|0,d)g=d;else{Se=128;break t}if(f=E-C&b,f>>>0<2147483647)if(d=Uc(f|0)|0,(d|0)==((p[g>>2]|0)+(p[g+4>>2]|0)|0)){if((d|0)!=-1){C=f,E=d,Se=145;break e}}else g=d,Se=136;else f=0}else Se=128;while(!1);do if((Se|0)==128)if(m=Uc(0)|0,(m|0)!=-1&&(f=m,pe=p[5976]|0,ae=pe+-1|0,f=(ae&f|0?(ae+f&0-pe)-f|0:0)+U|0,pe=p[5965]|0,ae=f+pe|0,f>>>0>te>>>0&f>>>0<2147483647)){if(he=p[5967]|0,he|0&&ae>>>0<=pe>>>0|ae>>>0>he>>>0){f=0;break}if(d=Uc(f|0)|0,(d|0)==(m|0)){C=f,E=m,Se=145;break e}else g=d,Se=136}else f=0;while(!1);do if((Se|0)==136){if(m=0-f|0,!(P>>>0>f>>>0&(f>>>0<2147483647&(g|0)!=-1)))if((g|0)==-1){f=0;break}else{C=f,E=g,Se=145;break e}if(d=p[5977]|0,d=k-f+d&0-d,d>>>0>=2147483647){C=f,E=g,Se=145;break e}if((Uc(d|0)|0)==-1){Uc(m|0)|0,f=0;break}else{C=d+f|0,E=g,Se=145;break e}}while(!1);p[5968]=p[5968]|4,Se=143}while(!1);if((Se|0)==143&&U>>>0<2147483647&&(Ie=Uc(U|0)|0,ae=Uc(0)|0,qe=ae-Ie|0,Ue=qe>>>0>(te+40|0)>>>0,!((Ie|0)==-1|Ue^1|Ie>>>0<ae>>>0&((Ie|0)!=-1&(ae|0)!=-1)^1))&&(C=Ue?qe:f,E=Ie,Se=145),(Se|0)==145){f=(p[5965]|0)+C|0,p[5965]=f,f>>>0>(p[5966]|0)>>>0&&(p[5966]=f),k=p[5863]|0;e:do if(k){for(f=23876;;){if(d=p[f>>2]|0,m=p[f+4>>2]|0,(E|0)==(d+m|0)){Se=154;break}if(g=p[f+8>>2]|0,g)f=g;else break}if((Se|0)==154&&(De=f+4|0,(p[f+12>>2]&8|0)==0)&&E>>>0>k>>>0&d>>>0<=k>>>0){p[De>>2]=m+C,be=(p[5860]|0)+C|0,Ie=k+8|0,Ie=Ie&7|0?0-Ie&7:0,De=k+Ie|0,Ie=be-Ie|0,p[5863]=De,p[5860]=Ie,p[De+4>>2]=Ie|1,p[k+be+4>>2]=40,p[5864]=p[5979];break}for(E>>>0<(p[5861]|0)>>>0&&(p[5861]=E),m=E+C|0,f=23876;;){if((p[f>>2]|0)==(m|0)){Se=162;break}if(d=p[f+8>>2]|0,d)f=d;else break}if((Se|0)==162&&!(p[f+12>>2]&8|0)){p[f>>2]=E,q=f+4|0,p[q>>2]=(p[q>>2]|0)+C,q=E+8|0,q=E+(q&7|0?0-q&7:0)|0,f=m+8|0,f=m+(f&7|0?0-f&7:0)|0,U=q+te|0,P=f-q-te|0,p[q+4>>2]=te|3;t:do if((k|0)==(f|0))be=(p[5860]|0)+P|0,p[5860]=be,p[5863]=U,p[U+4>>2]=be|1;else{if((p[5862]|0)==(f|0)){be=(p[5859]|0)+P|0,p[5859]=be,p[5862]=U,p[U+4>>2]=be|1,p[U+be>>2]=be;break}if(d=p[f+4>>2]|0,(d&3|0)==1){C=d&-8,g=d>>>3;n:do if(d>>>0<256)if(d=p[f+8>>2]|0,m=p[f+12>>2]|0,(m|0)==(d|0)){p[5857]=p[5857]&~(1<<g);break}else{p[d+12>>2]=m,p[m+8>>2]=d;break}else{E=p[f+24>>2]|0,d=p[f+12>>2]|0;do if((d|0)==(f|0)){if(m=f+16|0,g=m+4|0,d=p[g>>2]|0,d)m=g;else if(d=p[m>>2]|0,!d){d=0;break}for(;;)if(b=d+20|0,g=p[b>>2]|0,g)d=g,m=b;else if(b=d+16|0,g=p[b>>2]|0,g)d=g,m=b;else break;p[m>>2]=0}else be=p[f+8>>2]|0,p[be+12>>2]=d,p[d+8>>2]=be;while(!1);if(!E)break;m=p[f+28>>2]|0,g=23732+(m<<2)|0;do if((p[g>>2]|0)!=(f|0)){if(be=E+16|0,p[((p[be>>2]|0)==(f|0)?be:E+20|0)>>2]=d,!d)break n}else{if(p[g>>2]=d,d|0)break;p[5858]=p[5858]&~(1<<m);break n}while(!1);if(p[d+24>>2]=E,m=f+16|0,g=p[m>>2]|0,g|0&&(p[d+16>>2]=g,p[g+24>>2]=d),m=p[m+4>>2]|0,!m)break;p[d+20>>2]=m,p[m+24>>2]=d}while(!1);f=f+C|0,b=C+P|0}else b=P;if(f=f+4|0,p[f>>2]=p[f>>2]&-2,p[U+4>>2]=b|1,p[U+b>>2]=b,f=b>>>3,b>>>0<256){m=23468+(f<<1<<2)|0,d=p[5857]|0,f=1<<f,d&f?(d=m+8|0,f=p[d>>2]|0):(p[5857]=d|f,f=m,d=m+8|0),p[d>>2]=U,p[f+12>>2]=U,p[U+8>>2]=f,p[U+12>>2]=m;break}f=b>>>8;do if(!f)g=0;else{if(b>>>0>16777215){g=31;break}De=(f+1048320|0)>>>16&8,be=f<<De,Ie=(be+520192|0)>>>16&4,be=be<<Ie,g=(be+245760|0)>>>16&2,g=14-(Ie|De|g)+(be<<g>>>15)|0,g=b>>>(g+7|0)&1|g<<1}while(!1);if(f=23732+(g<<2)|0,p[U+28>>2]=g,d=U+16|0,p[d+4>>2]=0,p[d>>2]=0,d=p[5858]|0,m=1<<g,!(d&m)){p[5858]=d|m,p[f>>2]=U,p[U+24>>2]=f,p[U+12>>2]=U,p[U+8>>2]=U;break}f=p[f>>2]|0;n:do if((p[f+4>>2]&-8|0)!=(b|0)){for(g=b<<((g|0)==31?0:25-(g>>>1)|0);m=f+16+(g>>>31<<2)|0,d=p[m>>2]|0,!!d;)if((p[d+4>>2]&-8|0)==(b|0)){f=d;break n}else g=g<<1,f=d;p[m>>2]=U,p[U+24>>2]=f,p[U+12>>2]=U,p[U+8>>2]=U;break t}while(!1);De=f+8|0,be=p[De>>2]|0,p[be+12>>2]=U,p[De>>2]=U,p[U+8>>2]=be,p[U+12>>2]=f,p[U+24>>2]=0}while(!1);return be=q+8|0,Y=St,be|0}for(f=23876;d=p[f>>2]|0,!(d>>>0<=k>>>0&&(be=d+(p[f+4>>2]|0)|0,be>>>0>k>>>0));)f=p[f+8>>2]|0;b=be+-47|0,d=b+8|0,d=b+(d&7|0?0-d&7:0)|0,b=k+16|0,d=d>>>0<b>>>0?k:d,f=d+8|0,m=C+-40|0,Ie=E+8|0,Ie=Ie&7|0?0-Ie&7:0,De=E+Ie|0,Ie=m-Ie|0,p[5863]=De,p[5860]=Ie,p[De+4>>2]=Ie|1,p[E+m+4>>2]=40,p[5864]=p[5979],m=d+4|0,p[m>>2]=27,p[f>>2]=p[5969],p[f+4>>2]=p[5970],p[f+8>>2]=p[5971],p[f+12>>2]=p[5972],p[5969]=E,p[5970]=C,p[5972]=0,p[5971]=f,f=d+24|0;do De=f,f=f+4|0,p[f>>2]=7;while((De+8|0)>>>0<be>>>0);if((d|0)!=(k|0)){if(E=d-k|0,p[m>>2]=p[m>>2]&-2,p[k+4>>2]=E|1,p[d>>2]=E,f=E>>>3,E>>>0<256){m=23468+(f<<1<<2)|0,d=p[5857]|0,f=1<<f,d&f?(d=m+8|0,f=p[d>>2]|0):(p[5857]=d|f,f=m,d=m+8|0),p[d>>2]=k,p[f+12>>2]=k,p[k+8>>2]=f,p[k+12>>2]=m;break}if(f=E>>>8,f?E>>>0>16777215?g=31:(De=(f+1048320|0)>>>16&8,be=f<<De,Ie=(be+520192|0)>>>16&4,be=be<<Ie,g=(be+245760|0)>>>16&2,g=14-(Ie|De|g)+(be<<g>>>15)|0,g=E>>>(g+7|0)&1|g<<1):g=0,m=23732+(g<<2)|0,p[k+28>>2]=g,p[k+20>>2]=0,p[b>>2]=0,f=p[5858]|0,d=1<<g,!(f&d)){p[5858]=f|d,p[m>>2]=k,p[k+24>>2]=m,p[k+12>>2]=k,p[k+8>>2]=k;break}f=p[m>>2]|0;t:do if((p[f+4>>2]&-8|0)!=(E|0)){for(g=E<<((g|0)==31?0:25-(g>>>1)|0);m=f+16+(g>>>31<<2)|0,d=p[m>>2]|0,!!d;)if((p[d+4>>2]&-8|0)==(E|0)){f=d;break t}else g=g<<1,f=d;p[m>>2]=k,p[k+24>>2]=f,p[k+12>>2]=k,p[k+8>>2]=k;break e}while(!1);De=f+8|0,be=p[De>>2]|0,p[be+12>>2]=k,p[De>>2]=k,p[k+8>>2]=be,p[k+12>>2]=f,p[k+24>>2]=0}}else be=p[5861]|0,(be|0)==0|E>>>0<be>>>0&&(p[5861]=E),p[5969]=E,p[5970]=C,p[5972]=0,p[5866]=p[5975],p[5865]=-1,p[5870]=23468,p[5869]=23468,p[5872]=23476,p[5871]=23476,p[5874]=23484,p[5873]=23484,p[5876]=23492,p[5875]=23492,p[5878]=23500,p[5877]=23500,p[5880]=23508,p[5879]=23508,p[5882]=23516,p[5881]=23516,p[5884]=23524,p[5883]=23524,p[5886]=23532,p[5885]=23532,p[5888]=23540,p[5887]=23540,p[5890]=23548,p[5889]=23548,p[5892]=23556,p[5891]=23556,p[5894]=23564,p[5893]=23564,p[5896]=23572,p[5895]=23572,p[5898]=23580,p[5897]=23580,p[5900]=23588,p[5899]=23588,p[5902]=23596,p[5901]=23596,p[5904]=23604,p[5903]=23604,p[5906]=23612,p[5905]=23612,p[5908]=23620,p[5907]=23620,p[5910]=23628,p[5909]=23628,p[5912]=23636,p[5911]=23636,p[5914]=23644,p[5913]=23644,p[5916]=23652,p[5915]=23652,p[5918]=23660,p[5917]=23660,p[5920]=23668,p[5919]=23668,p[5922]=23676,p[5921]=23676,p[5924]=23684,p[5923]=23684,p[5926]=23692,p[5925]=23692,p[5928]=23700,p[5927]=23700,p[5930]=23708,p[5929]=23708,p[5932]=23716,p[5931]=23716,be=C+-40|0,Ie=E+8|0,Ie=Ie&7|0?0-Ie&7:0,De=E+Ie|0,Ie=be-Ie|0,p[5863]=De,p[5860]=Ie,p[De+4>>2]=Ie|1,p[E+be+4>>2]=40,p[5864]=p[5979];while(!1);if(f=p[5860]|0,f>>>0>te>>>0)return Ie=f-te|0,p[5860]=Ie,be=p[5863]|0,De=be+te|0,p[5863]=De,p[De+4>>2]=Ie|1,p[be+4>>2]=te|3,be=be+8|0,Y=St,be|0}return be=DK()|0,p[be>>2]=12,be=0,Y=St,be|0}function ln(d){d=d|0;var f=0,m=0,g=0,b=0,E=0,C=0,P=0,k=0;if(d){m=d+-8|0,b=p[5861]|0,d=p[d+-4>>2]|0,f=d&-8,k=m+f|0;do if(d&1)P=m,C=m;else{if(g=p[m>>2]|0,!(d&3)||(C=m+(0-g)|0,E=g+f|0,C>>>0<b>>>0))return;if((p[5862]|0)==(C|0)){if(d=k+4|0,f=p[d>>2]|0,(f&3|0)!=3){P=C,f=E;break}p[5859]=E,p[d>>2]=f&-2,p[C+4>>2]=E|1,p[C+E>>2]=E;return}if(m=g>>>3,g>>>0<256)if(d=p[C+8>>2]|0,f=p[C+12>>2]|0,(f|0)==(d|0)){p[5857]=p[5857]&~(1<<m),P=C,f=E;break}else{p[d+12>>2]=f,p[f+8>>2]=d,P=C,f=E;break}b=p[C+24>>2]|0,d=p[C+12>>2]|0;do if((d|0)==(C|0)){if(f=C+16|0,m=f+4|0,d=p[m>>2]|0,d)f=m;else if(d=p[f>>2]|0,!d){d=0;break}for(;;)if(g=d+20|0,m=p[g>>2]|0,m)d=m,f=g;else if(g=d+16|0,m=p[g>>2]|0,m)d=m,f=g;else break;p[f>>2]=0}else P=p[C+8>>2]|0,p[P+12>>2]=d,p[d+8>>2]=P;while(!1);if(b){if(f=p[C+28>>2]|0,m=23732+(f<<2)|0,(p[m>>2]|0)==(C|0)){if(p[m>>2]=d,!d){p[5858]=p[5858]&~(1<<f),P=C,f=E;break}}else if(P=b+16|0,p[((p[P>>2]|0)==(C|0)?P:b+20|0)>>2]=d,!d){P=C,f=E;break}p[d+24>>2]=b,f=C+16|0,m=p[f>>2]|0,m|0&&(p[d+16>>2]=m,p[m+24>>2]=d),f=p[f+4>>2]|0,f?(p[d+20>>2]=f,p[f+24>>2]=d,P=C,f=E):(P=C,f=E)}else P=C,f=E}while(!1);if(!(C>>>0>=k>>>0)&&(d=k+4|0,g=p[d>>2]|0,!!(g&1))){if(g&2)p[d>>2]=g&-2,p[P+4>>2]=f|1,p[C+f>>2]=f,b=f;else{if((p[5863]|0)==(k|0)){if(k=(p[5860]|0)+f|0,p[5860]=k,p[5863]=P,p[P+4>>2]=k|1,(P|0)!=(p[5862]|0))return;p[5862]=0,p[5859]=0;return}if((p[5862]|0)==(k|0)){k=(p[5859]|0)+f|0,p[5859]=k,p[5862]=C,p[P+4>>2]=k|1,p[C+k>>2]=k;return}b=(g&-8)+f|0,m=g>>>3;do if(g>>>0<256)if(f=p[k+8>>2]|0,d=p[k+12>>2]|0,(d|0)==(f|0)){p[5857]=p[5857]&~(1<<m);break}else{p[f+12>>2]=d,p[d+8>>2]=f;break}else{E=p[k+24>>2]|0,d=p[k+12>>2]|0;do if((d|0)==(k|0)){if(f=k+16|0,m=f+4|0,d=p[m>>2]|0,d)f=m;else if(d=p[f>>2]|0,!d){m=0;break}for(;;)if(g=d+20|0,m=p[g>>2]|0,m)d=m,f=g;else if(g=d+16|0,m=p[g>>2]|0,m)d=m,f=g;else break;p[f>>2]=0,m=d}else m=p[k+8>>2]|0,p[m+12>>2]=d,p[d+8>>2]=m,m=d;while(!1);if(E|0){if(d=p[k+28>>2]|0,f=23732+(d<<2)|0,(p[f>>2]|0)==(k|0)){if(p[f>>2]=m,!m){p[5858]=p[5858]&~(1<<d);break}}else if(g=E+16|0,p[((p[g>>2]|0)==(k|0)?g:E+20|0)>>2]=m,!m)break;p[m+24>>2]=E,d=k+16|0,f=p[d>>2]|0,f|0&&(p[m+16>>2]=f,p[f+24>>2]=m),d=p[d+4>>2]|0,d|0&&(p[m+20>>2]=d,p[d+24>>2]=m)}}while(!1);if(p[P+4>>2]=b|1,p[C+b>>2]=b,(P|0)==(p[5862]|0)){p[5859]=b;return}}if(d=b>>>3,b>>>0<256){m=23468+(d<<1<<2)|0,f=p[5857]|0,d=1<<d,f&d?(f=m+8|0,d=p[f>>2]|0):(p[5857]=f|d,d=m,f=m+8|0),p[f>>2]=P,p[d+12>>2]=P,p[P+8>>2]=d,p[P+12>>2]=m;return}d=b>>>8,d?b>>>0>16777215?g=31:(C=(d+1048320|0)>>>16&8,k=d<<C,E=(k+520192|0)>>>16&4,k=k<<E,g=(k+245760|0)>>>16&2,g=14-(E|C|g)+(k<<g>>>15)|0,g=b>>>(g+7|0)&1|g<<1):g=0,d=23732+(g<<2)|0,p[P+28>>2]=g,p[P+20>>2]=0,p[P+16>>2]=0,f=p[5858]|0,m=1<<g;e:do if(!(f&m))p[5858]=f|m,p[d>>2]=P,p[P+24>>2]=d,p[P+12>>2]=P,p[P+8>>2]=P;else{d=p[d>>2]|0;t:do if((p[d+4>>2]&-8|0)!=(b|0)){for(g=b<<((g|0)==31?0:25-(g>>>1)|0);m=d+16+(g>>>31<<2)|0,f=p[m>>2]|0,!!f;)if((p[f+4>>2]&-8|0)==(b|0)){d=f;break t}else g=g<<1,d=f;p[m>>2]=P,p[P+24>>2]=d,p[P+12>>2]=P,p[P+8>>2]=P;break e}while(!1);C=d+8|0,k=p[C>>2]|0,p[k+12>>2]=P,p[C>>2]=P,p[P+8>>2]=k,p[P+12>>2]=d,p[P+24>>2]=0}while(!1);if(k=(p[5865]|0)+-1|0,p[5865]=k,!(k|0)){for(d=23884;d=p[d>>2]|0,d;)d=d+8|0;p[5865]=-1}}}}function Fl(d,f){d=d|0,f=f|0;var m=0;return d?(m=Kt(f,d)|0,(f|d)>>>0>65535&&(m=((m>>>0)/(d>>>0)|0|0)==(f|0)?m:-1)):m=0,d=Ll(m)|0,!d||!(p[d+-4>>2]&3)||Tf(d|0,0,m|0)|0,d|0}function kn(d,f,m,g){return d=d|0,f=f|0,m=m|0,g=g|0,m=d+m>>>0,Ft(f+g+(m>>>0<d>>>0|0)>>>0|0),m|0|0}function gs(d,f,m,g){return d=d|0,f=f|0,m=m|0,g=g|0,g=f-g-(m>>>0>d>>>0|0)>>>0,Ft(g|0),d-m>>>0|0|0}function eI(d){return d=d|0,(d?31-(mn(d^d-1)|0)|0:32)|0}function cE(d,f,m,g,b){d=d|0,f=f|0,m=m|0,g=g|0,b=b|0;var E=0,C=0,P=0,k=0,U=0,q=0,te=0,he=0,pe=0,ae=0;if(q=d,k=f,U=k,C=m,he=g,P=he,!U)return E=(b|0)!=0,P?E?(p[b>>2]=d|0,p[b+4>>2]=f&0,he=0,b=0,Ft(he|0),b|0):(he=0,b=0,Ft(he|0),b|0):(E&&(p[b>>2]=(q>>>0)%(C>>>0),p[b+4>>2]=0),he=0,b=(q>>>0)/(C>>>0)>>>0,Ft(he|0),b|0);E=(P|0)==0;do if(C){if(!E){if(E=(mn(P|0)|0)-(mn(U|0)|0)|0,E>>>0<=31){te=E+1|0,P=31-E|0,f=E-31>>31,C=te,d=q>>>(te>>>0)&f|U<<P,f=U>>>(te>>>0)&f,E=0,P=q<<P;break}return b?(p[b>>2]=d|0,p[b+4>>2]=k|f&0,he=0,b=0,Ft(he|0),b|0):(he=0,b=0,Ft(he|0),b|0)}if(E=C-1|0,E&C|0){P=(mn(C|0)|0)+33-(mn(U|0)|0)|0,ae=64-P|0,te=32-P|0,k=te>>31,pe=P-32|0,f=pe>>31,C=P,d=te-1>>31&U>>>(pe>>>0)|(U<<te|q>>>(P>>>0))&f,f=f&U>>>(P>>>0),E=q<<ae&k,P=(U<<ae|q>>>(pe>>>0))&k|q<<te&P-33>>31;break}return b|0&&(p[b>>2]=E&q,p[b+4>>2]=0),(C|0)==1?(pe=k|f&0,ae=d|0|0,Ft(pe|0),ae|0):(ae=eI(C|0)|0,pe=U>>>(ae>>>0)|0,ae=U<<32-ae|q>>>(ae>>>0)|0,Ft(pe|0),ae|0)}else{if(E)return b|0&&(p[b>>2]=(U>>>0)%(C>>>0),p[b+4>>2]=0),pe=0,ae=(U>>>0)/(C>>>0)>>>0,Ft(pe|0),ae|0;if(!q)return b|0&&(p[b>>2]=0,p[b+4>>2]=(U>>>0)%(P>>>0)),pe=0,ae=(U>>>0)/(P>>>0)>>>0,Ft(pe|0),ae|0;if(E=P-1|0,!(E&P))return b|0&&(p[b>>2]=d|0,p[b+4>>2]=E&U|f&0),pe=0,ae=U>>>((eI(P|0)|0)>>>0),Ft(pe|0),ae|0;if(E=(mn(P|0)|0)-(mn(U|0)|0)|0,E>>>0<=30){f=E+1|0,P=31-E|0,C=f,d=U<<P|q>>>(f>>>0),f=U>>>(f>>>0),E=0,P=q<<P;break}return b?(p[b>>2]=d|0,p[b+4>>2]=k|f&0,pe=0,ae=0,Ft(pe|0),ae|0):(pe=0,ae=0,Ft(pe|0),ae|0)}while(!1);if(!C)U=P,k=0,P=0;else{te=m|0|0,q=he|g&0,U=kn(te|0,q|0,-1,-1)|0,m=ne()|0,k=P,P=0;do g=k,k=E>>>31|k<<1,E=P|E<<1,g=d<<1|g>>>31|0,he=d>>>31|f<<1|0,gs(U|0,m|0,g|0,he|0)|0,ae=ne()|0,pe=ae>>31|((ae|0)<0?-1:0)<<1,P=pe&1,d=gs(g|0,he|0,pe&te|0,(((ae|0)<0?-1:0)>>31|((ae|0)<0?-1:0)<<1)&q|0)|0,f=ne()|0,C=C-1|0;while(C|0);U=k,k=0}return C=0,b|0&&(p[b>>2]=d,p[b+4>>2]=f),pe=(E|0)>>>31|(U|C)<<1|(C<<1|E>>>31)&0|k,ae=(E<<1|0)&-2|P,Ft(pe|0),ae|0}function Ef(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0;return U=f>>31|((f|0)<0?-1:0)<<1,k=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,E=g>>31|((g|0)<0?-1:0)<<1,b=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,P=gs(U^d|0,k^f|0,U|0,k|0)|0,C=ne()|0,d=E^U,f=b^k,gs((cE(P,C,gs(E^m|0,b^g|0,E|0,b|0)|0,ne()|0,0)|0)^d|0,(ne()|0)^f|0,d|0,f|0)|0}function LK(d,f){d=d|0,f=f|0;var m=0,g=0,b=0,E=0;return E=d&65535,b=f&65535,m=Kt(b,E)|0,g=d>>>16,d=(m>>>16)+(Kt(b,g)|0)|0,b=f>>>16,f=Kt(b,E)|0,Ft((d>>>16)+(Kt(b,g)|0)+(((d&65535)+f|0)>>>16)|0),d+f<<16|m&65535|0|0}function vs(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0;return b=d,E=m,m=LK(b,E)|0,d=ne()|0,Ft((Kt(f,E)|0)+(Kt(g,b)|0)+d|d&0|0),m|0|0|0}function ly(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0,C=0,P=0,k=0,U=0;return b=Y,Y=Y+16|0,P=b|0,C=f>>31|((f|0)<0?-1:0)<<1,E=((f|0)<0?-1:0)>>31|((f|0)<0?-1:0)<<1,U=g>>31|((g|0)<0?-1:0)<<1,k=((g|0)<0?-1:0)>>31|((g|0)<0?-1:0)<<1,d=gs(C^d|0,E^f|0,C|0,E|0)|0,f=ne()|0,cE(d,f,gs(U^m|0,k^g|0,U|0,k|0)|0,ne()|0,P)|0,g=gs(p[P>>2]^C|0,p[P+4>>2]^E|0,C|0,E|0)|0,m=ne()|0,Y=b,Ft(m|0),g|0}function pp(d,f,m,g){d=d|0,f=f|0,m=m|0,g=g|0;var b=0,E=0;return E=Y,Y=Y+16|0,b=E|0,cE(d,f,m,g,b)|0,Y=E,Ft(p[b+4>>2]|0),p[b>>2]|0|0}function tI(d,f,m){return d=d|0,f=f|0,m=m|0,(m|0)<32?(Ft(f>>m|0),d>>>m|(f&(1<<m)-1)<<32-m):(Ft(((f|0)<0?-1:0)|0),f>>m-32|0)}function it(d,f,m){return d=d|0,f=f|0,m=m|0,(m|0)<32?(Ft(f>>>m|0),d>>>m|(f&(1<<m)-1)<<32-m):(Ft(0),f>>>m-32|0)}function vt(d,f,m){return d=d|0,f=f|0,m=m|0,(m|0)<32?(Ft(f<<m|(d&(1<<m)-1<<32-m)>>>32-m|0),d<<m):(Ft(d<<m-32|0),0)}function nI(d,f){return d=+d,f=+f,d!=d?+f:f!=f?+d:+Dn(+d,+f)}function hE(d,f){return d=+d,f=+f,d!=d?+f:f!=f?+d:+$e(+d,+f)}function uy(d){return d=+d,d>=0?+Yi(d+.5):+Qt(d-.5)}function cy(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0;if((m|0)>=8192)return Qn(d|0,f|0,m|0)|0,d|0;if(E=d|0,b=d+m|0,(d&3)==(f&3)){for(;d&3;){if(!m)return E|0;jt[d>>0]=jt[f>>0]|0,d=d+1|0,f=f+1|0,m=m-1|0}for(m=b&-4|0,g=m-64|0;(d|0)<=(g|0);)p[d>>2]=p[f>>2],p[d+4>>2]=p[f+4>>2],p[d+8>>2]=p[f+8>>2],p[d+12>>2]=p[f+12>>2],p[d+16>>2]=p[f+16>>2],p[d+20>>2]=p[f+20>>2],p[d+24>>2]=p[f+24>>2],p[d+28>>2]=p[f+28>>2],p[d+32>>2]=p[f+32>>2],p[d+36>>2]=p[f+36>>2],p[d+40>>2]=p[f+40>>2],p[d+44>>2]=p[f+44>>2],p[d+48>>2]=p[f+48>>2],p[d+52>>2]=p[f+52>>2],p[d+56>>2]=p[f+56>>2],p[d+60>>2]=p[f+60>>2],d=d+64|0,f=f+64|0;for(;(d|0)<(m|0);)p[d>>2]=p[f>>2],d=d+4|0,f=f+4|0}else for(m=b-4|0;(d|0)<(m|0);)jt[d>>0]=jt[f>>0]|0,jt[d+1>>0]=jt[f+1>>0]|0,jt[d+2>>0]=jt[f+2>>0]|0,jt[d+3>>0]=jt[f+3>>0]|0,d=d+4|0,f=f+4|0;for(;(d|0)<(b|0);)jt[d>>0]=jt[f>>0]|0,d=d+1|0,f=f+1|0;return E|0}function Tf(d,f,m){d=d|0,f=f|0,m=m|0;var g=0,b=0,E=0,C=0;if(E=d+m|0,f=f&255,(m|0)>=67){for(;d&3;)jt[d>>0]=f,d=d+1|0;for(g=E&-4|0,C=f|f<<8|f<<16|f<<24,b=g-64|0;(d|0)<=(b|0);)p[d>>2]=C,p[d+4>>2]=C,p[d+8>>2]=C,p[d+12>>2]=C,p[d+16>>2]=C,p[d+20>>2]=C,p[d+24>>2]=C,p[d+28>>2]=C,p[d+32>>2]=C,p[d+36>>2]=C,p[d+40>>2]=C,p[d+44>>2]=C,p[d+48>>2]=C,p[d+52>>2]=C,p[d+56>>2]=C,p[d+60>>2]=C,d=d+64|0;for(;(d|0)<(g|0);)p[d>>2]=C,d=d+4|0}for(;(d|0)<(E|0);)jt[d>>0]=f,d=d+1|0;return E-m|0}function iI(d){return d=+d,d>=0?+Yi(d+.5):+Qt(d-.5)}function Uc(d){d=d|0;var f=0,m=0,g=0;return g=ho()|0,m=p[Yn>>2]|0,f=m+d|0,(d|0)>0&(f|0)<(m|0)|(f|0)<0?(Gr(f|0)|0,$t(12),-1):(f|0)>(g|0)&&!(ps(f|0)|0)?($t(12),-1):(p[Yn>>2]=f,m|0)}return{___divdi3:Ef,___muldi3:vs,___remdi3:ly,___uremdi3:pp,_areNeighborCells:xQ,_bitshift64Ashr:tI,_bitshift64Lshr:it,_bitshift64Shl:vt,_calloc:Fl,_cellAreaKm2:tK,_cellAreaM2:nK,_cellAreaRads2:uE,_cellToBoundary:_m,_cellToCenterChild:FQ,_cellToChildPos:$Q,_cellToChildren:kQ,_cellToChildrenSize:ay,_cellToLatLng:ym,_cellToLocalIj:uK,_cellToParent:iE,_cellToVertex:ga,_cellToVertexes:CK,_cellsToDirectedEdge:bQ,_cellsToLinkedMultiPolygon:Kw,_childPosToCell:jQ,_compactCells:BQ,_destroyLinkedMultiPolygon:q8,_directedEdgeToBoundary:oy,_directedEdgeToCells:TQ,_edgeLengthKm:rK,_edgeLengthM:sK,_edgeLengthRads:iK,_emscripten_replace_memory:pu,_free:ln,_getBaseCellNumber:B8,_getDirectedEdgeDestination:wQ,_getDirectedEdgeOrigin:SQ,_getHexagonAreaAvgKm2:KQ,_getHexagonAreaAvgM2:ZQ,_getHexagonEdgeLengthAvgKm:JQ,_getHexagonEdgeLengthAvgM:eK,_getIcosahedronFaces:U8,_getNumCells:lE,_getPentagons:aE,_getRes0Cells:yn,_getResolution:DQ,_greatCircleDistanceKm:bm,_greatCircleDistanceM:XQ,_greatCircleDistanceRads:WQ,_gridDisk:ms,_gridDiskDistances:kc,_gridDistance:hK,_gridPathCells:dK,_gridPathCellsSize:fK,_gridRingUnsafe:Yw,_i64Add:kn,_i64Subtract:gs,_isPentagon:Ni,_isResClassIII:zQ,_isValidCell:nE,_isValidDirectedEdge:EQ,_isValidVertex:RK,_latLngToCell:O8,_llvm_maxnum_f64:nI,_llvm_minnum_f64:hE,_llvm_round_f64:uy,_localIjToCell:cK,_malloc:Ll,_maxFaceCount:qQ,_maxGridDiskSize:pa,_maxPolygonToCellsSize:ty,_memcpy:cy,_memset:Tf,_originToDirectedEdges:CQ,_pentagonCount:HQ,_polygonToCells:ny,_readInt64AsDoubleFromPointer:SK,_res0CellCount:bt,_round:iI,_sbrk:Uc,_sizeOfCellBoundary:vK,_sizeOfCoordIJ:bK,_sizeOfGeoLoop:yK,_sizeOfGeoPolygon:_K,_sizeOfH3Index:mK,_sizeOfLatLng:gK,_sizeOfLinkedGeoPolygon:xK,_uncompactCells:OQ,_uncompactCellsSize:UQ,_vertexToLatLng:MK,establishStackSpace:As,stackAlloc:fi,stackRestore:Au,stackSave:fo}}(Fe,Ve,z);e.___divdi3=Te.___divdi3,e.___muldi3=Te.___muldi3,e.___remdi3=Te.___remdi3,e.___uremdi3=Te.___uremdi3,e._areNeighborCells=Te._areNeighborCells,e._bitshift64Ashr=Te._bitshift64Ashr,e._bitshift64Lshr=Te._bitshift64Lshr,e._bitshift64Shl=Te._bitshift64Shl,e._calloc=Te._calloc,e._cellAreaKm2=Te._cellAreaKm2,e._cellAreaM2=Te._cellAreaM2,e._cellAreaRads2=Te._cellAreaRads2,e._cellToBoundary=Te._cellToBoundary,e._cellToCenterChild=Te._cellToCenterChild,e._cellToChildPos=Te._cellToChildPos,e._cellToChildren=Te._cellToChildren,e._cellToChildrenSize=Te._cellToChildrenSize,e._cellToLatLng=Te._cellToLatLng,e._cellToLocalIj=Te._cellToLocalIj,e._cellToParent=Te._cellToParent,e._cellToVertex=Te._cellToVertex,e._cellToVertexes=Te._cellToVertexes,e._cellsToDirectedEdge=Te._cellsToDirectedEdge,e._cellsToLinkedMultiPolygon=Te._cellsToLinkedMultiPolygon,e._childPosToCell=Te._childPosToCell,e._compactCells=Te._compactCells,e._destroyLinkedMultiPolygon=Te._destroyLinkedMultiPolygon,e._directedEdgeToBoundary=Te._directedEdgeToBoundary,e._directedEdgeToCells=Te._directedEdgeToCells,e._edgeLengthKm=Te._edgeLengthKm,e._edgeLengthM=Te._edgeLengthM,e._edgeLengthRads=Te._edgeLengthRads;var Ye=e._emscripten_replace_memory=Te._emscripten_replace_memory;e._free=Te._free,e._getBaseCellNumber=Te._getBaseCellNumber,e._getDirectedEdgeDestination=Te._getDirectedEdgeDestination,e._getDirectedEdgeOrigin=Te._getDirectedEdgeOrigin,e._getHexagonAreaAvgKm2=Te._getHexagonAreaAvgKm2,e._getHexagonAreaAvgM2=Te._getHexagonAreaAvgM2,e._getHexagonEdgeLengthAvgKm=Te._getHexagonEdgeLengthAvgKm,e._getHexagonEdgeLengthAvgM=Te._getHexagonEdgeLengthAvgM,e._getIcosahedronFaces=Te._getIcosahedronFaces,e._getNumCells=Te._getNumCells,e._getPentagons=Te._getPentagons,e._getRes0Cells=Te._getRes0Cells,e._getResolution=Te._getResolution,e._greatCircleDistanceKm=Te._greatCircleDistanceKm,e._greatCircleDistanceM=Te._greatCircleDistanceM,e._greatCircleDistanceRads=Te._greatCircleDistanceRads,e._gridDisk=Te._gridDisk,e._gridDiskDistances=Te._gridDiskDistances,e._gridDistance=Te._gridDistance,e._gridPathCells=Te._gridPathCells,e._gridPathCellsSize=Te._gridPathCellsSize,e._gridRingUnsafe=Te._gridRingUnsafe,e._i64Add=Te._i64Add,e._i64Subtract=Te._i64Subtract,e._isPentagon=Te._isPentagon,e._isResClassIII=Te._isResClassIII,e._isValidCell=Te._isValidCell,e._isValidDirectedEdge=Te._isValidDirectedEdge,e._isValidVertex=Te._isValidVertex,e._latLngToCell=Te._latLngToCell,e._llvm_maxnum_f64=Te._llvm_maxnum_f64,e._llvm_minnum_f64=Te._llvm_minnum_f64,e._llvm_round_f64=Te._llvm_round_f64,e._localIjToCell=Te._localIjToCell,e._malloc=Te._malloc,e._maxFaceCount=Te._maxFaceCount,e._maxGridDiskSize=Te._maxGridDiskSize,e._maxPolygonToCellsSize=Te._maxPolygonToCellsSize,e._memcpy=Te._memcpy,e._memset=Te._memset,e._originToDirectedEdges=Te._originToDirectedEdges,e._pentagonCount=Te._pentagonCount,e._polygonToCells=Te._polygonToCells,e._readInt64AsDoubleFromPointer=Te._readInt64AsDoubleFromPointer,e._res0CellCount=Te._res0CellCount,e._round=Te._round,e._sbrk=Te._sbrk,e._sizeOfCellBoundary=Te._sizeOfCellBoundary,e._sizeOfCoordIJ=Te._sizeOfCoordIJ,e._sizeOfGeoLoop=Te._sizeOfGeoLoop,e._sizeOfGeoPolygon=Te._sizeOfGeoPolygon,e._sizeOfH3Index=Te._sizeOfH3Index,e._sizeOfLatLng=Te._sizeOfLatLng,e._sizeOfLinkedGeoPolygon=Te._sizeOfLinkedGeoPolygon,e._uncompactCells=Te._uncompactCells,e._uncompactCellsSize=Te._uncompactCellsSize,e._vertexToLatLng=Te._vertexToLatLng,e.establishStackSpace=Te.establishStackSpace;var an=e.stackAlloc=Te.stackAlloc,bi=e.stackRestore=Te.stackRestore,yr=e.stackSave=Te.stackSave;if(e.asm=Te,e.cwrap=R,e.setValue=v,e.getValue=_,re){Ne(re)||(re=s(re));{Yt();var Fn=function(Re){Re.byteLength&&(Re=new Uint8Array(Re)),j.set(Re,A),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,Nt()},Xi=function(){o(re,Fn,function(){throw"could not load memory initializer "+re})},lo=ft(re);if(lo)Fn(lo.buffer);else if(e.memoryInitializerRequest){var Ga=function(){var Re=e.memoryInitializerRequest,We=Re.response;if(Re.status!==200&&Re.status!==0){var dt=ft(e.memoryInitializerRequestURL);if(dt)We=dt.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Re.status+", retrying "+re),Xi();return}}Fn(We)};e.memoryInitializerRequest.response?setTimeout(Ga,0):e.memoryInitializerRequest.addEventListener("load",Ga)}else Xi()}}var Vo;ht=function Re(){Vo||uo(),Vo||(ht=Re)};function uo(Re){if(xt>0||(tt(),xt>0))return;function We(){Vo||(Vo=!0,!S&&(Ot(),Ht(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Ct()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),We()},1)):We()}e.run=uo;function co(Re){throw e.onAbort&&e.onAbort(Re),Re+="",a(Re),l(Re),S=!0,"abort("+Re+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=co,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return uo(),n}(typeof Hn=="object"?Hn:{}),Sn="number",rn=Sn,qm=Sn,cn=Sn,hn=Sn,ws=Sn,Gt=Sn,LAe=[["sizeOfH3Index",Sn],["sizeOfLatLng",Sn],["sizeOfCellBoundary",Sn],["sizeOfGeoLoop",Sn],["sizeOfGeoPolygon",Sn],["sizeOfLinkedGeoPolygon",Sn],["sizeOfCoordIJ",Sn],["readInt64AsDoubleFromPointer",Sn],["isValidCell",qm,[cn,hn]],["latLngToCell",rn,[Sn,Sn,ws,Gt]],["cellToLatLng",rn,[cn,hn,Gt]],["cellToBoundary",rn,[cn,hn,Gt]],["maxGridDiskSize",rn,[Sn,Gt]],["gridDisk",rn,[cn,hn,Sn,Gt]],["gridDiskDistances",rn,[cn,hn,Sn,Gt,Gt]],["gridRingUnsafe",rn,[cn,hn,Sn,Gt]],["maxPolygonToCellsSize",rn,[Gt,ws,Sn,Gt]],["polygonToCells",rn,[Gt,ws,Sn,Gt]],["cellsToLinkedMultiPolygon",rn,[Gt,Sn,Gt]],["destroyLinkedMultiPolygon",null,[Gt]],["compactCells",rn,[Gt,Gt,Sn,Sn]],["uncompactCells",rn,[Gt,Sn,Sn,Gt,Sn,ws]],["uncompactCellsSize",rn,[Gt,Sn,Sn,ws,Gt]],["isPentagon",qm,[cn,hn]],["isResClassIII",qm,[cn,hn]],["getBaseCellNumber",Sn,[cn,hn]],["getResolution",Sn,[cn,hn]],["maxFaceCount",rn,[cn,hn,Gt]],["getIcosahedronFaces",rn,[cn,hn,Gt]],["cellToParent",rn,[cn,hn,ws,Gt]],["cellToChildren",rn,[cn,hn,ws,Gt]],["cellToCenterChild",rn,[cn,hn,ws,Gt]],["cellToChildrenSize",rn,[cn,hn,ws,Gt]],["cellToChildPos",rn,[cn,hn,ws,Gt]],["childPosToCell",rn,[Sn,Sn,cn,hn,ws,Gt]],["areNeighborCells",rn,[cn,hn,cn,hn,Gt]],["cellsToDirectedEdge",rn,[cn,hn,cn,hn,Gt]],["getDirectedEdgeOrigin",rn,[cn,hn,Gt]],["getDirectedEdgeDestination",rn,[cn,hn,Gt]],["isValidDirectedEdge",qm,[cn,hn]],["directedEdgeToCells",rn,[cn,hn,Gt]],["originToDirectedEdges",rn,[cn,hn,Gt]],["directedEdgeToBoundary",rn,[cn,hn,Gt]],["gridDistance",rn,[cn,hn,cn,hn,Gt]],["gridPathCells",rn,[cn,hn,cn,hn,Gt]],["gridPathCellsSize",rn,[cn,hn,cn,hn,Gt]],["cellToLocalIj",rn,[cn,hn,cn,hn,Sn,Gt]],["localIjToCell",rn,[cn,hn,Gt,Sn,Gt]],["getHexagonAreaAvgM2",rn,[ws,Gt]],["getHexagonAreaAvgKm2",rn,[ws,Gt]],["getHexagonEdgeLengthAvgM",rn,[ws,Gt]],["getHexagonEdgeLengthAvgKm",rn,[ws,Gt]],["greatCircleDistanceM",Sn,[Gt,Gt]],["greatCircleDistanceKm",Sn,[Gt,Gt]],["greatCircleDistanceRads",Sn,[Gt,Gt]],["cellAreaM2",rn,[cn,hn,Gt]],["cellAreaKm2",rn,[cn,hn,Gt]],["cellAreaRads2",rn,[cn,hn,Gt]],["edgeLengthM",rn,[cn,hn,Gt]],["edgeLengthKm",rn,[cn,hn,Gt]],["edgeLengthRads",rn,[cn,hn,Gt]],["getNumCells",rn,[ws,Gt]],["getRes0Cells",rn,[Gt]],["res0CellCount",Sn],["getPentagons",rn,[Sn,Gt]],["pentagonCount",Sn],["cellToVertex",rn,[cn,hn,Sn,Gt]],["cellToVertexes",rn,[cn,hn,Gt]],["vertexToLatLng",rn,[cn,hn,Gt]],["isValidVertex",qm,[cn,hn]]],FAe=0,BAe=1,OAe=2,UAe=3,cq=4,zAe=5,VAe=6,GAe=7,qAe=8,HAe=9,$Ae=10,jAe=11,WAe=12,XAe=13,YAe=14,QAe=15,fs={};fs[FAe]="Success";fs[BAe]="The operation failed but a more specific error is not available";fs[OAe]="Argument was outside of acceptable range";fs[UAe]="Latitude or longitude arguments were outside of acceptable range";fs[cq]="Resolution argument was outside of acceptable range";fs[zAe]="Cell argument was not valid";fs[VAe]="Directed edge argument was not valid";fs[GAe]="Undirected edge argument was not valid";fs[qAe]="Vertex argument was not valid";fs[HAe]="Pentagon distortion was encountered";fs[$Ae]="Duplicate input";fs[jAe]="Cell arguments were not neighbors";fs[WAe]="Cell arguments had incompatible resolutions";fs[XAe]="Memory allocation failed";fs[YAe]="Bounds of provided memory were insufficient";fs[QAe]="Mode or flags argument was not valid";var KAe=1e3,hq=1001,fq=1002,rw={};rw[KAe]="Unknown unit";rw[hq]="Array length out of bounds";rw[fq]="Got unexpected null value for H3 index";var ZAe="Unknown error";function dq(n,e,t){var i=t&&"value"in t,r=new Error((n[e]||ZAe)+" (code: "+e+(i?", value: "+t.value:"")+")");return r.code=e,r}function pq(n,e){var t=arguments.length===2?{value:e}:{};return dq(fs,n,t)}function Aq(n,e){var t=arguments.length===2?{value:e}:{};return dq(rw,n,t)}function B1(n){if(n!==0)throw pq(n)}var Lo={};LAe.forEach(function(e){Lo[e[0]]=Hn.cwrap.apply(Hn,e)});var TA=16,O1=4,R0=8,JAe=8,bb=Lo.sizeOfH3Index(),_6=Lo.sizeOfLatLng(),e0e=Lo.sizeOfCellBoundary(),t0e=Lo.sizeOfGeoPolygon(),Vg=Lo.sizeOfGeoLoop();Lo.sizeOfLinkedGeoPolygon();Lo.sizeOfCoordIJ();function n0e(n){if(typeof n!="number"||n<0||n>15||Math.floor(n)!==n)throw pq(cq,n);return n}function i0e(n){if(!n)throw Aq(fq);return n}var r0e=Math.pow(2,32)-1;function s0e(n){if(n>r0e)throw Aq(hq,n);return n}var o0e=/[^0-9a-fA-F]/;function mq(n){if(Array.isArray(n)&&n.length===2&&Number.isInteger(n[0])&&Number.isInteger(n[1]))return n;if(typeof n!="string"||o0e.test(n))return[0,0];var e=parseInt(n.substring(0,n.length-8),TA),t=parseInt(n.substring(n.length-8),TA);return[t,e]}function TF(n){if(n>=0)return n.toString(TA);n=n&2147483647;var e=gq(8,n.toString(TA)),t=(parseInt(e[0],TA)+8).toString(TA);return e=t+e.substring(1),e}function a0e(n,e){return TF(e)+gq(8,TF(n))}function gq(n,e){for(var t=n-e.length,i="",r=0;r<t;r++)i+="0";return i=i+e,i}function CF(n,e,t){for(var i=n.length,r=Hn._calloc(i,_6),s=t?1:0,o=t?0:1,a=0;a<i*2;a+=2)Hn.HEAPF64.set([n[a/2][s],n[a/2][o]].map(xq),r/R0+a);return Hn.HEAPU32.set([i,r],e/O1),e}function l0e(n,e){var t=n.length-1,i=Hn._calloc(t0e),r=0,s=r+Vg,o=s+O1;CF(n[0],i+r,e);var a;if(t>0){a=Hn._calloc(t,Vg);for(var l=0;l<t;l++)CF(n[l+1],a+Vg*l,e)}return Hn.setValue(i+s,t,"i32"),Hn.setValue(i+o,a,"i32"),i}function u0e(n){var e=0,t=e+Vg,i=t+O1,r=O1;Hn._free(Hn.getValue(n+e+r,"i8*"));var s=Hn.getValue(n+t,"i32");if(s>0){for(var o=Hn.getValue(n+i,"i32"),a=0;a<s;a++)Hn._free(Hn.getValue(o+Vg*a+r,"i8*"));Hn._free(o)}Hn._free(n)}function vq(n,e){e===void 0&&(e=0);var t=Hn.getValue(n+bb*e,"i32"),i=Hn.getValue(n+bb*e+O1,"i32");return i?a0e(t,i):null}function c0e(n){return Lo.readInt64AsDoubleFromPointer(n)}function h0e(n,e){for(var t=[],i=0;i<e;i++){var r=vq(n,i);r!==null&&t.push(r)}return t}function Sb(n){return m0e(Hn.getValue(n,"double"))}function f0e(n){return[Sb(n),Sb(n+R0)]}function d0e(n){return[Sb(n+R0),Sb(n)]}function p0e(n,e,t){for(var i=Hn.getValue(n,"i32"),r=n+R0,s=[],o=d0e,a=0;a<i*2;a+=2)s.push(o(r+R0*a));return s.push(s[0]),s}function A0e(n,e,t){var i=Hn._malloc(_6);Hn.HEAPF64.set([n,e].map(xq),i/R0);var r=Hn._malloc(bb);try{return B1(Lo.latLngToCell(i,t,r)),i0e(vq(r))}finally{Hn._free(r),Hn._free(i)}}function yq(n){var e=Hn._malloc(_6),t=mq(n),i=t[0],r=t[1];try{return B1(Lo.cellToLatLng(i,r,e)),f0e(e)}finally{Hn._free(e)}}function _q(n,e){var t=Hn._malloc(e0e),i=mq(n),r=i[0],s=i[1];try{return B1(Lo.cellToBoundary(r,s,t)),p0e(t,e,e)}finally{Hn._free(t)}}function MF(n,e,t){if(n0e(e),t=!!t,n.length===0||n[0].length===0)return[];var i=typeof n[0][0]=="number"?[n]:n,r=l0e(i,t),s=Hn._malloc(JAe);try{B1(Lo.maxPolygonToCellsSize(r,e,0,s));var o=s0e(c0e(s)),a=Hn._calloc(o,bb);try{return B1(Lo.polygonToCells(r,e,0,a)),h0e(a,o)}finally{Hn._free(a)}}finally{Hn._free(s),u0e(r)}}function xq(n){return n*Math.PI/180}function m0e(n){return n*180/Math.PI}function g0e(n){return n=Math.max(0,Math.min(1,n)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+n*(1172.33-n*(10793.56-n*(33300.12-n*(38394.49-n*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+n*(557.33+n*(1225.33-n*(3574.96-n*(1073.77+n*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+n*(3211.1-n*(15327.97-n*(27814-n*(22569.18-n*6838.66)))))))+")"}var bq=Sq;function Sq(n,e,t,i){this.x=typeof n=="number"?n:0,this.y=typeof e=="number"?e:0,this.z=typeof t=="number"?t:0,this.half=typeof i=="number"?i:0}Sq.prototype.contains=function(e,t,i){var r=this.half;return this.x-r<=e&&e<this.x+r&&this.y-r<=t&&t<this.y+r&&this.z-r<=i&&i<this.z+r};var Wc=bq,v0e=4,y0e=ba;function ba(n){this.bounds=n,this.q0=null,this.q1=null,this.q2=null,this.q3=null,this.q4=null,this.q5=null,this.q6=null,this.q7=null,this.items=null}ba.prototype.subdivide=function(){var e=this.bounds,t=e.half/2;this.q0=new ba(new Wc(e.x-t,e.y-t,e.z-t,t)),this.q1=new ba(new Wc(e.x+t,e.y-t,e.z-t,t)),this.q2=new ba(new Wc(e.x-t,e.y+t,e.z-t,t)),this.q3=new ba(new Wc(e.x+t,e.y+t,e.z-t,t)),this.q4=new ba(new Wc(e.x-t,e.y-t,e.z+t,t)),this.q5=new ba(new Wc(e.x+t,e.y-t,e.z+t,t)),this.q6=new ba(new Wc(e.x-t,e.y+t,e.z+t,t)),this.q7=new ba(new Wc(e.x+t,e.y+t,e.z+t,t))};ba.prototype.insert=function(e,t,i){var r=this.q0===null;if(r){if(this.items===null?this.items=[e]:this.items.push(e),this.items.length>=v0e&&i<16){this.subdivide();for(var s=0;s<this.items.length;++s)this.insert(this.items[s],t,i+1);this.items=null}}else{var o=t[e],a=t[e+1],l=t[e+2],u=this.bounds,c=0;o>u.x&&(c+=1),a>u.y&&(c+=2),l>u.z&&(c+=4);var h=_0e(this,c);h.insert(e,t,i+1)}};ba.prototype.query=function(e,t,i,r){if(i(this.bounds)){var s=this.items,o=typeof r=="function";if(s)for(var a=0;a<s.length;++a){var l=s[a];o?r(t[l],t[l+1],t[l+2])&&e.push(l):e.push(l)}this.q0&&(this.q0.query(e,t,i,r),this.q1.query(e,t,i,r),this.q2.query(e,t,i,r),this.q3.query(e,t,i,r),this.q4.query(e,t,i,r),this.q5.query(e,t,i,r),this.q6.query(e,t,i,r),this.q7.query(e,t,i,r))}};function _0e(n,e){if(e===0)return n.q0;if(e===1)return n.q1;if(e===2)return n.q2;if(e===3)return n.q3;if(e===4)return n.q4;if(e===5)return n.q5;if(e===6)return n.q6;if(e===7)return n.q7}var x0e=b0e;function b0e(n,e,t,i){var r=0,s=0;i=i||{};var o=i.step||1,a=i.maxTimeMS||8,l=i.probeElements||5e3;setTimeout(u,0);function u(){var c=Math.min(n.length,r+l),h=r,A=new Date;for(h=r;h<c;h+=o)e(n[h],h,n);h<n.length?(s+=new Date-A,r=h,l=Math.round(r*a/s),setTimeout(u,0)):t(n)}}var uR=bq,RF=y0e,S0e=new uR,w0e=x0e,E0e=T0e;function T0e(n){var e=[],t,i,r={initAsync:c,init:u,bounds:A,intersectRay:l,intersectSphere:o,getRoot:s};return r;function s(){return t}function o(_,S,w,x){if(!t)return e;var M=[],R=x*x;return t.query(M,i,N,B),M;function N(T){var D=R,F=T.half;return _<T.x-F?D-=a(_-(T.x-F)):_>T.x+F&&(D-=a(_-(T.x+F))),S<T.y-F?D-=a(S-(T.y-F)):S>T.y+F&&(D-=a(S-(T.y+F))),w<T.z-F?D-=a(w-(T.z-F)):w>T.z+F&&(D-=a(w-(T.z+F))),D>0}function B(T,D,F){return a(T-_)+a(D-S)+a(F-w)<R}}function a(_){return _*_}function l(_,S,w,x){if(!t)return e;w===void 0&&(w=0),x===void 0&&(x=Number.POSITIVE_INFINITY),w*=w,x*=x;var M=[];return t.query(M,i,R,N),M.sort(B);function R(T){var D=T.half,F=(T.x-D-_.x)/S.x,L=(T.x+D-_.x)/S.x,O=(T.y+D-_.y)/S.y,z=(T.y-D-_.y)/S.y,Q=(T.z-D-_.z)/S.z,j=(T.z+D-_.z)/S.z,ee=Math.min(Math.min(Math.max(F,L),Math.max(O,z)),Math.max(Q,j)),$;return ee<0?!1:($=Math.max(Math.max(Math.min(F,L),Math.min(O,z)),Math.min(Q,j)),$<=ee&&$<=x)}function N(T,D,F){var L=(T-_.x)*(T-_.x)+(D-_.y)*(D-_.y)+(F-_.z)*(F-_.z);return w<=L&&L<=x}function B(T,D){var F=_[T],L=_[T+1],O=_[T+2],z=(F-_.x)*(F-_.x)+(L-_.y)*(L-_.y)+(O-_.z)*(O-_.z),Q=_[D],j=_[D+1],ee=_[D+2],$=(Q-_.x)*(Q-_.x)+(j-_.y)*(j-_.y)+(ee-_.z)*(ee-_.z);return z-$}}function u(_){h(_),i=_,t=v(_);for(var S=0;S<_.length;S+=3)t.insert(S,i,0)}function c(_,S){h(_);var w=v(_);w0e(_,x,M,{step:3});function x(R,N){w.insert(N,_,0)}function M(){i=_,t=w,typeof S=="function"&&S(r)}}function h(_){if(!_)throw new Error("Points array is required for quadtree to work");if(typeof _.length!="number")throw new Error("Points should be array-like object");if(_.length%3!==0)throw new Error("Points array should consist of series of x,y,z coordinates and be multiple of 3")}function A(){return t?t.bounds:S0e}function v(_){if(_.length===0){var S=new uR;return new RF(S)}for(var w=Number.POSITIVE_INFINITY,x=Number.POSITIVE_INFINITY,M=Number.POSITIVE_INFINITY,R=Number.NEGATIVE_INFINITY,N=Number.NEGATIVE_INFINITY,B=Number.NEGATIVE_INFINITY,T=0;T<_.length;T+=3){var D=_[T],F=_[T+1],L=_[T+2];D<w&&(w=D),D>R&&(R=D),F<x&&(x=F),F>N&&(N=F),L<M&&(M=L),L>B&&(B=L)}var O=Math.max(Math.max(R-w,N-x),B-M);O+=2,w-=1,x-=1,M-=1;var z=O/2,Q=new uR(w+z,x+z,M+z,z);return new RF(Q)}}const C0e=G0(E0e),PF=new Cc,v_=new le;class wq extends Oue{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],i=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(i),this.setAttribute("position",new si(e,3)),this.setAttribute("uv",new si(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new u4(t,6,1);return this.setAttribute("instanceStart",new fd(i,3,0)),this.setAttribute("instanceEnd",new fd(i,3,3)),this.instanceCount=this.attributes.instanceStart.count,this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new u4(t,6,1);return this.setAttribute("instanceColorStart",new fd(i,3,0)),this.setAttribute("instanceColorEnd",new fd(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Rue(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Cc);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),PF.setFromBufferAttribute(t),this.boundingBox.union(PF))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Y0),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)v_.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(v_)),v_.fromBufferAttribute(t,s),r=Math.max(r,i.distanceToSquared(v_));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}Et.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new rt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};xo.line={uniforms:YS.merge([Et.common,Et.fog,Et.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};class x6 extends ko{static get type(){return"LineMaterial"}constructor(e){super({uniforms:YS.clone(xo.line.uniforms),vertexShader:xo.line.vertexShader,fragmentShader:xo.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){e===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){e===!0!==this.dashed&&(this.needsUpdate=!0),e===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(e===!0!==this.alphaToCoverage&&(this.needsUpdate=!0),e===!0?this.defines.USE_ALPHA_TO_COVERAGE="":delete this.defines.USE_ALPHA_TO_COVERAGE)}}const N3=new Ui,NF=new le,IF=new le,Zr=new Ui,Jr=new Ui,Ol=new Ui,I3=new le,D3=new ki,is=new zue,DF=new le,y_=new Cc,__=new Y0,Ul=new Ui;let Hl,Sd;function kF(n,e,t){return Ul.set(0,0,-e,1).applyMatrix4(n.projectionMatrix),Ul.multiplyScalar(1/Ul.w),Ul.x=Sd/t.width,Ul.y=Sd/t.height,Ul.applyMatrix4(n.projectionMatrixInverse),Ul.multiplyScalar(1/Ul.w),Math.abs(Math.max(Ul.x,Ul.y))}function M0e(n,e){const t=n.matrixWorld,i=n.geometry,r=i.attributes.instanceStart,s=i.attributes.instanceEnd,o=Math.min(i.instanceCount,r.count);for(let a=0,l=o;a<l;a++){is.start.fromBufferAttribute(r,a),is.end.fromBufferAttribute(s,a),is.applyMatrix4(t);const u=new le,c=new le;Hl.distanceSqToSegment(is.start,is.end,c,u),c.distanceTo(u)<Sd*.5&&e.push({point:c,pointOnLine:u,distance:Hl.origin.distanceTo(c),object:n,face:null,faceIndex:a,uv:null,uv1:null})}}function R0e(n,e,t){const i=e.projectionMatrix,s=n.material.resolution,o=n.matrixWorld,a=n.geometry,l=a.attributes.instanceStart,u=a.attributes.instanceEnd,c=Math.min(a.instanceCount,l.count),h=-e.near;Hl.at(1,Ol),Ol.w=1,Ol.applyMatrix4(e.matrixWorldInverse),Ol.applyMatrix4(i),Ol.multiplyScalar(1/Ol.w),Ol.x*=s.x/2,Ol.y*=s.y/2,Ol.z=0,I3.copy(Ol),D3.multiplyMatrices(e.matrixWorldInverse,o);for(let A=0,v=c;A<v;A++){if(Zr.fromBufferAttribute(l,A),Jr.fromBufferAttribute(u,A),Zr.w=1,Jr.w=1,Zr.applyMatrix4(D3),Jr.applyMatrix4(D3),Zr.z>h&&Jr.z>h)continue;if(Zr.z>h){const R=Zr.z-Jr.z,N=(Zr.z-h)/R;Zr.lerp(Jr,N)}else if(Jr.z>h){const R=Jr.z-Zr.z,N=(Jr.z-h)/R;Jr.lerp(Zr,N)}Zr.applyMatrix4(i),Jr.applyMatrix4(i),Zr.multiplyScalar(1/Zr.w),Jr.multiplyScalar(1/Jr.w),Zr.x*=s.x/2,Zr.y*=s.y/2,Jr.x*=s.x/2,Jr.y*=s.y/2,is.start.copy(Zr),is.start.z=0,is.end.copy(Jr),is.end.z=0;const S=is.closestPointToPointParameter(I3,!0);is.at(S,DF);const w=Fx.lerp(Zr.z,Jr.z,S),x=w>=-1&&w<=1,M=I3.distanceTo(DF)<Sd*.5;if(x&&M){is.start.fromBufferAttribute(l,A),is.end.fromBufferAttribute(u,A),is.start.applyMatrix4(o),is.end.applyMatrix4(o);const R=new le,N=new le;Hl.distanceSqToSegment(is.start,is.end,N,R),t.push({point:N,pointOnLine:R,distance:Hl.origin.distanceTo(N),object:n,face:null,faceIndex:A,uv:null,uv1:null})}}}class P0e extends rr{constructor(e=new wq,t=new x6({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let o=0,a=0,l=t.count;o<l;o++,a+=2)NF.fromBufferAttribute(t,o),IF.fromBufferAttribute(i,o),r[a]=a===0?0:r[a-1],r[a+1]=r[a]+NF.distanceTo(IF);const s=new u4(r,2,1);return e.setAttribute("instanceDistanceStart",new fd(s,1,0)),e.setAttribute("instanceDistanceEnd",new fd(s,1,1)),this}raycast(e,t){const i=this.material.worldUnits,r=e.camera;r===null&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Hl=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;Sd=l.linewidth+s,a.boundingSphere===null&&a.computeBoundingSphere(),__.copy(a.boundingSphere).applyMatrix4(o);let u;if(i)u=Sd*.5;else{const h=Math.max(r.near,__.distanceToPoint(Hl.origin));u=kF(r,h,l.resolution)}if(__.radius+=u,Hl.intersectsSphere(__)===!1)return;a.boundingBox===null&&a.computeBoundingBox(),y_.copy(a.boundingBox).applyMatrix4(o);let c;if(i)c=Sd*.5;else{const h=Math.max(r.near,y_.distanceToPoint(Hl.origin));c=kF(r,h,l.resolution)}y_.expandByScalar(c),Hl.intersectsBox(y_)!==!1&&(i?M0e(this,t):R0e(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(N3),this.material.uniforms.resolution.value.set(N3.z,N3.w))}}class Eq extends wq{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let r=0;r<t;r+=3)i[2*r]=e[r],i[2*r+1]=e[r+1],i[2*r+2]=e[r+2],i[2*r+3]=e[r+3],i[2*r+4]=e[r+4],i[2*r+5]=e[r+5];return super.setColors(i),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class N0e extends P0e{constructor(e=new Eq,t=new x6({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}class LF extends e6{constructor(e,t={}){const i=t.font;if(i===void 0)super();else{const r=i.generateShapes(e,t.size);t.depth===void 0&&t.height!==void 0&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),t.depth=t.depth!==void 0?t.depth:t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class I0e{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=D0e(e,t,this.data);for(let s=0,o=r.length;s<o;s++)i.push(...r[s].toShapes());return i}}function D0e(n,e,t){const i=Array.from(n),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,o=[];let a=0,l=0;for(let u=0;u<i.length;u++){const c=i[u];if(c===`
`)a=0,l-=s;else{const h=k0e(c,r,a,l,t);a+=h.offsetX,o.push(h.path)}}return o}function k0e(n,e,t,i,r){const s=r.glyphs[n]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+n+'" does not exists in font family '+r.familyName+".");return}const o=new Vue;let a,l,u,c,h,A,v,_;if(s.o){const S=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let w=0,x=S.length;w<x;)switch(S[w++]){case"m":a=S[w++]*e+t,l=S[w++]*e+i,o.moveTo(a,l);break;case"l":a=S[w++]*e+t,l=S[w++]*e+i,o.lineTo(a,l);break;case"q":u=S[w++]*e+t,c=S[w++]*e+i,h=S[w++]*e+t,A=S[w++]*e+i,o.quadraticCurveTo(h,A,u,c);break;case"b":u=S[w++]*e+t,c=S[w++]*e+i,h=S[w++]*e+t,A=S[w++]*e+i,v=S[w++]*e+t,_=S[w++]*e+i,o.bezierCurveTo(h,A,v,_,u,c);break}}return{offsetX:s.ha*e,path:o}}function cR(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function L0e(n){if(Array.isArray(n))return n}function F0e(n){if(Array.isArray(n))return cR(n)}function b6(n,e,t){if(typeof n=="function"?n===e:n.has(e))return arguments.length<3?e:t;throw new TypeError("Private element is not present on this object")}function B0e(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Tq(n,e,t){return e=wb(e),j0e(n,E6()?Reflect.construct(e,t||[],wb(n).constructor):e.apply(n,t))}function Cq(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S6(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function x_(n,e){return n.get(b6(n,e))}function k3(n,e,t){Cq(n,e),e.set(n,t)}function L3(n,e,t){return n.set(b6(n,e),t),t}function O0e(n,e){Cq(n,e),e.add(n)}function Mq(n,e,t){if(E6())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(n.bind.apply(n,i));return r}function U0e(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,Pq(i.key),i)}}function w6(n,e,t){return e&&U0e(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function Os(n,e,t){return(e=Pq(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wb(n){return wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wb(n)}function Rq(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&hR(n,e)}function E6(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(E6=function(){return!!n})()}function z0e(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function V0e(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function G0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q0e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FF(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function di(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?FF(Object(t),!0).forEach(function(i){Os(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):FF(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function H0e(n,e){if(n==null)return{};var t,i,r=$0e(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function $0e(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function j0e(n,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B0e(n)}function hR(n,e){return hR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t},hR(n,e)}function Mr(n,e){return L0e(n)||V0e(n,e)||Nq(n,e)||G0e()}function Ai(n){return F0e(n)||z0e(n)||Nq(n)||q0e()}function W0e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Pq(n){var e=W0e(n,"string");return typeof e=="symbol"?e:e+""}function Nq(n,e){if(n){if(typeof n=="string")return cR(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?cR(n,e):void 0}}var Iq=function(e){e instanceof Array?e.forEach(Iq):(e.map&&e.map.dispose(),e.dispose())},T6=function(e){e.geometry&&e.geometry.dispose(),e.material&&Iq(e.material),e.texture&&e.texture.dispose(),e.children&&e.children.forEach(T6)},$i=function(e){if(e&&e.children)for(;e.children.length;){var t=e.children[0];e.remove(t),T6(t)}};function Uo(n,e){var t=new e;return{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[n][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[n],a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var c=o[r].apply(o,l);return c===o?this:c}}}}var mr=100;function BF(){return mr}function Fo(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=(90-n)*Math.PI/180,r=(90-e)*Math.PI/180,s=mr*(1+t);return{x:s*Math.sin(i)*Math.cos(r),y:s*Math.cos(i),z:s*Math.sin(i)*Math.sin(r)}}function Dq(n){var e=n.x,t=n.y,i=n.z,r=Math.sqrt(e*e+t*t+i*i),s=Math.acos(t/r),o=Math.atan2(i,e);return{lat:90-s*180/Math.PI,lng:90-o*180/Math.PI-(o<-Math.PI/2?360:0),altitude:r/mr-1}}function ed(n){return n*Math.PI/180}var U1=window.THREE?window.THREE:{BackSide:Ds,BufferAttribute:Qr,Color:fn,Mesh:rr,ShaderMaterial:ko},X0e=`
uniform vec3 color;
uniform float coefficient;
uniform float power;
varying vec3 vVertexNormal;
varying vec3 vVertexWorldPosition;
void main() {
  vec3 worldCameraToVertex = vVertexWorldPosition - cameraPosition;
  vec3 viewCameraToVertex	= (viewMatrix * vec4(worldCameraToVertex, 0.0)).xyz;
  viewCameraToVertex = normalize(viewCameraToVertex);
  float intensity	= pow(
    coefficient + dot(vVertexNormal, viewCameraToVertex),
    power
  );
  gl_FragColor = vec4(color, intensity);
}`,Y0e=`
varying vec3 vVertexWorldPosition;
varying vec3 vVertexNormal;
void main() {
  vVertexNormal	= normalize(normalMatrix * normal);
  vVertexWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
  gl_Position	= projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,Q0e={backside:!0,coefficient:.5,color:"gold",size:2,power:1};function K0e(n,e,t){return new U1.ShaderMaterial({depthWrite:!1,fragmentShader:X0e,transparent:!0,uniforms:{coefficient:{value:n},color:{value:new U1.Color(e)},power:{value:t}},vertexShader:Y0e})}function Z0e(n,e){for(var t=n.clone(),i=new Float32Array(n.attributes.position.count*3),r=0,s=i.length;r<s;r++){var o=n.attributes.normal.array[r],a=n.attributes.position.array[r];i[r]=a+o*e}return t.setAttribute("position",new U1.BufferAttribute(i,3)),t}function J0e(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Q0e,t=e.backside,i=e.coefficient,r=e.color,s=e.size,o=e.power,a=Z0e(n,s),l=K0e(i,r,o);return t&&(l.side=U1.BackSide),new U1.Mesh(a,l)}var Su=window.THREE?window.THREE:{Color:fn,LineBasicMaterial:ZS,LineSegments:ZV,Mesh:rr,MeshPhongMaterial:Pue,SphereGeometry:Ev,SRGBColorSpace:vo,TextureLoader:lG},kq=hs({props:{globeImageUrl:{},bumpImageUrl:{},showGlobe:{default:!0,onChange:function(e,t){t.globeObj.visible=!!e},triggerUpdate:!1},showGraticules:{default:!1,onChange:function(e,t){t.graticulesObj.visible=!!e},triggerUpdate:!1},showAtmosphere:{default:!0,onChange:function(e,t){t.atmosphereObj&&(t.atmosphereObj.visible=!!e)},triggerUpdate:!1},atmosphereColor:{default:"lightskyblue"},atmosphereAltitude:{default:.15},onReady:{default:function(){},triggerUpdate:!1}},methods:{globeMaterial:function(e,t){return t!==void 0?(e.globeObj.material=t||e.defaultGlobeMaterial,this):e.globeObj.material},_destructor:function(e){$i(e.globeObj),$i(e.graticulesObj)}},stateInit:function(){var e=new Su.SphereGeometry(mr,75,75),t=new Su.MeshPhongMaterial({color:0}),i=new Su.Mesh(e,t);i.rotation.y=-Math.PI/2,i.__globeObjType="globe";var r=new Su.LineSegments(new PG(Dhe(),mr,2),new Su.LineBasicMaterial({color:"lightgrey",transparent:!0,opacity:.1}));return{globeObj:i,graticulesObj:r,defaultGlobeMaterial:t}},init:function(e,t){$i(e),t.scene=e,t.scene.add(t.globeObj),t.scene.add(t.graticulesObj),t.ready=!1},update:function(e,t){var i=e.globeObj.material;if(t.hasOwnProperty("globeImageUrl")&&(e.globeImageUrl?new Su.TextureLoader().load(e.globeImageUrl,function(s){s.colorSpace=Su.SRGBColorSpace,i.map=s,i.color=null,i.needsUpdate=!0,!e.ready&&(e.ready=!0)&&setTimeout(e.onReady)}):!i.color&&(i.color=new Su.Color(0))),t.hasOwnProperty("bumpImageUrl")&&(e.bumpImageUrl?e.bumpImageUrl&&new Su.TextureLoader().load(e.bumpImageUrl,function(s){i.bumpMap=s,i.needsUpdate=!0}):(i.bumpMap=null,i.needsUpdate=!0)),(t.hasOwnProperty("atmosphereColor")||t.hasOwnProperty("atmosphereAltitude"))&&(e.atmosphereObj&&(e.scene.remove(e.atmosphereObj),$i(e.atmosphereObj)),e.atmosphereColor&&e.atmosphereAltitude)){var r=e.atmosphereObj=J0e(e.globeObj.geometry,{backside:!0,color:e.atmosphereColor,size:mr*e.atmosphereAltitude,power:3.5,coefficient:.1});r.visible=!!e.showAtmosphere,r.__globeObjType="atmosphere",e.scene.add(r)}!e.ready&&!e.globeImageUrl&&(e.ready=!0,e.onReady())}}),Ac=function(e){return isNaN(e)?parseInt(Wt(e).toHex(),16):e},eu=function(e){return e&&isNaN(e)?kd(e).opacity:1},Jh=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r,s=1,o=/^rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.eE+-]+)\s*\)$/.exec(e.trim().toLowerCase());if(o){var a=o.slice(1),l=Mr(a,4),u=l[0],c=l[1],h=l[2],A=l[3];r=new fn("rgb(".concat(+u,",").concat(+c,",").concat(+h,")")),s=Math.min(+A,1)}else r=new fn(e);i&&r.convertLinearToSRGB();var v=r.toArray();return t?[].concat(Ai(v),[s]):v};function eme(n,e,t){return n.opacity=e,n.transparent=e<1,n.depthWrite=e>=1,n}var tme=window.THREE?window.THREE:{Float32BufferAttribute:si};function mc(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tme.Float32BufferAttribute,i=new t(n.length*e,e);return e===1?n.forEach(function(r,s){return i.setX(s,r)}):n.forEach(function(r,s){return i.set(r,s*e)}),i}function nme(n){for(var e=n.itemSize,t=[],i=0;i<n.count;i++)t.push(n.array.slice(i*e,(i+1)*e));return t}function fa(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=i.removeDelay,s=r===void 0?0:r;return ede(n,e.children,function(o){return e.add(o)},function(o){var a=function(){e.remove(o),$i(o),o&&o.hasOwnProperty("__data")&&delete o.__data.__currentTargetD};s?setTimeout(a,s):a()},di({objBindAttr:"__threeObj"},t))}var Wa=window.THREE?window.THREE:{BufferGeometry:ur,Color:fn,CylinderGeometry:JP,Matrix4:ki,Mesh:rr,MeshLambertMaterial:df,Object3D:Fs,Vector3:le},OF=Object.assign({},o6),UF=OF.BufferGeometryUtils||OF,Lq=hs({props:{pointsData:{default:[]},pointLat:{default:"lat"},pointLng:{default:"lng"},pointColor:{default:function(){return"#ffffaa"}},pointAltitude:{default:.1},pointRadius:{default:.25},pointResolution:{default:12,triggerUpdate:!1},pointsMerge:{default:!1},pointsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.pointLat),i=ot(e.pointLng),r=ot(e.pointAltitude),s=ot(e.pointRadius),o=ot(e.pointColor),a=new Wa.CylinderGeometry(1,1,1,e.pointResolution);a.applyMatrix4(new Wa.Matrix4().makeRotationX(Math.PI/2)),a.applyMatrix4(new Wa.Matrix4().makeTranslation(0,0,-.5));var l=2*Math.PI*mr/360,u={},c=e.pointsMerge?new Wa.Object3D:e.scene;if(fa(e.pointsData,c,{createObj:v,updateObj:_}),e.pointsMerge){var h=e.pointsData.length?(UF.mergeGeometries||UF.mergeBufferGeometries)(e.pointsData.map(function(S){var w=S.__threeObj;S.__threeObj=void 0;var x=w.geometry.clone();w.updateMatrix(),x.applyMatrix4(w.matrix);var M=Jh(o(S));return x.setAttribute("color",mc(Ai(new Array(x.getAttribute("position").count)).map(function(){return M}),4)),x})):new Wa.BufferGeometry,A=new Wa.Mesh(h,new Wa.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0}));A.__globeObjType="points",A.__data=e.pointsData,$i(e.scene),e.scene.add(A)}function v(){var S=new Wa.Mesh(a);return S.__globeObjType="point",S}function _(S,w){var x=function(F){var L=S.__currentTargetD=F,O=L.r,z=L.alt,Q=L.lat,j=L.lng;Object.assign(S.position,Fo(Q,j));var ee=e.pointsMerge?new Wa.Vector3(0,0,0):e.scene.localToWorld(new Wa.Vector3(0,0,0));S.lookAt(ee),S.scale.x=S.scale.y=Math.min(30,O)*l,S.scale.z=Math.max(z*mr,.1)},M={alt:+r(w),r:+s(w),lat:+t(w),lng:+i(w)},R=S.__currentTargetD||Object.assign({},M,{alt:-.001});if(Object.keys(M).some(function(D){return R[D]!==M[D]})&&(e.pointsMerge||!e.pointsTransitionDuration||e.pointsTransitionDuration<0?x(M):e.tweenGroup.add(new Bs(R).to(M,e.pointsTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(x).start())),!e.pointsMerge){var N=o(w),B=N?eu(N):0,T=!!B;S.visible=T,T&&(u.hasOwnProperty(N)||(u[N]=new Wa.MeshLambertMaterial({color:Ac(N),transparent:B<1,opacity:B})),S.material=u[N])}}}}),Fq=function(){return{uniforms:{dashOffset:{value:0},dashSize:{value:1},gapSize:{value:0},dashTranslate:{value:0}},vertexShader:`
    uniform float dashTranslate; 

    attribute vec4 color;
    varying vec4 vColor;
    
    attribute float relDistance;
    varying float vRelDistance;

    void main() {
      // pass through colors and distances
      vColor = color;
      vRelDistance = relDistance + dashTranslate;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,fragmentShader:`
    uniform float dashOffset; 
    uniform float dashSize;
    uniform float gapSize; 
    
    varying vec4 vColor;
    varying float vRelDistance;
    
    void main() {
      // ignore pixels in the gap
      if (vRelDistance < dashOffset) discard;
      if (mod(vRelDistance - dashOffset, dashSize + gapSize) > dashSize) discard;
    
      // set px color: [r, g, b, a], interpolated between vertices 
      gl_FragColor = vColor; 
    }
  `}},fR=function(e){return e.uniforms.surfaceRadius={type:"float",value:0},e.vertexShader=(`attribute float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.vertexShader).replace("void main() {",["void main() {","vSurfaceRadius = surfaceRadius;","vPos = position;"].join(`
`)),e.fragmentShader=(`uniform float surfaceRadius;
varying float vSurfaceRadius;
varying vec3 vPos;
`+e.fragmentShader).replace("void main() {",["void main() {","if (length(vPos) < max(surfaceRadius, vSurfaceRadius)) discard;"].join(`
`)),e},dR=function(e,t){return e.onBeforeCompile=function(i){e.userData.shader=t(i)},e},ime=["stroke"],Xa=window.THREE?window.THREE:{BufferGeometry:ur,CubicBezierCurve3:eG,Curve:Dl,Group:Ia,Line:JS,Mesh:rr,NormalBlending:Fh,QuadraticBezierCurve3:ZP,ShaderMaterial:ko,TubeGeometry:t6,Vector3:le},rme=w0.default||w0,Bq=hs({props:{arcsData:{default:[]},arcStartLat:{default:"startLat"},arcStartLng:{default:"startLng"},arcEndLat:{default:"endLat"},arcEndLng:{default:"endLng"},arcColor:{default:function(){return"#ffffaa"}},arcAltitude:{},arcAltitudeAutoScale:{default:.5},arcStroke:{},arcCurveResolution:{default:64,triggerUpdate:!1},arcCircularResolution:{default:6,triggerUpdate:!1},arcDashLength:{default:1},arcDashGap:{default:0},arcDashInitialGap:{default:0},arcDashAnimateTime:{default:0},arcsTransitionDuration:{default:1e3,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r,t.ticker=new rme,t.ticker.onTick.add(function(s,o){t.arcsData.filter(function(a){return a.__threeObj&&a.__threeObj.children.length&&a.__threeObj.children[0].material&&a.__threeObj.children[0].__dashAnimateStep}).forEach(function(a){var l=a.__threeObj.children[0],u=l.__dashAnimateStep*o,c=l.material.uniforms.dashTranslate.value%1e9;l.material.uniforms.dashTranslate.value=c+u})})},update:function(e){var t=ot(e.arcStartLat),i=ot(e.arcStartLng),r=ot(e.arcEndLat),s=ot(e.arcEndLng),o=ot(e.arcAltitude),a=ot(e.arcAltitudeAutoScale),l=ot(e.arcStroke),u=ot(e.arcColor),c=ot(e.arcDashLength),h=ot(e.arcDashGap),A=ot(e.arcDashInitialGap),v=ot(e.arcDashAnimateTime),_=new Xa.ShaderMaterial(di(di({},Fq()),{},{transparent:!0,blending:Xa.NormalBlending}));fa(e.arcsData,e.scene,{createObj:function(){var R=new Xa.Group;return R.__globeObjType="arc",R},updateObj:function(R,N){var B=l(N),T=B!=null;if(!R.children.length||T!==(R.children[0].type==="Mesh")){$i(R);var D=T?new Xa.Mesh:new Xa.Line(new Xa.BufferGeometry);D.material=_.clone(),R.add(D)}var F=R.children[0];Object.assign(F.material.uniforms,{dashSize:{value:c(N)},gapSize:{value:h(N)},dashOffset:{value:A(N)}});var L=v(N);F.__dashAnimateStep=L>0?1e3/L:0;var O=w(u(N),e.arcCurveResolution,T?e.arcCircularResolution+1:1),z=x(e.arcCurveResolution,T?e.arcCircularResolution+1:1,!0);F.geometry.setAttribute("color",O),F.geometry.setAttribute("relDistance",z);var Q=function(Z){var ce=N.__currentTargetD=Z,ie=ce.stroke,oe=H0e(ce,ime),me=S(oe);T?(F.geometry&&F.geometry.dispose(),F.geometry=new Xa.TubeGeometry(me,e.arcCurveResolution,ie/2,e.arcCircularResolution),F.geometry.setAttribute("color",O),F.geometry.setAttribute("relDistance",z)):F.geometry.setFromPoints(me.getPoints(e.arcCurveResolution))},j={stroke:B,alt:o(N),altAutoScale:+a(N),startLat:+t(N),startLng:+i(N),endLat:+r(N),endLng:+s(N)},ee=N.__currentTargetD||Object.assign({},j,{altAutoScale:-.001});Object.keys(j).some(function($){return ee[$]!==j[$]})&&(!e.arcsTransitionDuration||e.arcsTransitionDuration<0?Q(j):e.tweenGroup.add(new Bs(ee).to(j,e.arcsTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(Q).start()))}});function S(M){var R=M.alt,N=M.altAutoScale,B=M.startLat,T=M.startLng,D=M.endLat,F=M.endLng,L=function(Oe){var Ke=Mr(Oe,3),Me=Ke[0],ze=Ke[1],nt=Ke[2],tt=Fo(ze,Me,nt),Ot=tt.x,Ht=tt.y,Ct=tt.z;return new Xa.Vector3(Ot,Ht,Ct)},O=[T,B],z=[F,D],Q=R;if(Q==null&&(Q=Nhe(O,z)/2*N),Q){var j=khe(O,z),ee=[.25,.75].map(function(_e){return[].concat(Ai(j(_e)),[Q*1.5])}),$=Mr(ee,2),Z=$[0],ce=$[1],ie=Mq(Xa.CubicBezierCurve3,Ai([O,Z,ce,z].map(L)));return ie}else{var oe=.001;return me.apply(void 0,Ai([[].concat(O,[oe]),[].concat(z,[oe])].map(L)))}function me(_e,Oe){var Ke=_e.angleTo(Oe),Me=Ke===0?function(){return _e.clone()}:function(nt){return new Xa.Vector3().addVectors(_e.clone().multiplyScalar(Math.sin((1-nt)*Ke)),Oe.clone().multiplyScalar(Math.sin(nt*Ke))).divideScalar(Math.sin(Ke))},ze=new Xa.Curve;return ze.getPoint=Me,ze}}function w(M,R){var N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,B=R+1,T;if(M instanceof Array||M instanceof Function){var D=M instanceof Array?Ld().domain(M.map(function(ee,$){return $/(M.length-1)})).range(M):M;T=function($){return Jh(D($),!0,!0)}}else{var F=Jh(M,!0,!0);T=function(){return F}}for(var L=[],O=0,z=B;O<z;O++)for(var Q=T(O/(z-1)),j=0;j<N;j++)L.push(Q);return mc(L,4)}function x(M){for(var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,B=M+1,T=[],D=0,F=B;D<F;D++)for(var L=D/(F-1),O=0;O<R;O++)T.push(L);return N&&T.reverse(),mc(T,1)}}}),Xc=window.THREE?window.THREE:{BufferGeometry:ur,Color:fn,DoubleSide:Ks,Mesh:rr,MeshLambertMaterial:df,Object3D:Fs},zF=Object.assign({},o6),VF=zF.BufferGeometryUtils||zF,Oq=hs({props:{hexBinPointsData:{default:[]},hexBinPointLat:{default:"lat"},hexBinPointLng:{default:"lng"},hexBinPointWeight:{default:1},hexBinResolution:{default:4},hexMargin:{default:.2},hexTopCurvatureResolution:{default:5},hexTopColor:{default:function(){return"#ffffaa"}},hexSideColor:{default:function(){return"#ffffaa"}},hexAltitude:{default:function(e){var t=e.sumWeight;return t*.01}},hexBinMerge:{default:!1},hexTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.hexBinPointLat),i=ot(e.hexBinPointLng),r=ot(e.hexBinPointWeight),s=ot(e.hexAltitude),o=ot(e.hexTopColor),a=ot(e.hexSideColor),l=ot(e.hexMargin),u=z4(e.hexBinPointsData.map(function(x){return di(di({},x),{},{h3Idx:A0e(t(x),i(x),e.hexBinResolution)})}),"h3Idx"),c=Object.entries(u).map(function(x){var M=Mr(x,2),R=M[0],N=M[1];return{h3Idx:R,points:N,sumWeight:N.reduce(function(B,T){return B+ +r(T)},0)}}),h={},A=e.hexBinMerge?new Xc.Object3D:e.scene;if(fa(c,A,{createObj:S,updateObj:w,idAccessor:function(M){return M.h3Idx}}),e.hexBinMerge){var v=c.length?(VF.mergeGeometries||VF.mergeBufferGeometries)(c.map(function(x){var M=x.__threeObj;x.__threeObj=void 0;var R=M.geometry.toNonIndexed();M.updateMatrix(),R.applyMatrix4(M.matrix);var N=Jh(o(x)),B=Jh(a(x)),T=R.getAttribute("position").count,D=R.groups[0].count;return R.setAttribute("color",mc(Ai(new Array(T)).map(function(F,L){return L>=D?N:B}),4)),R})):new Xc.BufferGeometry,_=new Xc.Mesh(v,dR(new Xc.MeshLambertMaterial({color:16777215,transparent:!0,vertexColors:!0,side:Xc.DoubleSide}),fR));_.__globeObjType="hexBinPoints",_.__data=c,$i(e.scene),e.scene.add(_)}function S(x){var M=new Xc.Mesh;M.__hexCenter=yq(x.h3Idx),M.__hexGeoJson=_q(x.h3Idx,!0).reverse();var R=M.__hexCenter[1];return M.__hexGeoJson.forEach(function(N){var B=N[0];Math.abs(R-B)>170&&(N[0]+=R>B?360:-360)}),M.__globeObjType="hexbin",M}function w(x,M){var R=function(Z,ce,ie){return Z-(Z-ce)*ie},N=Math.max(0,Math.min(1,+l(M))),B=Mr(x.__hexCenter,2),T=B[0],D=B[1],F=N===0?x.__hexGeoJson:x.__hexGeoJson.map(function($){var Z=Mr($,2),ce=Z[0],ie=Z[1];return[[ce,D],[ie,T]].map(function(oe){var me=Mr(oe,2),_e=me[0],Oe=me[1];return R(_e,Oe,N)})}),L=e.hexTopCurvatureResolution;x.geometry&&x.geometry.dispose(),x.geometry=new y6([F],0,mr,!1,!0,!0,L);var O={alt:+s(M)},z=function(Z){var ce=x.__currentTargetD=Z,ie=ce.alt;x.scale.x=x.scale.y=x.scale.z=1+ie;var oe=mr/(ie+1);x.geometry.setAttribute("surfaceRadius",mc(Ai(new Array(x.geometry.getAttribute("position").count)).map(function(){return oe}),1))},Q=x.__currentTargetD||Object.assign({},O,{alt:-.001});if(Object.keys(O).some(function($){return Q[$]!==O[$]})&&(e.hexBinMerge||!e.hexTransitionDuration||e.hexTransitionDuration<0?z(O):e.tweenGroup.add(new Bs(Q).to(O,e.hexTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(z).start())),!e.hexBinMerge){var j=a(M),ee=o(M);[j,ee].forEach(function($){if(!h.hasOwnProperty($)){var Z=eu($);h[$]=dR(new Xc.MeshLambertMaterial({color:Ac($),transparent:Z<1,opacity:Z,side:Xc.DoubleSide}),fR)}}),x.material=[j,ee].map(function($){return h[$]})}}}}),Uq=function(e){return e*e};function sme(n,e){var t=Math.sqrt,i=Math.cos,r=function(h){return h*Math.PI/180},s=function(h){return Uq(Math.sin(h/2))},o=r(n[1]),a=r(e[1]),l=r(n[0]),u=r(e[0]);return 2*Math.asin(t(s(a-o)+i(o)*i(a)*s(u-l)))}var ome=Math.sqrt(2*Math.PI);function ame(n,e){return Math.exp(-Uq(n/e)/2)/(e*ome)}var lme=function(e){var t=Mr(e,2),i=t[0],r=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=o.lngAccessor,l=a===void 0?function(w){return w[0]}:a,u=o.latAccessor,c=u===void 0?function(w){return w[1]}:u,h=o.weightAccessor,A=h===void 0?function(){return 1}:h,v=o.bandwidth,_=[i,r],S=v*Math.PI/180;return bhe(s.map(function(w){var x=A(w);if(!x)return 0;var M=sme(_,[l(w),c(w)]);return ame(M,S)*x}))},b_=window.THREE?window.THREE:{Mesh:rr,MeshLambertMaterial:df,SphereGeometry:Ev},ume=3.5,cme=.1,hme=3.5,GF=new WeakSet,F3=new WeakMap,S_=new WeakMap,B3=new WeakMap,fme=function(){function n(e,t){S6(this,n),O0e(this,GF),k3(this,F3,void 0),k3(this,S_,void 0),k3(this,B3,void 0),L3(F3,this,e),L3(S_,this,C0e()),x_(S_,this).init(e.map(function(i){return[i.x,i.y,i.z]}).flat()),L3(B3,this,b6(GF,this,dme).call(this,Fo(0,0),Fo(0,Math.min(180,t))))}return w6(n,[{key:"getNearPoints",value:function(t,i,r){var s=this;return x_(S_,this).intersectSphere(t,i,r,x_(B3,this)).map(function(o){return x_(F3,s)[o/3]})}}])}();function dme(n,e){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)+Math.pow(n.z-e.z,2))}var pme=function(e){var t=kd(g0e(e));return t.opacity=Math.cbrt(e),t.formatRgb()},zq=hs({props:{heatmapsData:{default:[]},heatmapPoints:{default:function(e){return e}},heatmapPointLat:{default:function(e){return e[0]}},heatmapPointLng:{default:function(e){return e[1]}},heatmapPointWeight:{default:1},heatmapBandwidth:{default:4},heatmapColorFn:{default:function(){return pme}},heatmapColorSaturation:{default:1.5},heatmapBaseAltitude:{default:.01},heatmapTopAltitude:{},heatmapsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.heatmapPoints),i=ot(e.heatmapPointLat),r=ot(e.heatmapPointLng),s=ot(e.heatmapPointWeight),o=ot(e.heatmapBandwidth),a=ot(e.heatmapColorFn),l=ot(e.heatmapColorSaturation),u=ot(e.heatmapBaseAltitude),c=ot(e.heatmapTopAltitude);fa(e.heatmapsData,e.scene,{createObj:function(A){var v=new b_.Mesh(new b_.SphereGeometry(mr),new b_.MeshLambertMaterial({vertexColors:!0,transparent:!0}));return v.__globeObjType="heatmap",v},updateObj:function(A,v){var _=o(v),S=a(v),w=l(v),x=u(v),M=c(v),R=t(v).map(function(j){var ee=i(j),$=r(j),Z=Fo(ee,$),ce=Z.x,ie=Z.y,oe=Z.z;return{x:ce,y:ie,z:oe,lat:ee,lng:$,weight:s(j)}}),N=Math.max(cme,_/ume),B=Math.ceil(360/(N||-1));A.geometry.parameters.widthSegments!==B&&(A.geometry.dispose(),A.geometry=new b_.SphereGeometry(mr,B,B/2));var T=nme(A.geometry.getAttribute("position")),D=T.map(function(j){var ee=Mr(j,3),$=ee[0],Z=ee[1],ce=ee[2],ie=Dq({x:$,y:Z,z:ce}),oe=ie.lng,me=ie.lat;return[oe,me]}),F=new fme(R,_*hme),L=D.map(function(j,ee){var $=Mr(T[ee],3),Z=$[0],ce=$[1],ie=$[2];return lme(j,F.getNearPoints(Z,ce,ie),{latAccessor:function(me){return me.lat},lngAccessor:function(me){return me.lng},weightAccessor:function(me){return me.weight},bandwidth:_})}),O=function(ee){var $=A.__currentTargetD=ee,Z=$.kdeVals,ce=$.topAlt,ie=$.saturation,oe=xhe(Z.map(Math.abs))||1e-15;A.geometry.setAttribute("color",mc(Z.map(function(_e){return Jh(S(_e/oe*ie))}),4));var me=Ld([0,oe],[x,ce||x]);A.geometry.setAttribute("position",mc(Z.map(function(_e,Oe){var Ke=Mr(D[Oe],2),Me=Ke[0],ze=Ke[1],nt=me(Math.abs(_e)),tt=Fo(ze,Me,nt);return[tt.x,tt.y,tt.z]}),3))},z={kdeVals:L,topAlt:M,saturation:w},Q=A.__currentTargetD||Object.assign({},z,{kdeVals:L.map(function(){return 0}),topAlt:M&&x,saturation:.5});Q.kdeVals.length!==L.length&&(Q.kdeVals=L.slice()),Object.keys(z).some(function(j){return Q[j]!==z[j]})&&(!e.heatmapsTransitionDuration||e.heatmapsTransitionDuration<0?O(z):e.tweenGroup.add(new Bs(Q).to(z,e.heatmapsTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(O).start()))}})}}),Yc=window.THREE?window.THREE:{DoubleSide:Ks,Group:Ia,LineBasicMaterial:ZS,LineSegments:ZV,Mesh:rr,MeshBasicMaterial:WS},Vq=hs({props:{polygonsData:{default:[]},polygonGeoJsonGeometry:{default:"geometry"},polygonSideColor:{default:function(){return"#ffffaa"}},polygonSideMaterial:{},polygonCapColor:{default:function(){return"#ffffaa"}},polygonCapMaterial:{},polygonStrokeColor:{},polygonAltitude:{default:.01},polygonCapCurvatureResolution:{default:5},polygonsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.polygonGeoJsonGeometry),i=ot(e.polygonAltitude),r=ot(e.polygonCapCurvatureResolution),s=ot(e.polygonCapColor),o=ot(e.polygonCapMaterial),a=ot(e.polygonSideColor),l=ot(e.polygonSideMaterial),u=ot(e.polygonStrokeColor),c=[];e.polygonsData.forEach(function(h){var A={data:h,capColor:s(h),capMaterial:o(h),sideColor:a(h),sideMaterial:l(h),strokeColor:u(h),altitude:+i(h),capCurvatureResolution:+r(h)},v=t(h),_=h.__id||"".concat(Math.round(Math.random()*1e9));h.__id=_,v.type==="Polygon"?c.push(di({id:"".concat(_,"_0"),coords:v.coordinates},A)):v.type==="MultiPolygon"?c.push.apply(c,Ai(v.coordinates.map(function(S,w){return di({id:"".concat(_,"_").concat(w),coords:S},A)}))):console.warn("Unsupported GeoJson geometry type: ".concat(v.type,". Skipping geometry..."))}),fa(c,e.scene,{idAccessor:function(A){return A.id},createObj:function(){var A=new Yc.Group;return A.__defaultSideMaterial=dR(new Yc.MeshBasicMaterial({side:Yc.DoubleSide,depthWrite:!0}),fR),A.__defaultCapMaterial=new Yc.MeshBasicMaterial({side:Yc.DoubleSide,depthWrite:!0}),A.add(new Yc.Mesh(void 0,[A.__defaultSideMaterial,A.__defaultCapMaterial])),A.add(new Yc.LineSegments(void 0,new Yc.LineBasicMaterial)),A.__globeObjType="polygon",A},updateObj:function(A,v){var _=v.coords,S=v.capColor,w=v.capMaterial,x=v.sideColor,M=v.sideMaterial,R=v.strokeColor,N=v.altitude,B=v.capCurvatureResolution,T=Mr(A.children,2),D=T[0],F=T[1],L=!!R;if(F.visible=L,Ame(D.geometry.parameters||{},{polygonGeoJson:_,curvatureResolution:B})||(D.geometry&&D.geometry.dispose(),D.geometry=new y6(_,0,mr,!1,!0,!0,B)),L&&(!F.geometry.parameters||F.geometry.parameters.geoJson.coordinates!==_||F.geometry.parameters.resolution!==B)&&(F.geometry&&F.geometry.dispose(),F.geometry=new PG({type:"Polygon",coordinates:_},mr,B)),D.material[0]=M||A.__defaultSideMaterial,D.material[1]=w||A.__defaultCapMaterial,[!M&&x,!w&&S].forEach(function($,Z){if($){var ce=D.material[Z],ie=eu($);ce.color.set(Ac($)),ce.transparent=ie<1,ce.opacity=ie}}),L){var O=F.material,z=eu(R);O.color.set(Ac(R)),O.transparent=z<1,O.opacity=z}var Q={alt:N},j=function(Z){var ce=A.__currentTargetD=Z,ie=ce.alt;D.scale.x=D.scale.y=D.scale.z=1+ie,L&&(F.scale.x=F.scale.y=F.scale.z=1+ie+1e-4),A.__defaultSideMaterial.userData.shader&&(A.__defaultSideMaterial.userData.shader.uniforms.surfaceRadius.value=mr/(ie+1))},ee=A.__currentTargetD||Object.assign({},Q,{alt:-.001});Object.keys(Q).some(function($){return ee[$]!==Q[$]})&&(!e.polygonsTransitionDuration||e.polygonsTransitionDuration<0||ee.alt===Q.alt?j(Q):e.tweenGroup.add(new Bs(ee).to(Q,e.polygonsTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(j).start()))}})}});function Ame(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){return function(i,r){return i===r}};return Object.entries(e).every(function(i){var r=Mr(i,2),s=r[0],o=r[1];return n.hasOwnProperty(s)&&t(s)(n[s],o)})}var kp=window.THREE?window.THREE:{BufferGeometry:ur,CircleGeometry:wv,DoubleSide:Ks,Mesh:rr,MeshLambertMaterial:df,Vector3:le},qF=Object.assign({},o6),HF=qF.BufferGeometryUtils||qF,Gq=hs({props:{hexPolygonsData:{default:[]},hexPolygonGeoJsonGeometry:{default:"geometry"},hexPolygonColor:{default:function(){return"#ffffaa"}},hexPolygonAltitude:{default:.001},hexPolygonResolution:{default:3},hexPolygonMargin:{default:.2},hexPolygonUseDots:{default:!1},hexPolygonCurvatureResolution:{default:5},hexPolygonDotResolution:{default:12},hexPolygonsTransitionDuration:{default:0,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.hexPolygonGeoJsonGeometry),i=ot(e.hexPolygonColor),r=ot(e.hexPolygonAltitude),s=ot(e.hexPolygonResolution),o=ot(e.hexPolygonMargin),a=ot(e.hexPolygonUseDots),l=ot(e.hexPolygonCurvatureResolution),u=ot(e.hexPolygonDotResolution);fa(e.hexPolygonsData,e.scene,{createObj:function(h){var A=new kp.Mesh(void 0,new kp.MeshLambertMaterial({side:kp.DoubleSide}));return A.__globeObjType="hexPolygon",A},updateObj:function(h,A){var v=t(A),_=s(A),S=r(A),w=Math.max(0,Math.min(1,+o(A))),x=a(A),M=l(A),R=u(A),N=i(A),B=eu(N);h.material.color.set(Ac(N)),h.material.transparent=B<1,h.material.opacity=B;var T={alt:S,margin:w,curvatureResolution:M},D={geoJson:v,h3Res:_},F=h.__currentTargetD||Object.assign({},T,{alt:-.001}),L=h.__currentMemD||D;if(Object.keys(T).some(function(j){return F[j]!==T[j]})||Object.keys(D).some(function(j){return L[j]!==D[j]})){h.__currentMemD=D;var O=[];v.type==="Polygon"?MF(v.coordinates,_,!0).forEach(function(j){return O.push(j)}):v.type==="MultiPolygon"?v.coordinates.forEach(function(j){return MF(j,_,!0).forEach(function(ee){return O.push(ee)})}):console.warn("Unsupported GeoJson geometry type: ".concat(v.type,". Skipping geometry..."));var z=O.map(function(j){var ee=yq(j),$=_q(j,!0).reverse(),Z=ee[1];return $.forEach(function(ce){var ie=ce[0];Math.abs(Z-ie)>170&&(ce[0]+=Z>ie?360:-360)}),{h3Idx:j,hexCenter:ee,hexGeoJson:$}}),Q=function(ee){var $=h.__currentTargetD=ee,Z=$.alt,ce=$.margin,ie=$.curvatureResolution;h.geometry&&h.geometry.dispose(),h.geometry=z.length?(HF.mergeGeometries||HF.mergeBufferGeometries)(z.map(function(oe){var me=Mr(oe.hexCenter,2),_e=me[0],Oe=me[1];if(x){var Ke=Fo(_e,Oe,Z),Me=Fo(oe.hexGeoJson[0][1],oe.hexGeoJson[0][0],Z),ze=.85*(1-ce)*new kp.Vector3(Ke.x,Ke.y,Ke.z).distanceTo(new kp.Vector3(Me.x,Me.y,Me.z)),nt=new wv(ze,R);return nt.rotateX(ed(-_e)),nt.rotateY(ed(Oe)),nt.translate(Ke.x,Ke.y,Ke.z),nt}else{var tt=function(Ct,en,Ze){return Ct-(Ct-en)*Ze},Ot=ce===0?oe.hexGeoJson:oe.hexGeoJson.map(function(Ht){var Ct=Mr(Ht,2),en=Ct[0],Ze=Ct[1];return[[en,Oe],[Ze,_e]].map(function(at){var ue=Mr(at,2),zt=ue[0],st=ue[1];return tt(zt,st,ce)})});return new y6([Ot],mr,mr*(1+Z),!1,!0,!1,ie)}})):new kp.BufferGeometry};!e.hexPolygonsTransitionDuration||e.hexPolygonsTransitionDuration<0?Q(T):e.tweenGroup.add(new Bs(F).to(T,e.hexPolygonsTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(Q).start())}}})}}),mme=window.THREE?window.THREE:{Vector3:le};function gme(n,e){var t=function(o,a){var l=o[o.length-1];return[].concat(Ai(o),Ai(Ai(new Array(a-o.length)).map(function(){return l})))},i=Math.max(n.length,e.length),r=mde.apply(void 0,Ai([n,e].map(function(s){return s.map(function(o){var a=o.x,l=o.y,u=o.z;return[a,l,u]})}).map(function(s){return t(s,i)})));return function(s){return s===0?n:s===1?e:r(s).map(function(o){var a=Mr(o,3),l=a[0],u=a[1],c=a[2];return new mme.Vector3(l,u,c)})}}var kf=window.THREE?window.THREE:{BufferGeometry:ur,Color:fn,Group:Ia,Line:JS,NormalBlending:Fh,ShaderMaterial:ko,Vector3:le},vme=w0.default||w0,qq=hs({props:{pathsData:{default:[]},pathPoints:{default:function(e){return e}},pathPointLat:{default:function(e){return e[0]}},pathPointLng:{default:function(e){return e[1]}},pathPointAlt:{default:.001},pathResolution:{default:2},pathColor:{default:function(){return"#ffffaa"}},pathStroke:{},pathDashLength:{default:1},pathDashGap:{default:0},pathDashInitialGap:{default:0},pathDashAnimateTime:{default:0},pathTransitionDuration:{default:1e3,triggerUpdate:!1},rendererSize:{}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r,t.ticker=new vme,t.ticker.onTick.add(function(s,o){t.pathsData.filter(function(a){return a.__threeObj&&a.__threeObj.children.length&&a.__threeObj.children[0].material&&a.__threeObj.children[0].__dashAnimateStep}).forEach(function(a){var l=a.__threeObj.children[0],u=l.__dashAnimateStep*o;if(l.type==="Line"){var c=l.material.uniforms.dashTranslate.value%1e9;l.material.uniforms.dashTranslate.value=c+u}else if(l.type==="Line2"){for(var h=l.material.dashOffset-u,A=l.material.dashSize+l.material.gapSize;h<=-A;)h+=A;l.material.dashOffset=h}})})},update:function(e){var t=ot(e.pathPoints),i=ot(e.pathPointLat),r=ot(e.pathPointLng),s=ot(e.pathPointAlt),o=ot(e.pathStroke),a=ot(e.pathColor),l=ot(e.pathDashLength),u=ot(e.pathDashGap),c=ot(e.pathDashInitialGap),h=ot(e.pathDashAnimateTime),A=new kf.ShaderMaterial(di(di({},Fq()),{},{transparent:!0,blending:kf.NormalBlending}));fa(e.pathsData,e.scene,{createObj:function(){var M=new kf.Group;return M.__globeObjType="path",M},updateObj:function(M,R){var N=o(R),B=N!=null;if(!M.children.length||B===(M.children[0].type==="Line")){$i(M);var T=B?new N0e(new Eq,new x6):new kf.Line(new kf.BufferGeometry,A.clone());M.add(T)}var D=M.children[0],F=_(t(R),i,r,s,e.pathResolution),L=h(R);if(D.__dashAnimateStep=L>0?1e3/L:0,B){D.material.resolution=e.rendererSize;{var Q=l(R),j=u(R),ee=c(R);D.material.dashed=j>0,D.material.dashed?D.material.defines.USE_DASH="":delete D.material.defines.USE_DASH,D.material.dashed&&(D.material.dashScale=1/v(F),D.material.dashSize=Q,D.material.gapSize=j,D.material.dashOffset=-ee)}{var $=a(R);if($ instanceof Array){var Z=S(a(R),F.length-1,1,!1);D.geometry.setColors(Z.array),D.material.vertexColors=!0}else{var ce=$,ie=eu(ce);D.material.color=new kf.Color(Ac(ce)),D.material.transparent=ie<1,D.material.opacity=ie,D.material.vertexColors=!1}}D.material.needsUpdate=!0}else{Object.assign(D.material.uniforms,{dashSize:{value:l(R)},gapSize:{value:u(R)},dashOffset:{value:c(R)}});var O=S(a(R),F.length),z=w(F.length,1,!0);D.geometry.setAttribute("color",O),D.geometry.setAttribute("relDistance",z)}var oe=gme(R.__currentTargetD&&R.__currentTargetD.points||[F[0]],F),me=function(Me){var ze=R.__currentTargetD=Me,nt=ze.stroke,tt=ze.interpolK,Ot=R.__currentTargetD.points=oe(tt);if(B){var Ht;D.geometry.setPositions((Ht=[]).concat.apply(Ht,Ai(Ot.map(function(Ct){var en=Ct.x,Ze=Ct.y,at=Ct.z;return[en,Ze,at]})))),D.material.linewidth=nt,D.material.dashed&&D.computeLineDistances()}else D.geometry.setFromPoints(Ot),D.geometry.computeBoundingSphere()},_e={stroke:N,interpolK:1},Oe=Object.assign({},R.__currentTargetD||_e,{interpolK:0});Object.keys(_e).some(function(Ke){return Oe[Ke]!==_e[Ke]})&&(!e.pathTransitionDuration||e.pathTransitionDuration<0?me(_e):e.tweenGroup.add(new Bs(Oe).to(_e,e.pathTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(me).start()))}});function v(x){var M=0,R;return x.forEach(function(N){R&&(M+=R.distanceTo(N)),R=N}),M}function _(x,M,R,N,B){var T=function(O,z,Q){for(var j=[],ee=1;ee<=Q;ee++)j.push(O+(z-O)*ee/(Q+1));return j},D=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Q=[],j=null;return O.forEach(function(ee){if(j){for(;Math.abs(j[1]-ee[1])>180;)j[1]+=360*(j[1]<ee[1]?1:-1);var $=Math.sqrt(Math.pow(ee[0]-j[0],2)+Math.pow(ee[1]-j[1],2));if($>z)for(var Z=Math.floor($/z),ce=T(j[0],ee[0],Z),ie=T(j[1],ee[1],Z),oe=T(j[2],ee[2],Z),me=0,_e=ce.length;me<_e;me++)Q.push([ce[me],ie[me],oe[me]])}Q.push(j=ee)}),Q},F=function(O){var z=Mr(O,3),Q=z[0],j=z[1],ee=z[2],$=Fo(Q,j,ee),Z=$.x,ce=$.y,ie=$.z;return new kf.Vector3(Z,ce,ie)};return D(x.map(function(L){return[M(L),R(L),N(L)]}),B).map(F)}function S(x,M){var R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,B=M+1,T;if(x instanceof Array||x instanceof Function){var D=x instanceof Array?Ld().domain(x.map(function(ee,$){return $/(x.length-1)})).range(x):x;T=function($){return Jh(D($),N,!0)}}else{var F=Jh(x,N,!0);T=function(){return F}}for(var L=[],O=0,z=B;O<z;O++)for(var Q=T(O/(z-1)),j=0;j<R;j++)L.push(Q);return mc(L,N?4:3)}function w(x){for(var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,N=x+1,B=[],T=0,D=N;T<D;T++)for(var F=T/(D-1),L=0;L<M;L++)B.push(F);return R&&B.reverse(),mc(B,1)}}}),w_=window.THREE?window.THREE:{Euler:la,Mesh:rr,MeshLambertMaterial:df,SphereGeometry:Ev},Hq=hs({props:{tilesData:{default:[]},tileLat:{default:"lat"},tileLng:{default:"lng"},tileAltitude:{default:.01},tileWidth:{default:1},tileHeight:{default:1},tileUseGlobeProjection:{default:!0},tileMaterial:{default:function(){return new w_.MeshLambertMaterial({color:"#ffbb88",opacity:.4,transparent:!0})}},tileCurvatureResolution:{default:5},tilesTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.tileLat),i=ot(e.tileLng),r=ot(e.tileAltitude),s=ot(e.tileWidth),o=ot(e.tileHeight),a=ot(e.tileUseGlobeProjection),l=ot(e.tileMaterial),u=ot(e.tileCurvatureResolution);fa(e.tilesData,e.scene,{createObj:function(){var h=new w_.Mesh;return h.__globeObjType="tile",h},updateObj:function(h,A){h.material=l(A);var v=a(A),_=u(A),S=function(R){var N=h.__currentTargetD=R,B=N.lat,T=N.lng,D=N.alt,F=N.width,L=N.height,O=Lp(T),z=Lp(-B);h.geometry&&h.geometry.dispose(),h.geometry=new w_.SphereGeometry(mr*(1+D),Math.ceil(F/(_||-1)),Math.ceil(L/(_||-1)),Lp(90-F/2)+(v?O:0),Lp(F),Lp(90-L/2)+(v?z:0),Lp(L)),v||h.setRotationFromEuler(new w_.Euler(z,O,0,"YXZ"))},w={lat:+t(A),lng:+i(A),alt:+r(A),width:+s(A),height:+o(A)},x=h.__currentTargetD||Object.assign({},w,{width:0,height:0});Object.keys(w).some(function(M){return x[M]!==w[M]})&&(!e.tilesTransitionDuration||e.tilesTransitionDuration<0?S(w):e.tweenGroup.add(new Bs(x).to(w,e.tilesTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(S).start()))}})}}),Lp=function(e){return e*Math.PI/180},yme={0:{x_min:73,x_max:715,ha:792,o:"m 394 -29 q 153 129 242 -29 q 73 479 73 272 q 152 829 73 687 q 394 989 241 989 q 634 829 545 989 q 715 479 715 684 q 635 129 715 270 q 394 -29 546 -29 m 394 89 q 546 211 489 89 q 598 479 598 322 q 548 748 598 640 q 394 871 491 871 q 241 748 298 871 q 190 479 190 637 q 239 211 190 319 q 394 89 296 89 "},1:{x_min:215.671875,x_max:574,ha:792,o:"m 574 0 l 442 0 l 442 697 l 215 697 l 215 796 q 386 833 330 796 q 475 986 447 875 l 574 986 l 574 0 "},2:{x_min:59,x_max:731,ha:792,o:"m 731 0 l 59 0 q 197 314 59 188 q 457 487 199 315 q 598 691 598 580 q 543 819 598 772 q 411 867 488 867 q 272 811 328 867 q 209 630 209 747 l 81 630 q 182 901 81 805 q 408 986 271 986 q 629 909 536 986 q 731 694 731 826 q 613 449 731 541 q 378 316 495 383 q 201 122 235 234 l 731 122 l 731 0 "},3:{x_min:54,x_max:737,ha:792,o:"m 737 284 q 635 55 737 141 q 399 -25 541 -25 q 156 52 248 -25 q 54 308 54 140 l 185 308 q 245 147 185 202 q 395 96 302 96 q 539 140 484 96 q 602 280 602 190 q 510 429 602 390 q 324 454 451 454 l 324 565 q 487 584 441 565 q 565 719 565 617 q 515 835 565 791 q 395 879 466 879 q 255 824 307 879 q 203 661 203 769 l 78 661 q 166 909 78 822 q 387 992 250 992 q 603 921 513 992 q 701 723 701 844 q 669 607 701 656 q 578 524 637 558 q 696 434 655 499 q 737 284 737 369 "},4:{x_min:48,x_max:742.453125,ha:792,o:"m 742 243 l 602 243 l 602 0 l 476 0 l 476 243 l 48 243 l 48 368 l 476 958 l 602 958 l 602 354 l 742 354 l 742 243 m 476 354 l 476 792 l 162 354 l 476 354 "},5:{x_min:54.171875,x_max:738,ha:792,o:"m 738 314 q 626 60 738 153 q 382 -23 526 -23 q 155 47 248 -23 q 54 256 54 125 l 183 256 q 259 132 204 174 q 382 91 314 91 q 533 149 471 91 q 602 314 602 213 q 538 469 602 411 q 386 528 475 528 q 284 506 332 528 q 197 439 237 484 l 81 439 l 159 958 l 684 958 l 684 840 l 254 840 l 214 579 q 306 627 258 612 q 407 643 354 643 q 636 552 540 643 q 738 314 738 457 "},6:{x_min:53,x_max:739,ha:792,o:"m 739 312 q 633 62 739 162 q 400 -31 534 -31 q 162 78 257 -31 q 53 439 53 206 q 178 859 53 712 q 441 986 284 986 q 643 912 559 986 q 732 713 732 833 l 601 713 q 544 830 594 786 q 426 875 494 875 q 268 793 331 875 q 193 517 193 697 q 301 597 240 570 q 427 624 362 624 q 643 540 552 624 q 739 312 739 451 m 603 298 q 540 461 603 400 q 404 516 484 516 q 268 461 323 516 q 207 300 207 401 q 269 137 207 198 q 405 83 325 83 q 541 137 486 83 q 603 298 603 197 "},7:{x_min:58.71875,x_max:730.953125,ha:792,o:"m 730 839 q 469 448 560 641 q 335 0 378 255 l 192 0 q 328 441 235 252 q 593 830 421 630 l 58 830 l 58 958 l 730 958 l 730 839 "},8:{x_min:55,x_max:736,ha:792,o:"m 571 527 q 694 424 652 491 q 736 280 736 358 q 648 71 736 158 q 395 -26 551 -26 q 142 69 238 -26 q 55 279 55 157 q 96 425 55 359 q 220 527 138 491 q 120 615 153 562 q 88 726 88 668 q 171 904 88 827 q 395 986 261 986 q 618 905 529 986 q 702 727 702 830 q 670 616 702 667 q 571 527 638 565 m 394 565 q 519 610 475 565 q 563 717 563 655 q 521 823 563 781 q 392 872 474 872 q 265 824 312 872 q 224 720 224 783 q 265 613 224 656 q 394 565 312 565 m 395 91 q 545 150 488 91 q 597 280 597 204 q 546 408 597 355 q 395 465 492 465 q 244 408 299 465 q 194 280 194 356 q 244 150 194 203 q 395 91 299 91 "},9:{x_min:53,x_max:739,ha:792,o:"m 739 524 q 619 94 739 241 q 362 -32 516 -32 q 150 47 242 -32 q 59 244 59 126 l 191 244 q 246 129 191 176 q 373 82 301 82 q 526 161 466 82 q 597 440 597 255 q 363 334 501 334 q 130 432 216 334 q 53 650 53 521 q 134 880 53 786 q 383 986 226 986 q 659 841 566 986 q 739 524 739 719 m 388 449 q 535 514 480 449 q 585 658 585 573 q 535 805 585 744 q 388 873 480 873 q 242 809 294 873 q 191 658 191 745 q 239 514 191 572 q 388 449 292 449 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 96 88 192 -25 q 0 368 0 201 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 "},S:{x_min:0,x_max:788,ha:890,o:"m 788 291 q 662 54 788 144 q 397 -26 550 -26 q 116 68 226 -26 q 0 337 0 168 l 131 337 q 200 152 131 220 q 384 85 269 85 q 557 129 479 85 q 650 270 650 183 q 490 429 650 379 q 194 513 341 470 q 33 739 33 584 q 142 964 33 881 q 388 1041 242 1041 q 644 957 543 1041 q 756 716 756 867 l 625 716 q 561 874 625 816 q 395 933 497 933 q 243 891 309 933 q 164 759 164 841 q 325 609 164 656 q 625 526 475 568 q 788 291 788 454 "},"":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},"/":{x_min:183.25,x_max:608.328125,ha:792,o:"m 608 1041 l 266 -129 l 183 -129 l 520 1041 l 608 1041 "},:{x_min:-.4375,x_max:777.453125,ha:839,o:"m 777 893 l 458 893 l 458 0 l 319 0 l 319 892 l 0 892 l 0 1013 l 777 1013 l 777 893 "},y:{x_min:0,x_max:684.78125,ha:771,o:"m 684 738 l 388 -83 q 311 -216 356 -167 q 173 -279 252 -279 q 97 -266 133 -279 l 97 -149 q 132 -155 109 -151 q 168 -160 155 -160 q 240 -114 213 -160 q 274 -26 248 -98 l 0 738 l 137 737 l 341 139 l 548 737 l 684 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 803 1012 l 803 0 "},:{x_min:-111,x_max:339,ha:361,o:"m 339 800 l 229 800 l 229 925 l 339 925 l 339 800 m -1 800 l -111 800 l -111 925 l -1 925 l -1 800 m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 m 302 1040 l 113 819 l 30 819 l 165 1040 l 302 1040 "},g:{x_min:0,x_max:686,ha:838,o:"m 686 34 q 586 -213 686 -121 q 331 -306 487 -306 q 131 -252 216 -306 q 31 -84 31 -190 l 155 -84 q 228 -174 166 -138 q 345 -207 284 -207 q 514 -109 454 -207 q 564 89 564 -27 q 461 6 521 36 q 335 -23 401 -23 q 88 100 184 -23 q 0 370 0 215 q 87 634 0 522 q 330 758 183 758 q 457 728 398 758 q 564 644 515 699 l 564 737 l 686 737 l 686 34 m 582 367 q 529 560 582 481 q 358 652 468 652 q 189 561 250 652 q 135 369 135 482 q 189 176 135 255 q 361 85 251 85 q 529 176 468 85 q 582 367 582 255 "},"":{x_min:0,x_max:442,ha:539,o:"m 442 383 l 0 383 q 91 566 0 492 q 260 668 176 617 q 354 798 354 727 q 315 875 354 845 q 227 905 277 905 q 136 869 173 905 q 99 761 99 833 l 14 761 q 82 922 14 864 q 232 974 141 974 q 379 926 316 974 q 442 797 442 878 q 351 635 442 704 q 183 539 321 611 q 92 455 92 491 l 442 455 l 442 383 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},:{x_min:0,x_max:819.5625,ha:893,o:"m 819 0 l 650 0 l 294 509 l 139 356 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},:{x_min:-46.265625,x_max:392,ha:513,o:"m 392 651 l 259 651 l 79 -279 l -46 -278 l 134 651 l 14 651 l 14 751 l 135 751 q 151 948 135 900 q 304 1041 185 1041 q 334 1040 319 1041 q 392 1034 348 1039 l 392 922 q 337 931 360 931 q 271 883 287 931 q 260 793 260 853 l 260 751 l 392 751 l 392 651 "},e:{x_min:0,x_max:714,ha:813,o:"m 714 326 l 140 326 q 200 157 140 227 q 359 87 260 87 q 488 130 431 87 q 561 245 545 174 l 697 245 q 577 48 670 123 q 358 -26 484 -26 q 97 85 195 -26 q 0 363 0 197 q 94 642 0 529 q 358 765 195 765 q 626 627 529 765 q 714 326 714 503 m 576 429 q 507 583 564 522 q 355 650 445 650 q 206 583 266 650 q 140 429 152 522 l 576 429 "},:{x_min:0,x_max:712,ha:815,o:"m 356 -25 q 94 91 194 -25 q 0 368 0 202 q 92 642 0 533 q 356 761 192 761 q 617 644 517 761 q 712 368 712 533 q 619 91 712 201 q 356 -25 520 -25 m 356 85 q 527 175 465 85 q 583 369 583 255 q 528 562 583 484 q 356 651 466 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 356 85 250 85 m 576 1040 l 387 819 l 303 819 l 438 1040 l 576 1040 "},J:{x_min:0,x_max:588,ha:699,o:"m 588 279 q 287 -26 588 -26 q 58 73 126 -26 q 0 327 0 158 l 133 327 q 160 172 133 227 q 288 96 198 96 q 426 171 391 96 q 449 336 449 219 l 449 1013 l 588 1013 l 588 279 "},"":{x_min:-1,x_max:503,ha:601,o:"m 503 302 l 280 136 l 281 256 l 429 373 l 281 486 l 280 608 l 503 440 l 503 302 m 221 302 l 0 136 l 0 255 l 145 372 l 0 486 l -1 608 l 221 440 l 221 302 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 741 394 q 661 246 731 302 q 496 190 591 190 q 294 285 369 190 q 228 497 228 370 q 295 714 228 625 q 499 813 370 813 q 656 762 588 813 q 733 625 724 711 l 634 625 q 589 704 629 673 q 498 735 550 735 q 377 666 421 735 q 334 504 334 597 q 374 340 334 408 q 490 272 415 272 q 589 304 549 272 q 638 394 628 337 l 741 394 "},:{x_min:0,x_max:922,ha:1030,o:"m 687 1040 l 498 819 l 415 819 l 549 1040 l 687 1040 m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 338 0 202 q 45 551 0 444 q 161 737 84 643 l 302 737 q 175 552 219 647 q 124 336 124 446 q 155 179 124 248 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 341 797 257 q 745 555 797 450 q 619 737 705 637 l 760 737 q 874 551 835 640 q 922 339 922 444 "},"^":{x_min:193.0625,x_max:598.609375,ha:792,o:"m 598 772 l 515 772 l 395 931 l 277 772 l 193 772 l 326 1013 l 462 1013 l 598 772 "},"":{x_min:0,x_max:507.203125,ha:604,o:"m 506 136 l 284 302 l 284 440 l 506 608 l 507 485 l 360 371 l 506 255 l 506 136 m 222 136 l 0 302 l 0 440 l 222 608 l 221 486 l 73 373 l 222 256 l 222 136 "},D:{x_min:0,x_max:828,ha:935,o:"m 389 1013 q 714 867 593 1013 q 828 521 828 729 q 712 161 828 309 q 382 0 587 0 l 0 0 l 0 1013 l 389 1013 m 376 124 q 607 247 523 124 q 681 510 681 355 q 607 771 681 662 q 376 896 522 896 l 139 896 l 139 124 l 376 124 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:0,x_max:47,ha:125,o:"m 47 3 q 37 -7 47 -7 q 28 0 30 -7 q 39 -4 32 -4 q 45 3 45 -1 l 37 0 q 28 9 28 0 q 39 19 28 19 l 47 16 l 47 19 l 47 3 m 37 1 q 44 8 44 1 q 37 16 44 16 q 30 8 30 16 q 37 1 30 1 m 26 1 l 23 22 l 14 0 l 3 22 l 3 3 l 0 25 l 13 1 l 22 25 l 26 1 "},w:{x_min:0,x_max:1009.71875,ha:1100,o:"m 1009 738 l 783 0 l 658 0 l 501 567 l 345 0 l 222 0 l 0 738 l 130 738 l 284 174 l 432 737 l 576 738 l 721 173 l 881 737 l 1009 738 "},$:{x_min:0,x_max:700,ha:793,o:"m 664 717 l 542 717 q 490 825 531 785 q 381 872 450 865 l 381 551 q 620 446 540 522 q 700 241 700 370 q 618 45 700 116 q 381 -25 536 -25 l 381 -152 l 307 -152 l 307 -25 q 81 62 162 -25 q 0 297 0 149 l 124 297 q 169 146 124 204 q 307 81 215 89 l 307 441 q 80 536 148 469 q 13 725 13 603 q 96 910 13 839 q 307 982 180 982 l 307 1077 l 381 1077 l 381 982 q 574 917 494 982 q 664 717 664 845 m 307 565 l 307 872 q 187 831 233 872 q 142 724 142 791 q 180 618 142 656 q 307 565 218 580 m 381 76 q 562 237 562 96 q 517 361 562 313 q 381 423 472 409 l 381 76 "},"\\":{x_min:-.015625,x_max:425.0625,ha:522,o:"m 425 -129 l 337 -129 l 0 1041 l 83 1041 l 425 -129 "},:{x_min:0,x_max:697.21875,ha:747,o:"m 697 -4 q 629 -14 658 -14 q 498 97 513 -14 q 422 9 470 41 q 313 -23 374 -23 q 207 4 258 -23 q 119 81 156 32 l 119 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 173 124 246 q 308 83 216 83 q 452 178 402 83 q 493 359 493 255 l 493 738 l 617 738 l 617 214 q 623 136 617 160 q 673 92 637 92 q 697 96 684 92 l 697 -4 "},:{x_min:42,x_max:181,ha:297,o:"m 181 0 l 42 0 l 42 1013 l 181 1013 l 181 0 "},:{x_min:0,x_max:1144.5,ha:1214,o:"m 1144 1012 l 807 416 l 807 0 l 667 0 l 667 416 l 325 1012 l 465 1012 l 736 533 l 1004 1012 l 1144 1012 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:801,ha:915,o:"m 801 0 l 651 0 l 131 822 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 191 l 670 1013 l 801 1013 l 801 0 "},"-":{x_min:8.71875,x_max:350.390625,ha:478,o:"m 350 317 l 8 317 l 8 428 l 350 428 l 350 317 "},Q:{x_min:0,x_max:968,ha:1072,o:"m 954 5 l 887 -79 l 744 35 q 622 -11 687 2 q 483 -26 556 -26 q 127 130 262 -26 q 0 504 0 279 q 127 880 0 728 q 484 1041 262 1041 q 841 884 708 1041 q 968 507 968 735 q 933 293 968 398 q 832 104 899 188 l 954 5 m 723 191 q 802 330 777 248 q 828 499 828 412 q 744 790 828 673 q 483 922 650 922 q 228 791 322 922 q 142 505 142 673 q 227 221 142 337 q 487 91 323 91 q 632 123 566 91 l 520 215 l 587 301 l 723 191 "},:{x_min:1,x_max:676.28125,ha:740,o:"m 676 460 l 551 460 q 498 595 542 546 q 365 651 448 651 q 199 578 263 651 q 136 401 136 505 q 266 178 136 241 q 508 106 387 142 q 640 -50 640 62 q 625 -158 640 -105 q 583 -278 611 -211 l 465 -278 q 498 -182 490 -211 q 515 -80 515 -126 q 381 12 515 -15 q 134 91 197 51 q 1 388 1 179 q 100 651 1 542 q 354 761 199 761 q 587 680 498 761 q 676 460 676 599 "},M:{x_min:0,x_max:954,ha:1067,o:"m 954 0 l 819 0 l 819 869 l 537 0 l 405 0 l 128 866 l 128 0 l 0 0 l 0 1013 l 200 1013 l 472 160 l 757 1013 l 954 1013 l 954 0 "},:{x_min:0,x_max:1006,ha:1094,o:"m 1006 678 q 914 319 1006 429 q 571 200 814 200 l 571 0 l 433 0 l 433 200 q 92 319 194 200 q 0 678 0 429 l 0 1013 l 139 1013 l 139 679 q 191 417 139 492 q 433 326 255 326 l 433 1013 l 571 1013 l 571 326 l 580 326 q 813 423 747 326 q 868 679 868 502 l 868 1013 l 1006 1013 l 1006 678 "},C:{x_min:0,x_max:886,ha:944,o:"m 886 379 q 760 87 886 201 q 455 -26 634 -26 q 112 136 236 -26 q 0 509 0 283 q 118 882 0 737 q 469 1041 245 1041 q 748 955 630 1041 q 879 708 879 859 l 745 708 q 649 862 724 805 q 473 920 573 920 q 219 791 312 920 q 136 509 136 675 q 217 229 136 344 q 470 99 311 99 q 672 179 591 99 q 753 379 753 259 l 886 379 "},"!":{x_min:0,x_max:138,ha:236,o:"m 138 684 q 116 409 138 629 q 105 244 105 299 l 33 244 q 16 465 33 313 q 0 684 0 616 l 0 1013 l 138 1013 l 138 684 m 138 0 l 0 0 l 0 151 l 138 151 l 138 0 "},"{":{x_min:0,x_max:480.5625,ha:578,o:"m 480 -286 q 237 -213 303 -286 q 187 -45 187 -159 q 194 48 187 -15 q 201 141 201 112 q 164 264 201 225 q 0 314 118 314 l 0 417 q 164 471 119 417 q 201 605 201 514 q 199 665 201 644 q 193 772 193 769 q 241 941 193 887 q 480 1015 308 1015 l 480 915 q 336 866 375 915 q 306 742 306 828 q 310 662 306 717 q 314 577 314 606 q 288 452 314 500 q 176 365 256 391 q 289 275 257 337 q 314 143 314 226 q 313 84 314 107 q 310 -11 310 -5 q 339 -131 310 -94 q 480 -182 377 -182 l 480 -286 "},X:{x_min:-.015625,x_max:854.15625,ha:940,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 428 637 l 675 1013 l 836 1013 l 504 520 l 854 0 "},"#":{x_min:0,x_max:963.890625,ha:1061,o:"m 963 690 l 927 590 l 719 590 l 655 410 l 876 410 l 840 310 l 618 310 l 508 -3 l 393 -2 l 506 309 l 329 310 l 215 -2 l 102 -3 l 212 310 l 0 310 l 36 410 l 248 409 l 312 590 l 86 590 l 120 690 l 347 690 l 459 1006 l 573 1006 l 462 690 l 640 690 l 751 1006 l 865 1006 l 754 690 l 963 690 m 606 590 l 425 590 l 362 410 l 543 410 l 606 590 "},:{x_min:42,x_max:284,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 738 l 167 738 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 103 239 101 q 284 112 257 104 l 284 3 "},:{x_min:0,x_max:906.953125,ha:982,o:"m 283 1040 l 88 799 l 5 799 l 145 1040 l 283 1040 m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1012 l 529 1012 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},")":{x_min:0,x_max:318,ha:415,o:"m 318 365 q 257 25 318 191 q 87 -290 197 -141 l 0 -290 q 140 21 93 -128 q 193 360 193 189 q 141 704 193 537 q 0 1024 97 850 l 87 1024 q 257 706 197 871 q 318 365 318 542 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 314 0 265 q 128 390 67 353 q 56 460 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 "},:{x_min:0,x_max:952.78125,ha:1028,o:"m 952 0 l 0 0 l 400 1013 l 551 1013 l 952 0 m 762 124 l 476 867 l 187 124 l 762 124 "},"}":{x_min:0,x_max:481,ha:578,o:"m 481 314 q 318 262 364 314 q 282 136 282 222 q 284 65 282 97 q 293 -58 293 -48 q 241 -217 293 -166 q 0 -286 174 -286 l 0 -182 q 143 -130 105 -182 q 171 -2 171 -93 q 168 81 171 22 q 165 144 165 140 q 188 275 165 229 q 306 365 220 339 q 191 455 224 391 q 165 588 165 505 q 168 681 165 624 q 171 742 171 737 q 141 865 171 827 q 0 915 102 915 l 0 1015 q 243 942 176 1015 q 293 773 293 888 q 287 675 293 741 q 282 590 282 608 q 318 466 282 505 q 481 417 364 417 l 481 314 "},"":{x_min:-3,x_max:1672,ha:1821,o:"m 846 0 q 664 76 732 0 q 603 244 603 145 q 662 412 603 344 q 846 489 729 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 846 0 962 0 m 845 103 q 945 143 910 103 q 981 243 981 184 q 947 340 981 301 q 845 385 910 385 q 745 342 782 385 q 709 243 709 300 q 742 147 709 186 q 845 103 781 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 m 1428 0 q 1246 76 1314 0 q 1185 244 1185 145 q 1244 412 1185 344 q 1428 489 1311 489 q 1610 412 1542 489 q 1672 244 1672 343 q 1612 76 1672 144 q 1428 0 1545 0 m 1427 103 q 1528 143 1492 103 q 1564 243 1564 184 q 1530 340 1564 301 q 1427 385 1492 385 q 1327 342 1364 385 q 1291 243 1291 300 q 1324 147 1291 186 q 1427 103 1363 103 "},a:{x_min:0,x_max:698.609375,ha:794,o:"m 698 0 q 661 -12 679 -7 q 615 -17 643 -17 q 536 12 564 -17 q 500 96 508 41 q 384 6 456 37 q 236 -25 312 -25 q 65 31 130 -25 q 0 194 0 88 q 118 390 0 334 q 328 435 180 420 q 488 483 476 451 q 495 523 495 504 q 442 619 495 584 q 325 654 389 654 q 209 617 257 654 q 152 513 161 580 l 33 513 q 123 705 33 633 q 332 772 207 772 q 528 712 448 772 q 617 531 617 645 l 617 163 q 624 108 617 126 q 664 90 632 90 l 698 94 l 698 0 m 491 262 l 491 372 q 272 329 350 347 q 128 201 128 294 q 166 113 128 144 q 264 83 205 83 q 414 130 346 83 q 491 262 491 183 "},"":{x_min:0,x_max:941.671875,ha:1039,o:"m 941 334 l 0 334 l 0 410 l 941 410 l 941 334 "},"=":{x_min:8.71875,x_max:780.953125,ha:792,o:"m 780 510 l 8 510 l 8 606 l 780 606 l 780 510 m 780 235 l 8 235 l 8 332 l 780 332 l 780 235 "},N:{x_min:0,x_max:801,ha:914,o:"m 801 0 l 651 0 l 131 823 l 131 0 l 0 0 l 0 1013 l 151 1013 l 670 193 l 670 1013 l 801 1013 l 801 0 "},:{x_min:0,x_max:712,ha:797,o:"m 712 369 q 620 94 712 207 q 362 -26 521 -26 q 230 2 292 -26 q 119 83 167 30 l 119 -278 l 0 -278 l 0 362 q 91 643 0 531 q 355 764 190 764 q 617 647 517 764 q 712 369 712 536 m 583 366 q 530 559 583 480 q 359 651 469 651 q 190 562 252 651 q 135 370 135 483 q 189 176 135 257 q 359 85 250 85 q 528 175 466 85 q 583 366 583 254 "},"":{x_min:0,x_max:941.671875,ha:938,o:"m 941 1033 l 0 1033 l 0 1109 l 941 1109 l 941 1033 "},Z:{x_min:0,x_max:779,ha:849,o:"m 779 0 l 0 0 l 0 113 l 621 896 l 40 896 l 40 1013 l 779 1013 l 778 887 l 171 124 l 779 124 l 779 0 "},u:{x_min:0,x_max:617,ha:729,o:"m 617 0 l 499 0 l 499 110 q 391 10 460 45 q 246 -25 322 -25 q 61 58 127 -25 q 0 258 0 136 l 0 738 l 125 738 l 125 284 q 156 148 125 202 q 273 82 197 82 q 433 165 369 82 q 493 340 493 243 l 493 738 l 617 738 l 617 0 "},k:{x_min:0,x_max:612.484375,ha:697,o:"m 612 738 l 338 465 l 608 0 l 469 0 l 251 382 l 121 251 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 402 l 456 738 l 612 738 "},:{x_min:0,x_max:803,ha:917,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:906.953125,ha:985,o:"m 906 0 l 756 0 l 650 303 l 251 303 l 143 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 609 421 l 452 866 l 293 421 l 609 421 "},s:{x_min:0,x_max:604,ha:697,o:"m 604 217 q 501 36 604 104 q 292 -23 411 -23 q 86 43 166 -23 q 0 238 0 114 l 121 237 q 175 122 121 164 q 300 85 223 85 q 415 112 363 85 q 479 207 479 147 q 361 309 479 276 q 140 372 141 370 q 21 544 21 426 q 111 708 21 647 q 298 761 190 761 q 492 705 413 761 q 583 531 583 643 l 462 531 q 412 625 462 594 q 298 657 363 657 q 199 636 242 657 q 143 558 143 608 q 262 454 143 486 q 484 394 479 397 q 604 217 604 341 "},B:{x_min:0,x_max:778,ha:876,o:"m 580 546 q 724 469 670 535 q 778 311 778 403 q 673 83 778 171 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 892 q 691 633 732 693 q 580 546 650 572 m 393 899 l 139 899 l 139 588 l 379 588 q 521 624 462 588 q 592 744 592 667 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 303 635 219 q 559 436 635 389 q 402 477 494 477 l 139 477 l 139 124 l 419 124 "},"":{x_min:0,x_max:614,ha:708,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 m 378 0 l 236 0 l 236 151 l 378 151 l 378 0 m 614 0 l 472 0 l 472 151 l 614 151 l 614 0 "},"?":{x_min:0,x_max:607,ha:704,o:"m 607 777 q 543 599 607 674 q 422 474 482 537 q 357 272 357 391 l 236 272 q 297 487 236 395 q 411 619 298 490 q 474 762 474 691 q 422 885 474 838 q 301 933 371 933 q 179 880 228 933 q 124 706 124 819 l 0 706 q 94 963 0 872 q 302 1044 177 1044 q 511 973 423 1044 q 607 777 607 895 m 370 0 l 230 0 l 230 151 l 370 151 l 370 0 "},H:{x_min:0,x_max:803,ha:915,o:"m 803 0 l 667 0 l 667 475 l 140 475 l 140 0 l 0 0 l 0 1013 l 140 1013 l 140 599 l 667 599 l 667 1013 l 803 1013 l 803 0 "},:{x_min:0,x_max:675,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 738 l 340 147 l 541 738 l 675 738 "},c:{x_min:1,x_max:701.390625,ha:775,o:"m 701 264 q 584 53 681 133 q 353 -26 487 -26 q 91 91 188 -26 q 1 370 1 201 q 92 645 1 537 q 353 761 190 761 q 572 688 479 761 q 690 493 666 615 l 556 493 q 487 606 545 562 q 356 650 428 650 q 186 563 246 650 q 134 372 134 487 q 188 179 134 258 q 359 88 250 88 q 492 136 437 88 q 566 264 548 185 l 701 264 "},"":{x_min:0,x_max:566.671875,ha:678,o:"m 21 892 l 52 892 l 98 761 l 145 892 l 176 892 l 178 741 l 157 741 l 157 867 l 108 741 l 88 741 l 40 871 l 40 741 l 21 741 l 21 892 m 308 854 l 308 731 q 252 691 308 691 q 227 691 240 691 q 207 696 213 695 l 207 712 l 253 706 q 288 733 288 706 l 288 763 q 244 741 279 741 q 193 797 193 741 q 261 860 193 860 q 287 860 273 860 q 308 854 302 855 m 288 842 l 263 843 q 213 796 213 843 q 248 756 213 756 q 288 796 288 756 l 288 842 m 566 988 l 502 988 l 502 -1 l 439 -1 l 439 988 l 317 988 l 317 -1 l 252 -1 l 252 602 q 81 653 155 602 q 0 805 0 711 q 101 989 0 918 q 309 1053 194 1053 l 566 1053 l 566 988 "},:{x_min:0,x_max:660,ha:745,o:"m 471 550 q 610 450 561 522 q 660 280 660 378 q 578 64 660 151 q 367 -22 497 -22 q 239 5 299 -22 q 126 82 178 32 l 126 -278 l 0 -278 l 0 593 q 54 903 0 801 q 318 1042 127 1042 q 519 964 436 1042 q 603 771 603 887 q 567 644 603 701 q 471 550 532 586 m 337 79 q 476 138 418 79 q 535 279 535 198 q 427 437 535 386 q 226 477 344 477 l 226 583 q 398 620 329 583 q 486 762 486 668 q 435 884 486 833 q 312 935 384 935 q 169 861 219 935 q 126 698 126 797 l 126 362 q 170 169 126 242 q 337 79 224 79 "},:{x_min:0,x_max:954,ha:1068,o:"m 954 0 l 819 0 l 819 868 l 537 0 l 405 0 l 128 865 l 128 0 l 0 0 l 0 1013 l 199 1013 l 472 158 l 758 1013 l 954 1013 l 954 0 "},:{x_min:.109375,x_max:1120,ha:1217,o:"m 1120 505 q 994 132 1120 282 q 642 -29 861 -29 q 290 130 422 -29 q 167 505 167 280 q 294 883 167 730 q 650 1046 430 1046 q 999 882 868 1046 q 1120 505 1120 730 m 977 504 q 896 784 977 669 q 644 915 804 915 q 391 785 484 915 q 307 504 307 669 q 391 224 307 339 q 644 95 486 95 q 894 224 803 95 q 977 504 977 339 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:0,x_max:1158,ha:1275,o:"m 1158 0 l 1022 0 l 1022 475 l 496 475 l 496 0 l 356 0 l 356 1012 l 496 1012 l 496 599 l 1022 599 l 1022 1012 l 1158 1012 l 1158 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},"":{x_min:0,x_max:663.890625,ha:775,o:"m 663 529 q 566 293 663 391 q 331 196 469 196 q 97 294 194 196 q 0 529 0 393 q 96 763 0 665 q 331 861 193 861 q 566 763 469 861 q 663 529 663 665 "},"":{x_min:.1875,x_max:819.546875,ha:886,o:"m 563 561 l 697 561 l 696 487 l 520 487 l 482 416 l 482 380 l 697 380 l 695 308 l 482 308 l 482 0 l 342 0 l 342 308 l 125 308 l 125 380 l 342 380 l 342 417 l 303 487 l 125 487 l 125 561 l 258 561 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 l 563 561 "},"(":{x_min:0,x_max:318.0625,ha:415,o:"m 318 -290 l 230 -290 q 61 23 122 -142 q 0 365 0 190 q 62 712 0 540 q 230 1024 119 869 l 318 1024 q 175 705 219 853 q 125 360 125 542 q 176 22 125 187 q 318 -290 223 -127 "},U:{x_min:0,x_max:796,ha:904,o:"m 796 393 q 681 93 796 212 q 386 -25 566 -25 q 101 95 208 -25 q 0 393 0 211 l 0 1013 l 138 1013 l 138 391 q 204 191 138 270 q 394 107 276 107 q 586 191 512 107 q 656 391 656 270 l 656 1013 l 796 1013 l 796 393 "},:{x_min:.5,x_max:744.953125,ha:822,o:"m 744 737 l 463 54 l 463 -278 l 338 -278 l 338 54 l 154 495 q 104 597 124 569 q 13 651 67 651 l 0 651 l 0 751 l 39 753 q 168 711 121 753 q 242 594 207 676 l 403 208 l 617 737 l 744 737 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 728 407 760 q 563 637 524 696 l 563 739 l 685 739 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 96 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 "},F:{x_min:0,x_max:683.328125,ha:717,o:"m 683 888 l 140 888 l 140 583 l 613 583 l 613 458 l 140 458 l 140 0 l 0 0 l 0 1013 l 683 1013 l 683 888 "},"":{x_min:0,x_max:705.5625,ha:803,o:"m 705 334 l 0 334 l 0 410 l 705 410 l 705 334 "},":":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:0,x_max:854.171875,ha:935,o:"m 854 0 l 683 0 l 423 409 l 166 0 l 0 0 l 347 519 l 18 1013 l 186 1013 l 427 637 l 675 1013 l 836 1013 l 504 521 l 854 0 "},"*":{x_min:116,x_max:674,ha:792,o:"m 674 768 l 475 713 l 610 544 l 517 477 l 394 652 l 272 478 l 178 544 l 314 713 l 116 766 l 153 876 l 341 812 l 342 1013 l 446 1013 l 446 811 l 635 874 l 674 768 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 804 l 777 804 l 777 683 l 458 683 l 458 0 l 319 0 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 "},"":{x_min:0,x_max:347,ha:444,o:"m 173 802 q 43 856 91 802 q 0 977 0 905 q 45 1101 0 1049 q 173 1153 90 1153 q 303 1098 255 1153 q 347 977 347 1049 q 303 856 347 905 q 173 802 256 802 m 173 884 q 238 910 214 884 q 262 973 262 937 q 239 1038 262 1012 q 173 1064 217 1064 q 108 1037 132 1064 q 85 973 85 1010 q 108 910 85 937 q 173 884 132 884 "},V:{x_min:0,x_max:862.71875,ha:940,o:"m 862 1013 l 505 0 l 361 0 l 0 1013 l 143 1013 l 434 165 l 718 1012 l 862 1013 "},:{x_min:0,x_max:734.71875,ha:763,o:"m 723 889 l 9 889 l 9 1013 l 723 1013 l 723 889 m 673 463 l 61 463 l 61 589 l 673 589 l 673 463 m 734 0 l 0 0 l 0 124 l 734 124 l 734 0 "},"":{x_min:0,x_max:0,ha:853},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 588 1046 l 460 1046 l 460 1189 l 588 1189 l 588 1046 m 360 1046 l 232 1046 l 232 1189 l 360 1189 l 360 1046 m 819 1012 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1012 l 140 1012 l 411 533 l 679 1012 l 819 1012 "},"":{x_min:0,x_max:347,ha:454,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 m 347 851 q 310 737 347 784 q 208 669 273 690 l 208 734 q 267 787 250 741 q 280 873 280 821 l 208 873 l 208 1013 l 347 1013 l 347 851 "},"@":{x_min:0,x_max:1260,ha:1357,o:"m 1098 -45 q 877 -160 1001 -117 q 633 -203 752 -203 q 155 -29 327 -203 q 0 360 0 127 q 176 802 0 616 q 687 1008 372 1008 q 1123 854 969 1008 q 1260 517 1260 718 q 1155 216 1260 341 q 868 82 1044 82 q 772 106 801 82 q 737 202 737 135 q 647 113 700 144 q 527 82 594 82 q 367 147 420 82 q 314 312 314 212 q 401 565 314 452 q 639 690 498 690 q 810 588 760 690 l 849 668 l 938 668 q 877 441 900 532 q 833 226 833 268 q 853 182 833 198 q 902 167 873 167 q 1088 272 1012 167 q 1159 512 1159 372 q 1051 793 1159 681 q 687 925 925 925 q 248 747 415 925 q 97 361 97 586 q 226 26 97 159 q 627 -122 370 -122 q 856 -87 737 -122 q 1061 8 976 -53 l 1098 -45 m 786 488 q 738 580 777 545 q 643 615 700 615 q 483 517 548 615 q 425 322 425 430 q 457 203 425 250 q 552 156 490 156 q 722 273 665 156 q 786 488 738 309 "},:{x_min:0,x_max:499,ha:613,o:"m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 m 499 0 l 360 0 l 360 1012 l 499 1012 l 499 0 "},i:{x_min:14,x_max:136,ha:275,o:"m 136 873 l 14 873 l 14 1013 l 136 1013 l 136 873 m 136 0 l 14 0 l 14 737 l 136 737 l 136 0 "},:{x_min:0,x_max:778,ha:877,o:"m 580 545 q 724 468 671 534 q 778 310 778 402 q 673 83 778 170 q 432 0 575 0 l 0 0 l 0 1013 l 411 1013 q 629 957 541 1013 q 732 768 732 891 q 691 632 732 692 q 580 545 650 571 m 393 899 l 139 899 l 139 587 l 379 587 q 521 623 462 587 q 592 744 592 666 q 531 859 592 819 q 393 899 471 899 m 419 124 q 566 169 504 124 q 635 302 635 219 q 559 435 635 388 q 402 476 494 476 l 139 476 l 139 124 l 419 124 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 94 617 199 q 308 -24 455 -24 q 76 94 161 -24 q 0 352 0 199 l 0 739 l 126 739 l 126 355 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 355 492 257 l 492 739 l 617 739 l 617 352 "},"]":{x_min:0,x_max:275,ha:372,o:"m 275 -281 l 0 -281 l 0 -187 l 151 -187 l 151 920 l 0 920 l 0 1013 l 275 1013 l 275 -281 "},m:{x_min:0,x_max:1019,ha:1128,o:"m 1019 0 l 897 0 l 897 454 q 860 591 897 536 q 739 660 816 660 q 613 586 659 660 q 573 436 573 522 l 573 0 l 447 0 l 447 455 q 412 591 447 535 q 294 657 372 657 q 165 586 213 657 q 122 437 122 521 l 122 0 l 0 0 l 0 738 l 117 738 l 117 640 q 202 730 150 697 q 316 763 254 763 q 437 730 381 763 q 525 642 494 697 q 621 731 559 700 q 753 763 682 763 q 943 694 867 763 q 1019 512 1019 625 l 1019 0 "},:{x_min:8.328125,x_max:780.5625,ha:815,o:"m 780 -278 q 715 -294 747 -294 q 616 -257 663 -294 q 548 -175 576 -227 l 379 133 l 143 -277 l 9 -277 l 313 254 l 163 522 q 127 586 131 580 q 36 640 91 640 q 8 637 27 640 l 8 752 l 52 757 q 162 719 113 757 q 236 627 200 690 l 383 372 l 594 737 l 726 737 l 448 250 l 625 -69 q 670 -153 647 -110 q 743 -188 695 -188 q 780 -184 759 -188 l 780 -278 "},:{x_min:42,x_max:326.71875,ha:361,o:"m 284 3 q 233 -10 258 -5 q 182 -15 207 -15 q 85 26 119 -15 q 42 200 42 79 l 42 737 l 167 737 l 168 215 q 172 141 168 157 q 226 101 183 101 q 248 102 239 101 q 284 112 257 104 l 284 3 m 326 1040 l 137 819 l 54 819 l 189 1040 l 326 1040 "},:{x_min:0,x_max:779.171875,ha:850,o:"m 779 0 l 0 0 l 0 113 l 620 896 l 40 896 l 40 1013 l 779 1013 l 779 887 l 170 124 l 779 124 l 779 0 "},R:{x_min:0,x_max:781.953125,ha:907,o:"m 781 0 l 623 0 q 587 242 590 52 q 407 433 585 433 l 138 433 l 138 0 l 0 0 l 0 1013 l 396 1013 q 636 946 539 1013 q 749 731 749 868 q 711 597 749 659 q 608 502 674 534 q 718 370 696 474 q 729 207 722 352 q 781 26 736 62 l 781 0 m 373 551 q 533 594 465 551 q 614 731 614 645 q 532 859 614 815 q 373 896 465 896 l 138 896 l 138 551 l 373 551 "},o:{x_min:0,x_max:713,ha:821,o:"m 357 -25 q 94 91 194 -25 q 0 368 0 202 q 93 642 0 533 q 357 761 193 761 q 618 644 518 761 q 713 368 713 533 q 619 91 713 201 q 357 -25 521 -25 m 357 85 q 528 175 465 85 q 584 369 584 255 q 529 562 584 484 q 357 651 467 651 q 189 560 250 651 q 135 369 135 481 q 187 177 135 257 q 357 85 250 85 "},K:{x_min:0,x_max:819.46875,ha:906,o:"m 819 0 l 649 0 l 294 509 l 139 355 l 139 0 l 0 0 l 0 1013 l 139 1013 l 139 526 l 626 1013 l 809 1013 l 395 600 l 819 0 "},",":{x_min:0,x_max:142,ha:239,o:"m 142 -12 q 105 -132 142 -82 q 0 -205 68 -182 l 0 -138 q 57 -82 40 -124 q 70 0 70 -51 l 0 0 l 0 151 l 142 151 l 142 -12 "},d:{x_min:0,x_max:683,ha:796,o:"m 683 0 l 564 0 l 564 93 q 456 6 516 38 q 327 -25 395 -25 q 87 100 181 -25 q 0 365 0 215 q 90 639 0 525 q 343 763 187 763 q 564 647 486 763 l 564 1013 l 683 1013 l 683 0 m 582 373 q 529 562 582 484 q 361 653 468 653 q 190 561 253 653 q 135 365 135 479 q 189 175 135 254 q 358 85 251 85 q 529 178 468 85 q 582 373 582 258 "},"":{x_min:-109,x_max:247,ha:232,o:"m 247 1046 l 119 1046 l 119 1189 l 247 1189 l 247 1046 m 19 1046 l -109 1046 l -109 1189 l 19 1189 l 19 1046 "},E:{x_min:0,x_max:736.109375,ha:789,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},Y:{x_min:0,x_max:820,ha:886,o:"m 820 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 534 l 679 1012 l 820 1013 "},'"':{x_min:0,x_max:299,ha:396,o:"m 299 606 l 203 606 l 203 988 l 299 988 l 299 606 m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:364,ha:467,o:"m 141 -12 q 104 -132 141 -82 q 0 -205 67 -182 l 0 -138 q 56 -82 40 -124 q 69 0 69 -51 l 0 0 l 0 151 l 141 151 l 141 -12 m 364 -12 q 327 -132 364 -82 q 222 -205 290 -182 l 222 -138 q 279 -82 262 -124 q 292 0 292 -51 l 222 0 l 222 151 l 364 151 l 364 -12 "},:{x_min:1,x_max:710,ha:810,o:"m 710 360 q 616 87 710 196 q 356 -28 518 -28 q 99 82 197 -28 q 1 356 1 192 q 100 606 1 509 q 355 703 199 703 q 180 829 288 754 q 70 903 124 866 l 70 1012 l 643 1012 l 643 901 l 258 901 q 462 763 422 794 q 636 592 577 677 q 710 360 710 485 m 584 365 q 552 501 584 447 q 451 602 521 555 q 372 611 411 611 q 197 541 258 611 q 136 355 136 472 q 190 171 136 245 q 358 85 252 85 q 528 173 465 85 q 584 365 584 252 "},:{x_min:0,x_max:634.71875,ha:714,o:"m 634 234 q 527 38 634 110 q 300 -25 433 -25 q 98 29 183 -25 q 0 204 0 93 q 37 313 0 265 q 128 390 67 352 q 56 459 82 419 q 26 555 26 505 q 114 712 26 654 q 295 763 191 763 q 499 700 416 763 q 589 515 589 631 l 478 515 q 419 618 464 580 q 307 657 374 657 q 207 630 253 657 q 151 547 151 598 q 238 445 151 469 q 389 434 280 434 l 389 331 l 349 331 q 206 315 255 331 q 125 210 125 287 q 183 107 125 145 q 302 76 233 76 q 436 117 379 76 q 509 234 493 159 l 634 234 m 520 1040 l 331 819 l 248 819 l 383 1040 l 520 1040 "},:{x_min:0,x_max:922,ha:1031,o:"m 922 339 q 856 97 922 203 q 650 -26 780 -26 q 538 9 587 -26 q 461 103 489 44 q 387 12 436 46 q 277 -22 339 -22 q 69 97 147 -22 q 0 339 0 203 q 45 551 0 444 q 161 738 84 643 l 302 738 q 175 553 219 647 q 124 336 124 446 q 155 179 124 249 q 275 88 197 88 q 375 163 341 88 q 400 294 400 219 l 400 572 l 524 572 l 524 294 q 561 135 524 192 q 643 88 591 88 q 762 182 719 88 q 797 342 797 257 q 745 556 797 450 q 619 738 705 638 l 760 738 q 874 551 835 640 q 922 339 922 444 "},"":{x_min:0,x_max:96,ha:251,o:"m 96 606 l 0 606 l 0 988 l 96 988 l 96 606 "},"":{x_min:11,x_max:781,ha:792,o:"m 781 490 l 446 490 l 446 255 l 349 255 l 349 490 l 11 490 l 11 586 l 349 586 l 349 819 l 446 819 l 446 586 l 781 586 l 781 490 m 781 21 l 11 21 l 11 115 l 781 115 l 781 21 "},"|":{x_min:343,x_max:449,ha:792,o:"m 449 462 l 343 462 l 343 986 l 449 986 l 449 462 m 449 -242 l 343 -242 l 343 280 l 449 280 l 449 -242 "},:{x_min:0,x_max:617,ha:725,o:"m 482 800 l 372 800 l 372 925 l 482 925 l 482 800 m 239 800 l 129 800 l 129 925 l 239 925 l 239 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 "},"":{x_min:0,x_max:593,ha:690,o:"m 593 425 q 554 312 593 369 q 467 233 516 254 q 537 83 537 172 q 459 -74 537 -12 q 288 -133 387 -133 q 115 -69 184 -133 q 47 96 47 -6 l 166 96 q 199 7 166 40 q 288 -26 232 -26 q 371 -5 332 -26 q 420 60 420 21 q 311 201 420 139 q 108 309 210 255 q 0 490 0 383 q 33 602 0 551 q 124 687 66 654 q 75 743 93 712 q 58 812 58 773 q 133 984 58 920 q 300 1043 201 1043 q 458 987 394 1043 q 529 814 529 925 l 411 814 q 370 908 404 877 q 289 939 336 939 q 213 911 246 939 q 180 841 180 883 q 286 720 180 779 q 484 612 480 615 q 593 425 593 534 m 467 409 q 355 544 467 473 q 196 630 228 612 q 146 587 162 609 q 124 525 124 558 q 239 387 124 462 q 398 298 369 315 q 448 345 429 316 q 467 409 467 375 "},b:{x_min:0,x_max:685,ha:783,o:"m 685 372 q 597 99 685 213 q 347 -25 501 -25 q 219 5 277 -25 q 121 93 161 36 l 121 0 l 0 0 l 0 1013 l 121 1013 l 121 634 q 214 723 157 692 q 341 754 272 754 q 591 637 493 754 q 685 372 685 526 m 554 356 q 499 550 554 470 q 328 644 437 644 q 162 556 223 644 q 108 369 108 478 q 160 176 108 256 q 330 83 221 83 q 498 169 435 83 q 554 356 554 245 "},q:{x_min:0,x_max:683,ha:876,o:"m 683 -278 l 564 -278 l 564 97 q 474 8 533 39 q 345 -23 415 -23 q 91 93 188 -23 q 0 364 0 203 q 87 635 0 522 q 337 760 184 760 q 466 727 408 760 q 564 637 523 695 l 564 737 l 683 737 l 683 -278 m 582 375 q 527 564 582 488 q 358 652 466 652 q 190 565 253 652 q 135 377 135 488 q 189 179 135 261 q 361 84 251 84 q 530 179 469 84 q 582 375 582 260 "},:{x_min:-.171875,x_max:969.5625,ha:1068,o:"m 969 0 l 555 0 l 555 123 q 744 308 675 194 q 814 558 814 423 q 726 812 814 709 q 484 922 633 922 q 244 820 334 922 q 154 567 154 719 q 223 316 154 433 q 412 123 292 199 l 412 0 l 0 0 l 0 124 l 217 124 q 68 327 122 210 q 15 572 15 444 q 144 911 15 781 q 484 1041 274 1041 q 822 909 691 1041 q 953 569 953 777 q 899 326 953 443 q 750 124 846 210 l 969 124 l 969 0 "},:{x_min:0,x_max:617,ha:725,o:"m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 535 1040 l 346 819 l 262 819 l 397 1040 l 535 1040 "},z:{x_min:-.015625,x_max:613.890625,ha:697,o:"m 613 0 l 0 0 l 0 100 l 433 630 l 20 630 l 20 738 l 594 738 l 593 636 l 163 110 l 613 110 l 613 0 "},"":{x_min:0,x_max:894,ha:1e3,o:"m 389 951 l 229 951 l 229 503 l 160 503 l 160 951 l 0 951 l 0 1011 l 389 1011 l 389 951 m 894 503 l 827 503 l 827 939 l 685 503 l 620 503 l 481 937 l 481 503 l 417 503 l 417 1011 l 517 1011 l 653 580 l 796 1010 l 894 1011 l 894 503 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 721 124 755 q 200 630 193 687 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 m 479 1040 l 290 819 l 207 819 l 341 1040 l 479 1040 "},:{x_min:0,x_max:960,ha:1056,o:"m 960 507 q 833 129 960 280 q 476 -32 698 -32 q 123 129 255 -32 q 0 507 0 280 q 123 883 0 732 q 476 1045 255 1045 q 832 883 696 1045 q 960 507 960 732 m 817 500 q 733 789 817 669 q 476 924 639 924 q 223 792 317 924 q 142 507 142 675 q 222 222 142 339 q 476 89 315 89 q 730 218 636 89 q 817 500 817 334 m 716 449 l 243 449 l 243 571 l 716 571 l 716 449 "},"":{x_min:-3,x_max:1008,ha:1106,o:"m 503 532 q 614 562 566 532 q 672 658 672 598 q 614 747 672 716 q 503 772 569 772 l 338 772 l 338 532 l 503 532 m 502 -7 q 123 151 263 -7 q -3 501 -3 294 q 123 851 -3 706 q 502 1011 263 1011 q 881 851 739 1011 q 1008 501 1008 708 q 883 151 1008 292 q 502 -7 744 -7 m 502 60 q 830 197 709 60 q 940 501 940 322 q 831 805 940 681 q 502 944 709 944 q 174 805 296 944 q 65 501 65 680 q 173 197 65 320 q 502 60 294 60 m 788 146 l 678 146 q 653 316 655 183 q 527 449 652 449 l 338 449 l 338 146 l 241 146 l 241 854 l 518 854 q 688 808 621 854 q 766 658 766 755 q 739 563 766 607 q 668 497 713 519 q 751 331 747 472 q 788 164 756 190 l 788 146 "},"~":{x_min:0,x_max:833,ha:931,o:"m 833 958 q 778 753 833 831 q 594 665 716 665 q 402 761 502 665 q 240 857 302 857 q 131 795 166 857 q 104 665 104 745 l 0 665 q 54 867 0 789 q 237 958 116 958 q 429 861 331 958 q 594 765 527 765 q 704 827 670 765 q 729 958 729 874 l 833 958 "},:{x_min:0,x_max:736.21875,ha:778,o:"m 736 0 l 0 0 l 0 1013 l 725 1013 l 725 889 l 139 889 l 139 585 l 677 585 l 677 467 l 139 467 l 139 125 l 736 125 l 736 0 "},"":{x_min:0,x_max:450,ha:547,o:"m 450 552 q 379 413 450 464 q 220 366 313 366 q 69 414 130 366 q 0 567 0 470 l 85 567 q 126 470 85 504 q 225 437 168 437 q 320 467 280 437 q 360 552 360 498 q 318 632 360 608 q 213 657 276 657 q 195 657 203 657 q 176 657 181 657 l 176 722 q 279 733 249 722 q 334 815 334 752 q 300 881 334 856 q 220 907 267 907 q 133 875 169 907 q 97 781 97 844 l 15 781 q 78 926 15 875 q 220 972 135 972 q 364 930 303 972 q 426 817 426 888 q 344 697 426 733 q 421 642 392 681 q 450 552 450 603 "},"[":{x_min:0,x_max:273.609375,ha:371,o:"m 273 -281 l 0 -281 l 0 1013 l 273 1013 l 273 920 l 124 920 l 124 -187 l 273 -187 l 273 -281 "},L:{x_min:0,x_max:645.828125,ha:696,o:"m 645 0 l 0 0 l 0 1013 l 140 1013 l 140 126 l 645 126 l 645 0 "},:{x_min:0,x_max:803.390625,ha:894,o:"m 803 628 l 633 628 q 713 368 713 512 q 618 93 713 204 q 357 -25 518 -25 q 94 91 194 -25 q 0 368 0 201 q 94 644 0 533 q 356 761 194 761 q 481 750 398 761 q 608 739 564 739 l 803 739 l 803 628 m 360 85 q 529 180 467 85 q 584 374 584 262 q 527 566 584 490 q 352 651 463 651 q 187 559 247 651 q 135 368 135 478 q 189 175 135 254 q 360 85 251 85 "},:{x_min:0,x_max:573,ha:642,o:"m 573 -40 q 553 -162 573 -97 q 510 -278 543 -193 l 400 -278 q 441 -187 428 -219 q 462 -90 462 -132 q 378 -14 462 -14 q 108 45 197 -14 q 0 290 0 117 q 108 631 0 462 q 353 901 194 767 l 55 901 l 55 1012 l 561 1012 l 561 924 q 261 669 382 831 q 128 301 128 489 q 243 117 128 149 q 458 98 350 108 q 573 -40 573 80 "},:{x_min:0,x_max:674,ha:778,o:"m 674 496 q 601 160 674 304 q 336 -26 508 -26 q 73 153 165 -26 q 0 485 0 296 q 72 840 0 683 q 343 1045 166 1045 q 605 844 516 1045 q 674 496 674 692 m 546 579 q 498 798 546 691 q 336 935 437 935 q 178 798 237 935 q 126 579 137 701 l 546 579 m 546 475 l 126 475 q 170 233 126 348 q 338 80 230 80 q 504 233 447 80 q 546 475 546 346 "},:{x_min:0,x_max:958,ha:1054,o:"m 485 1042 q 834 883 703 1042 q 958 511 958 735 q 834 136 958 287 q 481 -26 701 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 729 q 485 1042 263 1042 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 670 q 480 913 640 913 q 226 785 321 913 q 142 504 142 671 q 226 224 142 339 q 480 98 319 98 "},:{x_min:0,x_max:705.28125,ha:749,o:"m 705 886 l 140 886 l 140 0 l 0 0 l 0 1012 l 705 1012 l 705 886 "}," ":{x_min:0,x_max:0,ha:375},"%":{x_min:-3,x_max:1089,ha:1186,o:"m 845 0 q 663 76 731 0 q 602 244 602 145 q 661 412 602 344 q 845 489 728 489 q 1027 412 959 489 q 1089 244 1089 343 q 1029 76 1089 144 q 845 0 962 0 m 844 103 q 945 143 909 103 q 981 243 981 184 q 947 340 981 301 q 844 385 909 385 q 744 342 781 385 q 708 243 708 300 q 741 147 708 186 q 844 103 780 103 m 888 986 l 284 -25 l 199 -25 l 803 986 l 888 986 m 241 468 q 58 545 126 468 q -3 715 -3 615 q 56 881 -3 813 q 238 958 124 958 q 421 881 353 958 q 483 712 483 813 q 423 544 483 612 q 241 468 356 468 m 241 855 q 137 811 175 855 q 100 710 100 768 q 136 612 100 653 q 240 572 172 572 q 344 614 306 572 q 382 713 382 656 q 347 810 382 771 q 241 855 308 855 "},P:{x_min:0,x_max:726,ha:806,o:"m 424 1013 q 640 931 555 1013 q 726 719 726 850 q 637 506 726 587 q 413 426 548 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 379 889 l 140 889 l 140 548 l 372 548 q 522 589 459 548 q 593 720 593 637 q 528 845 593 801 q 379 889 463 889 "},:{x_min:0,x_max:1078.21875,ha:1118,o:"m 1078 0 l 342 0 l 342 1013 l 1067 1013 l 1067 889 l 481 889 l 481 585 l 1019 585 l 1019 467 l 481 467 l 481 125 l 1078 125 l 1078 0 m 277 1040 l 83 799 l 0 799 l 140 1040 l 277 1040 "},:{x_min:.125,x_max:1136.546875,ha:1235,o:"m 1136 0 l 722 0 l 722 123 q 911 309 842 194 q 981 558 981 423 q 893 813 981 710 q 651 923 800 923 q 411 821 501 923 q 321 568 321 720 q 390 316 321 433 q 579 123 459 200 l 579 0 l 166 0 l 166 124 l 384 124 q 235 327 289 210 q 182 572 182 444 q 311 912 182 782 q 651 1042 441 1042 q 989 910 858 1042 q 1120 569 1120 778 q 1066 326 1120 443 q 917 124 1013 210 l 1136 124 l 1136 0 m 277 1040 l 83 800 l 0 800 l 140 1041 l 277 1040 "},_:{x_min:0,x_max:705.5625,ha:803,o:"m 705 -334 l 0 -334 l 0 -234 l 705 -234 l 705 -334 "},:{x_min:-110,x_max:246,ha:275,o:"m 246 1046 l 118 1046 l 118 1189 l 246 1189 l 246 1046 m 18 1046 l -110 1046 l -110 1189 l 18 1189 l 18 1046 m 136 0 l 0 0 l 0 1012 l 136 1012 l 136 0 "},"+":{x_min:23,x_max:768,ha:792,o:"m 768 372 l 444 372 l 444 0 l 347 0 l 347 372 l 23 372 l 23 468 l 347 468 l 347 840 l 444 840 l 444 468 l 768 468 l 768 372 "},"":{x_min:0,x_max:1050,ha:1149,o:"m 1050 0 l 625 0 q 712 178 625 108 q 878 277 722 187 q 967 385 967 328 q 932 456 967 429 q 850 484 897 484 q 759 450 798 484 q 721 352 721 416 l 640 352 q 706 502 640 448 q 851 551 766 551 q 987 509 931 551 q 1050 385 1050 462 q 976 251 1050 301 q 829 179 902 215 q 717 68 740 133 l 1050 68 l 1050 0 m 834 985 l 215 -28 l 130 -28 l 750 984 l 834 985 m 224 422 l 142 422 l 142 811 l 0 811 l 0 867 q 104 889 62 867 q 164 973 157 916 l 224 973 l 224 422 "},:{x_min:0,x_max:720,ha:783,o:"m 424 1013 q 637 933 554 1013 q 720 723 720 853 q 633 508 720 591 q 413 426 546 426 l 140 426 l 140 0 l 0 0 l 0 1013 l 424 1013 m 378 889 l 140 889 l 140 548 l 371 548 q 521 589 458 548 q 592 720 592 637 q 527 845 592 801 q 378 889 463 889 "},"'":{x_min:0,x_max:139,ha:236,o:"m 139 851 q 102 737 139 784 q 0 669 65 690 l 0 734 q 59 787 42 741 q 72 873 72 821 l 0 873 l 0 1013 l 139 1013 l 139 851 "},:{x_min:0,x_max:350,ha:397,o:"m 350 625 q 307 616 328 616 q 266 631 281 616 q 247 673 251 645 q 190 628 225 644 q 116 613 156 613 q 32 641 64 613 q 0 722 0 669 q 72 826 0 800 q 247 866 159 846 l 247 887 q 220 934 247 916 q 162 953 194 953 q 104 934 129 953 q 76 882 80 915 l 16 882 q 60 976 16 941 q 166 1011 104 1011 q 266 979 224 1011 q 308 891 308 948 l 308 706 q 311 679 308 688 q 331 670 315 670 l 350 672 l 350 625 m 247 757 l 247 811 q 136 790 175 798 q 64 726 64 773 q 83 682 64 697 q 132 667 103 667 q 207 690 174 667 q 247 757 247 718 "},"":{x_min:0,x_max:450,ha:553,o:"m 450 800 l 340 800 l 340 925 l 450 925 l 450 800 m 406 1040 l 212 800 l 129 800 l 269 1040 l 406 1040 m 110 800 l 0 800 l 0 925 l 110 925 l 110 800 "},T:{x_min:0,x_max:777,ha:835,o:"m 777 894 l 458 894 l 458 0 l 319 0 l 319 894 l 0 894 l 0 1013 l 777 1013 l 777 894 "},:{x_min:0,x_max:915,ha:997,o:"m 527 0 l 389 0 l 389 122 q 110 231 220 122 q 0 509 0 340 q 110 785 0 677 q 389 893 220 893 l 389 1013 l 527 1013 l 527 893 q 804 786 693 893 q 915 509 915 679 q 805 231 915 341 q 527 122 696 122 l 527 0 m 527 226 q 712 310 641 226 q 779 507 779 389 q 712 705 779 627 q 527 787 641 787 l 527 226 m 389 226 l 389 787 q 205 698 275 775 q 136 505 136 620 q 206 308 136 391 q 389 226 276 226 "},"":{x_min:0,x_max:0,ha:694},j:{x_min:-77.78125,x_max:167,ha:349,o:"m 167 871 l 42 871 l 42 1013 l 167 1013 l 167 871 m 167 -80 q 121 -231 167 -184 q -26 -278 76 -278 l -77 -278 l -77 -164 l -41 -164 q 26 -143 11 -164 q 42 -65 42 -122 l 42 737 l 167 737 l 167 -80 "},:{x_min:0,x_max:756.953125,ha:819,o:"m 756 0 l 0 0 l 0 107 l 395 523 l 22 904 l 22 1013 l 745 1013 l 745 889 l 209 889 l 566 523 l 187 125 l 756 125 l 756 0 "},"":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},"<":{x_min:17.984375,x_max:773.609375,ha:792,o:"m 773 40 l 18 376 l 17 465 l 773 799 l 773 692 l 159 420 l 773 149 l 773 40 "},"":{x_min:0,x_max:704.484375,ha:801,o:"m 704 41 q 623 -10 664 5 q 543 -26 583 -26 q 359 15 501 -26 q 243 36 288 36 q 158 23 197 36 q 73 -21 119 10 l 6 76 q 125 195 90 150 q 175 331 175 262 q 147 443 175 383 l 0 443 l 0 512 l 108 512 q 43 734 43 623 q 120 929 43 854 q 358 1010 204 1010 q 579 936 487 1010 q 678 729 678 857 l 678 684 l 552 684 q 504 838 552 780 q 362 896 457 896 q 216 852 263 896 q 176 747 176 815 q 199 627 176 697 q 248 512 217 574 l 468 512 l 468 443 l 279 443 q 297 356 297 398 q 230 194 297 279 q 153 107 211 170 q 227 133 190 125 q 293 142 264 142 q 410 119 339 142 q 516 96 482 96 q 579 105 550 96 q 648 142 608 115 l 704 41 "},t:{x_min:0,x_max:367,ha:458,o:"m 367 0 q 312 -5 339 -2 q 262 -8 284 -8 q 145 28 183 -8 q 108 143 108 64 l 108 638 l 0 638 l 0 738 l 108 738 l 108 944 l 232 944 l 232 738 l 367 738 l 367 638 l 232 638 l 232 185 q 248 121 232 140 q 307 102 264 102 q 345 104 330 102 q 367 107 360 107 l 367 0 "},"":{x_min:0,x_max:706,ha:803,o:"m 706 411 l 706 158 l 630 158 l 630 335 l 0 335 l 0 411 l 706 411 "},:{x_min:0,x_max:750,ha:803,o:"m 750 -7 q 679 -15 716 -15 q 538 59 591 -15 q 466 214 512 97 l 336 551 l 126 0 l 0 0 l 270 705 q 223 837 247 770 q 116 899 190 899 q 90 898 100 899 l 90 1004 q 152 1011 125 1011 q 298 938 244 1011 q 373 783 326 901 l 605 192 q 649 115 629 136 q 716 95 669 95 l 736 95 q 750 97 745 97 l 750 -7 "},W:{x_min:0,x_max:1263.890625,ha:1351,o:"m 1263 1013 l 995 0 l 859 0 l 627 837 l 405 0 l 265 0 l 0 1013 l 136 1013 l 342 202 l 556 1013 l 701 1013 l 921 207 l 1133 1012 l 1263 1013 "},">":{x_min:18.0625,x_max:774,ha:792,o:"m 774 376 l 18 40 l 18 149 l 631 421 l 18 692 l 18 799 l 774 465 l 774 376 "},v:{x_min:0,x_max:675.15625,ha:761,o:"m 675 738 l 404 0 l 272 0 l 0 738 l 133 737 l 340 147 l 541 737 l 675 738 "},:{x_min:.28125,x_max:644.5,ha:703,o:"m 644 628 l 382 628 l 382 179 q 388 120 382 137 q 436 91 401 91 q 474 94 447 91 q 504 97 501 97 l 504 0 q 454 -9 482 -5 q 401 -14 426 -14 q 278 67 308 -14 q 260 233 260 118 l 260 628 l 0 628 l 0 739 l 644 739 l 644 628 "},:{x_min:0,x_max:624.9375,ha:699,o:"m 624 -37 q 608 -153 624 -96 q 563 -278 593 -211 l 454 -278 q 491 -183 486 -200 q 511 -83 511 -126 q 484 -23 511 -44 q 370 1 452 1 q 323 0 354 1 q 283 -1 293 -1 q 84 76 169 -1 q 0 266 0 154 q 56 431 0 358 q 197 538 108 498 q 94 613 134 562 q 54 730 54 665 q 77 823 54 780 q 143 901 101 867 l 27 901 l 27 1012 l 576 1012 l 576 901 l 380 901 q 244 863 303 901 q 178 745 178 820 q 312 600 178 636 q 532 582 380 582 l 532 479 q 276 455 361 479 q 118 281 118 410 q 165 173 118 217 q 274 120 208 133 q 494 101 384 110 q 624 -37 624 76 "},"&":{x_min:-3,x_max:894.25,ha:992,o:"m 894 0 l 725 0 l 624 123 q 471 0 553 40 q 306 -41 390 -41 q 168 -7 231 -41 q 62 92 105 26 q 14 187 31 139 q -3 276 -3 235 q 55 433 -3 358 q 248 581 114 508 q 170 689 196 640 q 137 817 137 751 q 214 985 137 922 q 384 1041 284 1041 q 548 988 483 1041 q 622 824 622 928 q 563 666 622 739 q 431 556 516 608 l 621 326 q 649 407 639 361 q 663 493 653 426 l 781 493 q 703 229 781 352 l 894 0 m 504 818 q 468 908 504 877 q 384 940 433 940 q 293 907 331 940 q 255 818 255 875 q 289 714 255 767 q 363 628 313 678 q 477 729 446 682 q 504 818 504 771 m 556 209 l 314 499 q 179 395 223 449 q 135 283 135 341 q 146 222 135 253 q 183 158 158 192 q 333 80 241 80 q 556 209 448 80 "},:{x_min:0,x_max:862.5,ha:942,o:"m 862 0 l 719 0 l 426 847 l 143 0 l 0 0 l 356 1013 l 501 1013 l 862 0 "},I:{x_min:41,x_max:180,ha:293,o:"m 180 0 l 41 0 l 41 1013 l 180 1013 l 180 0 "},G:{x_min:0,x_max:921,ha:1011,o:"m 921 0 l 832 0 l 801 136 q 655 15 741 58 q 470 -28 568 -28 q 126 133 259 -28 q 0 499 0 284 q 125 881 0 731 q 486 1043 259 1043 q 763 957 647 1043 q 905 709 890 864 l 772 709 q 668 866 747 807 q 486 926 589 926 q 228 795 322 926 q 142 507 142 677 q 228 224 142 342 q 483 94 323 94 q 712 195 625 94 q 796 435 796 291 l 477 435 l 477 549 l 921 549 l 921 0 "},:{x_min:0,x_max:617,ha:725,o:"m 524 800 l 414 800 l 414 925 l 524 925 l 524 800 m 183 800 l 73 800 l 73 925 l 183 925 l 183 800 m 617 352 q 540 93 617 199 q 308 -24 455 -24 q 76 93 161 -24 q 0 352 0 199 l 0 738 l 126 738 l 126 354 q 169 185 126 257 q 312 98 220 98 q 451 185 402 98 q 492 354 492 257 l 492 738 l 617 738 l 617 352 m 489 1040 l 300 819 l 216 819 l 351 1040 l 489 1040 "},"`":{x_min:0,x_max:138.890625,ha:236,o:"m 138 699 l 0 699 l 0 861 q 36 974 0 929 q 138 1041 72 1020 l 138 977 q 82 931 95 969 q 69 839 69 893 l 138 839 l 138 699 "},"":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 "},:{x_min:.328125,x_max:819.515625,ha:889,o:"m 819 1013 l 482 416 l 482 0 l 342 0 l 342 416 l 0 1013 l 140 1013 l 411 533 l 679 1013 l 819 1013 "},r:{x_min:0,x_max:355.5625,ha:432,o:"m 355 621 l 343 621 q 179 569 236 621 q 122 411 122 518 l 122 0 l 0 0 l 0 737 l 117 737 l 117 604 q 204 719 146 686 q 355 753 262 753 l 355 621 "},x:{x_min:0,x_max:675,ha:764,o:"m 675 0 l 525 0 l 331 286 l 144 0 l 0 0 l 256 379 l 12 738 l 157 737 l 336 473 l 516 738 l 661 738 l 412 380 l 675 0 "},:{x_min:0,x_max:696.609375,ha:747,o:"m 696 -4 q 628 -14 657 -14 q 498 97 513 -14 q 422 8 470 41 q 313 -24 374 -24 q 207 3 258 -24 q 120 80 157 31 l 120 -278 l 0 -278 l 0 738 l 124 738 l 124 343 q 165 172 124 246 q 308 82 216 82 q 451 177 402 82 q 492 358 492 254 l 492 738 l 616 738 l 616 214 q 623 136 616 160 q 673 92 636 92 q 696 95 684 92 l 696 -4 "},h:{x_min:0,x_max:615,ha:724,o:"m 615 472 l 615 0 l 490 0 l 490 454 q 456 590 490 535 q 338 654 416 654 q 186 588 251 654 q 122 436 122 522 l 122 0 l 0 0 l 0 1013 l 122 1013 l 122 633 q 218 727 149 694 q 362 760 287 760 q 552 676 484 760 q 615 472 615 600 "},".":{x_min:0,x_max:142,ha:239,o:"m 142 0 l 0 0 l 0 151 l 142 151 l 142 0 "},:{x_min:-2,x_max:878,ha:974,o:"m 496 -279 l 378 -279 l 378 -17 q 101 88 204 -17 q -2 367 -2 194 q 68 626 -2 510 q 283 758 151 758 l 283 646 q 167 537 209 626 q 133 373 133 462 q 192 177 133 254 q 378 93 259 93 l 378 758 q 445 764 426 763 q 476 765 464 765 q 765 659 653 765 q 878 377 878 553 q 771 96 878 209 q 496 -17 665 -17 l 496 -279 m 496 93 l 514 93 q 687 183 623 93 q 746 380 746 265 q 691 569 746 491 q 522 658 629 658 l 496 656 l 496 93 "},";":{x_min:0,x_max:142,ha:239,o:"m 142 585 l 0 585 l 0 738 l 142 738 l 142 585 m 142 -12 q 105 -132 142 -82 q 0 -206 68 -182 l 0 -138 q 58 -82 43 -123 q 68 0 68 -56 l 0 0 l 0 151 l 142 151 l 142 -12 "},f:{x_min:0,x_max:378,ha:472,o:"m 378 638 l 246 638 l 246 0 l 121 0 l 121 638 l 0 638 l 0 738 l 121 738 q 137 935 121 887 q 290 1028 171 1028 q 320 1027 305 1028 q 378 1021 334 1026 l 378 908 q 323 918 346 918 q 257 870 273 918 q 246 780 246 840 l 246 738 l 378 738 l 378 638 "},"":{x_min:1,x_max:348.21875,ha:454,o:"m 140 670 l 1 670 l 1 830 q 37 943 1 897 q 140 1011 74 990 l 140 947 q 82 900 97 940 q 68 810 68 861 l 140 810 l 140 670 m 348 670 l 209 670 l 209 830 q 245 943 209 897 q 348 1011 282 990 l 348 947 q 290 900 305 940 q 276 810 276 861 l 348 810 l 348 670 "},A:{x_min:.03125,x_max:906.953125,ha:1008,o:"m 906 0 l 756 0 l 648 303 l 251 303 l 142 0 l 0 0 l 376 1013 l 529 1013 l 906 0 m 610 421 l 452 867 l 293 421 l 610 421 "},"":{x_min:1,x_max:139.890625,ha:236,o:"m 139 670 l 1 670 l 1 830 q 37 943 1 897 q 139 1011 74 990 l 139 947 q 82 900 97 940 q 68 810 68 861 l 139 810 l 139 670 "},:{x_min:-70,x_max:283,ha:361,o:"m 283 800 l 173 800 l 173 925 l 283 925 l 283 800 m 40 800 l -70 800 l -70 925 l 40 925 l 40 800 m 283 3 q 232 -10 257 -5 q 181 -15 206 -15 q 84 26 118 -15 q 41 200 41 79 l 41 737 l 166 737 l 167 215 q 171 141 167 157 q 225 101 182 101 q 247 103 238 101 q 283 112 256 104 l 283 3 "},:{x_min:-.21875,x_max:773.21875,ha:857,o:"m 773 -7 l 707 -11 q 575 40 607 -11 q 552 174 552 77 l 552 226 l 552 626 l 222 626 l 222 0 l 97 0 l 97 626 l 0 626 l 0 737 l 773 737 l 773 626 l 676 626 l 676 171 q 695 103 676 117 q 773 90 714 90 l 773 -7 "},:{x_min:0,x_max:765.5625,ha:809,o:"m 765 -4 q 698 -14 726 -14 q 564 97 586 -14 q 466 7 525 40 q 337 -26 407 -26 q 88 98 186 -26 q 0 369 0 212 q 88 637 0 525 q 337 760 184 760 q 465 727 407 760 q 563 637 524 695 l 563 738 l 685 738 l 685 222 q 693 141 685 168 q 748 94 708 94 q 765 95 760 94 l 765 -4 m 584 371 q 531 562 584 485 q 360 653 470 653 q 192 566 254 653 q 135 379 135 489 q 186 181 135 261 q 358 84 247 84 q 528 176 465 84 q 584 371 584 260 m 604 1040 l 415 819 l 332 819 l 466 1040 l 604 1040 "},O:{x_min:0,x_max:958,ha:1057,o:"m 485 1041 q 834 882 702 1041 q 958 512 958 734 q 834 136 958 287 q 481 -26 702 -26 q 126 130 261 -26 q 0 504 0 279 q 127 880 0 728 q 485 1041 263 1041 m 480 98 q 731 225 638 98 q 815 504 815 340 q 733 783 815 669 q 480 912 640 912 q 226 784 321 912 q 142 504 142 670 q 226 224 142 339 q 480 98 319 98 "},n:{x_min:0,x_max:615,ha:724,o:"m 615 463 l 615 0 l 490 0 l 490 454 q 453 592 490 537 q 331 656 410 656 q 178 585 240 656 q 117 421 117 514 l 117 0 l 0 0 l 0 738 l 117 738 l 117 630 q 218 728 150 693 q 359 764 286 764 q 552 675 484 764 q 615 463 615 593 "},l:{x_min:41,x_max:166,ha:279,o:"m 166 0 l 41 0 l 41 1013 l 166 1013 l 166 0 "},"":{x_min:40.09375,x_max:728.796875,ha:825,o:"m 728 304 l 649 224 l 512 363 q 383 331 458 331 q 256 363 310 331 l 119 224 l 40 304 l 177 441 q 150 553 150 493 q 184 673 150 621 l 40 818 l 119 898 l 267 749 q 321 766 291 759 q 384 773 351 773 q 447 766 417 773 q 501 749 477 759 l 649 898 l 728 818 l 585 675 q 612 618 604 648 q 621 553 621 587 q 591 441 621 491 l 728 304 m 384 682 q 280 643 318 682 q 243 551 243 604 q 279 461 243 499 q 383 423 316 423 q 487 461 449 423 q 525 553 525 500 q 490 641 525 605 q 384 682 451 682 "},:{x_min:0,x_max:632.328125,ha:679,o:"m 632 0 l 482 0 l 225 384 l 124 288 l 124 0 l 0 0 l 0 738 l 124 738 l 124 446 l 433 738 l 596 738 l 312 466 l 632 0 "},p:{x_min:0,x_max:685,ha:786,o:"m 685 364 q 598 96 685 205 q 350 -23 504 -23 q 121 89 205 -23 l 121 -278 l 0 -278 l 0 738 l 121 738 l 121 633 q 220 726 159 691 q 351 761 280 761 q 598 636 504 761 q 685 364 685 522 m 557 371 q 501 560 557 481 q 330 651 437 651 q 162 559 223 651 q 108 366 108 479 q 162 177 108 254 q 333 87 224 87 q 502 178 441 87 q 557 371 557 258 "},"":{x_min:0,x_max:777,ha:835,o:"m 458 238 l 458 0 l 319 0 l 319 238 l 0 238 l 0 360 l 319 360 l 319 681 l 0 683 l 0 804 l 319 804 l 319 1015 l 458 1013 l 458 804 l 777 804 l 777 683 l 458 683 l 458 360 l 777 360 l 777 238 l 458 238 "},:{x_min:0,x_max:808,ha:907,o:"m 465 -278 l 341 -278 l 341 -15 q 87 102 180 -15 q 0 378 0 210 l 0 739 l 133 739 l 133 379 q 182 195 133 275 q 341 98 242 98 l 341 922 l 465 922 l 465 98 q 623 195 563 98 q 675 382 675 278 l 675 742 l 808 742 l 808 381 q 720 104 808 213 q 466 -13 627 -13 l 465 -278 "},:{x_min:.78125,x_max:697,ha:810,o:"m 697 -278 l 572 -278 l 572 454 q 540 587 572 536 q 425 650 501 650 q 271 579 337 650 q 206 420 206 509 l 206 0 l 81 0 l 81 489 q 73 588 81 562 q 0 644 56 644 l 0 741 q 68 755 38 755 q 158 720 124 755 q 200 630 193 686 q 297 726 234 692 q 434 761 359 761 q 620 692 544 761 q 697 516 697 624 l 697 -278 "}},_me="normal",xme=1189,bme=-100,Sme="normal",wme={yMin:-334,xMin:-111,yMax:1189,xMax:1672},Eme=1e3,Tme={postscript_name:"Helvetiker-Regular",version_string:"Version 1.00 2004 initial release",vendor_url:"http://www.magenta.gr/",full_font_name:"Helvetiker",font_family_name:"Helvetiker",copyright:"Copyright (c) agenta ltd, 2004",description:"",trademark:"",designer:"",designer_url:"",unique_font_identifier:"agenta ltd:Helvetiker:22-10-104",license_url:"http://www.ellak.gr/fonts/MgOpen/license.html",license_description:`Copyright (c) 2004 by MAGENTA Ltd. All Rights Reserved.\r
\r
Permission is hereby granted, free of charge, to any person obtaining a copy of the fonts accompanying this license ("Fonts") and associated documentation files (the "Font Software"), to reproduce and distribute the Font Software, including without limitation the rights to use, copy, merge, publish, distribute, and/or sell copies of the Font Software, and to permit persons to whom the Font Software is furnished to do so, subject to the following conditions: \r
\r
The above copyright and this permission notice shall be included in all copies of one or more of the Font Software typefaces.\r
\r
The Font Software may be modified, altered, or added to, and in particular the designs of glyphs or characters in the Fonts may be modified and additional glyphs or characters may be added to the Fonts, only if the fonts are renamed to names not containing the word "MgOpen", or if the modifications are accepted for inclusion in the Font Software itself by the each appointed Administrator.\r
\r
This License becomes null and void to the extent applicable to Fonts or Font Software that has been modified and is distributed under the "MgOpen" name.\r
\r
The Font Software may be sold as part of a larger software package but no copy of one or more of the Font Software typefaces may be sold by itself. \r
\r
THE FONT SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF COPYRIGHT, PATENT, TRADEMARK, OR OTHER RIGHT. IN NO EVENT SHALL MAGENTA OR PERSONS OR BODIES IN CHARGE OF ADMINISTRATION AND MAINTENANCE OF THE FONT SOFTWARE BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, INCLUDING ANY GENERAL, SPECIAL, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF THE USE OR INABILITY TO USE THE FONT SOFTWARE OR FROM OTHER DEALINGS IN THE FONT SOFTWARE.`,manufacturer_name:"agenta ltd",font_sub_family_name:"Regular"},Cme=-334,Mme="Helvetiker",Rme=1522,Pme=50,Nme={glyphs:yme,cssFontWeight:_me,ascender:xme,underlinePosition:bme,cssFontStyle:Sme,boundingBox:wme,resolution:Eme,original_font_information:Tme,descender:Cme,familyName:Mme,lineHeight:Rme,underlineThickness:Pme},Ya=di(di({},window.THREE?window.THREE:{BoxGeometry:XS,CircleGeometry:wv,DoubleSide:Ks,Group:Ia,Mesh:rr,MeshLambertMaterial:df,TextGeometry:LF,Vector3:le}),{},{Font:I0e,TextGeometry:LF}),$q=hs({props:{labelsData:{default:[]},labelLat:{default:"lat"},labelLng:{default:"lng"},labelAltitude:{default:0},labelText:{default:"text"},labelSize:{default:.5},labelTypeFace:{default:Nme,onChange:function(e,t){t.font=new Ya.Font(e)}},labelColor:{default:function(){return"lightgrey"}},labelRotation:{default:0},labelResolution:{default:3},labelIncludeDot:{default:!0},labelDotRadius:{default:.1},labelDotOrientation:{default:function(){return"bottom"}},labelsTransitionDuration:{default:1e3,triggerUpdate:!1}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e){var t=ot(e.labelLat),i=ot(e.labelLng),r=ot(e.labelAltitude),s=ot(e.labelText),o=ot(e.labelSize),a=ot(e.labelRotation),l=ot(e.labelColor),u=ot(e.labelIncludeDot),c=ot(e.labelDotRadius),h=ot(e.labelDotOrientation),A=new Set(["right","top","bottom"]),v=2*Math.PI*mr/360,_=new Ya.CircleGeometry(1,32);fa(e.labelsData,e.scene,{createObj:function(){var w=new Ya.MeshLambertMaterial;w.side=Ks;var x=new Ya.Group;x.add(new Ya.Mesh(_,w));var M=new Ya.Mesh(void 0,w);x.add(M);var R=new Ya.Mesh;return R.visible=!1,M.add(R),x.__globeObjType="label",x},updateObj:function(w,x){var M=Mr(w.children,2),R=M[0],N=M[1],B=Mr(N.children,1),T=B[0],D=l(x),F=eu(D);N.material.color.set(Ac(D)),N.material.transparent=F<1,N.material.opacity=F;var L=u(x),O=h(x);!L||!A.has(O)&&(O="bottom");var z=L?+c(x)*v:1e-12;R.scale.x=R.scale.y=z;var Q=+o(x)*v;if(N.geometry&&N.geometry.dispose(),N.geometry=new Ya.TextGeometry(s(x),{font:e.font,size:Q,depth:0,height:0,curveSegments:e.labelResolution}),T.geometry&&T.geometry.dispose(),N.geometry.computeBoundingBox(),T.geometry=Mq(Ya.BoxGeometry,Ai(new Ya.Vector3().subVectors(N.geometry.boundingBox.max,N.geometry.boundingBox.min).toArray())),O!=="right"&&N.geometry.center(),L){var j=z+Q/2;O==="right"&&(N.position.x=j),N.position.y={right:-Q/2,top:j+Q/2,bottom:-j-Q/2}[O]}var ee=function(ie){var oe=w.__currentTargetD=ie,me=oe.lat,_e=oe.lng,Oe=oe.alt,Ke=oe.rot,Me=oe.scale;Object.assign(w.position,Fo(me,_e,Oe)),w.lookAt(e.scene.localToWorld(new Ya.Vector3(0,0,0))),w.rotateY(Math.PI),w.rotateZ(-Ke*Math.PI/180),w.scale.x=w.scale.y=w.scale.z=Me},$={lat:+t(x),lng:+i(x),alt:+r(x),rot:+a(x),scale:1},Z=w.__currentTargetD||Object.assign({},$,{scale:1e-12});Object.keys($).some(function(ce){return Z[ce]!==$[ce]})&&(!e.labelsTransitionDuration||e.labelsTransitionDuration<0?ee($):e.tweenGroup.add(new Bs(Z).to($,e.labelsTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(ee).start()))}})}}),Ime=window.THREE?window.THREE:{BufferGeometry:ur},Dme=function(n){function e(){var t,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:32;S6(this,e),t=Tq(this,e),t.type="CircleLineGeometry",t.parameters={radius:i,segmentCount:r};for(var s=[],o=0;o<=r;o++){var a=(o/r-.25)*Math.PI*2;s.push({x:Math.cos(a)*i,y:Math.sin(a)*i,z:0})}return t.setFromPoints(s),t}return Rq(e,n),w6(e)}(Ime.BufferGeometry),Fp=window.THREE?window.THREE:{Color:fn,Group:Ia,Line:JS,LineBasicMaterial:ZS,Vector3:le},kme=w0.default||w0,jq=hs({props:{ringsData:{default:[]},ringLat:{default:"lat"},ringLng:{default:"lng"},ringAltitude:{default:.0015},ringColor:{default:function(){return"#ffffaa"},triggerUpdate:!1},ringResolution:{default:64,triggerUpdate:!1},ringMaxRadius:{default:2,triggerUpdate:!1},ringPropagationSpeed:{default:1,triggerUpdate:!1},ringRepeatPeriod:{default:700,triggerUpdate:!1}},methods:{pauseAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.pause()},resumeAnimation:function(e){var t;(t=e.ticker)===null||t===void 0||t.resume()},_destructor:function(e){var t;(t=e.ticker)===null||t===void 0||t.dispose()}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r,t.ticker=new kme,t.ticker.onTick.add(function(s){if(t.ringsData.length){var o=ot(t.ringColor),a=ot(t.ringAltitude),l=ot(t.ringMaxRadius),u=ot(t.ringPropagationSpeed),c=ot(t.ringRepeatPeriod);t.ringsData.filter(function(h){return h.__threeObj}).forEach(function(h){var A=h.__threeObj;if((A.__nextRingTime||0)<=s){var v=c(h)/1e3;A.__nextRingTime=s+(v<=0?1/0:v);var _=new Fp.Line(new Dme(1,t.ringResolution),new Fp.LineBasicMaterial),S=o(h),w=S instanceof Array||S instanceof Function,x;w?S instanceof Array?(x=Ld().domain(S.map(function(L,O){return O/(S.length-1)})).range(S),_.material.transparent=S.some(function(L){return eu(L)<1})):(x=S,_.material.transparent=!0):(_.material.color=new Fp.Color(Ac(S)),eme(_.material,eu(S)));var M=mr*(1+a(h)),R=l(h),N=R*Math.PI/180,B=u(h),T=B<=0,D=function(O){var z=O.t,Q=(T?1-z:z)*N;if(_.scale.x=_.scale.y=M*Math.sin(Q),_.position.z=M*(1-Math.cos(Q)),w){var j=x(z);_.material.color=new Fp.Color(Ac(j)),_.material.transparent&&(_.material.opacity=eu(j))}};if(B===0)D({t:0}),A.add(_);else{var F=Math.abs(R/B)*1e3;t.tweenGroup.add(new Bs({t:0}).to({t:1},F).onUpdate(D).onStart(function(){return A.add(_)}).onComplete(function(){A.remove(_),T6(_)}).start())}}})}})},update:function(e){var t=ot(e.ringLat),i=ot(e.ringLng),r=ot(e.ringAltitude),s=e.scene.localToWorld(new Fp.Vector3(0,0,0));fa(e.ringsData,e.scene,{createObj:function(){var a=new Fp.Group;return a.__globeObjType="ring",a},updateObj:function(a,l){var u=t(l),c=i(l),h=r(l);Object.assign(a.position,Fo(u,c,h)),a.lookAt(s)}},{removeDelay:3e4})}}),Lme=di(di({},window.THREE?window.THREE:{}),{},{CSS2DObject:Gue}),Wq=hs({props:{htmlElementsData:{default:[]},htmlLat:{default:"lat"},htmlLng:{default:"lng"},htmlAltitude:{default:0},htmlElement:{},htmlTransitionDuration:{default:1e3,triggerUpdate:!1},isBehindGlobe:{onChange:function(){this.updateObjVisibility()},triggerUpdate:!1}},methods:{updateObjVisibility:function(e,t){var i=t?[t]:e.htmlElementsData.map(function(r){return r.__threeObj}).filter(function(r){return r});i.forEach(function(r){return r.visible=!e.isBehindGlobe||!e.isBehindGlobe(r.position)})}},init:function(e,t,i){var r=i.tweenGroup;$i(e),t.scene=e,t.tweenGroup=r},update:function(e,t){var i=this,r=ot(e.htmlLat),s=ot(e.htmlLng),o=ot(e.htmlAltitude),a=ot(e.htmlElement);fa(e.htmlElementsData,e.scene,{purge:t.hasOwnProperty("htmlElement"),createObj:function(u){var c=a(u),h=new Lme.CSS2DObject(c);return h.__globeObjType="html",h},updateObj:function(u,c){var h=function(_){var S=u.__currentTargetD=_,w=S.alt,x=S.lat,M=S.lng;Object.assign(u.position,Fo(x,M,w)),i.updateObjVisibility(u)},A={lat:+r(c),lng:+s(c),alt:+o(c)};!e.htmlTransitionDuration||e.htmlTransitionDuration<0||!u.__currentTargetD?h(A):e.tweenGroup.add(new Bs(u.__currentTargetD).to(A,e.htmlTransitionDuration).easing(Rr.Quadratic.InOut).onUpdate(h).start())}})}}),E_=window.THREE?window.THREE:{Euler:la,Group:Ia,Mesh:rr,MeshLambertMaterial:df,SphereGeometry:Ev},Xq=hs({props:{objectsData:{default:[]},objectLat:{default:"lat"},objectLng:{default:"lng"},objectAltitude:{default:.01},objectFacesSurface:{default:!0},objectRotation:{},objectThreeObject:{default:new E_.Mesh(new E_.SphereGeometry(1,16,8),new E_.MeshLambertMaterial({color:"#ffffaa",transparent:!0,opacity:.7}))}},init:function(e,t){$i(e),t.scene=e},update:function(e,t){var i=ot(e.objectLat),r=ot(e.objectLng),s=ot(e.objectAltitude),o=ot(e.objectFacesSurface),a=ot(e.objectRotation),l=ot(e.objectThreeObject);fa(e.objectsData,e.scene,{purge:t.hasOwnProperty("objectThreeObject"),createObj:function(c){var h=l(c);e.objectThreeObject===h&&(h=h.clone());var A=new E_.Group;return A.add(h),A.__globeObjType="object",A},updateObj:function(c,h){var A=+i(h),v=+r(h),_=+s(h);Object.assign(c.position,Fo(A,v,_)),o(h)?c.setRotationFromEuler(new la(ed(-A),ed(v),0,"YXZ")):c.rotation.set(0,0,0);var S=c.children[0],w=a(h);w&&S.setRotationFromEuler(new la(ed(w.x||0),ed(w.y||0),ed(w.z||0)))}})}}),Yq=hs({props:{customLayerData:{default:[]},customThreeObject:{},customThreeObjectUpdate:{triggerUpdate:!1}},init:function(e,t){$i(e),t.scene=e},update:function(e,t){e.customThreeObjectUpdate||$i(e.scene);var i=ot(e.customThreeObject),r=ot(e.customThreeObjectUpdate);fa(e.customLayerData,e.scene,{purge:t.hasOwnProperty("customThreeObject"),createObj:function(o){var a=i(o,mr);return a&&(e.customThreeObject===a&&(a=a.clone()),a.__globeObjType="custom"),a},updateObj:function(o,a){return r(o,a,mr)}})}}),O3=window.THREE?window.THREE:{Group:Ia,Vector2:rt,Vector3:le},Fme=["globeLayer","pointsLayer","arcsLayer","hexBinLayer","heatmapsLayer","polygonsLayer","hexedPolygonsLayer","pathsLayer","tilesLayer","labelsLayer","ringsLayer","htmlElementsLayer","objectsLayer","customLayer"],Qq=Uo("globeLayer",kq),Bme=Object.assign.apply(Object,Ai(["globeImageUrl","bumpImageUrl","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude"].map(function(n){return Os({},n,Qq.linkProp(n))}))),Ome=Object.assign.apply(Object,Ai(["globeMaterial"].map(function(n){return Os({},n,Qq.linkMethod(n))}))),Ume=Uo("pointsLayer",Lq),zme=Object.assign.apply(Object,Ai(["pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration"].map(function(n){return Os({},n,Ume.linkProp(n))}))),Vme=Uo("arcsLayer",Bq),Gme=Object.assign.apply(Object,Ai(["arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration"].map(function(n){return Os({},n,Vme.linkProp(n))}))),qme=Uo("hexBinLayer",Oq),Hme=Object.assign.apply(Object,Ai(["hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration"].map(function(n){return Os({},n,qme.linkProp(n))}))),$me=Uo("heatmapsLayer",zq),jme=Object.assign.apply(Object,Ai(["heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration"].map(function(n){return Os({},n,$me.linkProp(n))}))),Wme=Uo("hexedPolygonsLayer",Gq),Xme=Object.assign.apply(Object,Ai(["hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration"].map(function(n){return Os({},n,Wme.linkProp(n))}))),Yme=Uo("polygonsLayer",Vq),Qme=Object.assign.apply(Object,Ai(["polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration"].map(function(n){return Os({},n,Yme.linkProp(n))}))),Kme=Uo("pathsLayer",qq),Zme=Object.assign.apply(Object,Ai(["pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration"].map(function(n){return Os({},n,Kme.linkProp(n))}))),Jme=Uo("tilesLayer",Hq),ege=Object.assign.apply(Object,Ai(["tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration"].map(function(n){return Os({},n,Jme.linkProp(n))}))),tge=Uo("labelsLayer",$q),nge=Object.assign.apply(Object,Ai(["labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration"].map(function(n){return Os({},n,tge.linkProp(n))}))),ige=Uo("ringsLayer",jq),rge=Object.assign.apply(Object,Ai(["ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod"].map(function(n){return Os({},n,ige.linkProp(n))}))),sge=Uo("htmlElementsLayer",Wq),oge=Object.assign.apply(Object,Ai(["htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlTransitionDuration"].map(function(n){return Os({},n,sge.linkProp(n))}))),age=Uo("objectsLayer",Xq),lge=Object.assign.apply(Object,Ai(["objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject"].map(function(n){return Os({},n,age.linkProp(n))}))),uge=Uo("customLayer",Yq),cge=Object.assign.apply(Object,Ai(["customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(n){return Os({},n,uge.linkProp(n))}))),hge=hs({props:di(di(di(di(di(di(di(di(di(di(di(di(di(di({onGlobeReady:{triggerUpdate:!1},rendererSize:{default:new O3.Vector2(window.innerWidth,window.innerHeight),onChange:function(e,t){t.pathsLayer.rendererSize(e)},triggerUpdate:!1}},Bme),zme),Gme),Hme),jme),Qme),Xme),Zme),ege),nge),rge),oge),lge),cge),methods:di({getGlobeRadius:BF,getCoords:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Fo.apply(void 0,i)},toGeoCoords:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return Dq.apply(void 0,i)},setPointOfView:function(e,t,i){var r=void 0;if(t){var s=BF(),o=i?t.clone().sub(i):t,a,l,u;r=function(h){a===void 0&&(a=o.length()),l===void 0&&(l=Math.sqrt(Math.pow(a,2)-Math.pow(s,2))),u===void 0&&(u=Math.acos(l/a));var A=o.distanceTo(h);if(A<l)return!1;var v=h.length(),_=Math.acos((Math.pow(a,2)+Math.pow(A,2)-Math.pow(v,2))/(2*a*A));return _<u}}e.layersThatNeedBehindGlobeChecker.forEach(function(c){return c.isBehindGlobe(r)})},pauseAnimation:function(e){return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),e.pausableLayers.forEach(function(t){var i;return(i=t.pauseAnimation)===null||i===void 0?void 0:i.call(t)}),this},resumeAnimation:function(e){return e.animationFrameRequestId===null&&this._animationCycle(),e.pausableLayers.forEach(function(t){var i;return(i=t.resumeAnimation)===null||i===void 0?void 0:i.call(t)}),this},_animationCycle:function(e){e.animationFrameRequestId=requestAnimationFrame(this._animationCycle),e.tweenGroup.update()},_destructor:function(e){this.pauseAnimation(),e.destructableLayers.forEach(function(t){return t._destructor()})}},Ome),stateInit:function(){var e=new tw,t={tweenGroup:e},i={globeLayer:kq(t),pointsLayer:Lq(t),arcsLayer:Bq(t),hexBinLayer:Oq(t),heatmapsLayer:zq(t),polygonsLayer:Vq(t),hexedPolygonsLayer:Gq(t),pathsLayer:qq(t),tilesLayer:Hq(t),labelsLayer:$q(t),ringsLayer:jq(t),htmlElementsLayer:Wq(t),objectsLayer:Xq(t),customLayer:Yq(t)};return di(di({tweenGroup:e},i),{},{layersThatNeedBehindGlobeChecker:Object.values(i).filter(function(r){return r.hasOwnProperty("isBehindGlobe")}),destructableLayers:Object.values(i).filter(function(r){return r.hasOwnProperty("_destructor")}),pausableLayers:Object.values(i).filter(function(r){return r.hasOwnProperty("pauseAnimation")})})},init:function(e,t,i){var r=i.animateIn,s=r===void 0?!0:r,o=i.waitForGlobeReady,a=o===void 0?!0:o;$i(e),t.scene=e,t.scene.visible=!1,Fme.forEach(function(u){var c=new O3.Group;t.scene.add(c),t[u](c)});var l=function(){if(s){t.scene.scale.set(1e-6,1e-6,1e-6),t.tweenGroup.add(new Bs({k:1e-6}).to({k:1},600).easing(Rr.Quadratic.Out).onUpdate(function(h){var A=h.k;return t.scene.scale.set(A,A,A)}).start());var c=new O3.Vector3(0,1,0);t.tweenGroup.add(new Bs({rot:Math.PI*2}).to({rot:0},1200).easing(Rr.Quintic.Out).onUpdate(function(h){var A=h.rot;return t.scene.setRotationFromAxisAngle(c,A)}).start())}t.scene.visible=!0,t.onGlobeReady&&t.onGlobeReady()};a?t.globeLayer.onReady(l):l(),this._animationCycle()},update:function(e){}});function fge(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=function(r){function s(){var o;S6(this,s);for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return o=Tq(this,s,[].concat(l)),o.__kapsuleInstance=n.apply(void 0,l).apply(void 0,[].concat(Ai(t?[o]:[]),l)),o}return Rq(s,r),w6(s)}(e);return Object.keys(n()).forEach(function(r){return i.prototype[r]=function(){var s,o=(s=this.__kapsuleInstance)[r].apply(s,arguments);return o===this.__kapsuleInstance?this:o}}),i}var dge=window.THREE?window.THREE:{Group:Ia},Kq=fge(hge,dge.Group,!0);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const sw="170",pge=0,Age=1,mge=2,gge=1,T_=3,P0=0,Cl=1,XA=2,N0=0,Oh=1,Eb=2,Tb=3,Cb=4,Zq=5,gh=100,Jq=101,eH=102,vge=103,yge=104,tH=200,nH=201,iH=202,rH=203,Mb=204,Rb=205,sH=206,oH=207,aH=208,lH=209,uH=210,cH=0,hH=1,fH=2,Pb=3,dH=4,pH=5,AH=6,mH=7,ow=0,_ge=1,xge=2,YA=0,bge=1,Sge=2,wge=3,Ege=4,Tge=6,Cge=7,C6=300,Fd=301,I0=302,Pv=303,Nv=304,pR=306,Nb=1e3,CA=1001,Ib=1002,Ps=1003,AR=1004,QA=1005,ua=1006,mR=1007,Ju=1008,Uh=1009,Gg=1010,qg=1011,MA=1012,Qs=1013,rs=1014,na=1015,ec=1016,Mge=1017,Rge=1018,Iv=1020,gH=35902,Pge=1021,M6=1022,K0=1023,Nge=1024,Ige=1025,wd=1026,D0=1027,R6=1028,P6=1029,z1=1030,N6=1031,Dge=1032,I6=1033,U3=33776,X2=33777,Y2=33778,Q2=33779,$F=35840,jF=35841,WF=35842,XF=35843,YF=36196,gR=37492,vR=37496,yR=37808,_R=37809,xR=37810,bR=37811,SR=37812,wR=37813,ER=37814,TR=37815,CR=37816,MR=37817,RR=37818,PR=37819,NR=37820,IR=37821,z3=36492,kge=36283,QF=36284,KF=36285,ZF=36286,ef=0,Lge=1,Bd="",Jt="srgb",zh="srgb-linear",vH="linear",V1="srgb",Fge=0,jf=7680,Bge=7681,Oge=7682,Uge=7683,zge=34055,Vge=34056,Gge=5386,qge=512,Hge=513,$ge=514,jge=515,Wge=516,Xge=517,Yge=518,DR=519,yH=512,D6=513,_H=514,xH=515,bH=516,SH=517,wH=518,EH=519,Db=35044,RA=35048,ml=2e3,Od=2001;class Z0{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Es=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let JF=1234567;const Hg=Math.PI/180,G1=180/Math.PI;function tc(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Es[n&255]+Es[n>>8&255]+Es[n>>16&255]+Es[n>>24&255]+"-"+Es[e&255]+Es[e>>8&255]+"-"+Es[e>>16&15|64]+Es[e>>24&255]+"-"+Es[t&63|128]+Es[t>>8&255]+"-"+Es[t>>16&255]+Es[t>>24&255]+Es[i&255]+Es[i>>8&255]+Es[i>>16&255]+Es[i>>24&255]).toLowerCase()}function ss(n,e,t){return Math.max(e,Math.min(t,n))}function k6(n,e){return(n%e+e)%e}function Qge(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function Kge(n,e,t){return n!==e?(t-n)/(e-n):0}function $g(n,e,t){return(1-t)*n+t*e}function Zge(n,e,t,i){return $g(n,e,1-Math.exp(-t*i))}function Jge(n,e=1){return e-Math.abs(k6(n,e*2)-e)}function e1e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function t1e(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function n1e(n,e){return n+Math.floor(Math.random()*(e-n+1))}function i1e(n,e){return n+Math.random()*(e-n)}function r1e(n){return n*(.5-Math.random())}function s1e(n){n!==void 0&&(JF=n);let e=JF+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function o1e(n){return n*Hg}function a1e(n){return n*G1}function l1e(n){return(n&n-1)===0&&n!==0}function u1e(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function c1e(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function h1e(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),l=o(t/2),u=s((e+i)/2),c=o((e+i)/2),h=s((e-i)/2),A=o((e-i)/2),v=s((i-e)/2),_=o((i-e)/2);switch(r){case"XYX":n.set(a*c,l*h,l*A,a*u);break;case"YZY":n.set(l*A,a*c,l*h,a*u);break;case"ZXZ":n.set(l*h,l*A,a*c,a*u);break;case"XZX":n.set(a*c,l*_,l*v,a*u);break;case"YXY":n.set(l*v,a*c,l*_,a*u);break;case"ZYZ":n.set(l*_,l*v,a*c,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Zs(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Tn(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const f1e={DEG2RAD:Hg,RAD2DEG:G1,generateUUID:tc,clamp:ss,euclideanModulo:k6,mapLinear:Qge,inverseLerp:Kge,lerp:$g,damp:Zge,pingpong:Jge,smoothstep:e1e,smootherstep:t1e,randInt:n1e,randFloat:i1e,randFloatSpread:r1e,seededRandom:s1e,degToRad:o1e,radToDeg:a1e,isPowerOfTwo:l1e,ceilPowerOfTwo:u1e,floorPowerOfTwo:c1e,setQuaternionFromProperEuler:h1e,normalize:Tn,denormalize:Zs};class Jn{constructor(e=0,t=0){Jn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ss(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class zo{constructor(e,t,i,r,s,o,a,l,u){zo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u)}set(e,t,i,r,s,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=r,c[2]=a,c[3]=t,c[4]=s,c[5]=l,c[6]=i,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],c=i[4],h=i[7],A=i[2],v=i[5],_=i[8],S=r[0],w=r[3],x=r[6],M=r[1],R=r[4],N=r[7],B=r[2],T=r[5],D=r[8];return s[0]=o*S+a*M+l*B,s[3]=o*w+a*R+l*T,s[6]=o*x+a*N+l*D,s[1]=u*S+c*M+h*B,s[4]=u*w+c*R+h*T,s[7]=u*x+c*N+h*D,s[2]=A*S+v*M+_*B,s[5]=A*w+v*R+_*T,s[8]=A*x+v*N+_*D,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*a*u-i*s*c+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,A=a*l-c*s,v=u*s-o*l,_=t*h+i*A+r*v;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const S=1/_;return e[0]=h*S,e[1]=(r*u-c*i)*S,e[2]=(a*i-r*o)*S,e[3]=A*S,e[4]=(c*t-r*l)*S,e[5]=(r*s-a*t)*S,e[6]=v*S,e[7]=(i*l-u*t)*S,e[8]=(o*t-i*s)*S,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(V3.makeScale(e,t)),this}rotate(e){return this.premultiply(V3.makeRotation(-e)),this}translate(e,t){return this.premultiply(V3.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const V3=new zo;function d1e(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function kR(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function p1e(){const n=kR("canvas");return n.style.display="block",n}const e7={};function A1e(n){n in e7||(e7[n]=!0,console.warn(n))}const wr={enabled:!0,workingColorSpace:zh,spaces:{},convert:function(n,e,t){return this.enabled===!1||e===t||!e||!t||(this.spaces[e].transfer===V1&&(n.r=nc(n.r),n.g=nc(n.g),n.b=nc(n.b)),this.spaces[e].primaries!==this.spaces[t].primaries&&(n.applyMatrix3(this.spaces[e].toXYZ),n.applyMatrix3(this.spaces[t].fromXYZ)),this.spaces[t].transfer===V1&&(n.r=KA(n.r),n.g=KA(n.g),n.b=KA(n.b))),n},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)},getPrimaries:function(n){return this.spaces[n].primaries},getTransfer:function(n){return n===Bd?vH:this.spaces[n].transfer},getLuminanceCoefficients:function(n,e=this.workingColorSpace){return n.fromArray(this.spaces[e].luminanceCoefficients)},define:function(n){Object.assign(this.spaces,n)},_getMatrix:function(n,e,t){return n.copy(this.spaces[e].toXYZ).multiply(this.spaces[t].fromXYZ)},_getDrawingBufferColorSpace:function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace}};function nc(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function KA(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const t7=[.64,.33,.3,.6,.15,.06],n7=[.2126,.7152,.0722],i7=[.3127,.329],r7=new zo().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),s7=new zo().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);wr.define({[zh]:{primaries:t7,whitePoint:i7,transfer:vH,toXYZ:r7,fromXYZ:s7,luminanceCoefficients:n7,workingColorSpaceConfig:{unpackColorSpace:Jt},outputColorSpaceConfig:{drawingBufferColorSpace:Jt}},[Jt]:{primaries:t7,whitePoint:i7,transfer:V1,toXYZ:r7,fromXYZ:s7,luminanceCoefficients:n7,outputColorSpaceConfig:{drawingBufferColorSpace:Jt}}});let Bp;class m1e{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Bp===void 0&&(Bp=kR("canvas")),Bp.width=e.width,Bp.height=e.height;const i=Bp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Bp}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=kR("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=nc(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(nc(t[i]/255)*255):t[i]=nc(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let g1e=0;class TH{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:g1e++}),this.uuid=tc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(G3(r[o].image)):s.push(G3(r[o]))}else s=G3(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function G3(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?m1e.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let v1e=0;class to extends Z0{constructor(e=to.DEFAULT_IMAGE,t=to.DEFAULT_MAPPING,i=CA,r=CA,s=ua,o=Ju,a=K0,l=Uh,u=to.DEFAULT_ANISOTROPY,c=Bd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:v1e++}),this.uuid=tc(),this.name="",this.source=new TH(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Jn(0,0),this.repeat=new Jn(1,1),this.center=new Jn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new zo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==C6)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Nb:e.x=e.x-Math.floor(e.x);break;case CA:e.x=e.x<0?0:1;break;case Ib:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Nb:e.y=e.y-Math.floor(e.y);break;case CA:e.y=e.y<0?0:1;break;case Ib:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}to.DEFAULT_IMAGE=null;to.DEFAULT_MAPPING=C6;to.DEFAULT_ANISOTROPY=1;class pi{constructor(e=0,t=0,i=0,r=1){pi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const l=e.elements,u=l[0],c=l[4],h=l[8],A=l[1],v=l[5],_=l[9],S=l[2],w=l[6],x=l[10];if(Math.abs(c-A)<.01&&Math.abs(h-S)<.01&&Math.abs(_-w)<.01){if(Math.abs(c+A)<.1&&Math.abs(h+S)<.1&&Math.abs(_+w)<.1&&Math.abs(u+v+x-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(u+1)/2,N=(v+1)/2,B=(x+1)/2,T=(c+A)/4,D=(h+S)/4,F=(_+w)/4;return R>N&&R>B?R<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(R),r=T/i,s=D/i):N>B?N<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(N),i=T/r,s=F/r):B<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(B),i=D/s,r=F/s),this.set(i,r,s,t),this}let M=Math.sqrt((w-_)*(w-_)+(h-S)*(h-S)+(A-c)*(A-c));return Math.abs(M)<.001&&(M=1),this.x=(w-_)/M,this.y=(h-S)/M,this.z=(A-c)/M,this.w=Math.acos((u+v+x-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class J0 extends Z0{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new pi(0,0,e,t),this.scissorTest=!1,this.viewport=new pi(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ua,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new to(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new TH(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class y1e extends J0{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class _1e extends to{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ps,this.minFilter=Ps,this.wrapR=CA,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Dv{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let l=i[r+0],u=i[r+1],c=i[r+2],h=i[r+3];const A=s[o+0],v=s[o+1],_=s[o+2],S=s[o+3];if(a===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h;return}if(a===1){e[t+0]=A,e[t+1]=v,e[t+2]=_,e[t+3]=S;return}if(h!==S||l!==A||u!==v||c!==_){let w=1-a;const x=l*A+u*v+c*_+h*S,M=x>=0?1:-1,R=1-x*x;if(R>Number.EPSILON){const B=Math.sqrt(R),T=Math.atan2(B,x*M);w=Math.sin(w*T)/B,a=Math.sin(a*T)/B}const N=a*M;if(l=l*w+A*N,u=u*w+v*N,c=c*w+_*N,h=h*w+S*N,w===1-a){const B=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=B,u*=B,c*=B,h*=B}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],c=i[r+3],h=s[o],A=s[o+1],v=s[o+2],_=s[o+3];return e[t]=a*_+c*h+l*v-u*A,e[t+1]=l*_+c*A+u*h-a*v,e[t+2]=u*_+c*v+a*A-l*h,e[t+3]=c*_-a*h-l*A-u*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),c=a(r/2),h=a(s/2),A=l(i/2),v=l(r/2),_=l(s/2);switch(o){case"XYZ":this._x=A*c*h+u*v*_,this._y=u*v*h-A*c*_,this._z=u*c*_+A*v*h,this._w=u*c*h-A*v*_;break;case"YXZ":this._x=A*c*h+u*v*_,this._y=u*v*h-A*c*_,this._z=u*c*_-A*v*h,this._w=u*c*h+A*v*_;break;case"ZXY":this._x=A*c*h-u*v*_,this._y=u*v*h+A*c*_,this._z=u*c*_+A*v*h,this._w=u*c*h-A*v*_;break;case"ZYX":this._x=A*c*h-u*v*_,this._y=u*v*h+A*c*_,this._z=u*c*_-A*v*h,this._w=u*c*h+A*v*_;break;case"YZX":this._x=A*c*h+u*v*_,this._y=u*v*h+A*c*_,this._z=u*c*_-A*v*h,this._w=u*c*h-A*v*_;break;case"XZY":this._x=A*c*h-u*v*_,this._y=u*v*h-A*c*_,this._z=u*c*_+A*v*h,this._w=u*c*h+A*v*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],l=t[9],u=t[2],c=t[6],h=t[10],A=i+a+h;if(A>0){const v=.5/Math.sqrt(A+1);this._w=.25/v,this._x=(c-l)*v,this._y=(s-u)*v,this._z=(o-r)*v}else if(i>a&&i>h){const v=2*Math.sqrt(1+i-a-h);this._w=(c-l)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+u)/v}else if(a>h){const v=2*Math.sqrt(1+a-i-h);this._w=(s-u)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(l+c)/v}else{const v=2*Math.sqrt(1+h-i-a);this._w=(o-r)/v,this._x=(s+u)/v,this._y=(l+c)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ss(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,l=t._y,u=t._z,c=t._w;return this._x=i*c+o*a+r*u-s*l,this._y=r*c+o*l+s*a-i*u,this._z=s*c+o*u+i*l-r*a,this._w=o*c-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*i+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-t)*c)/u,A=Math.sin(t*c)/u;return this._w=o*h+this._w*A,this._x=i*h+this._x*A,this._y=r*h+this._y*A,this._z=s*h+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Pe{constructor(e=0,t=0,i=0){Pe.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(o7.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(o7.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*r-a*i),c=2*(a*t-s*r),h=2*(s*i-o*t);return this.x=t+l*u+o*h-a*c,this.y=i+l*c+a*u-s*h,this.z=r+l*h+s*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,l=t.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return q3.copy(this).projectOnVector(e),this.sub(q3)}reflect(e){return this.sub(q3.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(ss(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const q3=new Pe,o7=new Dv;class kv{constructor(e=new Pe(1/0,1/0,1/0),t=new Pe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Qa.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Qa.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Qa.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Qa):Qa.fromBufferAttribute(s,o),Qa.applyMatrix4(e.matrixWorld),this.expandByPoint(Qa);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),C_.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),C_.copy(i.boundingBox)),C_.applyMatrix4(e.matrixWorld),this.union(C_)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Qa),Qa.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Hm),M_.subVectors(this.max,Hm),Op.subVectors(e.a,Hm),Up.subVectors(e.b,Hm),zp.subVectors(e.c,Hm),Qc.subVectors(Up,Op),Kc.subVectors(zp,Up),Lf.subVectors(Op,zp);let t=[0,-Qc.z,Qc.y,0,-Kc.z,Kc.y,0,-Lf.z,Lf.y,Qc.z,0,-Qc.x,Kc.z,0,-Kc.x,Lf.z,0,-Lf.x,-Qc.y,Qc.x,0,-Kc.y,Kc.x,0,-Lf.y,Lf.x,0];return!H3(t,Op,Up,zp,M_)||(t=[1,0,0,0,1,0,0,0,1],!H3(t,Op,Up,zp,M_))?!1:(R_.crossVectors(Qc,Kc),t=[R_.x,R_.y,R_.z],H3(t,Op,Up,zp,M_))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Qa).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Qa).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(wu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),wu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),wu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),wu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),wu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),wu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),wu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),wu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(wu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const wu=[new Pe,new Pe,new Pe,new Pe,new Pe,new Pe,new Pe,new Pe],Qa=new Pe,C_=new kv,Op=new Pe,Up=new Pe,zp=new Pe,Qc=new Pe,Kc=new Pe,Lf=new Pe,Hm=new Pe,M_=new Pe,R_=new Pe,Ff=new Pe;function H3(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Ff.fromArray(n,s);const a=r.x*Math.abs(Ff.x)+r.y*Math.abs(Ff.y)+r.z*Math.abs(Ff.z),l=e.dot(Ff),u=t.dot(Ff),c=i.dot(Ff);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const x1e=new kv,$m=new Pe,$3=new Pe;class L6{constructor(e=new Pe,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):x1e.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$m.subVectors(e,this.center);const t=$m.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector($m,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):($3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($m.copy(e.center).add($3)),this.expandByPoint($m.copy(e.center).sub($3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Eu=new Pe,j3=new Pe,P_=new Pe,Zc=new Pe,W3=new Pe,N_=new Pe,X3=new Pe;class b1e{constructor(e=new Pe,t=new Pe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Eu)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Eu.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Eu.copy(this.origin).addScaledVector(this.direction,t),Eu.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){j3.copy(e).add(t).multiplyScalar(.5),P_.copy(t).sub(e).normalize(),Zc.copy(this.origin).sub(j3);const s=e.distanceTo(t)*.5,o=-this.direction.dot(P_),a=Zc.dot(this.direction),l=-Zc.dot(P_),u=Zc.lengthSq(),c=Math.abs(1-o*o);let h,A,v,_;if(c>0)if(h=o*l-a,A=o*a-l,_=s*c,h>=0)if(A>=-_)if(A<=_){const S=1/c;h*=S,A*=S,v=h*(h+o*A+2*a)+A*(o*h+A+2*l)+u}else A=s,h=Math.max(0,-(o*A+a)),v=-h*h+A*(A+2*l)+u;else A=-s,h=Math.max(0,-(o*A+a)),v=-h*h+A*(A+2*l)+u;else A<=-_?(h=Math.max(0,-(-o*s+a)),A=h>0?-s:Math.min(Math.max(-s,-l),s),v=-h*h+A*(A+2*l)+u):A<=_?(h=0,A=Math.min(Math.max(-s,-l),s),v=A*(A+2*l)+u):(h=Math.max(0,-(o*s+a)),A=h>0?s:Math.min(Math.max(-s,-l),s),v=-h*h+A*(A+2*l)+u);else A=o>0?-s:s,h=Math.max(0,-(o*A+a)),v=-h*h+A*(A+2*l)+u;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(j3).addScaledVector(P_,A),v}intersectSphere(e,t){Eu.subVectors(e.center,this.origin);const i=Eu.dot(this.direction),r=Eu.dot(Eu)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,A=this.origin;return u>=0?(i=(e.min.x-A.x)*u,r=(e.max.x-A.x)*u):(i=(e.max.x-A.x)*u,r=(e.min.x-A.x)*u),c>=0?(s=(e.min.y-A.y)*c,o=(e.max.y-A.y)*c):(s=(e.max.y-A.y)*c,o=(e.min.y-A.y)*c),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-A.z)*h,l=(e.max.z-A.z)*h):(a=(e.max.z-A.z)*h,l=(e.min.z-A.z)*h),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Eu)!==null}intersectTriangle(e,t,i,r,s){W3.subVectors(t,e),N_.subVectors(i,e),X3.crossVectors(W3,N_);let o=this.direction.dot(X3),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Zc.subVectors(this.origin,e);const l=a*this.direction.dot(N_.crossVectors(Zc,N_));if(l<0)return null;const u=a*this.direction.dot(W3.cross(Zc));if(u<0||l+u>o)return null;const c=-a*Zc.dot(X3);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ji{constructor(e,t,i,r,s,o,a,l,u,c,h,A,v,_,S,w){ji.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,l,u,c,h,A,v,_,S,w)}set(e,t,i,r,s,o,a,l,u,c,h,A,v,_,S,w){const x=this.elements;return x[0]=e,x[4]=t,x[8]=i,x[12]=r,x[1]=s,x[5]=o,x[9]=a,x[13]=l,x[2]=u,x[6]=c,x[10]=h,x[14]=A,x[3]=v,x[7]=_,x[11]=S,x[15]=w,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ji().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Vp.setFromMatrixColumn(e,0).length(),s=1/Vp.setFromMatrixColumn(e,1).length(),o=1/Vp.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),c=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const A=o*c,v=o*h,_=a*c,S=a*h;t[0]=l*c,t[4]=-l*h,t[8]=u,t[1]=v+_*u,t[5]=A-S*u,t[9]=-a*l,t[2]=S-A*u,t[6]=_+v*u,t[10]=o*l}else if(e.order==="YXZ"){const A=l*c,v=l*h,_=u*c,S=u*h;t[0]=A+S*a,t[4]=_*a-v,t[8]=o*u,t[1]=o*h,t[5]=o*c,t[9]=-a,t[2]=v*a-_,t[6]=S+A*a,t[10]=o*l}else if(e.order==="ZXY"){const A=l*c,v=l*h,_=u*c,S=u*h;t[0]=A-S*a,t[4]=-o*h,t[8]=_+v*a,t[1]=v+_*a,t[5]=o*c,t[9]=S-A*a,t[2]=-o*u,t[6]=a,t[10]=o*l}else if(e.order==="ZYX"){const A=o*c,v=o*h,_=a*c,S=a*h;t[0]=l*c,t[4]=_*u-v,t[8]=A*u+S,t[1]=l*h,t[5]=S*u+A,t[9]=v*u-_,t[2]=-u,t[6]=a*l,t[10]=o*l}else if(e.order==="YZX"){const A=o*l,v=o*u,_=a*l,S=a*u;t[0]=l*c,t[4]=S-A*h,t[8]=_*h+v,t[1]=h,t[5]=o*c,t[9]=-a*c,t[2]=-u*c,t[6]=v*h+_,t[10]=A-S*h}else if(e.order==="XZY"){const A=o*l,v=o*u,_=a*l,S=a*u;t[0]=l*c,t[4]=-h,t[8]=u*c,t[1]=A*h+S,t[5]=o*c,t[9]=v*h-_,t[2]=_*h-v,t[6]=a*c,t[10]=S*h+A}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(S1e,e,w1e)}lookAt(e,t,i){const r=this.elements;return Ho.subVectors(e,t),Ho.lengthSq()===0&&(Ho.z=1),Ho.normalize(),Jc.crossVectors(i,Ho),Jc.lengthSq()===0&&(Math.abs(i.z)===1?Ho.x+=1e-4:Ho.z+=1e-4,Ho.normalize(),Jc.crossVectors(i,Ho)),Jc.normalize(),I_.crossVectors(Ho,Jc),r[0]=Jc.x,r[4]=I_.x,r[8]=Ho.x,r[1]=Jc.y,r[5]=I_.y,r[9]=Ho.y,r[2]=Jc.z,r[6]=I_.z,r[10]=Ho.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],c=i[1],h=i[5],A=i[9],v=i[13],_=i[2],S=i[6],w=i[10],x=i[14],M=i[3],R=i[7],N=i[11],B=i[15],T=r[0],D=r[4],F=r[8],L=r[12],O=r[1],z=r[5],Q=r[9],j=r[13],ee=r[2],$=r[6],Z=r[10],ce=r[14],ie=r[3],oe=r[7],me=r[11],_e=r[15];return s[0]=o*T+a*O+l*ee+u*ie,s[4]=o*D+a*z+l*$+u*oe,s[8]=o*F+a*Q+l*Z+u*me,s[12]=o*L+a*j+l*ce+u*_e,s[1]=c*T+h*O+A*ee+v*ie,s[5]=c*D+h*z+A*$+v*oe,s[9]=c*F+h*Q+A*Z+v*me,s[13]=c*L+h*j+A*ce+v*_e,s[2]=_*T+S*O+w*ee+x*ie,s[6]=_*D+S*z+w*$+x*oe,s[10]=_*F+S*Q+w*Z+x*me,s[14]=_*L+S*j+w*ce+x*_e,s[3]=M*T+R*O+N*ee+B*ie,s[7]=M*D+R*z+N*$+B*oe,s[11]=M*F+R*Q+N*Z+B*me,s[15]=M*L+R*j+N*ce+B*_e,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],A=e[10],v=e[14],_=e[3],S=e[7],w=e[11],x=e[15];return _*(+s*l*h-r*u*h-s*a*A+i*u*A+r*a*v-i*l*v)+S*(+t*l*v-t*u*A+s*o*A-r*o*v+r*u*c-s*l*c)+w*(+t*u*h-t*a*v-s*o*h+i*o*v+s*a*c-i*u*c)+x*(-r*a*c-t*l*h+t*a*A+r*o*h-i*o*A+i*l*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],A=e[10],v=e[11],_=e[12],S=e[13],w=e[14],x=e[15],M=h*w*u-S*A*u+S*l*v-a*w*v-h*l*x+a*A*x,R=_*A*u-c*w*u-_*l*v+o*w*v+c*l*x-o*A*x,N=c*S*u-_*h*u+_*a*v-o*S*v-c*a*x+o*h*x,B=_*h*l-c*S*l-_*a*A+o*S*A+c*a*w-o*h*w,T=t*M+i*R+r*N+s*B;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const D=1/T;return e[0]=M*D,e[1]=(S*A*s-h*w*s-S*r*v+i*w*v+h*r*x-i*A*x)*D,e[2]=(a*w*s-S*l*s+S*r*u-i*w*u-a*r*x+i*l*x)*D,e[3]=(h*l*s-a*A*s-h*r*u+i*A*u+a*r*v-i*l*v)*D,e[4]=R*D,e[5]=(c*w*s-_*A*s+_*r*v-t*w*v-c*r*x+t*A*x)*D,e[6]=(_*l*s-o*w*s-_*r*u+t*w*u+o*r*x-t*l*x)*D,e[7]=(o*A*s-c*l*s+c*r*u-t*A*u-o*r*v+t*l*v)*D,e[8]=N*D,e[9]=(_*h*s-c*S*s-_*i*v+t*S*v+c*i*x-t*h*x)*D,e[10]=(o*S*s-_*a*s+_*i*u-t*S*u-o*i*x+t*a*x)*D,e[11]=(c*a*s-o*h*s-c*i*u+t*h*u+o*i*v-t*a*v)*D,e[12]=B*D,e[13]=(c*S*r-_*h*r+_*i*A-t*S*A-c*i*w+t*h*w)*D,e[14]=(_*a*r-o*S*r-_*i*l+t*S*l+o*i*w-t*a*w)*D,e[15]=(o*h*r-c*a*r+c*i*l-t*h*l-o*i*A+t*a*A)*D,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,c=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,c*a+i,c*l-r*o,0,u*l-r*a,c*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,l=t._w,u=s+s,c=o+o,h=a+a,A=s*u,v=s*c,_=s*h,S=o*c,w=o*h,x=a*h,M=l*u,R=l*c,N=l*h,B=i.x,T=i.y,D=i.z;return r[0]=(1-(S+x))*B,r[1]=(v+N)*B,r[2]=(_-R)*B,r[3]=0,r[4]=(v-N)*T,r[5]=(1-(A+x))*T,r[6]=(w+M)*T,r[7]=0,r[8]=(_+R)*D,r[9]=(w-M)*D,r[10]=(1-(A+S))*D,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Vp.set(r[0],r[1],r[2]).length();const o=Vp.set(r[4],r[5],r[6]).length(),a=Vp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ka.copy(this);const u=1/s,c=1/o,h=1/a;return Ka.elements[0]*=u,Ka.elements[1]*=u,Ka.elements[2]*=u,Ka.elements[4]*=c,Ka.elements[5]*=c,Ka.elements[6]*=c,Ka.elements[8]*=h,Ka.elements[9]*=h,Ka.elements[10]*=h,t.setFromRotationMatrix(Ka),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=ml){const l=this.elements,u=2*s/(t-e),c=2*s/(i-r),h=(t+e)/(t-e),A=(i+r)/(i-r);let v,_;if(a===ml)v=-(o+s)/(o-s),_=-2*o*s/(o-s);else if(a===Od)v=-o/(o-s),_=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=A,l[13]=0,l[2]=0,l[6]=0,l[10]=v,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=ml){const l=this.elements,u=1/(t-e),c=1/(i-r),h=1/(o-s),A=(t+e)*u,v=(i+r)*c;let _,S;if(a===ml)_=(o+s)*h,S=-2*h;else if(a===Od)_=s*h,S=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-A,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-v,l[2]=0,l[6]=0,l[10]=S,l[14]=-_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Vp=new Pe,Ka=new ji,S1e=new Pe(0,0,0),w1e=new Pe(1,1,1),Jc=new Pe,I_=new Pe,Ho=new Pe,a7=new ji,l7=new Dv;class Ml{constructor(e=0,t=0,i=0,r=Ml.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],c=r[9],h=r[2],A=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(ss(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(A,u),this._z=0);break;case"YXZ":this._x=Math.asin(-ss(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(ss(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-h,v),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-ss(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(A,v),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(ss(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-ss(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(A,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-c,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return a7.makeRotationFromQuaternion(e),this.setFromRotationMatrix(a7,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return l7.setFromEuler(this),this.setFromQuaternion(l7,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ml.DEFAULT_ORDER="XYZ";class E1e{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let T1e=0;const u7=new Pe,Gp=new Dv,Tu=new ji,D_=new Pe,jm=new Pe,C1e=new Pe,M1e=new Dv,c7=new Pe(1,0,0),h7=new Pe(0,1,0),f7=new Pe(0,0,1),d7={type:"added"},R1e={type:"removed"},qp={type:"childadded",child:null},Y3={type:"childremoved",child:null};class Kr extends Z0{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:T1e++}),this.uuid=tc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kr.DEFAULT_UP.clone();const e=new Pe,t=new Ml,i=new Dv,r=new Pe(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ji},normalMatrix:{value:new zo}}),this.matrix=new ji,this.matrixWorld=new ji,this.matrixAutoUpdate=Kr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Kr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new E1e,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Gp.setFromAxisAngle(e,t),this.quaternion.multiply(Gp),this}rotateOnWorldAxis(e,t){return Gp.setFromAxisAngle(e,t),this.quaternion.premultiply(Gp),this}rotateX(e){return this.rotateOnAxis(c7,e)}rotateY(e){return this.rotateOnAxis(h7,e)}rotateZ(e){return this.rotateOnAxis(f7,e)}translateOnAxis(e,t){return u7.copy(e).applyQuaternion(this.quaternion),this.position.add(u7.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(c7,e)}translateY(e){return this.translateOnAxis(h7,e)}translateZ(e){return this.translateOnAxis(f7,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Tu.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?D_.copy(e):D_.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),jm.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tu.lookAt(jm,D_,this.up):Tu.lookAt(D_,jm,this.up),this.quaternion.setFromRotationMatrix(Tu),r&&(Tu.extractRotation(r.matrixWorld),Gp.setFromRotationMatrix(Tu),this.quaternion.premultiply(Gp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(d7),qp.child=e,this.dispatchEvent(qp),qp.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(R1e),Y3.child=e,this.dispatchEvent(Y3),Y3.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Tu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Tu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Tu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(d7),qp.child=e,this.dispatchEvent(qp),qp.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jm,e,C1e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jm,M1e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];s(e.shapes,h)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(t){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),A=o(e.skeletons),v=o(e.animations),_=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),c.length>0&&(i.images=c),h.length>0&&(i.shapes=h),A.length>0&&(i.skeletons=A),v.length>0&&(i.animations=v),_.length>0&&(i.nodes=_)}return i.object=r,i;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Kr.DEFAULT_UP=new Pe(0,1,0);Kr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Kr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Za=new Pe,Cu=new Pe,Q3=new Pe,Mu=new Pe,Hp=new Pe,$p=new Pe,p7=new Pe,K3=new Pe,Z3=new Pe,J3=new Pe,eT=new pi,tT=new pi,nT=new pi;class hl{constructor(e=new Pe,t=new Pe,i=new Pe){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),Za.subVectors(e,t),r.cross(Za);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){Za.subVectors(r,t),Cu.subVectors(i,t),Q3.subVectors(e,t);const o=Za.dot(Za),a=Za.dot(Cu),l=Za.dot(Q3),u=Cu.dot(Cu),c=Cu.dot(Q3),h=o*u-a*a;if(h===0)return s.set(0,0,0),null;const A=1/h,v=(u*l-a*c)*A,_=(o*c-a*l)*A;return s.set(1-v-_,_,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Mu)===null?!1:Mu.x>=0&&Mu.y>=0&&Mu.x+Mu.y<=1}static getInterpolation(e,t,i,r,s,o,a,l){return this.getBarycoord(e,t,i,r,Mu)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,Mu.x),l.addScaledVector(o,Mu.y),l.addScaledVector(a,Mu.z),l)}static getInterpolatedAttribute(e,t,i,r,s,o){return eT.setScalar(0),tT.setScalar(0),nT.setScalar(0),eT.fromBufferAttribute(e,t),tT.fromBufferAttribute(e,i),nT.fromBufferAttribute(e,r),o.setScalar(0),o.addScaledVector(eT,s.x),o.addScaledVector(tT,s.y),o.addScaledVector(nT,s.z),o}static isFrontFacing(e,t,i,r){return Za.subVectors(i,t),Cu.subVectors(e,t),Za.cross(Cu).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Za.subVectors(this.c,this.b),Cu.subVectors(this.a,this.b),Za.cross(Cu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return hl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return hl.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return hl.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return hl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return hl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;Hp.subVectors(r,i),$p.subVectors(s,i),K3.subVectors(e,i);const l=Hp.dot(K3),u=$p.dot(K3);if(l<=0&&u<=0)return t.copy(i);Z3.subVectors(e,r);const c=Hp.dot(Z3),h=$p.dot(Z3);if(c>=0&&h<=c)return t.copy(r);const A=l*h-c*u;if(A<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(i).addScaledVector(Hp,o);J3.subVectors(e,s);const v=Hp.dot(J3),_=$p.dot(J3);if(_>=0&&v<=_)return t.copy(s);const S=v*u-l*_;if(S<=0&&u>=0&&_<=0)return a=u/(u-_),t.copy(i).addScaledVector($p,a);const w=c*_-v*h;if(w<=0&&h-c>=0&&v-_>=0)return p7.subVectors(s,r),a=(h-c)/(h-c+(v-_)),t.copy(r).addScaledVector(p7,a);const x=1/(w+S+A);return o=S*x,a=A*x,t.copy(i).addScaledVector(Hp,o).addScaledVector($p,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const CH={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},eh={h:0,s:0,l:0},k_={h:0,s:0,l:0};function iT(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class mi{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Jt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,wr.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=wr.workingColorSpace){return this.r=e,this.g=t,this.b=i,wr.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=wr.workingColorSpace){if(e=k6(e,1),t=ss(t,0,1),i=ss(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=iT(o,s,e+1/3),this.g=iT(o,s,e),this.b=iT(o,s,e-1/3)}return wr.toWorkingColorSpace(this,r),this}setStyle(e,t=Jt){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Jt){const i=CH[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=nc(e.r),this.g=nc(e.g),this.b=nc(e.b),this}copyLinearToSRGB(e){return this.r=KA(e.r),this.g=KA(e.g),this.b=KA(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Jt){return wr.fromWorkingColorSpace(Ts.copy(this),e),Math.round(ss(Ts.r*255,0,255))*65536+Math.round(ss(Ts.g*255,0,255))*256+Math.round(ss(Ts.b*255,0,255))}getHexString(e=Jt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=wr.workingColorSpace){wr.fromWorkingColorSpace(Ts.copy(this),t);const i=Ts.r,r=Ts.g,s=Ts.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const h=o-a;switch(u=c<=.5?h/(o+a):h/(2-o-a),o){case i:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-i)/h+2;break;case s:l=(i-r)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=wr.workingColorSpace){return wr.fromWorkingColorSpace(Ts.copy(this),t),e.r=Ts.r,e.g=Ts.g,e.b=Ts.b,e}getStyle(e=Jt){wr.fromWorkingColorSpace(Ts.copy(this),e);const t=Ts.r,i=Ts.g,r=Ts.b;return e!==Jt?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(eh),this.setHSL(eh.h+e,eh.s+t,eh.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(eh),e.getHSL(k_);const i=$g(eh.h,k_.h,t),r=$g(eh.s,k_.s,t),s=$g(eh.l,k_.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ts=new mi;mi.NAMES=CH;let P1e=0;class Bo extends Z0{static get type(){return"Material"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:P1e++}),this.uuid=tc(),this.name="",this.blending=Oh,this.side=P0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Mb,this.blendDst=Rb,this.blendEquation=gh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new mi(0,0,0),this.blendAlpha=0,this.depthFunc=Pb,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=DR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=jf,this.stencilZFail=jf,this.stencilZPass=jf,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Oh&&(i.blending=this.blending),this.side!==P0&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Mb&&(i.blendSrc=this.blendSrc),this.blendDst!==Rb&&(i.blendDst=this.blendDst),this.blendEquation!==gh&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Pb&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==DR&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==jf&&(i.stencilFail=this.stencilFail),this.stencilZFail!==jf&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==jf&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class aw extends Bo{static get type(){return"MeshBasicMaterial"}constructor(e){super(),this.isMeshBasicMaterial=!0,this.color=new mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ml,this.combine=ow,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bu=N1e();function N1e(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,c=0;for(;!(u&8388608);)u<<=1,c-=8388608;u&=-8388609,c+=947912704,s[l]=u|c}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function $o(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=ss(n,-65504,65504),Bu.floatView[0]=n;const e=Bu.uint32View[0],t=e>>23&511;return Bu.baseTable[t]+((e&8388607)>>Bu.shiftTable[t])}function L_(n){const e=n>>10;return Bu.uint32View[0]=Bu.mantissaTable[Bu.offsetTable[e]+(n&1023)]+Bu.exponentTable[e],Bu.floatView[0]}const br=new Pe,F_=new Jn;class La{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Db,this.updateRanges=[],this.gpuType=na,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)F_.fromBufferAttribute(this,t),F_.applyMatrix3(e),this.setXY(t,F_.x,F_.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.applyMatrix3(e),this.setXYZ(t,br.x,br.y,br.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.applyMatrix4(e),this.setXYZ(t,br.x,br.y,br.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.applyNormalMatrix(e),this.setXYZ(t,br.x,br.y,br.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)br.fromBufferAttribute(this,t),br.transformDirection(e),this.setXYZ(t,br.x,br.y,br.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Zs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Tn(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Zs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Zs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Zs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Zs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),r=Tn(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),r=Tn(r,this.array),s=Tn(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Db&&(e.usage=this.usage),e}}class MH extends La{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class RH extends La{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class PH extends La{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=L_(this.array[e*this.itemSize]);return this.normalized&&(t=Zs(t,this.array)),t}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize]=$o(t),this}getY(e){let t=L_(this.array[e*this.itemSize+1]);return this.normalized&&(t=Zs(t,this.array)),t}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+1]=$o(t),this}getZ(e){let t=L_(this.array[e*this.itemSize+2]);return this.normalized&&(t=Zs(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+2]=$o(t),this}getW(e){let t=L_(this.array[e*this.itemSize+3]);return this.normalized&&(t=Zs(t,this.array)),t}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.array[e*this.itemSize+3]=$o(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array)),this.array[e+0]=$o(t),this.array[e+1]=$o(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),r=Tn(r,this.array)),this.array[e+0]=$o(t),this.array[e+1]=$o(i),this.array[e+2]=$o(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),r=Tn(r,this.array),s=Tn(s,this.array)),this.array[e+0]=$o(t),this.array[e+1]=$o(i),this.array[e+2]=$o(r),this.array[e+3]=$o(s),this}}class ic extends La{constructor(e,t,i){super(new Float32Array(e),t,i)}}let I1e=0;const ya=new ji,rT=new Kr,jp=new Pe,jo=new kv,Wm=new kv,Hr=new Pe;class np extends Z0{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:I1e++}),this.uuid=tc(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(d1e(e)?RH:MH)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new zo().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ya.makeRotationFromQuaternion(e),this.applyMatrix4(ya),this}rotateX(e){return ya.makeRotationX(e),this.applyMatrix4(ya),this}rotateY(e){return ya.makeRotationY(e),this.applyMatrix4(ya),this}rotateZ(e){return ya.makeRotationZ(e),this.applyMatrix4(ya),this}translate(e,t,i){return ya.makeTranslation(e,t,i),this.applyMatrix4(ya),this}scale(e,t,i){return ya.makeScale(e,t,i),this.applyMatrix4(ya),this}lookAt(e){return rT.lookAt(e),rT.updateMatrix(),this.applyMatrix4(rT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jp).negate(),this.translate(jp.x,jp.y,jp.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const o=e[r];i.push(o.x,o.y,o.z||0)}this.setAttribute("position",new ic(i,3))}else{for(let i=0,r=t.count;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new kv);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Pe(-1/0,-1/0,-1/0),new Pe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];jo.setFromBufferAttribute(s),this.morphTargetsRelative?(Hr.addVectors(this.boundingBox.min,jo.min),this.boundingBox.expandByPoint(Hr),Hr.addVectors(this.boundingBox.max,jo.max),this.boundingBox.expandByPoint(Hr)):(this.boundingBox.expandByPoint(jo.min),this.boundingBox.expandByPoint(jo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new L6);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Pe,1/0);return}if(e){const i=this.boundingSphere.center;if(jo.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Wm.setFromBufferAttribute(a),this.morphTargetsRelative?(Hr.addVectors(jo.min,Wm.min),jo.expandByPoint(Hr),Hr.addVectors(jo.max,Wm.max),jo.expandByPoint(Hr)):(jo.expandByPoint(Wm.min),jo.expandByPoint(Wm.max))}jo.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Hr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Hr));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)Hr.fromBufferAttribute(a,u),l&&(jp.fromBufferAttribute(e,u),Hr.add(jp)),r=Math.max(r,i.distanceToSquared(Hr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new La(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let F=0;F<i.count;F++)a[F]=new Pe,l[F]=new Pe;const u=new Pe,c=new Pe,h=new Pe,A=new Jn,v=new Jn,_=new Jn,S=new Pe,w=new Pe;function x(F,L,O){u.fromBufferAttribute(i,F),c.fromBufferAttribute(i,L),h.fromBufferAttribute(i,O),A.fromBufferAttribute(s,F),v.fromBufferAttribute(s,L),_.fromBufferAttribute(s,O),c.sub(u),h.sub(u),v.sub(A),_.sub(A);const z=1/(v.x*_.y-_.x*v.y);isFinite(z)&&(S.copy(c).multiplyScalar(_.y).addScaledVector(h,-v.y).multiplyScalar(z),w.copy(h).multiplyScalar(v.x).addScaledVector(c,-_.x).multiplyScalar(z),a[F].add(S),a[L].add(S),a[O].add(S),l[F].add(w),l[L].add(w),l[O].add(w))}let M=this.groups;M.length===0&&(M=[{start:0,count:e.count}]);for(let F=0,L=M.length;F<L;++F){const O=M[F],z=O.start,Q=O.count;for(let j=z,ee=z+Q;j<ee;j+=3)x(e.getX(j+0),e.getX(j+1),e.getX(j+2))}const R=new Pe,N=new Pe,B=new Pe,T=new Pe;function D(F){B.fromBufferAttribute(r,F),T.copy(B);const L=a[F];R.copy(L),R.sub(B.multiplyScalar(B.dot(L))).normalize(),N.crossVectors(T,L);const z=N.dot(l[F])<0?-1:1;o.setXYZW(F,R.x,R.y,R.z,z)}for(let F=0,L=M.length;F<L;++F){const O=M[F],z=O.start,Q=O.count;for(let j=z,ee=z+Q;j<ee;j+=3)D(e.getX(j+0)),D(e.getX(j+1)),D(e.getX(j+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new La(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let A=0,v=i.count;A<v;A++)i.setXYZ(A,0,0,0);const r=new Pe,s=new Pe,o=new Pe,a=new Pe,l=new Pe,u=new Pe,c=new Pe,h=new Pe;if(e)for(let A=0,v=e.count;A<v;A+=3){const _=e.getX(A+0),S=e.getX(A+1),w=e.getX(A+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,S),o.fromBufferAttribute(t,w),c.subVectors(o,s),h.subVectors(r,s),c.cross(h),a.fromBufferAttribute(i,_),l.fromBufferAttribute(i,S),u.fromBufferAttribute(i,w),a.add(c),l.add(c),u.add(c),i.setXYZ(_,a.x,a.y,a.z),i.setXYZ(S,l.x,l.y,l.z),i.setXYZ(w,u.x,u.y,u.z)}else for(let A=0,v=t.count;A<v;A+=3)r.fromBufferAttribute(t,A+0),s.fromBufferAttribute(t,A+1),o.fromBufferAttribute(t,A+2),c.subVectors(o,s),h.subVectors(r,s),c.cross(h),i.setXYZ(A+0,c.x,c.y,c.z),i.setXYZ(A+1,c.x,c.y,c.z),i.setXYZ(A+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Hr.fromBufferAttribute(e,t),Hr.normalize(),e.setXYZ(t,Hr.x,Hr.y,Hr.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,A=new u.constructor(l.length*c);let v=0,_=0;for(let S=0,w=l.length;S<w;S++){a.isInterleavedBufferAttribute?v=l[S]*a.data.stride+a.offset:v=l[S]*c;for(let x=0;x<c;x++)A[_++]=u[v++]}return new La(A,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new np,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);t.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let c=0,h=u.length;c<h;c++){const A=u[c],v=e(A,i);l.push(v)}t.morphAttributes[a]=l}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,A=u.length;h<A;h++){const v=u[h];c.push(v.toJSON(e.data))}c.length>0&&(r[l]=c,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const u in r){const c=r[u];this.setAttribute(u,c.clone(t))}const s=e.morphAttributes;for(const u in s){const c=[],h=s[u];for(let A=0,v=h.length;A<v;A++)c.push(h[A].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const A7=new ji,Bf=new b1e,B_=new L6,m7=new Pe,O_=new Pe,U_=new Pe,z_=new Pe,sT=new Pe,V_=new Pe,g7=new Pe,G_=new Pe;class Ud extends Kr{constructor(e=new np,t=new aw){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){V_.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const c=a[l],h=s[l];c!==0&&(sT.fromBufferAttribute(h,e),o?V_.addScaledVector(sT,c):V_.addScaledVector(sT.sub(t),c))}t.add(V_)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),B_.copy(i.boundingSphere),B_.applyMatrix4(s),Bf.copy(e.ray).recast(e.near),!(B_.containsPoint(Bf.origin)===!1&&(Bf.intersectSphere(B_,m7)===null||Bf.origin.distanceToSquared(m7)>(e.far-e.near)**2))&&(A7.copy(s).invert(),Bf.copy(e.ray).applyMatrix4(A7),!(i.boundingBox!==null&&Bf.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Bf)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,l=s.attributes.position,u=s.attributes.uv,c=s.attributes.uv1,h=s.attributes.normal,A=s.groups,v=s.drawRange;if(a!==null)if(Array.isArray(o))for(let _=0,S=A.length;_<S;_++){const w=A[_],x=o[w.materialIndex],M=Math.max(w.start,v.start),R=Math.min(a.count,Math.min(w.start+w.count,v.start+v.count));for(let N=M,B=R;N<B;N+=3){const T=a.getX(N),D=a.getX(N+1),F=a.getX(N+2);r=q_(this,x,e,i,u,c,h,T,D,F),r&&(r.faceIndex=Math.floor(N/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const _=Math.max(0,v.start),S=Math.min(a.count,v.start+v.count);for(let w=_,x=S;w<x;w+=3){const M=a.getX(w),R=a.getX(w+1),N=a.getX(w+2);r=q_(this,o,e,i,u,c,h,M,R,N),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}else if(l!==void 0)if(Array.isArray(o))for(let _=0,S=A.length;_<S;_++){const w=A[_],x=o[w.materialIndex],M=Math.max(w.start,v.start),R=Math.min(l.count,Math.min(w.start+w.count,v.start+v.count));for(let N=M,B=R;N<B;N+=3){const T=N,D=N+1,F=N+2;r=q_(this,x,e,i,u,c,h,T,D,F),r&&(r.faceIndex=Math.floor(N/3),r.face.materialIndex=w.materialIndex,t.push(r))}}else{const _=Math.max(0,v.start),S=Math.min(l.count,v.start+v.count);for(let w=_,x=S;w<x;w+=3){const M=w,R=w+1,N=w+2;r=q_(this,o,e,i,u,c,h,M,R,N),r&&(r.faceIndex=Math.floor(w/3),t.push(r))}}}}function D1e(n,e,t,i,r,s,o,a){let l;if(e.side===Cl?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===P0,a),l===null)return null;G_.copy(a),G_.applyMatrix4(n.matrixWorld);const u=t.ray.origin.distanceTo(G_);return u<t.near||u>t.far?null:{distance:u,point:G_.clone(),object:n}}function q_(n,e,t,i,r,s,o,a,l,u){n.getVertexPosition(a,O_),n.getVertexPosition(l,U_),n.getVertexPosition(u,z_);const c=D1e(n,e,t,i,O_,U_,z_,g7);if(c){const h=new Pe;hl.getBarycoord(g7,O_,U_,z_,h),r&&(c.uv=hl.getInterpolatedAttribute(r,a,l,u,h,new Jn)),s&&(c.uv1=hl.getInterpolatedAttribute(s,a,l,u,h,new Jn)),o&&(c.normal=hl.getInterpolatedAttribute(o,a,l,u,h,new Pe),c.normal.dot(i.direction)>0&&c.normal.multiplyScalar(-1));const A={a,b:l,c:u,normal:new Pe,materialIndex:0};hl.getNormal(O_,U_,z_,A.normal),c.face=A,c.barycoord=h}return c}class Lv extends np{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],c=[],h=[];let A=0,v=0;_("z","y","x",-1,-1,i,t,e,o,s,0),_("z","y","x",1,-1,i,t,-e,o,s,1),_("x","z","y",1,1,e,i,t,r,o,2),_("x","z","y",1,-1,e,i,-t,r,o,3),_("x","y","z",1,-1,e,t,i,r,s,4),_("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new ic(u,3)),this.setAttribute("normal",new ic(c,3)),this.setAttribute("uv",new ic(h,2));function _(S,w,x,M,R,N,B,T,D,F,L){const O=N/D,z=B/F,Q=N/2,j=B/2,ee=T/2,$=D+1,Z=F+1;let ce=0,ie=0;const oe=new Pe;for(let me=0;me<Z;me++){const _e=me*z-j;for(let Oe=0;Oe<$;Oe++){const Ke=Oe*O-Q;oe[S]=Ke*M,oe[w]=_e*R,oe[x]=ee,u.push(oe.x,oe.y,oe.z),oe[S]=0,oe[w]=0,oe[x]=T>0?1:-1,c.push(oe.x,oe.y,oe.z),h.push(Oe/D),h.push(1-me/F),ce+=1}}for(let me=0;me<F;me++)for(let _e=0;_e<D;_e++){const Oe=A+_e+$*me,Ke=A+_e+$*(me+1),Me=A+(_e+1)+$*(me+1),ze=A+(_e+1)+$*me;l.push(Oe,Ke,ze),l.push(Ke,Me,ze),ie+=6}a.addGroup(v,ie,L),v+=ie,A+=ce}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lv(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function NH(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function k1e(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}var L1e=`
void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}
`,F1e=`
void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}
`;class B1e extends Bo{static get type(){return"ShaderMaterial"}constructor(e){super(),this.isShaderMaterial=!0,this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=L1e,this.fragmentShader=F1e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=NH(e.uniforms),this.uniformsGroups=k1e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class IH extends Kr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ji,this.projectionMatrix=new ji,this.projectionMatrixInverse=new ji,this.coordinateSystem=ml}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const th=new Pe,v7=new Jn,y7=new Jn;class Lu extends IH{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=G1*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Hg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return G1*2*Math.atan(Math.tan(Hg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){th.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(th.x,th.y).multiplyScalar(-e/th.z),th.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(th.x,th.y).multiplyScalar(-e/th.z)}getViewSize(e,t){return this.getViewBounds(e,v7,y7),t.subVectors(y7,v7)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Hg*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,t-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Wp=-90,Xp=1;class DH extends Kr{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Lu(Wp,Xp,e,t);r.layers=this.layers,this.add(r);const s=new Lu(Wp,Xp,e,t);s.layers=this.layers,this.add(s);const o=new Lu(Wp,Xp,e,t);o.layers=this.layers,this.add(o);const a=new Lu(Wp,Xp,e,t);a.layers=this.layers,this.add(a);const l=new Lu(Wp,Xp,e,t);l.layers=this.layers,this.add(l);const u=new Lu(Wp,Xp,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,l]=t;for(const u of t)this.remove(u);if(e===ml)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Od)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,l,u,c]=this.children,h=e.getRenderTarget(),A=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const S=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,l),e.setRenderTarget(i,4,r),e.render(t,u),i.texture.generateMipmaps=S,e.setRenderTarget(i,5,r),e.render(t,c),e.setRenderTarget(h,A,v),e.xr.enabled=_,i.texture.needsPMREMUpdate=!0}}class F6 extends to{constructor(e,t,i,r,s,o,a,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:Fd,super(e,t,i,r,s,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class O1e extends y1e{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new F6(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:ua}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Lv(5,5,5),s=new B1e({name:"CubemapFromEquirect",uniforms:NH(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Cl,blending:N0});s.uniforms.tEquirect.value=t;const o=new Ud(r,s),a=t.minFilter;return t.minFilter===Ju&&(t.minFilter=ua),new DH(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}class kH extends Kr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Ml,this.environmentIntensity=1,this.environmentRotation=new Ml,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class LH{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Db,this.updateRanges=[],this.version=0,this.uuid=tc()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=tc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=tc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const qs=new Pe;class B6{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)qs.fromBufferAttribute(this,t),qs.applyMatrix4(e),this.setXYZ(t,qs.x,qs.y,qs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)qs.fromBufferAttribute(this,t),qs.applyNormalMatrix(e),this.setXYZ(t,qs.x,qs.y,qs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)qs.fromBufferAttribute(this,t),qs.transformDirection(e),this.setXYZ(t,qs.x,qs.y,qs.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=Zs(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Tn(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Tn(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Zs(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Zs(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Zs(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Zs(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),r=Tn(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Tn(t,this.array),i=Tn(i,this.array),r=Tn(r,this.array),s=Tn(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new La(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new B6(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class FH extends Bo{static get type(){return"SpriteMaterial"}constructor(e){super(),this.isSpriteMaterial=!0,this.color=new mi(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class U1e extends to{constructor(e=null,t=1,i=1,r,s,o,a,l,u=Ps,c=Ps,h,A){super(null,o,a,l,u,c,r,s,h,A),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class z1e extends La{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const oT=new Pe,V1e=new Pe,G1e=new zo;class hh{constructor(e=new Pe(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=oT.subVectors(i,t).cross(V1e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(oT),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||G1e.getNormalMatrix(e),r=this.coplanarPoint(oT).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Of=new L6,H_=new Pe;class BH{constructor(e=new hh,t=new hh,i=new hh,r=new hh,s=new hh,o=new hh){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ml){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],l=r[3],u=r[4],c=r[5],h=r[6],A=r[7],v=r[8],_=r[9],S=r[10],w=r[11],x=r[12],M=r[13],R=r[14],N=r[15];if(i[0].setComponents(l-s,A-u,w-v,N-x).normalize(),i[1].setComponents(l+s,A+u,w+v,N+x).normalize(),i[2].setComponents(l+o,A+c,w+_,N+M).normalize(),i[3].setComponents(l-o,A-c,w-_,N-M).normalize(),i[4].setComponents(l-a,A-h,w-S,N-R).normalize(),t===ml)i[5].setComponents(l+a,A+h,w+S,N+R).normalize();else if(t===Od)i[5].setComponents(a,h,S,R).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Of.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Of.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Of)}intersectsSprite(e){return Of.center.set(0,0,0),Of.radius=.7071067811865476,Of.applyMatrix4(e.matrixWorld),this.intersectsSphere(Of)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(H_.x=r.normal.x>0?e.max.x:e.min.x,H_.y=r.normal.y>0?e.max.y:e.min.y,H_.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(H_)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class O6 extends Bo{static get type(){return"LineBasicMaterial"}constructor(e){super(),this.isLineBasicMaterial=!0,this.color=new mi(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}class OH extends Bo{static get type(){return"PointsMaterial"}constructor(e){super(),this.isPointsMaterial=!0,this.color=new mi(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}class q1e extends to{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ps,this.minFilter=Ps,this.generateMipmaps=!1,this.needsUpdate=!0}}class em extends to{constructor(e,t,i,r,s,o,a,l,u,c=wd){if(c!==wd&&c!==D0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===wd&&(i=rs),i===void 0&&c===D0&&(i=Iv),super(null,r,s,o,a,l,c,i,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Ps,this.minFilter=l!==void 0?l:Ps,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class U6 extends np{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let u=0;const c=[],h=new Pe,A=new Pe,v=[],_=[],S=[],w=[];for(let x=0;x<=i;x++){const M=[],R=x/i;let N=0;x===0&&o===0?N=.5/t:x===i&&l===Math.PI&&(N=-.5/t);for(let B=0;B<=t;B++){const T=B/t;h.x=-e*Math.cos(r+T*s)*Math.sin(o+R*a),h.y=e*Math.cos(o+R*a),h.z=e*Math.sin(r+T*s)*Math.sin(o+R*a),_.push(h.x,h.y,h.z),A.copy(h).normalize(),S.push(A.x,A.y,A.z),w.push(T+N,1-R),M.push(u++)}c.push(M)}for(let x=0;x<i;x++)for(let M=0;M<t;M++){const R=c[x][M+1],N=c[x][M],B=c[x+1][M],T=c[x+1][M+1];(x!==0||o>0)&&v.push(R,N,T),(x!==i-1||l<Math.PI)&&v.push(N,B,T)}this.setIndex(v),this.setAttribute("position",new ic(_,3)),this.setAttribute("normal",new ic(S,3)),this.setAttribute("uv",new ic(w,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new U6(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class UH extends Bo{static get type(){return"ShadowMaterial"}constructor(e){super(),this.isShadowMaterial=!0,this.color=new mi(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class z6 extends Bo{static get type(){return"MeshStandardMaterial"}constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.color=new mi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ef,this.normalScale=new Jn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ml,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class zH extends z6{static get type(){return"MeshPhysicalMaterial"}constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Jn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ss(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new mi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new mi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new mi(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class VH extends Bo{static get type(){return"MeshPhongMaterial"}constructor(e){super(),this.isMeshPhongMaterial=!0,this.color=new mi(16777215),this.specular=new mi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ef,this.normalScale=new Jn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ml,this.combine=ow,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class GH extends Bo{static get type(){return"MeshToonMaterial"}constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.color=new mi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ef,this.normalScale=new Jn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class qH extends Bo{static get type(){return"MeshNormalMaterial"}constructor(e){super(),this.isMeshNormalMaterial=!0,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ef,this.normalScale=new Jn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class HH extends Bo{static get type(){return"MeshLambertMaterial"}constructor(e){super(),this.isMeshLambertMaterial=!0,this.color=new mi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new mi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ef,this.normalScale=new Jn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Ml,this.combine=ow,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $H extends Bo{static get type(){return"MeshMatcapMaterial"}constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.color=new mi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ef,this.normalScale=new Jn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class jH extends O6{static get type(){return"LineDashedMaterial"}constructor(e){super(),this.isLineDashedMaterial=!0,this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}class ip extends Kr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new mi(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class H1e extends ip{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Kr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new mi(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const aT=new ji,_7=new Pe,x7=new Pe;class V6{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Jn(512,512),this.map=null,this.mapPass=null,this.matrix=new ji,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new BH,this._frameExtents=new Jn(1,1),this._viewportCount=1,this._viewports=[new pi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;_7.setFromMatrixPosition(e.matrixWorld),t.position.copy(_7),x7.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(x7),t.updateMatrixWorld(),aT.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aT),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(aT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class $1e extends V6{constructor(){super(new Lu(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=G1*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class WH extends ip{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Kr.DEFAULT_UP),this.updateMatrix(),this.target=new Kr,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new $1e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const b7=new ji,Xm=new Pe,lT=new Pe;class j1e extends V6{constructor(){super(new Lu(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Jn(4,2),this._viewportCount=6,this._viewports=[new pi(2,1,1,1),new pi(0,1,1,1),new pi(3,1,1,1),new pi(1,1,1,1),new pi(3,0,1,1),new pi(1,0,1,1)],this._cubeDirections=[new Pe(1,0,0),new Pe(-1,0,0),new Pe(0,0,1),new Pe(0,0,-1),new Pe(0,1,0),new Pe(0,-1,0)],this._cubeUps=[new Pe(0,1,0),new Pe(0,1,0),new Pe(0,1,0),new Pe(0,1,0),new Pe(0,0,1),new Pe(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Xm.setFromMatrixPosition(e.matrixWorld),i.position.copy(Xm),lT.copy(i.position),lT.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(lT),i.updateMatrixWorld(),r.makeTranslation(-Xm.x,-Xm.y,-Xm.z),b7.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(b7)}}class W1e extends ip{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new j1e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class G6 extends IH{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,l=r-t;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class X1e extends V6{constructor(){super(new G6(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Y1e extends ip{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Kr.DEFAULT_UP),this.updateMatrix(),this.target=new Kr,this.shadow=new X1e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Q1e extends ip{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class K1e extends ip{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class Z1e{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Pe)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class J1e extends ip{constructor(e=new Z1e,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class eve extends LH{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}const tve=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveMap","envMap","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"];class nve{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=tve,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:i,material:r}=e;if(t={material:this.getMaterialData(r),geometry:{attributes:this.getAttributesData(i.attributes),indexVersion:i.index?i.index.version:null,drawRange:{start:i.drawRange.start,count:i.drawRange.count}},worldMatrix:e.object.matrixWorld.clone()},e.object.center&&(t.center=e.object.center.clone()),e.object.morphTargetInfluences&&(t.morphTargetInfluences=e.object.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:s,height:o}=e.context;t.bufferWidth=s,t.bufferHeight=o}this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const i in e){const r=e[i];t[i]={version:r.version}}return t}containsNode(e){const t=e.material;for(const i in t)if(t[i]&&t[i].isNode)return!0;return e.renderer.nodes.modelViewMatrix!==null||e.renderer.nodes.modelNormalViewMatrix!==null}getMaterialData(e){const t={};for(const i of this.refreshUniforms){const r=e[i];r!=null&&(typeof r=="object"&&r.clone!==void 0?r.isTexture===!0?t[i]={id:r.id,version:r.version}:t[i]=r.clone():t[i]=r)}return t}equals(e){const{object:t,material:i,geometry:r}=e,s=this.getRenderObjectData(e);if(s.worldMatrix.equals(t.matrixWorld)!==!0)return s.worldMatrix.copy(t.matrixWorld),!1;const o=s.material;for(const S in o){const w=o[S],x=i[S];if(w.equals!==void 0){if(w.equals(x)===!1)return w.copy(x),!1}else if(x.isTexture===!0){if(w.id!==x.id||w.version!==x.version)return w.id=x.id,w.version=x.version,!1}else if(w!==x)return o[S]=x,!1}if(o.transmission>0){const{width:S,height:w}=e.context;if(s.bufferWidth!==S||s.bufferHeight!==w)return s.bufferWidth=S,s.bufferHeight=w,!1}const a=s.geometry,l=r.attributes,u=a.attributes,c=Object.keys(u),h=Object.keys(l);if(c.length!==h.length)return s.geometry.attributes=this.getAttributesData(l),!1;for(const S of c){const w=u[S],x=l[S];if(x===void 0)return delete u[S],!1;if(w.version!==x.version)return w.version=x.version,!1}const A=r.index,v=a.indexVersion,_=A?A.version:null;if(v!==_)return a.indexVersion=_,!1;if(a.drawRange.start!==r.drawRange.start||a.drawRange.count!==r.drawRange.count)return a.drawRange.start=r.drawRange.start,a.drawRange.count=r.drawRange.count,!1;if(s.morphTargetInfluences){let S=!1;for(let w=0;w<s.morphTargetInfluences.length;w++)s.morphTargetInfluences[w]!==t.morphTargetInfluences[w]&&(S=!0);if(S)return!0}return s.center&&s.center.equals(t.center)===!1?(s.center.copy(t.center),!0):(e.bundle!==null&&(s.version=e.bundle.version),!0)}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e))return!0;const{renderId:i}=t;if(this.renderId!==i)return this.renderId=i,!0;const r=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;return r||s?!1:this.equals(e)!==!0}}function q1(n,e=0){let t=3735928559^e,i=1103547991^e;if(n instanceof Array)for(let r=0,s;r<n.length;r++)s=n[r],t=Math.imul(t^s,2654435761),i=Math.imul(i^s,1597334677);else for(let r=0,s;r<n.length;r++)s=n.charCodeAt(r),t=Math.imul(t^s,2654435761),i=Math.imul(i^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507),i^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&i)+(t>>>0)}const ive=n=>q1(n),XH=n=>q1(n),kb=(...n)=>q1(n);function YH(n,e=!1){const t=[];n.isNode===!0&&(t.push(n.id),n=n.getSelf());for(const{property:i,childNode:r}of Lb(n))t.push(t,q1(i.slice(0,-4)),r.getCacheKey(e));return q1(t)}function*Lb(n,e=!1){for(const t in n){if(t.startsWith("_")===!0)continue;const i=n[t];if(Array.isArray(i)===!0)for(let r=0;r<i.length;r++){const s=i[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}else if(i&&i.isNode===!0)yield{property:t,childNode:i};else if(typeof i=="object")for(const r in i){const s=i[r];s&&(s.isNode===!0||e&&typeof s.toJSON=="function")&&(yield{property:t,index:r,childNode:s})}}}function Fb(n){if(n==null)return null;const e=typeof n;return n.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":n.isVector2===!0?"vec2":n.isVector3===!0?"vec3":n.isVector4===!0?"vec4":n.isMatrix3===!0?"mat3":n.isMatrix4===!0?"mat4":n.isColor===!0?"color":n instanceof ArrayBuffer?"ArrayBuffer":null}function QH(n,...e){const t=n?n.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),n==="color"?new mi(...e):t==="vec2"?new Jn(...e):t==="vec3"?new Pe(...e):t==="vec4"?new pi(...e):t==="mat3"?new zo(...e):t==="mat4"?new ji(...e):n==="bool"?e[0]||!1:n==="float"||n==="int"||n==="uint"?e[0]||0:n==="string"?e[0]||"":n==="ArrayBuffer"?sve(e[0]):null}function rve(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.length;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function sve(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0)).buffer}const S7={VERTEX:"vertex",FRAGMENT:"fragment"},Nn={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},ove=["fragment","vertex"],w7=["setup","analyze","generate"],E7=[...ove,"compute"],tm=["x","y","z","w"];let ave=0,Cn=class extends Z0{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=Nn.NONE,this.updateBeforeType=Nn.NONE,this.updateAfterType=Nn.NONE,this.uuid=f1e.generateUUID(),this.version=0,this._cacheKey=null,this._cacheKeyVersion=0,this.global=!1,this.isNode=!0,Object.defineProperty(this,"id",{value:ave++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this.getSelf()),this}onFrameUpdate(e){return this.onUpdate(e,Nn.FRAME)}onRenderUpdate(e){return this.onUpdate(e,Nn.RENDER)}onObjectUpdate(e){return this.onUpdate(e,Nn.OBJECT)}onReference(e){return this.updateReference=e.bind(this.getSelf()),this}getSelf(){return this.self||this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of Lb(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(e=!1){return e=e||this.version!==this._cacheKeyVersion,(e===!0||this._cacheKey===null)&&(this._cacheKey=YH(this,e),this._cacheKeyVersion=this.version),this._cacheKey}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);let i=0;for(const r of this.getChildren())t["node"+i++]=r;return null}analyze(e){if(e.increaseUsage(this)===1){const i=e.getNodeProperties(this);for(const r of Object.values(i))r&&r.isNode===!0&&r.build(e)}}generate(e,t){const{outputNode:i}=e.getNodeProperties(this);if(i&&i.isNode===!0)return i.build(e,t)}updateBefore(){console.warn("Abstract function.")}updateAfter(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const i=this.getShared(e);if(this!==i)return i.build(e,t);e.addNode(this),e.addChain(this);let r=null;const s=e.getBuildStage();if(s==="setup"){this.updateReference(e);const o=e.getNodeProperties(this);if(o.initialized!==!0){const a=e.stack.nodes.length;o.initialized=!0,o.outputNode=this.setup(e),o.outputNode!==null&&e.stack.nodes.length;for(const l of Object.values(o))l&&l.isNode===!0&&l.build(e)}}else if(s==="analyze")this.analyze(e);else if(s==="generate")if(this.generate.length===1){const a=this.getNodeType(e),l=e.getDataFromNode(this);r=l.snippet,r===void 0?(r=this.generate(e)||"",l.snippet=r):l.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),r=e.format(r,a,t)}else r=this.generate(e,t)||"";return e.removeChain(this),e.addSequentialNode(this),r}getSerializeChildren(){return Lb(this)}serialize(e){const t=this.getSerializeChildren(),i={};for(const{property:r,index:s,childNode:o}of t)s!==void 0?(i[r]===void 0&&(i[r]=Number.isInteger(s)?[]:{}),i[r][s]=o.toJSON(e.meta).uuid):i[r]=o.toJSON(e.meta).uuid;Object.keys(i).length>0&&(e.inputNodes=i)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const i in e.inputNodes)if(Array.isArray(e.inputNodes[i])){const r=[];for(const s of e.inputNodes[i])r.push(t[s]);this[i]=r}else if(typeof e.inputNodes[i]=="object"){const r={};for(const s in e.inputNodes[i]){const o=e.inputNodes[i][s];r[s]=t[o]}this[i]=r}else{const r=e.inputNodes[i];this[i]=t[r]}}}toJSON(e){const{uuid:t,type:i}=this,r=e===void 0||typeof e=="string";r&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:i,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},r!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}if(r){const a=o(e.textures),l=o(e.images),u=o(e.nodes);a.length>0&&(s.textures=a),l.length>0&&(s.images=l),u.length>0&&(s.nodes=u)}return s}};class Fv extends Cn{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}generate(e){const t=this.node.build(e),i=this.indexNode.build(e,"uint");return`${t}[ ${i} ]`}}class KH extends Cn{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let i=null;for(const r of this.convertTo.split("|"))(i===null||e.getTypeLength(t)===e.getTypeLength(r))&&(i=r);return i}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const i=this.node,r=this.getNodeType(e),s=i.build(e,r);return e.format(s,r,t)}}class Nr extends Cn{static get type(){return"TempNode"}constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const r=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,r,t);if(r!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,r),a=e.getVarFromNode(this,null,r),l=e.getPropertyName(a);return e.addLineFlowCode(`${l} = ${o}`,this),s.snippet=o,s.propertyName=l,e.format(s.propertyName,r,t)}}return super.build(e,t)}}class lve extends Nr{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,i)=>t+e.getTypeLength(i.getNodeType(e)),0))}generate(e,t){const i=this.getNodeType(e),r=this.nodes,s=e.getComponentType(i),o=[];for(const l of r){let u=l.build(e);const c=e.getComponentType(l.getNodeType(e));c!==s&&(u=e.format(u,c,s)),o.push(u)}const a=`${e.getType(i)}( ${o.join(", ")} )`;return e.format(a,i,t)}}const uve=tm.join("");class T7 extends Cn{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(tm.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const i=this.node,r=e.getTypeLength(i.getNodeType(e));let s=null;if(r>1){let o=null;this.getVectorLength()>=r&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const l=i.build(e,o);this.components.length===r&&this.components===uve.slice(0,this.components.length)?s=e.format(l,o,t):s=e.format(`${l}.${this.components}`,this.getNodeType(e),t)}else s=i.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class cve extends Nr{static get type(){return"SetNode"}constructor(e,t,i){super(),this.sourceNode=e,this.components=t,this.targetNode=i}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:i,targetNode:r}=this,s=this.getNodeType(e),o=e.getTypeFromLength(i.length,r.getNodeType(e)),a=r.build(e,o),l=t.build(e,s),u=e.getTypeLength(s),c=[];for(let h=0;h<u;h++){const A=tm[h];A===i[0]?(c.push(a),h+=i.length-1):c.push(l+"."+A)}return`${e.getType(s)}( ${c.join(", ")} )`}}class hve extends Nr{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:i}=this,r=this.getNodeType(e),s=i.build(e),o=e.getVarFromNode(this),a=e.getPropertyName(o);e.addLineFlowCode(a+" = "+s,this);const l=e.getTypeLength(r),u=[];let c=0;for(let h=0;h<l;h++){const A=tm[h];A===t[c]?(u.push("1.0 - "+(a+"."+A)),c++):u.push(a+"."+A)}return`${e.getType(r)}( ${u.join(", ")} )`}}class q6 extends Cn{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Fb(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Fb(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=rve(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?QH(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}class Mc extends q6{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const i=this.getNodeType(e);return e.format(this.generateConst(e),i,t)}}let k0=null;const PA=new Map;function je(n,e){if(PA.has(n)){console.warn(`Redefinition of method chaining ${n}`);return}if(typeof e!="function")throw new Error(`Node element ${n} is not a function`);PA.set(n,e)}const ZH=n=>n.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),C7=n=>ZH(n).split("").sort().join(""),JH={setup(n,e){const t=e.shift();return n(cw(t),...e)},get(n,e,t){if(typeof e=="string"&&n[e]===void 0){if(n.isStackNode!==!0&&e==="assign")return(...i)=>(k0.assign(t,...i),t);if(PA.has(e)){const i=PA.get(e);return n.isStackNode?(...r)=>t.add(i(...r)):(...r)=>i(t,...r)}else{if(e==="self")return n;if(e.endsWith("Assign")&&PA.has(e.slice(0,e.length-6))){const i=PA.get(e.slice(0,e.length-6));return n.isStackNode?(...r)=>t.assign(r[0],i(...r)):(...r)=>t.assign(i(t,...r))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=ZH(e),pt(new T7(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=C7(e.slice(3).toLowerCase()),i=>pt(new cve(n,e,i));if(/^flip[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=C7(e.slice(4).toLowerCase()),()=>pt(new hve(pt(n),e));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),pt(new T7(n,e));if(/^\d+$/.test(e)===!0)return pt(new Fv(t,new Mc(Number(e),"uint")))}}}return Reflect.get(n,e,t)},set(n,e,t,i){return typeof e=="string"&&n[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(i[e].assign(t),!0):Reflect.set(n,e,t,i)}},uT=new WeakMap,M7=new WeakMap,fve=function(n,e=null){const t=Fb(n);if(t==="node"){let i=uT.get(n);return i===void 0&&(i=new Proxy(n,JH),uT.set(n,i),uT.set(i,i)),i}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return pt(LR(n,e));if(t==="shader")return Tt(n)}return n},dve=function(n,e=null){for(const t in n)n[t]=pt(n[t],e);return n},pve=function(n,e=null){const t=n.length;for(let i=0;i<t;i++)n[i]=pt(n[i],e);return n},Ave=function(n,e=null,t=null,i=null){const r=s=>pt(i!==null?Object.assign(s,i):s);return e===null?(...s)=>r(new n(...ZA(s))):t!==null?(t=pt(t),(...s)=>r(new n(e,...ZA(s),t))):(...s)=>r(new n(e,...ZA(s)))},mve=function(n,...e){return pt(new n(...ZA(e)))};class gve extends Cn{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}call(e){const{shaderNode:t,inputNodes:i}=this,r=e.getNodeProperties(t);if(r.onceOutput)return r.onceOutput;let s=null;if(t.layout){let o=M7.get(e.constructor);o===void 0&&(o=new WeakMap,M7.set(e.constructor,o));let a=o.get(t);a===void 0&&(a=pt(e.buildFunctionNode(t)),o.set(t,a)),e.currentFunctionNode!==null&&e.currentFunctionNode.includes.push(a),s=pt(a.call(i))}else{const o=t.jsFunc,a=i!==null?o(i,e):o(e);s=pt(a)}return t.once&&(r.onceOutput=s),s}getOutputNode(e){const t=e.getNodeProperties(this);return t.outputNode===null&&(t.outputNode=this.setupOutput(e)),t.outputNode}setup(e){return this.getOutputNode(e)}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){return this.getOutputNode(e).build(e,t)}}class vve extends Cn{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}call(e=null){return cw(e),pt(new gve(this,e))}setup(){return this.call()}}const yve=[!1,!0],_ve=[0,1,2,3],xve=[-1,-2],e$=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],H6=new Map;for(const n of yve)H6.set(n,new Mc(n));const $6=new Map;for(const n of _ve)$6.set(n,new Mc(n,"uint"));const j6=new Map([...$6].map(n=>new Mc(n.value,"int")));for(const n of xve)j6.set(n,new Mc(n,"int"));const lw=new Map([...j6].map(n=>new Mc(n.value)));for(const n of e$)lw.set(n,new Mc(n));for(const n of e$)lw.set(-n,new Mc(-n));const uw={bool:H6,uint:$6,ints:j6,float:lw},R7=new Map([...H6,...lw]),LR=(n,e)=>R7.has(n)?R7.get(n):n.isNode===!0?n:new Mc(n,e),bve=n=>{try{return n.getNodeType()}catch{return}},Ir=function(n,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(n)&&t.every(r=>typeof r!="object"))&&(t=[QH(n,...t)]),t.length===1&&e!==null&&e.has(t[0]))return pt(e.get(t[0]));if(t.length===1){const r=LR(t[0],n);return bve(r)===n?pt(r):pt(new KH(r,n))}const i=t.map(r=>LR(r));return pt(new lve(i,n))}},P7=n=>typeof n=="object"&&n!==null?n.value:n,Sve=n=>n!=null?n.nodeType||n.convertTo||(typeof n=="string"?n:null):null;function K2(n,e){return new Proxy(new vve(n,e),JH)}const pt=(n,e=null)=>fve(n,e),cw=(n,e=null)=>new dve(n,e),ZA=(n,e=null)=>new pve(n,e),Je=(...n)=>new Ave(...n),gt=(...n)=>new mve(...n),Tt=(n,e)=>{const t=new K2(n,e),i=(...r)=>{let s;return cw(r),r[0]&&r[0].isNode?s=[...r]:s=r[0],t.call(s)};return i.shaderNode=t,i.setLayout=r=>(t.setLayout(r),i),i.once=()=>(t.once=!0,i),i};je("toGlobal",n=>(n.global=!0,n));const Bb=n=>{k0=n},t$=()=>k0,ls=(...n)=>k0.If(...n);function wve(n){return k0&&k0.add(n),n}je("append",wve);const Eve=new Ir("color"),Qe=new Ir("float",uw.float),dr=new Ir("int",uw.ints),Tve=new Ir("uint",uw.uint),Cve=new Ir("bool",uw.bool),Pt=new Ir("vec2"),Fu=new Ir("ivec2"),Mve=new Ir("uvec2"),Rve=new Ir("bvec2"),Xe=new Ir("vec3"),Pve=new Ir("ivec3"),Nve=new Ir("uvec3"),Ive=new Ir("bvec3"),wn=new Ir("vec4"),Dve=new Ir("ivec4"),kve=new Ir("uvec4"),Lve=new Ir("bvec4"),W6=new Ir("mat2"),no=new Ir("mat3"),JA=new Ir("mat4");je("toColor",Eve);je("toFloat",Qe);je("toInt",dr);je("toUint",Tve);je("toBool",Cve);je("toVec2",Pt);je("toIVec2",Fu);je("toUVec2",Mve);je("toBVec2",Rve);je("toVec3",Xe);je("toIVec3",Pve);je("toUVec3",Nve);je("toBVec3",Ive);je("toVec4",wn);je("toIVec4",Dve);je("toUVec4",kve);je("toBVec4",Lve);je("toMat2",W6);je("toMat3",no);je("toMat4",JA);const Fve=Je(Fv),Bve=(n,e)=>pt(new KH(pt(n),e));je("element",Fve);je("convert",Bve);class n$ extends Cn{static get type(){return"UniformGroupNode"}constructor(e,t=!1,i=1){super("string"),this.name=e,this.version=0,this.shared=t,this.order=i,this.isUniformGroup=!0}set needsUpdate(e){e===!0&&this.version++}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const Ove=n=>new n$(n),i$=(n,e=0)=>new n$(n,!0,e),Uve=i$("frame"),$n=i$("render"),r$=Ove("object");class Bv extends q6{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=r$}label(e){return this.name=e,this}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){const i=this.getSelf();return e=e.bind(i),super.onUpdate(r=>{const s=e(r,i);s!==void 0&&(this.value=s)},t)}generate(e,t){const i=this.getNodeType(e),r=this.getUniformHash(e);let s=e.getNodeFromHash(r);s===void 0&&(e.setHashNode(this,r),s=this);const o=s.getInputType(e),a=e.getUniformFromNode(s,o,e.shaderStage,this.name||e.context.label),l=e.getPropertyName(a);return e.context.label!==void 0&&delete e.context.label,e.format(l,i,t)}}const En=(n,e)=>{const t=Sve(e||n),i=n&&n.isNode===!0?n.node&&n.node.value||n.value:n;return pt(new Bv(i,t))};class gi extends Cn{static get type(){return"PropertyNode"}constructor(e,t=null,i=!1){super(e),this.name=t,this.varying=i,this.isPropertyNode=!0}getHash(e){return this.name||super.getHash(e)}isGlobal(){return!0}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const sA=(n,e)=>pt(new gi(n,e)),Ob=(n,e)=>pt(new gi(n,e,!0)),ui=gt(gi,"vec4","DiffuseColor"),N7=gt(gi,"vec3","EmissiveColor"),Ou=gt(gi,"float","Roughness"),Ub=gt(gi,"float","Metalness"),FR=gt(gi,"float","Clearcoat"),zb=gt(gi,"float","ClearcoatRoughness"),NA=gt(gi,"vec3","Sheen"),X6=gt(gi,"float","SheenRoughness"),Y6=gt(gi,"float","Iridescence"),s$=gt(gi,"float","IridescenceIOR"),o$=gt(gi,"float","IridescenceThickness"),BR=gt(gi,"float","AlphaT"),Wf=gt(gi,"float","Anisotropy"),Z2=gt(gi,"vec3","AnisotropyT"),e0=gt(gi,"vec3","AnisotropyB"),Yo=gt(gi,"color","SpecularColor"),Vb=gt(gi,"float","SpecularF90"),OR=gt(gi,"float","Shininess"),zve=gt(gi,"vec4","Output"),cT=gt(gi,"float","dashSize"),I7=gt(gi,"float","gapSize"),J2=gt(gi,"float","IOR"),UR=gt(gi,"float","Transmission"),a$=gt(gi,"float","Thickness"),l$=gt(gi,"float","AttenuationDistance"),u$=gt(gi,"color","AttenuationColor"),c$=gt(gi,"float","Dispersion");class Vve extends Nr{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const i=e.getTypeLength(t.node.getNodeType(e));return tm.join("").slice(0,i)!==t.components}return!1}generate(e,t){const{targetNode:i,sourceNode:r}=this,s=this.needsSplitAssign(e),o=i.getNodeType(e),a=i.context({assign:!0}).build(e),l=r.build(e,o),u=r.getNodeType(e),c=e.getDataFromNode(this);let h;if(c.initialized===!0)t!=="void"&&(h=a);else if(s){const A=e.getVarFromNode(this,null,o),v=e.getPropertyName(A);e.addLineFlowCode(`${v} = ${l}`,this);const _=i.node.context({assign:!0}).build(e);for(let S=0;S<i.components.length;S++){const w=i.components[S];e.addLineFlowCode(`${_}.${w} = ${v}[ ${S} ]`,this)}t!=="void"&&(h=a)}else h=`${a} = ${l}`,(t==="void"||u==="void")&&(e.addLineFlowCode(h,this),t!=="void"&&(h=a));return c.initialized=!0,e.format(h,o,t)}}const Gve=Je(Vve);je("assign",Gve);class qve extends Nr{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}generate(e){const t=[],i=this.functionNode,r=i.getInputs(e),s=this.parameters,o=(l,u)=>{const c=u.type,h=c==="pointer";let A;return h?A="&"+l.build(e):A=l.build(e,c),A};if(Array.isArray(s))for(let l=0;l<s.length;l++)t.push(o(s[l],r[l]));else for(const l of r){const u=s[l.name];if(u!==void 0)t.push(o(u,l));else throw new Error(`FunctionCallNode: Input '${l.name}' not found in FunctionNode.`)}return`${i.build(e,"property")}( ${t.join(", ")} )`}}const Hve=(n,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?ZA(e):cw(e[0]),pt(new qve(pt(n),e)));je("call",Hve);class Wi extends Nr{static get type(){return"OperatorNode"}constructor(e,t,i,...r){if(super(),r.length>0){let s=new Wi(e,t,i);for(let o=0;o<r.length-1;o++)s=new Wi(e,s,r[o]);t=s,i=r[r.length-1]}this.op=e,this.aNode=t,this.bNode=i}getNodeType(e,t){const i=this.op,r=this.aNode,s=this.bNode,o=r.getNodeType(e),a=typeof s<"u"?s.getNodeType(e):null;if(o==="void"||a==="void")return"void";if(i==="%")return o;if(i==="~"||i==="&"||i==="|"||i==="^"||i===">>"||i==="<<")return e.getIntegerType(o);if(i==="!"||i==="=="||i==="&&"||i==="||"||i==="^^")return"bool";if(i==="<"||i===">"||i==="<="||i===">="){const l=t?e.getTypeLength(t):Math.max(e.getTypeLength(o),e.getTypeLength(a));return l>1?`bvec${l}`:"bool"}else return o==="float"&&e.isMatrix(a)?a:e.isMatrix(o)&&e.isVector(a)?e.getVectorFromMatrix(o):e.isVector(o)&&e.isMatrix(a)?e.getVectorFromMatrix(a):e.getTypeLength(a)>e.getTypeLength(o)?a:o}generate(e,t){const i=this.op,r=this.aNode,s=this.bNode,o=this.getNodeType(e,t);let a=null,l=null;o!=="void"?(a=r.getNodeType(e),l=typeof s<"u"?s.getNodeType(e):null,i==="<"||i===">"||i==="<="||i===">="||i==="=="?e.isVector(a)?l=a:a!==l&&(a=l="float"):i===">>"||i==="<<"?(a=o,l=e.changeComponentType(l,"uint")):e.isMatrix(a)&&e.isVector(l)?l=e.getVectorFromMatrix(a):e.isVector(a)&&e.isMatrix(l)?a=e.getVectorFromMatrix(l):a=l=o):a=l=o;const u=r.build(e,a),c=typeof s<"u"?s.build(e,l):null,h=e.getTypeLength(t),A=e.getFunctionOperator(i);if(t!=="void")return i==="<"&&h>1?e.useComparisonMethod?e.format(`${e.getMethod("lessThan",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} < ${c} )`,o,t):i==="<="&&h>1?e.useComparisonMethod?e.format(`${e.getMethod("lessThanEqual",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} <= ${c} )`,o,t):i===">"&&h>1?e.useComparisonMethod?e.format(`${e.getMethod("greaterThan",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} > ${c} )`,o,t):i===">="&&h>1?e.useComparisonMethod?e.format(`${e.getMethod("greaterThanEqual",t)}( ${u}, ${c} )`,o,t):e.format(`( ${u} >= ${c} )`,o,t):i==="!"||i==="~"?e.format(`(${i}${u})`,a,t):A?e.format(`${A}( ${u}, ${c} )`,o,t):e.format(`( ${u} ${i} ${c} )`,o,t);if(a!=="void")return A?e.format(`${A}( ${u}, ${c} )`,o,t):e.format(`${u} ${i} ${c}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const io=Je(Wi,"+"),ta=Je(Wi,"-"),Un=Je(Wi,"*"),tf=Je(Wi,"/"),h$=Je(Wi,"%"),$ve=Je(Wi,"=="),jve=Je(Wi,"!="),Wve=Je(Wi,"<"),Xve=Je(Wi,">"),Yve=Je(Wi,"<="),Qve=Je(Wi,">="),Kve=Je(Wi,"&&"),Zve=Je(Wi,"||"),Jve=Je(Wi,"!"),eye=Je(Wi,"^^"),tye=Je(Wi,"&"),nye=Je(Wi,"~"),iye=Je(Wi,"|"),rye=Je(Wi,"^"),sye=Je(Wi,"<<"),oye=Je(Wi,">>");je("add",io);je("sub",ta);je("mul",Un);je("div",tf);je("modInt",h$);je("equal",$ve);je("notEqual",jve);je("lessThan",Wve);je("greaterThan",Xve);je("lessThanEqual",Yve);je("greaterThanEqual",Qve);je("and",Kve);je("or",Zve);je("not",Jve);je("xor",eye);je("bitAnd",tye);je("bitNot",nye);je("bitOr",iye);je("bitXor",rye);je("shiftLeft",sye);je("shiftRight",oye);const aye=(...n)=>(console.warn("TSL.OperatorNode: .remainder() has been renamed to .modInt()."),h$(...n));je("remainder",aye);class we extends Nr{static get type(){return"MathNode"}constructor(e,t,i=null,r=null){super(),this.method=e,this.aNode=t,this.bNode=i,this.cNode=r}getInputType(e){const t=this.aNode.getNodeType(e),i=this.bNode?this.bNode.getNodeType(e):null,r=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(i)?0:e.getTypeLength(i),a=e.isMatrix(r)?0:e.getTypeLength(r);return s>o&&s>a?t:o>a?i:a>s?r:t}getNodeType(e){const t=this.method;return t===we.LENGTH||t===we.DISTANCE||t===we.DOT?"float":t===we.CROSS?"vec3":t===we.ALL?"bool":t===we.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===we.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const i=this.method,r=this.getNodeType(e),s=this.getInputType(e),o=this.aNode,a=this.bNode,l=this.cNode,u=e.renderer.isWebGLRenderer===!0;if(i===we.TRANSFORM_DIRECTION){let c=o,h=a;e.isMatrix(c.getNodeType(e))?h=wn(Xe(h),0):c=wn(Xe(c),0);const A=Un(c,h).xyz;return $1(A).build(e,t)}else{if(i===we.NEGATE)return e.format("( - "+o.build(e,s)+" )",r,t);if(i===we.ONE_MINUS)return ta(1,o).build(e,t);if(i===we.RECIPROCAL)return tf(1,o).build(e,t);if(i===we.DIFFERENCE)return ll(ta(o,a)).build(e,t);{const c=[];return i===we.CROSS||i===we.MOD?c.push(o.build(e,r),a.build(e,r)):u&&i===we.STEP?c.push(o.build(e,e.getTypeLength(o.getNodeType(e))===1?"float":s),a.build(e,s)):u&&(i===we.MIN||i===we.MAX)||i===we.MOD?c.push(o.build(e,s),a.build(e,e.getTypeLength(a.getNodeType(e))===1?"float":s)):i===we.REFRACT?c.push(o.build(e,s),a.build(e,s),l.build(e,"float")):i===we.MIX?c.push(o.build(e,s),a.build(e,s),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":s)):(c.push(o.build(e,s)),a!==null&&c.push(a.build(e,s)),l!==null&&c.push(l.build(e,s))),e.format(`${e.getMethod(i,r)}( ${c.join(", ")} )`,r,t)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}we.ALL="all";we.ANY="any";we.EQUALS="equals";we.RADIANS="radians";we.DEGREES="degrees";we.EXP="exp";we.EXP2="exp2";we.LOG="log";we.LOG2="log2";we.SQRT="sqrt";we.INVERSE_SQRT="inversesqrt";we.FLOOR="floor";we.CEIL="ceil";we.NORMALIZE="normalize";we.FRACT="fract";we.SIN="sin";we.COS="cos";we.TAN="tan";we.ASIN="asin";we.ACOS="acos";we.ATAN="atan";we.ABS="abs";we.SIGN="sign";we.LENGTH="length";we.NEGATE="negate";we.ONE_MINUS="oneMinus";we.DFDX="dFdx";we.DFDY="dFdy";we.ROUND="round";we.RECIPROCAL="reciprocal";we.TRUNC="trunc";we.FWIDTH="fwidth";we.BITCAST="bitcast";we.TRANSPOSE="transpose";we.ATAN2="atan2";we.MIN="min";we.MAX="max";we.MOD="mod";we.STEP="step";we.REFLECT="reflect";we.DISTANCE="distance";we.DIFFERENCE="difference";we.DOT="dot";we.CROSS="cross";we.POW="pow";we.TRANSFORM_DIRECTION="transformDirection";we.MIX="mix";we.CLAMP="clamp";we.REFRACT="refract";we.SMOOTHSTEP="smoothstep";we.FACEFORWARD="faceforward";const lye=Qe(1e-6),uye=Qe(Math.PI),f$=Je(we,we.ALL),cye=Je(we,we.ANY),hye=Je(we,we.EQUALS),fye=Je(we,we.RADIANS),dye=Je(we,we.DEGREES),d$=Je(we,we.EXP),H1=Je(we,we.EXP2),p$=Je(we,we.LOG),rc=Je(we,we.LOG2),Q6=Je(we,we.SQRT),pye=Je(we,we.INVERSE_SQRT),Ed=Je(we,we.FLOOR),K6=Je(we,we.CEIL),$1=Je(we,we.NORMALIZE),pf=Je(we,we.FRACT),al=Je(we,we.SIN),fh=Je(we,we.COS),Aye=Je(we,we.TAN),mye=Je(we,we.ASIN),gye=Je(we,we.ACOS),vye=Je(we,we.ATAN),ll=Je(we,we.ABS),A$=Je(we,we.SIGN),Vh=Je(we,we.LENGTH),yye=Je(we,we.NEGATE),_ye=Je(we,we.ONE_MINUS),m$=Je(we,we.DFDX),g$=Je(we,we.DFDY),xye=Je(we,we.ROUND),bye=Je(we,we.RECIPROCAL),Sye=Je(we,we.TRUNC),wye=Je(we,we.FWIDTH);we.BITCAST;const Eye=Je(we,we.TRANSPOSE),Tye=Je(we,we.ATAN2),j1=Je(we,we.MIN),Ua=Je(we,we.MAX),v$=Je(we,we.MOD),y$=Je(we,we.STEP),Cye=Je(we,we.REFLECT),Mye=Je(we,we.DISTANCE),Rye=Je(we,we.DIFFERENCE),Z6=Je(we,we.DOT),_$=Je(we,we.CROSS),hw=Je(we,we.POW),x$=Je(we,we.POW,2),Pye=Je(we,we.POW,3),Nye=Je(we,we.POW,4),Iye=Je(we,we.TRANSFORM_DIRECTION),Dye=n=>Un(A$(n),hw(ll(n),1/3)),kye=n=>Z6(n,n),Bi=Je(we,we.MIX),gc=(n,e=0,t=1)=>pt(new we(we.CLAMP,pt(n),pt(e),pt(t))),Lye=n=>gc(n),b$=Je(we,we.REFRACT),zd=Je(we,we.SMOOTHSTEP),Fye=Je(we,we.FACEFORWARD),Bye=Tt(([n])=>{const i=43758.5453,r=Z6(n.xy,Pt(12.9898,78.233)),s=v$(r,uye);return pf(al(s).mul(i))}),Oye=(n,e,t)=>Bi(e,t,n),Uye=(n,e,t)=>zd(e,t,n);je("all",f$);je("any",cye);je("equals",hye);je("radians",fye);je("degrees",dye);je("exp",d$);je("exp2",H1);je("log",p$);je("log2",rc);je("sqrt",Q6);je("inverseSqrt",pye);je("floor",Ed);je("ceil",K6);je("normalize",$1);je("fract",pf);je("sin",al);je("cos",fh);je("tan",Aye);je("asin",mye);je("acos",gye);je("atan",vye);je("abs",ll);je("sign",A$);je("length",Vh);je("lengthSq",kye);je("negate",yye);je("oneMinus",_ye);je("dFdx",m$);je("dFdy",g$);je("round",xye);je("reciprocal",bye);je("trunc",Sye);je("fwidth",wye);je("atan2",Tye);je("min",j1);je("max",Ua);je("mod",v$);je("step",y$);je("reflect",Cye);je("distance",Mye);je("dot",Z6);je("cross",_$);je("pow",hw);je("pow2",x$);je("pow3",Pye);je("pow4",Nye);je("transformDirection",Iye);je("mix",Oye);je("clamp",gc);je("refract",b$);je("smoothstep",Uye);je("faceForward",Fye);je("difference",Rye);je("saturate",Lye);je("cbrt",Dye);je("transpose",Eye);je("rand",Bye);class zye extends Cn{static get type(){return"ConditionalNode"}constructor(e,t,i=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=i}getNodeType(e){const t=this.ifNode.getNodeType(e);if(this.elseNode!==null){const i=this.elseNode.getNodeType(e);if(e.getTypeLength(i)>e.getTypeLength(t))return i}return t}setup(e){const t=this.condNode.cache(),i=this.ifNode.cache(),r=this.elseNode?this.elseNode.cache():null,s=e.context.nodeBlock;e.getDataFromNode(i).parentNodeBlock=s,r!==null&&(e.getDataFromNode(r).parentNodeBlock=s);const o=e.getNodeProperties(this);o.condNode=t,o.ifNode=i.context({nodeBlock:i}),o.elseNode=r?r.context({nodeBlock:r}):null}generate(e,t){const i=this.getNodeType(e),r=e.getDataFromNode(this);if(r.nodeProperty!==void 0)return r.nodeProperty;const{condNode:s,ifNode:o,elseNode:a}=e.getNodeProperties(this),l=t!=="void",u=l?sA(i).build(e):"";r.nodeProperty=u;const c=s.build(e,"bool");e.addFlowCode(`
${e.tab}if ( ${c} ) {

`).addFlowTab();let h=o.build(e,i);if(h&&(l?h=u+" = "+h+";":h="return "+h+";"),e.removeFlowTab().addFlowCode(e.tab+"	"+h+`

`+e.tab+"}"),a!==null){e.addFlowCode(` else {

`).addFlowTab();let A=a.build(e,i);A&&(l?A=u+" = "+A+";":A="return "+A+";"),e.removeFlowTab().addFlowCode(e.tab+"	"+A+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(u,i,t)}}const Eo=Je(zye);je("select",Eo);const Vye=(...n)=>(console.warn("TSL.ConditionalNode: cond() has been renamed to select()."),Eo(...n));je("cond",Vye);class S$ extends Cn{static get type(){return"ContextNode"}constructor(e,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}analyze(e){this.node.build(e)}setup(e){const t=e.getContext();e.setContext({...e.context,...this.value});const i=this.node.build(e);return e.setContext(t),i}generate(e,t){const i=e.getContext();e.setContext({...e.context,...this.value});const r=this.node.build(e,t);return e.setContext(i),r}}const J6=Je(S$),Gye=(n,e)=>J6(n,{label:e});je("context",J6);je("label",Gye);class qye extends Cn{static get type(){return"VarNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}generate(e){const{node:t,name:i}=this,r=e.getVarFromNode(this,i,e.getVectorType(this.getNodeType(e))),s=e.getPropertyName(r),o=t.build(e,r.type);return e.addLineFlowCode(`${s} = ${o}`,this),s}}const w$=Je(qye);je("toVar",(...n)=>w$(...n).append());const Hye=n=>(console.warn('TSL: "temp" is deprecated. Use ".toVar()" instead.'),w$(n));je("temp",Hye);class $ye extends Cn{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0}isGlobal(){return!0}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let i=t.varying;if(i===void 0){const r=this.name,s=this.getNodeType(e);t.varying=i=e.getVaryingFromNode(this,r,s),t.node=this.node}return i.needsInterpolation||(i.needsInterpolation=e.shaderStage==="fragment"),i}setup(e){this.setupVarying(e)}analyze(e){return this.setupVarying(e),this.node.analyze(e)}generate(e){const t=e.getNodeProperties(this),i=this.setupVarying(e);if(t.propertyName===void 0){const r=this.getNodeType(e),s=e.getPropertyName(i,S7.VERTEX);e.flowNodeFromShaderStage(S7.VERTEX,this.node,r,s),t.propertyName=s}return e.getPropertyName(i)}}const Rc=Je($ye);je("varying",Rc);const jye=Tt(([n])=>{const e=n.mul(.9478672986).add(.0521327014).pow(2.4),t=n.mul(.0773993808),i=n.lessThanEqual(.04045);return Bi(e,t,i)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Wye=Tt(([n])=>{const e=n.pow(.41666).mul(1.055).sub(.055),t=n.mul(12.92),i=n.lessThanEqual(.0031308);return Bi(e,t,i)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),Ov="WorkingColorSpace",eN="OutputColorSpace";class fw extends Nr{static get type(){return"ColorSpaceNode"}constructor(e,t,i){super("vec4"),this.colorNode=e,this.source=t,this.target=i}resolveColorSpace(e,t){return t===Ov?wr.workingColorSpace:t===eN?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,i=this.resolveColorSpace(e,this.source),r=this.resolveColorSpace(e,this.target);let s=t;return wr.enabled===!1||i===r||!i||!r||(wr.getTransfer(i)===V1&&(s=wn(jye(s.rgb),s.a)),wr.getPrimaries(i)!==wr.getPrimaries(r)&&(s=wn(no(wr._getMatrix(new zo,i,r)).mul(s.rgb),s.a)),wr.getTransfer(r)===V1&&(s=wn(Wye(s.rgb),s.a))),s}}const Xye=n=>pt(new fw(pt(n),Ov,eN)),Yye=n=>pt(new fw(pt(n),eN,Ov)),Qye=(n,e)=>pt(new fw(pt(n),Ov,e)),E$=(n,e)=>pt(new fw(pt(n),e,Ov));je("toOutputColorSpace",Xye);je("toWorkingColorSpace",Yye);je("workingToColorSpace",Qye);je("colorSpaceToWorking",E$);let Kye=class extends Fv{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),i=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,i,r)}};class T$ extends Cn{static get type(){return"ReferenceBaseNode"}constructor(e,t,i=null,r=null){super(),this.property=e,this.uniformType=t,this.object=i,this.count=r,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.updateType=Nn.OBJECT}setGroup(e){return this.group=e,this}element(e){return pt(new Kye(this,pt(e)))}setNodeType(e){const t=En(null,e).getSelf();this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let i=e[t[0]];for(let r=1;r<t.length;r++)i=i[t[r]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const Zye=(n,e,t)=>pt(new T$(n,e,t));class Jye extends T${static get type(){return"RendererReferenceNode"}constructor(e,t,i=null){super(e,t,i),this.renderer=i,this.setGroup($n)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const e_e=(n,e,t)=>pt(new Jye(n,e,t));class t_e extends Nr{static get type(){return"ToneMappingNode"}constructor(e,t=i_e,i=null){super("vec3"),this.toneMapping=e,this.exposureNode=t,this.colorNode=i}getCacheKey(){return kb(super.getCacheKey(),this.toneMapping)}setup(e){const t=this.colorNode||e.context.color,i=this.toneMapping;if(i===YA)return t;let r=null;const s=e.renderer.library.getToneMappingFunction(i);return s!==null?r=wn(s(t.rgb,this.exposureNode),t.a):(console.error("ToneMappingNode: Unsupported Tone Mapping configuration.",i),r=t),r}}const n_e=(n,e,t)=>pt(new t_e(n,pt(e),pt(t))),i_e=e_e("toneMappingExposure","float");je("toneMapping",(n,e,t)=>n_e(e,t,n));class r_e extends q6{static get type(){return"BufferAttributeNode"}constructor(e,t=null,i=0,r=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=i,this.bufferOffset=r,this.usage=Db,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),i=this.value,r=e.getTypeLength(t),s=this.bufferStride||r,o=this.bufferOffset,a=i.isInterleavedBuffer===!0?i:new LH(i,s),l=new B6(a,r,o);a.setUsage(this.usage),this.attribute=l,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),i=e.getBufferAttributeFromNode(this,t),r=e.getPropertyName(i);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=r,s=r):s=Rc(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}const tN=(n,e,t,i)=>pt(new r_e(n,e,t,i)),s_e=(n,e,t,i)=>tN(n,e,t,i).setUsage(RA),D7=(n,e,t,i)=>tN(n,e,t,i).setInstanced(!0),k7=(n,e,t,i)=>s_e(n,e,t,i).setInstanced(!0);je("toAttribute",n=>tN(n.value));class o_e extends Cn{static get type(){return"ComputeNode"}constructor(e,t,i=[64]){super("void"),this.isComputeNode=!0,this.computeNode=e,this.count=t,this.workgroupSize=i,this.dispatchCount=0,this.version=1,this.updateBeforeType=Nn.OBJECT,this.onInitFunction=null,this.updateDispatchCount()}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}updateDispatchCount(){const{count:e,workgroupSize:t}=this;let i=t[0];for(let r=1;r<t.length;r++)i*=t[r];this.dispatchCount=Math.ceil(e/i)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}generate(e){const{shaderStage:t}=e;if(t==="compute"){const i=this.computeNode.build(e,"void");i!==""&&e.addLineFlowCode(i,this)}}}const a_e=(n,e,t)=>pt(new o_e(pt(n),e,t));je("compute",a_e);let l_e=class extends Cn{static get type(){return"CacheNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isCacheNode=!0}getNodeType(e){return this.node.getNodeType(e)}build(e,...t){const i=e.getCache(),r=e.getCacheFromNode(this,this.parent);e.setCache(r);const s=this.node.build(e,...t);return e.setCache(i),s}};const ex=(n,...e)=>pt(new l_e(pt(n),...e));je("cache",ex);class u_e extends Cn{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const c_e=Je(u_e);je("bypass",c_e);class C$ extends Cn{static get type(){return"RemapNode"}constructor(e,t,i,r=Qe(0),s=Qe(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=i,this.outLowNode=r,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:i,outLowNode:r,outHighNode:s,doClamp:o}=this;let a=e.sub(t).div(i.sub(t));return o===!0&&(a=a.clamp()),a.mul(s.sub(r)).add(r)}}const h_e=Je(C$,null,null,{doClamp:!1}),f_e=Je(C$);je("remap",h_e);je("remapClamp",f_e);class d_e extends Cn{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const i=this.getNodeType(e),r=this.snippet;if(i==="void")e.addLineFlowCode(r,this);else return e.format(`( ${r} )`,i,t)}}const W1=Je(d_e),p_e=n=>(n?Eo(n,W1("discard")):W1("discard")).append();je("discard",p_e);class A_e extends Nr{static get type(){return"RenderOutputNode"}constructor(e,t,i){super("vec4"),this.colorNode=e,this.toneMapping=t,this.outputColorSpace=i,this.isRenderOutput=!0}setup({context:e}){let t=this.colorNode||e.color;const i=(this.toneMapping!==null?this.toneMapping:e.toneMapping)||YA,r=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Bd;return i!==YA&&(t=t.toneMapping(i)),r!==Bd&&r!==wr.workingColorSpace&&(t=t.workingToColorSpace(r)),t}}const m_e=(n,e=null,t=null)=>pt(new A_e(pt(n),e,t));je("renderOutput",m_e);class g_e extends Cn{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const i=this.getAttributeName(e);if(e.hasGeometryAttribute(i)){const r=e.geometry.getAttribute(i);t=e.getTypeFromAttribute(r)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),i=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),o=e.getTypeFromAttribute(s),a=e.getAttribute(t,o);return e.shaderStage==="vertex"?e.format(a.name,o,i):Rc(this).build(e,i)}else return console.warn(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(i)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const vc=(n,e)=>pt(new g_e(n,e)),dw=n=>vc("uv"+(n>0?n:""),"vec2");class v_e extends Cn{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const i=this.textureNode.build(e,"property"),r=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${i}, ${r} )`,this.getNodeType(e),t)}}const jg=Je(v_e);class y_e extends Bv{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=Nn.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,i=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(i&&i.width!==void 0){const{width:r,height:s}=i;this.value=Math.log2(Math.max(r,s))}}}const __e=Je(y_e);class Uv extends Bv{static get type(){return"TextureNode"}constructor(e,t=null,i=null,r=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=i,this.biasNode=r,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=Nn.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===rs?"uvec4":this.value.type===Qs?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return dw(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=En(this.value.matrix)),this._matrixUniform.mul(Xe(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this.updateType=e?Nn.FRAME:Nn.NONE,this}setupUV(e,t){const i=this.value;return e.isFlipY()&&(i.isRenderTargetTexture===!0||i.isFramebufferTexture===!0||i.isDepthTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(dr(jg(this,this.levelNode).y).sub(t.y).sub(1))),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;let i=this.uvNode;(i===null||e.context.forceUVContext===!0)&&e.context.getUV&&(i=e.context.getUV(this)),i||(i=this.getDefaultUV()),this.updateMatrix===!0&&(i=this.getTransformedUV(i)),i=this.setupUV(e,i);let r=this.levelNode;r===null&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),t.uvNode=i,t.levelNode=r,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateSnippet(e,t,i,r,s,o,a,l){const u=this.value;let c;return r?c=e.generateTextureLevel(u,t,i,r,o):s?c=e.generateTextureBias(u,t,i,s,o):l?c=e.generateTextureGrad(u,t,i,l,o):a?c=e.generateTextureCompare(u,t,i,a,o):this.sampler===!1?c=e.generateTextureLoad(u,t,i,o):c=e.generateTexture(u,t,i,o),c}generate(e,t){const i=e.getNodeProperties(this),r=this.value;if(!r||r.isTexture!==!0)throw new Error("TextureNode: Need a three.js texture.");const s=super.generate(e,"property");if(t==="sampler")return s+"_sampler";if(e.isReference(t))return s;{const o=e.getDataFromNode(this);let a=o.propertyName;if(a===void 0){const{uvNode:c,levelNode:h,biasNode:A,compareNode:v,depthNode:_,gradNode:S}=i,w=this.generateUV(e,c),x=h?h.build(e,"float"):null,M=A?A.build(e,"float"):null,R=_?_.build(e,"int"):null,N=v?v.build(e,"float"):null,B=S?[S[0].build(e,"vec2"),S[1].build(e,"vec2")]:null,T=e.getVarFromNode(this);a=e.getPropertyName(T);const D=this.generateSnippet(e,s,w,x,M,R,N,B);e.addLineFlowCode(`${a} = ${D}`,this),o.snippet=D,o.propertyName=a}let l=a;const u=this.getNodeType(e);return e.needsToWorkingColorSpace(r)&&(l=E$(W1(l,u),r.colorSpace).setup(e).build(e,u)),e.format(l,u,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){const t=this.clone();return t.uvNode=pt(e),t.referenceNode=this.getSelf(),pt(t)}blur(e){const t=this.clone();return t.biasNode=pt(e).mul(__e(t)),t.referenceNode=this.getSelf(),pt(t)}level(e){const t=this.clone();return t.levelNode=pt(e),t.referenceNode=this.getSelf(),pt(t)}size(e){return jg(this,e)}bias(e){const t=this.clone();return t.biasNode=pt(e),t.referenceNode=this.getSelf(),pt(t)}compare(e){const t=this.clone();return t.compareNode=pt(e),t.referenceNode=this.getSelf(),pt(t)}grad(e,t){const i=this.clone();return i.gradNode=[pt(e),pt(t)],i.referenceNode=this.getSelf(),pt(i)}depth(e){const t=this.clone();return t.depthNode=pt(e),t.referenceNode=this.getSelf(),pt(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix()}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e}}const pr=Je(Uv),nl=(...n)=>pr(...n).setSampler(!1),td=En("float").label("cameraNear").setGroup($n).onRenderUpdate(({camera:n})=>n.near),nd=En("float").label("cameraFar").setGroup($n).onRenderUpdate(({camera:n})=>n.far),Gb=En("mat4").label("cameraProjectionMatrix").setGroup($n).onRenderUpdate(({camera:n})=>n.projectionMatrix),Pc=En("mat4").label("cameraViewMatrix").setGroup($n).onRenderUpdate(({camera:n})=>n.matrixWorldInverse),x_e=En(new Pe).label("cameraPosition").setGroup($n).onRenderUpdate(({camera:n},e)=>e.value.setFromMatrixPosition(n.matrixWorld));class oi extends Cn{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=Nn.OBJECT,this._uniformNode=new Bv(null)}getNodeType(){const e=this.scope;if(e===oi.WORLD_MATRIX)return"mat4";if(e===oi.POSITION||e===oi.VIEW_POSITION||e===oi.DIRECTION||e===oi.SCALE)return"vec3"}update(e){const t=this.object3d,i=this._uniformNode,r=this.scope;if(r===oi.WORLD_MATRIX)i.value=t.matrixWorld;else if(r===oi.POSITION)i.value=i.value||new Pe,i.value.setFromMatrixPosition(t.matrixWorld);else if(r===oi.SCALE)i.value=i.value||new Pe,i.value.setFromMatrixScale(t.matrixWorld);else if(r===oi.DIRECTION)i.value=i.value||new Pe,t.getWorldDirection(i.value);else if(r===oi.VIEW_POSITION){const s=e.camera;i.value=i.value||new Pe,i.value.setFromMatrixPosition(t.matrixWorld),i.value.applyMatrix4(s.matrixWorldInverse)}}generate(e){const t=this.scope;return t===oi.WORLD_MATRIX?this._uniformNode.nodeType="mat4":(t===oi.POSITION||t===oi.VIEW_POSITION||t===oi.DIRECTION||t===oi.SCALE)&&(this._uniformNode.nodeType="vec3"),this._uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}oi.WORLD_MATRIX="worldMatrix";oi.POSITION="position";oi.SCALE="scale";oi.VIEW_POSITION="viewPosition";oi.DIRECTION="direction";oi.DIRECTION;oi.WORLD_MATRIX;oi.POSITION;oi.SCALE;oi.VIEW_POSITION;class ru extends oi{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}ru.DIRECTION;const Vd=gt(ru,ru.WORLD_MATRIX);ru.POSITION;ru.SCALE;ru.VIEW_POSITION;const b_e=En(new zo).onObjectUpdate(({object:n},e)=>e.value.getNormalMatrix(n.matrixWorld)),pw=Pc.mul(Vd).toVar("modelViewMatrix"),M$=vc("position","vec3"),us=M$.varying("positionLocal"),L7=M$.varying("positionPrevious"),zR=Vd.mul(us).xyz.varying("v_positionWorld"),R$=us.transformDirection(Vd).varying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),os=pw.mul(us).xyz.varying("v_positionView"),er=os.negate().varying("v_positionViewDirection").normalize().toVar("positionViewDirection");class S_e extends Cn{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){const{renderer:t,material:i}=e;return t.coordinateSystem===ml&&i.side===Cl?"false":e.getFrontFacing()}}const w_e=gt(S_e),Aw=Qe(w_e).mul(2).sub(1),P$=vc("normal","vec3"),su=Tt(n=>n.geometry.hasAttribute("normal")===!1?(console.warn('TSL.NormalNode: Vertex attribute "normal" not found on geometry.'),Xe(0,1,0)):P$,"vec3").once()().toVar("normalLocal"),E_e=os.dFdx().cross(os.dFdy()).normalize().toVar("normalFlat"),Rl=Tt(n=>{let e;return n.material.flatShading===!0?e=E_e:e=Rc(I$(su),"v_normalView").normalize(),e},"vec3").once()().toVar("normalView"),N$=Rc(Rl.transformDirection(Pc),"v_normalWorld").normalize().toVar("normalWorld"),Tr=Tt(n=>n.context.setupNormal(),"vec3").once()().mul(Aw).toVar("transformedNormalView"),nN=Tr.transformDirection(Pc).toVar("transformedNormalWorld"),_g=Tt(n=>n.context.setupClearcoatNormal(),"vec3").once()().mul(Aw).toVar("transformedClearcoatNormalView"),T_e=Tt(([n,e=Vd])=>{const t=no(e),i=n.div(Xe(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(i).xyz}),I$=Tt(([n],e)=>{const t=e.renderer.nodes.modelNormalViewMatrix;if(t!==null)return t.transformDirection(n);const i=b_e.mul(n);return Pc.transformDirection(i)}),C_e=En(0).onReference(({material:n})=>n).onRenderUpdate(({material:n})=>n.refractionRatio),M_e=er.negate().reflect(Tr),R_e=er.negate().refract(Tr,C_e),P_e=M_e.transformDirection(Pc).toVar("reflectVector"),N_e=R_e.transformDirection(Pc).toVar("reflectVector");class I_e extends Uv{static get type(){return"CubeTextureNode"}constructor(e,t=null,i=null,r=null){super(e,t,i,r),this.isCubeTextureNode=!0}getInputType(){return"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===Fd?P_e:e.mapping===I0?N_e:(console.error('THREE.CubeTextureNode: Mapping "%s" not supported.',e.mapping),Xe(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const i=this.value;return e.renderer.coordinateSystem===Od||!i.isRenderTargetTexture?Xe(t.x.negate(),t.yz):t}generateUV(e,t){return t.build(e,"vec3")}}const X1=Je(I_e);class D$ extends Bv{static get type(){return"BufferNode"}constructor(e,t,i=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=i}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const iN=(n,e,t)=>pt(new D$(n,e,t));class D_e extends Fv{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),i=this.getNodeType();return e.format(t,"vec4",i)}}class k_e extends D${static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null,"vec4"),this.array=e,this.elementType=t,this._elementType=null,this._elementLength=0,this.updateType=Nn.RENDER,this.isArrayBufferNode=!0}getElementType(){return this.elementType||this._elementType}getElementLength(){return this._elementLength}update(){const{array:e,value:t}=this,i=this.getElementLength(),r=this.getElementType();if(i===1)for(let s=0;s<e.length;s++){const o=s*4;t[o]=e[s]}else if(r==="color")for(let s=0;s<e.length;s++){const o=s*4,a=e[s];t[o]=a.r,t[o+1]=a.g,t[o+2]=a.b||0}else for(let s=0;s<e.length;s++){const o=s*4,a=e[s];t[o]=a.x,t[o+1]=a.y,t[o+2]=a.z||0,t[o+3]=a.w||0}}setup(e){const t=this.array.length;this._elementType=this.elementType===null?Fb(this.array[0]):this.elementType,this._elementLength=e.getTypeLength(this._elementType);let i=Float32Array;return this._elementType.charAt(0)==="i"?i=Int32Array:this._elementType.charAt(0)==="u"&&(i=Uint32Array),this.value=new i(t*4),this.bufferCount=t,this.bufferType=e.changeComponentType("vec4",e.getComponentType(this._elementType)),super.setup(e)}element(e){return pt(new D_e(this,pt(e)))}}const Y1=(n,e)=>pt(new k_e(n,e));class L_e extends Fv{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),i=this.referenceNode.getNodeType(),r=this.getNodeType();return e.format(t,i,r)}}class rN extends Cn{static get type(){return"ReferenceNode"}constructor(e,t,i=null,r=null){super(),this.property=e,this.uniformType=t,this.object=i,this.count=r,this.properties=e.split("."),this.reference=i,this.node=null,this.group=null,this.name=null,this.updateType=Nn.OBJECT}element(e){return pt(new L_e(this,pt(e)))}setGroup(e){return this.group=e,this}label(e){return this.name=e,this}setNodeType(e){let t=null;this.count!==null?t=iN(null,e,this.count):Array.isArray(this.getValueFromReference())?t=Y1(null,e):e==="texture"?t=pr(null):e==="cubeTexture"?t=X1(null):t=En(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.label(this.name),this.node=t.getSelf()}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let i=e[t[0]];for(let r=1;r<t.length;r++)i=i[t[r]];return i}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const tr=(n,e,t)=>pt(new rN(n,e,t)),F7=(n,e,t,i)=>pt(new rN(n,e,i,t));class F_e extends rN{static get type(){return"MaterialReferenceNode"}constructor(e,t,i=null){super(e,t,i),this.material=i,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const vh=(n,e,t)=>pt(new F_e(n,e,t)),k$=Tt(n=>(n.geometry.hasAttribute("tangent")===!1&&n.geometry.computeTangents(),vc("tangent","vec4")))(),sN=k$.xyz.toVar("tangentLocal"),L$=pw.mul(wn(sN,0)).xyz.varying("v_tangentView").normalize().toVar("tangentView"),B_e=n=>n.mul(k$.w).xyz,O_e=Rc(B_e(Rl.cross(L$)),"v_bitangentView").normalize().toVar("bitangentView"),xg=no(L$,O_e,Rl),U_e=(()=>{let n=e0.cross(er);return n=n.cross(e0).normalize(),n=Bi(n,Tr,Wf.mul(Ou.oneMinus()).oneMinus().pow2().pow2()).normalize(),n})(),z_e=Tt(n=>{const{eye_pos:e,surf_norm:t,mapN:i,uv:r}=n,s=e.dFdx(),o=e.dFdy(),a=r.dFdx(),l=r.dFdy(),u=t,c=o.cross(u),h=u.cross(s),A=c.mul(a.x).add(h.mul(l.x)),v=c.mul(a.y).add(h.mul(l.y)),_=A.dot(A).max(v.dot(v)),S=Aw.mul(_.inverseSqrt());return io(A.mul(i.x,S),v.mul(i.y,S),u.mul(i.z)).normalize()});class V_e extends Nr{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=ef}setup(e){const{normalMapType:t,scaleNode:i}=this;let r=this.node.mul(2).sub(1);i!==null&&(r=Xe(r.xy.mul(i),r.z));let s=null;return t===Lge?s=I$(r):t===ef&&(e.hasGeometryAttribute("tangent")===!0?s=xg.mul(r).normalize():s=z_e({eye_pos:os,surf_norm:Rl,mapN:r,uv:dw()})),s}}const B7=Je(V_e),G_e=Tt(({textureNode:n,bumpScale:e})=>{const t=r=>n.cache().context({getUV:s=>r(s.uvNode||dw()),forceUVContext:!0}),i=Qe(t(r=>r));return Pt(Qe(t(r=>r.add(r.dFdx()))).sub(i),Qe(t(r=>r.add(r.dFdy()))).sub(i)).mul(e)}),q_e=Tt(n=>{const{surf_pos:e,surf_norm:t,dHdxy:i}=n,r=e.dFdx().normalize(),s=e.dFdy().normalize(),o=t,a=s.cross(o),l=o.cross(r),u=r.dot(a).mul(Aw),c=u.sign().mul(i.x.mul(a).add(i.y.mul(l)));return u.abs().mul(t).sub(c).normalize()});class H_e extends Nr{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=G_e({textureNode:this.textureNode,bumpScale:e});return q_e({surf_pos:os,surf_norm:Rl,dHdxy:t})}}const $_e=Je(H_e),O7=new Map;class Ge extends Cn{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let i=O7.get(e);return i===void 0&&(i=vh(e,t),O7.set(e,i)),i}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,i=this.scope;let r=null;if(i===Ge.COLOR){const s=t.color!==void 0?this.getColor(i):Xe();t.map&&t.map.isTexture===!0?r=s.mul(this.getTexture("map")):r=s}else if(i===Ge.OPACITY){const s=this.getFloat(i);t.alphaMap&&t.alphaMap.isTexture===!0?r=s.mul(this.getTexture("alpha")):r=s}else if(i===Ge.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?r=this.getTexture("specular").r:r=Qe(1);else if(i===Ge.SPECULAR_INTENSITY){const s=this.getFloat(i);t.specularMap?r=s.mul(this.getTexture(i).a):r=s}else if(i===Ge.SPECULAR_COLOR){const s=this.getColor(i);t.specularColorMap&&t.specularColorMap.isTexture===!0?r=s.mul(this.getTexture(i).rgb):r=s}else if(i===Ge.ROUGHNESS){const s=this.getFloat(i);t.roughnessMap&&t.roughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).g):r=s}else if(i===Ge.METALNESS){const s=this.getFloat(i);t.metalnessMap&&t.metalnessMap.isTexture===!0?r=s.mul(this.getTexture(i).b):r=s}else if(i===Ge.EMISSIVE){const s=this.getFloat("emissiveIntensity"),o=this.getColor(i).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?r=o.mul(this.getTexture(i)):r=o}else if(i===Ge.NORMAL)t.normalMap?(r=B7(this.getTexture("normal"),this.getCache("normalScale","vec2")),r.normalMapType=t.normalMapType):t.bumpMap?r=$_e(this.getTexture("bump").r,this.getFloat("bumpScale")):r=Rl;else if(i===Ge.CLEARCOAT){const s=this.getFloat(i);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?r=s.mul(this.getTexture(i).r):r=s}else if(i===Ge.CLEARCOAT_ROUGHNESS){const s=this.getFloat(i);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).r):r=s}else if(i===Ge.CLEARCOAT_NORMAL)t.clearcoatNormalMap?r=B7(this.getTexture(i),this.getCache(i+"Scale","vec2")):r=Rl;else if(i===Ge.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?r=s.mul(this.getTexture("sheenColor").rgb):r=s}else if(i===Ge.SHEEN_ROUGHNESS){const s=this.getFloat(i);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?r=s.mul(this.getTexture(i).a):r=s,r=r.clamp(.07,1)}else if(i===Ge.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(i);r=W6(Ym.x,Ym.y,Ym.y.negate(),Ym.x).mul(s.rg.mul(2).sub(Pt(1)).normalize().mul(s.b))}else r=Ym;else if(i===Ge.IRIDESCENCE_THICKNESS){const s=tr("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const o=tr("0","float",t.iridescenceThicknessRange);r=s.sub(o).mul(this.getTexture(i).g).add(o)}else r=s}else if(i===Ge.TRANSMISSION){const s=this.getFloat(i);t.transmissionMap?r=s.mul(this.getTexture(i).r):r=s}else if(i===Ge.THICKNESS){const s=this.getFloat(i);t.thicknessMap?r=s.mul(this.getTexture(i).g):r=s}else if(i===Ge.IOR)r=this.getFloat(i);else if(i===Ge.LIGHT_MAP)r=this.getTexture(i).rgb.mul(this.getFloat("lightMapIntensity"));else if(i===Ge.AO_MAP)r=this.getTexture(i).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else{const s=this.getNodeType(e);r=this.getCache(i,s)}return r}}Ge.ALPHA_TEST="alphaTest";Ge.COLOR="color";Ge.OPACITY="opacity";Ge.SHININESS="shininess";Ge.SPECULAR="specular";Ge.SPECULAR_STRENGTH="specularStrength";Ge.SPECULAR_INTENSITY="specularIntensity";Ge.SPECULAR_COLOR="specularColor";Ge.REFLECTIVITY="reflectivity";Ge.ROUGHNESS="roughness";Ge.METALNESS="metalness";Ge.NORMAL="normal";Ge.CLEARCOAT="clearcoat";Ge.CLEARCOAT_ROUGHNESS="clearcoatRoughness";Ge.CLEARCOAT_NORMAL="clearcoatNormal";Ge.EMISSIVE="emissive";Ge.ROTATION="rotation";Ge.SHEEN="sheen";Ge.SHEEN_ROUGHNESS="sheenRoughness";Ge.ANISOTROPY="anisotropy";Ge.IRIDESCENCE="iridescence";Ge.IRIDESCENCE_IOR="iridescenceIOR";Ge.IRIDESCENCE_THICKNESS="iridescenceThickness";Ge.IOR="ior";Ge.TRANSMISSION="transmission";Ge.THICKNESS="thickness";Ge.ATTENUATION_DISTANCE="attenuationDistance";Ge.ATTENUATION_COLOR="attenuationColor";Ge.LINE_SCALE="scale";Ge.LINE_DASH_SIZE="dashSize";Ge.LINE_GAP_SIZE="gapSize";Ge.LINE_WIDTH="linewidth";Ge.LINE_DASH_OFFSET="dashOffset";Ge.POINT_WIDTH="pointWidth";Ge.DISPERSION="dispersion";Ge.LIGHT_MAP="light";Ge.AO_MAP="ao";const j_e=gt(Ge,Ge.ALPHA_TEST),W_e=gt(Ge,Ge.COLOR),X_e=gt(Ge,Ge.SHININESS),Y_e=gt(Ge,Ge.EMISSIVE),F$=gt(Ge,Ge.OPACITY),Q_e=gt(Ge,Ge.SPECULAR),U7=gt(Ge,Ge.SPECULAR_INTENSITY),K_e=gt(Ge,Ge.SPECULAR_COLOR),tx=gt(Ge,Ge.SPECULAR_STRENGTH),hT=gt(Ge,Ge.REFLECTIVITY),Z_e=gt(Ge,Ge.ROUGHNESS),J_e=gt(Ge,Ge.METALNESS),e2e=gt(Ge,Ge.NORMAL).context({getUV:null}),t2e=gt(Ge,Ge.CLEARCOAT),n2e=gt(Ge,Ge.CLEARCOAT_ROUGHNESS),i2e=gt(Ge,Ge.CLEARCOAT_NORMAL).context({getUV:null}),r2e=gt(Ge,Ge.ROTATION),s2e=gt(Ge,Ge.SHEEN),o2e=gt(Ge,Ge.SHEEN_ROUGHNESS),a2e=gt(Ge,Ge.ANISOTROPY),l2e=gt(Ge,Ge.IRIDESCENCE),u2e=gt(Ge,Ge.IRIDESCENCE_IOR),c2e=gt(Ge,Ge.IRIDESCENCE_THICKNESS),h2e=gt(Ge,Ge.TRANSMISSION),f2e=gt(Ge,Ge.THICKNESS),d2e=gt(Ge,Ge.IOR),p2e=gt(Ge,Ge.ATTENUATION_DISTANCE),A2e=gt(Ge,Ge.ATTENUATION_COLOR),m2e=gt(Ge,Ge.LINE_SCALE),g2e=gt(Ge,Ge.LINE_DASH_SIZE),v2e=gt(Ge,Ge.LINE_GAP_SIZE);Ge.LINE_WIDTH;Ge.LINE_DASH_OFFSET;Ge.POINT_WIDTH;const y2e=gt(Ge,Ge.DISPERSION),B$=gt(Ge,Ge.LIGHT_MAP),_2e=gt(Ge,Ge.AO_MAP),Ym=En(new Jn).onReference(function(n){return n.material}).onRenderUpdate(function({material:n}){this.value.set(n.anisotropy*Math.cos(n.anisotropyRotation),n.anisotropy*Math.sin(n.anisotropyRotation))});class x2e extends Nr{static get type(){return"ModelViewProjectionNode"}constructor(e=null){super("vec4"),this.positionNode=e}setup(e){if(e.shaderStage==="fragment")return Rc(e.context.mvp);const t=this.positionNode||us,i=e.renderer.nodes.modelViewMatrix||pw;return Gb.mul(i).mul(t)}}const VR=Je(x2e);class Oi extends Cn{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isInstanceIndexNode=!0}generate(e){const t=this.getNodeType(e),i=this.scope;let r;if(i===Oi.VERTEX)r=e.getVertexIndex();else if(i===Oi.INSTANCE)r=e.getInstanceIndex();else if(i===Oi.DRAW)r=e.getDrawIndex();else if(i===Oi.INVOCATION_LOCAL)r=e.getInvocationLocalIndex();else if(i===Oi.INVOCATION_SUBGROUP)r=e.getInvocationSubgroupIndex();else if(i===Oi.SUBGROUP)r=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+i);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=r:s=Rc(this).build(e,t),s}}Oi.VERTEX="vertex";Oi.INSTANCE="instance";Oi.SUBGROUP="subgroup";Oi.INVOCATION_LOCAL="invocationLocal";Oi.INVOCATION_SUBGROUP="invocationSubgroup";Oi.DRAW="draw";const b2e=gt(Oi,Oi.VERTEX),oN=gt(Oi,Oi.INSTANCE);Oi.SUBGROUP;Oi.INVOCATION_SUBGROUP;Oi.INVOCATION_LOCAL;const S2e=gt(Oi,Oi.DRAW);class w2e extends Cn{static get type(){return"InstanceNode"}constructor(e){super("void"),this.instanceMesh=e,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=Nn.FRAME,this.buffer=null,this.bufferColor=null}setup(e){let t=this.instanceMatrixNode,i=this.instanceColorNode;const r=this.instanceMesh;if(t===null){const a=r.instanceMatrix;if(r.count<=1e3)t=iN(a.array,"mat4",Math.max(r.count,1)).element(oN);else{const l=new eve(a.array,16,1);this.buffer=l;const u=a.usage===RA?k7:D7,c=[u(l,"vec4",16,0),u(l,"vec4",16,4),u(l,"vec4",16,8),u(l,"vec4",16,12)];t=JA(...c)}this.instanceMatrixNode=t}const s=r.instanceColor;if(s&&i===null){const a=new z1e(s.array,3),l=s.usage===RA?k7:D7;this.bufferColor=a,i=Xe(l(a,"vec3",3,0)),this.instanceColorNode=i}const o=t.mul(us).xyz;if(us.assign(o),e.hasGeometryAttribute("normal")){const a=T_e(su,t);su.assign(a)}this.instanceColorNode!==null&&Ob("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.instanceMesh.instanceMatrix.usage!==RA&&this.buffer!=null&&this.instanceMesh.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMesh.instanceMatrix.version),this.instanceMesh.instanceColor&&this.instanceMesh.instanceColor.usage!==RA&&this.bufferColor!=null&&this.instanceMesh.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceMesh.instanceColor.version)}}const E2e=Je(w2e);class T2e extends Cn{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=oN:this.batchingIdNode=S2e);const i=Tt(([_])=>{const S=jg(nl(this.batchMesh._indirectTexture),0),w=dr(_).modInt(dr(S)),x=dr(_).div(dr(S));return nl(this.batchMesh._indirectTexture,Fu(w,x)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(dr(this.batchingIdNode)),r=this.batchMesh._matricesTexture,s=jg(nl(r),0),o=Qe(i).mul(4).toInt().toVar(),a=o.modInt(s),l=o.div(dr(s)),u=JA(nl(r,Fu(a,l)),nl(r,Fu(a.add(1),l)),nl(r,Fu(a.add(2),l)),nl(r,Fu(a.add(3),l))),c=this.batchMesh._colorsTexture;if(c!==null){const S=Tt(([w])=>{const x=jg(nl(c),0).x,M=w,R=M.modInt(x),N=M.div(x);return nl(c,Fu(R,N)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(i);Ob("vec3","vBatchColor").assign(S)}const h=no(u);us.assign(u.mul(us));const A=su.div(Xe(h[0].dot(h[0]),h[1].dot(h[1]),h[2].dot(h[2]))),v=h.mul(A).xyz;su.assign(v),e.hasGeometryAttribute("tangent")&&sN.mulAssign(h)}}const C2e=Je(T2e),z7=new WeakMap;class M2e extends Cn{static get type(){return"SkinningNode"}constructor(e,t=!1){super("void"),this.skinnedMesh=e,this.useReference=t,this.updateType=Nn.OBJECT,this.skinIndexNode=vc("skinIndex","uvec4"),this.skinWeightNode=vc("skinWeight","vec4");let i,r,s;t?(i=tr("bindMatrix","mat4"),r=tr("bindMatrixInverse","mat4"),s=F7("skeleton.boneMatrices","mat4",e.skeleton.bones.length)):(i=En(e.bindMatrix,"mat4"),r=En(e.bindMatrixInverse,"mat4"),s=iN(e.skeleton.boneMatrices,"mat4",e.skeleton.bones.length)),this.bindMatrixNode=i,this.bindMatrixInverseNode=r,this.boneMatricesNode=s,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=us){const{skinIndexNode:i,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(i.x),l=e.element(i.y),u=e.element(i.z),c=e.element(i.w),h=s.mul(t),A=io(a.mul(r.x).mul(h),l.mul(r.y).mul(h),u.mul(r.z).mul(h),c.mul(r.w).mul(h));return o.mul(A).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=su){const{skinIndexNode:i,skinWeightNode:r,bindMatrixNode:s,bindMatrixInverseNode:o}=this,a=e.element(i.x),l=e.element(i.y),u=e.element(i.z),c=e.element(i.w);let h=io(r.x.mul(a),r.y.mul(l),r.z.mul(u),r.w.mul(c));return h=o.mul(h).mul(s),h.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=F7("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,L7)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")}setup(e){this.needsPreviousBoneMatrices(e)&&L7.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(us.assign(t),e.hasGeometryAttribute("normal")){const i=this.getSkinnedNormal();su.assign(i),e.hasGeometryAttribute("tangent")&&sN.assign(i)}}generate(e,t){if(t!=="void")return us.build(e,t)}update(e){const i=(this.useReference?e.object:this.skinnedMesh).skeleton;z7.get(i)!==e.frameId&&(z7.set(i,e.frameId),this.previousBoneMatricesNode!==null&&i.previousBoneMatrices.set(i.boneMatrices),i.update())}}const R2e=n=>pt(new M2e(n,!0));class P2e extends Cn{static get type(){return"LoopNode"}constructor(e=[]){super(),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const i={};for(let s=0,o=this.params.length-1;s<o;s++){const a=this.params[s],l=a.isNode!==!0&&a.name||this.getVarName(s),u=a.isNode!==!0&&a.type||"int";i[l]=W1(l,u)}const r=e.addStack();return t.returnsNode=this.params[this.params.length-1](i,r,e),t.stackNode=r,e.removeStack(),t}getNodeType(e){const{returnsNode:t}=this.getProperties(e);return t?t.getNodeType(e):"void"}setup(e){this.getProperties(e)}generate(e){const t=this.getProperties(e),i=this.params,r=t.stackNode;for(let a=0,l=i.length-1;a<l;a++){const u=i[a];let c=null,h=null,A=null,v=null,_=null,S=null;u.isNode?(v="int",A=this.getVarName(a),c="0",h=u.build(e,v),_="<"):(v=u.type||"int",A=u.name||this.getVarName(a),c=u.start,h=u.end,_=u.condition,S=u.update,typeof c=="number"?c=e.generateConst(v,c):c&&c.isNode&&(c=c.build(e,v)),typeof h=="number"?h=e.generateConst(v,h):h&&h.isNode&&(h=h.build(e,v)),c!==void 0&&h===void 0?(c=c+" - 1",h="0",_=">="):h!==void 0&&c===void 0&&(c="0",_="<"),_===void 0&&(Number(c)>Number(h)?_=">=":_="<"));const w={start:c,end:h,condition:_},x=w.start,M=w.end;let R="",N="",B="";S||(v==="int"||v==="uint"?_.includes("<")?S="++":S="--":_.includes("<")?S="+= 1.":S="-= 1."),R+=e.getVar(v,A)+" = "+x,N+=A+" "+_+" "+M,B+=A+" "+S;const T=`for ( ${R}; ${N}; ${B} )`;e.addFlowCode((a===0?`
`:"")+e.tab+T+` {

`).addFlowTab()}const s=r.build(e,"void"),o=t.returnsNode?t.returnsNode.build(e):"";e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,l=this.params.length-1;a<l;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();return e.addFlowTab(),o}}const jl=(...n)=>pt(new P2e(ZA(n,"int"))).append(),N2e=()=>W1("break").append(),fT=new WeakMap,Wo=new pi,V7=Tt(({bufferMap:n,influence:e,stride:t,width:i,depth:r,offset:s})=>{const o=dr(b2e).mul(t).add(s),a=o.div(i),l=o.sub(a.mul(i));return nl(n,Fu(l,a)).depth(r).mul(e)});function I2e(n){const e=n.morphAttributes.position!==void 0,t=n.morphAttributes.normal!==void 0,i=n.morphAttributes.color!==void 0,r=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,s=r!==void 0?r.length:0;let o=fT.get(n);if(o===void 0||o.count!==s){let x=function(){S.dispose(),fT.delete(n),n.removeEventListener("dispose",x)};o!==void 0&&o.texture.dispose();const a=n.morphAttributes.position||[],l=n.morphAttributes.normal||[],u=n.morphAttributes.color||[];let c=0;e===!0&&(c=1),t===!0&&(c=2),i===!0&&(c=3);let h=n.attributes.position.count*c,A=1;const v=4096;h>v&&(A=Math.ceil(h/v),h=v);const _=new Float32Array(h*A*4*s),S=new _1e(_,h,A,s);S.type=na,S.needsUpdate=!0;const w=c*4;for(let M=0;M<s;M++){const R=a[M],N=l[M],B=u[M],T=h*A*4*M;for(let D=0;D<R.count;D++){const F=D*w;e===!0&&(Wo.fromBufferAttribute(R,D),_[T+F+0]=Wo.x,_[T+F+1]=Wo.y,_[T+F+2]=Wo.z,_[T+F+3]=0),t===!0&&(Wo.fromBufferAttribute(N,D),_[T+F+4]=Wo.x,_[T+F+5]=Wo.y,_[T+F+6]=Wo.z,_[T+F+7]=0),i===!0&&(Wo.fromBufferAttribute(B,D),_[T+F+8]=Wo.x,_[T+F+9]=Wo.y,_[T+F+10]=Wo.z,_[T+F+11]=B.itemSize===4?Wo.w:1)}}o={count:s,texture:S,stride:c,size:new Jn(h,A)},fT.set(n,o),n.addEventListener("dispose",x)}return o}class D2e extends Cn{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=En(1),this.updateType=Nn.OBJECT}setup(e){const{geometry:t}=e,i=t.morphAttributes.position!==void 0,r=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,o=s!==void 0?s.length:0,{texture:a,stride:l,size:u}=I2e(t);i===!0&&us.mulAssign(this.morphBaseInfluence),r===!0&&su.mulAssign(this.morphBaseInfluence);const c=dr(u.width);jl(o,({i:h})=>{const A=Qe(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?A.assign(nl(this.mesh.morphTexture,Fu(dr(h).add(1),dr(oN))).r):A.assign(tr("morphTargetInfluences","float").element(h).toVar()),i===!0&&us.addAssign(V7({bufferMap:a,influence:A,stride:l,width:c,depth:h,offset:dr(0)})),r===!0&&su.addAssign(V7({bufferMap:a,influence:A,stride:l,width:c,depth:h,offset:dr(1)}))})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,i)=>t+i,0)}}const k2e=Je(D2e);class nm extends Cn{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}generate(){console.warn("Abstract function.")}}class L2e extends nm{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class F2e extends S${static get type(){return"LightingContextNode"}constructor(e,t=null,i=null,r=null){super(e),this.lightingModel=t,this.backdropNode=i,this.backdropAlphaNode=r,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,i=Xe().toVar("directDiffuse"),r=Xe().toVar("directSpecular"),s=Xe().toVar("indirectDiffuse"),o=Xe().toVar("indirectSpecular"),a={directDiffuse:i,directSpecular:r,indirectDiffuse:s,indirectSpecular:o};return{radiance:Xe().toVar("radiance"),irradiance:Xe().toVar("irradiance"),iblIrradiance:Xe().toVar("iblIrradiance"),ambientOcclusion:Qe(1).toVar("ambientOcclusion"),reflectedLight:a,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const B2e=Je(F2e);class O2e extends nm{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}let Qm,Km;class Er extends Cn{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this.isViewportNode=!0}getNodeType(){return this.scope===Er.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=Nn.NONE;return(this.scope===Er.SIZE||this.scope===Er.VIEWPORT)&&(e=Nn.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===Er.VIEWPORT?t!==null?Km.copy(t.viewport):(e.getViewport(Km),Km.multiplyScalar(e.getPixelRatio())):t!==null?(Qm.width=t.width,Qm.height=t.height):e.getDrawingBufferSize(Qm)}setup(){const e=this.scope;let t=null;return e===Er.SIZE?t=En(Qm||(Qm=new Jn)):e===Er.VIEWPORT?t=En(Km||(Km=new pi)):t=Pt(mw.div(GR)),t}generate(e){if(this.scope===Er.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const i=e.getNodeProperties(GR).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${i}.y - ${t}.y )`}return t}return super.generate(e)}}Er.COORDINATE="coordinate";Er.VIEWPORT="viewport";Er.SIZE="size";Er.UV="uv";const Q1=gt(Er,Er.UV),GR=gt(Er,Er.SIZE),mw=gt(Er,Er.COORDINATE),O$=gt(Er,Er.VIEWPORT);O$.zw;O$.xy;const Zm=new Jn;class U$ extends Uv{static get type(){return"ViewportTextureNode"}constructor(e=Q1,t=null,i=null){i===null&&(i=new q1e,i.minFilter=Ju),super(i,e,t),this.generateMipmaps=!1,this.isOutputTextureNode=!0,this.updateBeforeType=Nn.FRAME}updateBefore(e){const t=e.renderer;t.getDrawingBufferSize(Zm);const i=this.value;(i.image.width!==Zm.width||i.image.height!==Zm.height)&&(i.image.width=Zm.width,i.image.height=Zm.height,i.needsUpdate=!0);const r=i.generateMipmaps;i.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(i),i.generateMipmaps=r}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const z$=Je(U$,null,null,{generateMipmaps:!0});let dT=null;class U2e extends U${static get type(){return"ViewportDepthTextureNode"}constructor(e=Q1,t=null){dT===null&&(dT=new em),super(e,t,dT)}}const z2e=Je(U2e);class To extends Cn{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===To.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,i=this.valueNode;let r=null;if(t===To.DEPTH_BASE)i!==null&&(r=q$().assign(i));else if(t===To.DEPTH)e.isPerspectiveCamera?r=V2e(os.z,td,nd):r=Wg(os.z,td,nd);else if(t===To.LINEAR_DEPTH)if(i!==null)if(e.isPerspectiveCamera){const s=V$(i,td,nd);r=Wg(s,td,nd)}else r=i;else r=Wg(os.z,td,nd);return r}}To.DEPTH_BASE="depthBase";To.DEPTH="depth";To.LINEAR_DEPTH="linearDepth";const Wg=(n,e,t)=>n.add(e).div(e.sub(t)),V2e=(n,e,t)=>e.add(n).mul(t).div(t.sub(e).mul(n)),V$=(n,e,t)=>e.mul(t).div(t.sub(e).mul(n).sub(t)),G$=(n,e,t)=>{e=e.max(1e-6).toVar();const i=rc(n.div(e).add(1)),r=rc(t.div(e).add(1));return i.div(r)},q$=Je(To,To.DEPTH_BASE),H$=gt(To,To.DEPTH),G2e=Je(To,To.LINEAR_DEPTH);z2e();H$.assign=n=>q$(n);class nf extends Cn{static get type(){return"ClippingNode"}constructor(e=nf.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{localClipIntersection:i,localClippingCount:r,globalClippingCount:s}=t,o=s+r,a=i?o-r:o;return this.scope===nf.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(t.planes,o,a):this.setupDefault(t.planes,o,a)}setupAlphaToCoverage(e,t,i){return Tt(()=>{const r=Y1(e),s=sA("float","distanceToPlane"),o=sA("float","distanceToGradient"),a=sA("float","clipOpacity");a.assign(1);let l;if(jl(i,({i:u})=>{l=r.element(u),s.assign(os.dot(l.xyz).negate().add(l.w)),o.assign(s.fwidth().div(2)),a.mulAssign(zd(o.negate(),o,s)),a.equal(0).discard()}),i<t){const u=sA("float","unionclipOpacity");u.assign(1),jl({start:i,end:t},({i:c})=>{l=r.element(c),s.assign(os.dot(l.xyz).negate().add(l.w)),o.assign(s.fwidth().div(2)),u.mulAssign(zd(o.negate(),o,s).oneMinus())}),a.mulAssign(u.oneMinus())}ui.a.mulAssign(a),ui.a.equal(0).discard()})()}setupDefault(e,t,i){return Tt(()=>{const r=Y1(e);let s;if(jl(i,({i:o})=>{s=r.element(o),os.dot(s.xyz).greaterThan(s.w).discard()}),i<t){const o=sA("bool","clipped");o.assign(!0),jl({start:i,end:t},({i:a})=>{s=r.element(a),o.assign(os.dot(s.xyz).greaterThan(s.w).and(o))}),o.discard()}})()}}nf.ALPHA_TO_COVERAGE="alphaToCoverage";nf.DEFAULT="default";const q2e=()=>pt(new nf),H2e=()=>pt(new nf(nf.ALPHA_TO_COVERAGE)),$2e=.05,G7=Tt(([n])=>pf(Un(1e4,al(Un(17,n.x).add(Un(.1,n.y)))).mul(io(.1,ll(al(Un(13,n.y).add(n.x))))))),q7=Tt(([n])=>G7(Pt(G7(n.xy),n.z))),j2e=Tt(([n])=>{const e=Ua(Vh(m$(n.xyz)),Vh(g$(n.xyz))).toVar("maxDeriv"),t=Qe(1).div(Qe($2e).mul(e)).toVar("pixScale"),i=Pt(H1(Ed(rc(t))),H1(K6(rc(t)))).toVar("pixScales"),r=Pt(q7(Ed(i.x.mul(n.xyz))),q7(Ed(i.y.mul(n.xyz)))).toVar("alpha"),s=pf(rc(t)).toVar("lerpFactor"),o=io(Un(s.oneMinus(),r.x),Un(s,r.y)).toVar("x"),a=j1(s,s.oneMinus()).toVar("a"),l=Xe(o.mul(o).div(Un(2,a).mul(ta(1,a))),o.sub(Un(.5,a)).div(ta(1,a)),ta(1,ta(1,o).mul(ta(1,o)).div(Un(2,a).mul(ta(1,a))))).toVar("cases"),u=o.lessThan(a.oneMinus()).select(o.lessThan(a).select(l.x,l.y),l.z);return gc(u,1e-6,1)});class Pr extends Bo{static get type(){return"NodeMaterial"}constructor(){super(),this.isNodeMaterial=!0,this.type=this.constructor.type,this.forceSinglePass=!1,this.fog=!0,this.lights=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.shadowNode=null,this.shadowPositionNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null}customProgramCacheKey(){return this.type+YH(this)}build(e){this.setup(e)}setupObserver(e){return new nve(e)}setup(e){e.context.setupNormal=()=>this.setupNormal(e),e.addStack(),e.stack.outputNode=this.vertexNode||this.setupPosition(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let t;const i=this.setupClipping(e);if(this.depthWrite===!0&&this.setupDepth(e),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const r=this.setupLighting(e);i!==null&&e.stack.add(i);const s=wn(r,ui.a).max(0);if(t=this.setupOutput(e,s),zve.assign(t),this.outputNode!==null&&(t=this.outputNode),e.renderer.getRenderTarget()!==null){const a=e.renderer.getMRT(),l=this.mrtNode;a!==null?(t=a,l!==null&&(t=a.merge(l))):l!==null&&(t=l)}}else{let r=this.fragmentNode;r.isOutputStructNode!==!0&&(r=wn(r)),t=this.setupOutput(e,r)}e.stack.outputNode=t,e.addFlow("fragment",e.removeStack()),e.monitor=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{globalClippingCount:t,localClippingCount:i}=e.clippingContext;let r=null;if(t||i){const s=e.renderer.samples;this.alphaToCoverage&&s>1?r=H2e():e.stack.add(q2e())}return r}setupDepth(e){const{renderer:t,camera:i}=e;let r=this.depthNode;if(r===null){const s=t.getMRT();s&&s.has("depth")?r=s.get("depth"):t.logarithmicDepthBuffer===!0&&(i.isPerspectiveCamera?r=G$(VR().w,td,nd):r=Wg(os.z,td,nd))}r!==null&&H$.assign(r).append()}setupPosition(e){const{object:t}=e,i=t.geometry;if(e.addStack(),(i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color)&&k2e(t).append(),t.isSkinnedMesh===!0&&R2e(t).append(),this.displacementMap){const s=vh("displacementMap","texture"),o=vh("displacementScale","float"),a=vh("displacementBias","float");us.addAssign(su.normalize().mul(s.x.mul(o).add(a)))}t.isBatchedMesh&&C2e(t).append(),t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&E2e(t).append(),this.positionNode!==null&&us.assign(this.positionNode);const r=VR();return e.context.vertex=e.removeStack(),e.context.mvp=r,r}setupDiffuseColor({object:e,geometry:t}){let i=this.colorNode?wn(this.colorNode):W_e;this.vertexColors===!0&&t.hasAttribute("color")&&(i=wn(i.xyz.mul(vc("color","vec3")),i.a)),e.instanceColor&&(i=Ob("vec3","vInstanceColor").mul(i)),e.isBatchedMesh&&e._colorsTexture&&(i=Ob("vec3","vBatchColor").mul(i)),ui.assign(i);const r=this.opacityNode?Qe(this.opacityNode):F$;if(ui.a.assign(ui.a.mul(r)),this.alphaTestNode!==null||this.alphaTest>0){const s=this.alphaTestNode!==null?Qe(this.alphaTestNode):j_e;ui.a.lessThanEqual(s).discard()}this.alphaHash===!0&&ui.a.lessThan(j2e(us)).discard(),this.transparent===!1&&this.blending===Oh&&this.alphaToCoverage===!1&&ui.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?Xe(0):ui.rgb}setupNormal(){return this.normalNode?Xe(this.normalNode):e2e}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?vh("envMap","cubeTexture"):vh("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new O2e(B$)),t}setupLights(e){const t=[],i=this.setupEnvironment(e);i&&i.isLightingNode&&t.push(i);const r=this.setupLightMap(e);if(r&&r.isLightingNode&&t.push(r),this.aoNode!==null||e.material.aoMap){const o=this.aoNode!==null?this.aoNode:_2e;t.push(new L2e(o))}let s=this.lightsNode||e.lightsNode;return t.length>0&&(s=e.renderer.lighting.createNode([...s.getLights(),...t])),s}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:i,backdropAlphaNode:r,emissiveNode:s}=this,a=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let l=this.setupOutgoingLight(e);if(a&&a.getScope().hasLights){const u=this.setupLightingModel(e);l=B2e(a,u,i,r)}else i!==null&&(l=Xe(r!==null?Bi(l,i,r):i));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(N7.assign(Xe(s||Y_e)),l=l.add(N7)),l}setupOutput(e,t){if(this.fog===!0){const i=e.fogNode;i&&(t=wn(i.mix(t.rgb,i.colorNode),t.a))}return t}setDefaultValues(e){for(const i in e){const r=e[i];this[i]===void 0&&(this[i]=r,r&&r.clone&&(this[i]=r.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const i in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,i)===void 0&&t[i].get!==void 0&&Object.defineProperty(this.constructor.prototype,i,t[i])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const i=Bo.prototype.toJSON.call(this,e),r=Lb(this);i.inputNodes={};for(const{property:o,childNode:a}of r)i.inputNodes[o]=a.toJSON(e).uuid;function s(o){const a=[];for(const l in o){const u=o[l];delete u.metadata,a.push(u)}return a}if(t){const o=s(e.textures),a=s(e.images),l=s(e.nodes);o.length>0&&(i.textures=o),a.length>0&&(i.images=a),l.length>0&&(i.nodes=l)}return i}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.shadowNode=e.shadowNode,this.shadowPositionNode=e.shadowPositionNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,super.copy(e)}}const W2e=new O6;class X2e extends Pr{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.lights=!1,this.setDefaultValues(W2e),this.setValues(e)}}const Y2e=new jH;class Q2e extends Pr{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.lights=!1,this.setDefaultValues(Y2e),this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode,t=this.dashScaleNode?Qe(this.dashScaleNode):m2e,i=this.dashSizeNode?Qe(this.dashSizeNode):g2e,r=this.dashSizeNode?Qe(this.dashGapNode):v2e;cT.assign(i),I7.assign(r);const s=Rc(vc("lineDistance").mul(t));(e?s.add(e):s).mod(cT.add(I7)).greaterThan(cT).discard()}}const K2e=n=>pt(n).mul(.5).add(.5),Z2e=new qH;class J2e extends Pr{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.lights=!1,this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(Z2e),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?Qe(this.opacityNode):F$;ui.assign(wn(K2e(Tr),e))}}class exe extends Nr{static get type(){return"EquirectUVNode"}constructor(e=R$){super("vec2"),this.dirNode=e}setup(){const e=this.dirNode,t=e.z.atan2(e.x).mul(1/(Math.PI*2)).add(.5),i=e.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return Pt(t,i)}}const $$=Je(exe);class j$ extends O1e{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const i=t.minFilter,r=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new Lv(5,5,5),o=$$(R$),a=new Pr;a.colorNode=pr(t,o,0),a.side=Cl,a.blending=N0;const l=new Ud(s,a),u=new kH;u.add(l),t.minFilter===Ju&&(t.minFilter=ua);const c=new DH(1,10,this),h=e.getMRT();return e.setMRT(null),c.update(e,u),e.setMRT(h),t.minFilter=i,t.currentGenerateMipmaps=r,l.geometry.dispose(),l.material.dispose(),this}}const Xg=new WeakMap;class txe extends Nr{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=X1();const t=new F6;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=Nn.RENDER}updateBefore(e){const{renderer:t,material:i}=e,r=this.envNode;if(r.isTextureNode||r.isMaterialReferenceNode){const s=r.isTextureNode?r.value:i[r.property];if(s&&s.isTexture){const o=s.mapping;if(o===Pv||o===Nv){if(Xg.has(s)){const a=Xg.get(s);H7(a,s.mapping),this._cubeTexture=a}else{const a=s.image;if(nxe(a)){const l=new j$(a.height);l.fromEquirectangularTexture(t,s),H7(l.texture,s.mapping),this._cubeTexture=l.texture,Xg.set(s,l.texture),s.addEventListener("dispose",W$)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function nxe(n){return n==null?!1:n.height>0}function W$(n){const e=n.target;e.removeEventListener("dispose",W$);const t=Xg.get(e);t!==void 0&&(Xg.delete(e),t.dispose())}function H7(n,e){e===Pv?n.mapping=Fd:e===Nv&&(n.mapping=I0)}const X$=Je(txe);class aN extends nm{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=X$(this.envNode)}}class ixe extends nm{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=Qe(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class gw{start(){}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class Y$ extends gw{constructor(){super()}indirect(e,t,i){const r=e.ambientOcclusion,s=e.reflectedLight,o=i.context.irradianceLightMap;s.indirectDiffuse.assign(wn(0)),o?s.indirectDiffuse.addAssign(o):s.indirectDiffuse.addAssign(wn(1,1,1,0)),s.indirectDiffuse.mulAssign(r),s.indirectDiffuse.mulAssign(ui.rgb)}finish(e,t,i){const r=i.material,s=e.outgoingLight,o=i.context.environment;if(o)switch(r.combine){case ow:s.rgb.assign(Bi(s.rgb,s.rgb.mul(o.rgb),tx.mul(hT)));break;case _ge:s.rgb.assign(Bi(s.rgb,o.rgb,tx.mul(hT)));break;case xge:s.rgb.addAssign(o.rgb.mul(tx.mul(hT)));break;default:console.warn("THREE.BasicLightingModel: Unsupported .combine value:",r.combine);break}}}const rxe=new aw;class sxe extends Pr{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(rxe),this.setValues(e)}setupNormal(){return Rl}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new aN(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new ixe(B$)),t}setupOutgoingLight(){return ui.rgb}setupLightingModel(){return new Y$}}const K1=Tt(({f0:n,f90:e,dotVH:t})=>{const i=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return n.mul(i.oneMinus()).add(e.mul(i))}),L0=Tt(n=>n.diffuseColor.mul(1/Math.PI)),oxe=()=>Qe(.25),axe=Tt(({dotNH:n})=>OR.mul(Qe(.5)).add(1).mul(Qe(1/Math.PI)).mul(n.pow(OR))),lxe=Tt(({lightDirection:n})=>{const e=n.add(er).normalize(),t=Tr.dot(e).clamp(),i=er.dot(e).clamp(),r=K1({f0:Yo,f90:1,dotVH:i}),s=oxe(),o=axe({dotNH:t});return r.mul(s).mul(o)});class Q$ extends Y${constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:i}){const s=Tr.dot(e).clamp().mul(t);i.directDiffuse.addAssign(s.mul(L0({diffuseColor:ui.rgb}))),this.specular===!0&&i.directSpecular.addAssign(s.mul(lxe({lightDirection:e})).mul(tx))}indirect({ambientOcclusion:e,irradiance:t,reflectedLight:i}){i.indirectDiffuse.addAssign(t.mul(L0({diffuseColor:ui}))),i.indirectDiffuse.mulAssign(e)}}const uxe=new HH;class cxe extends Pr{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(uxe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new aN(t):null}setupLightingModel(){return new Q$(!1)}}const hxe=new VH;class fxe extends Pr{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(hxe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new aN(t):null}setupLightingModel(){return new Q$}setupVariants(){const e=(this.shininessNode?Qe(this.shininessNode):X_e).max(1e-4);OR.assign(e);const t=this.specularNode||Q_e;Yo.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const dxe=Tt(n=>{if(n.geometry.hasAttribute("normal")===!1)return Qe(0);const e=Rl.dFdx().abs().max(Rl.dFdy().abs());return e.x.max(e.y).max(e.z)}),K$=Tt(n=>{const{roughness:e}=n,t=dxe();let i=e.max(.0525);return i=i.add(t),i=i.min(1),i}),pxe=Tt(({alpha:n,dotNL:e,dotNV:t})=>{const i=n.pow2(),r=e.mul(i.add(i.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(i.add(i.oneMinus().mul(e.pow2())).sqrt());return tf(.5,r.add(s).max(lye))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),Axe=Tt(({alphaT:n,alphaB:e,dotTV:t,dotBV:i,dotTL:r,dotBL:s,dotNV:o,dotNL:a})=>{const l=a.mul(Xe(n.mul(t),e.mul(i),o).length()),u=o.mul(Xe(n.mul(r),e.mul(s),a).length());return tf(.5,l.add(u)).saturate()}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),mxe=Tt(({alpha:n,dotNH:e})=>{const t=n.pow2(),i=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(i.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),gxe=Qe(1/Math.PI),vxe=Tt(({alphaT:n,alphaB:e,dotNH:t,dotTH:i,dotBH:r})=>{const s=n.mul(e),o=Xe(e.mul(i),n.mul(r),s.mul(t)),a=o.dot(o),l=s.div(a);return gxe.mul(s.mul(l.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),$7=Tt(n=>{const{lightDirection:e,f0:t,f90:i,roughness:r,f:s,USE_IRIDESCENCE:o,USE_ANISOTROPY:a}=n,l=n.normalView||Tr,u=r.pow2(),c=e.add(er).normalize(),h=l.dot(e).clamp(),A=l.dot(er).clamp(),v=l.dot(c).clamp(),_=er.dot(c).clamp();let S=K1({f0:t,f90:i,dotVH:_}),w,x;if(P7(o)&&(S=Y6.mix(S,s)),P7(a)){const M=Z2.dot(e),R=Z2.dot(er),N=Z2.dot(c),B=e0.dot(e),T=e0.dot(er),D=e0.dot(c);w=Axe({alphaT:BR,alphaB:u,dotTV:R,dotBV:T,dotTL:M,dotBL:B,dotNV:A,dotNL:h}),x=vxe({alphaT:BR,alphaB:u,dotNH:v,dotTH:N,dotBH:D})}else w=pxe({alpha:u,dotNL:h,dotNV:A}),x=mxe({alpha:u,dotNH:v});return S.mul(w).mul(x)}),Z$=Tt(({roughness:n,dotNV:e})=>{const t=wn(-1,-.0275,-.572,.022),i=wn(1,.0425,1.04,-.04),r=n.mul(t).add(i),s=r.x.mul(r.x).min(e.mul(-9.28).exp2()).mul(r.x).add(r.y);return Pt(-1.04,1.04).mul(s).add(r.zw)}).setLayout({name:"DFGApprox",type:"vec2",inputs:[{name:"roughness",type:"float"},{name:"dotNV",type:"vec3"}]}),J$=Tt(n=>{const{dotNV:e,specularColor:t,specularF90:i,roughness:r}=n,s=Z$({dotNV:e,roughness:r});return t.mul(s.x).add(i.mul(s.y))}),yxe=Tt(({f:n,f90:e,dotVH:t})=>{const i=t.oneMinus().saturate(),r=i.mul(i),s=i.mul(r,r).clamp(0,.9999);return n.sub(Xe(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),_xe=Tt(({roughness:n,dotNH:e})=>{const t=n.pow2(),i=Qe(1).div(t),s=e.pow2().oneMinus().max(.0078125);return Qe(2).add(i).mul(s.pow(i.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),xxe=Tt(({dotNV:n,dotNL:e})=>Qe(1).div(Qe(4).mul(e.add(n).sub(e.mul(n))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),bxe=Tt(({lightDirection:n})=>{const e=n.add(er).normalize(),t=Tr.dot(n).clamp(),i=Tr.dot(er).clamp(),r=Tr.dot(e).clamp(),s=_xe({roughness:X6,dotNH:r}),o=xxe({dotNV:i,dotNL:t});return NA.mul(s).mul(o)}),Sxe=Tt(({N:n,V:e,roughness:t})=>{const s=.0078125,o=n.dot(e).saturate(),a=Pt(t,o.oneMinus().sqrt());return a.assign(a.mul(.984375).add(s)),a}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),wxe=Tt(({f:n})=>{const e=n.length();return Ua(e.mul(e).add(n.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),$_=Tt(({v1:n,v2:e})=>{const t=n.dot(e),i=t.abs().toVar(),r=i.mul(.0145206).add(.4965155).mul(i).add(.8543985).toVar(),s=i.add(4.1616724).mul(i).add(3.417594).toVar(),o=r.div(s),a=t.greaterThan(0).select(o,Ua(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(o));return n.cross(e).mul(a)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),j7=Tt(({N:n,V:e,P:t,mInv:i,p0:r,p1:s,p2:o,p3:a})=>{const l=s.sub(r).toVar(),u=a.sub(r).toVar(),c=l.cross(u),h=Xe().toVar();return ls(c.dot(t.sub(r)).greaterThanEqual(0),()=>{const A=e.sub(n.mul(e.dot(n))).normalize(),v=n.cross(A).negate(),_=i.mul(no(A,v,n).transpose()).toVar(),S=_.mul(r.sub(t)).normalize().toVar(),w=_.mul(s.sub(t)).normalize().toVar(),x=_.mul(o.sub(t)).normalize().toVar(),M=_.mul(a.sub(t)).normalize().toVar(),R=Xe(0).toVar();R.addAssign($_({v1:S,v2:w})),R.addAssign($_({v1:w,v2:x})),R.addAssign($_({v1:x,v2:M})),R.addAssign($_({v1:M,v2:S})),h.assign(Xe(wxe({f:R})))}),h}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),vw=1/6,ej=n=>Un(vw,Un(n,Un(n,n.negate().add(3)).sub(3)).add(1)),qR=n=>Un(vw,Un(n,Un(n,Un(3,n).sub(6))).add(4)),tj=n=>Un(vw,Un(n,Un(n,Un(-3,n).add(3)).add(3)).add(1)),HR=n=>Un(vw,hw(n,3)),W7=n=>ej(n).add(qR(n)),X7=n=>tj(n).add(HR(n)),Y7=n=>io(-1,qR(n).div(ej(n).add(qR(n)))),Q7=n=>io(1,HR(n).div(tj(n).add(HR(n)))),K7=(n,e,t)=>{const i=n.uvNode,r=Un(i,e.zw).add(.5),s=Ed(r),o=pf(r),a=W7(o.x),l=X7(o.x),u=Y7(o.x),c=Q7(o.x),h=Y7(o.y),A=Q7(o.y),v=Pt(s.x.add(u),s.y.add(h)).sub(.5).mul(e.xy),_=Pt(s.x.add(c),s.y.add(h)).sub(.5).mul(e.xy),S=Pt(s.x.add(u),s.y.add(A)).sub(.5).mul(e.xy),w=Pt(s.x.add(c),s.y.add(A)).sub(.5).mul(e.xy),x=W7(o.y).mul(io(a.mul(n.uv(v).level(t)),l.mul(n.uv(_).level(t)))),M=X7(o.y).mul(io(a.mul(n.uv(S).level(t)),l.mul(n.uv(w).level(t))));return x.add(M)},Exe=Tt(([n,e=Qe(3)])=>{const t=Pt(n.size(dr(e))),i=Pt(n.size(dr(e.add(1)))),r=tf(1,t),s=tf(1,i),o=K7(n,wn(r,t),Ed(e)),a=K7(n,wn(s,i),K6(e));return pf(e).mix(o,a)}),Z7=Tt(([n,e,t,i,r])=>{const s=Xe(b$(e.negate(),$1(n),tf(1,i))),o=Xe(Vh(r[0].xyz),Vh(r[1].xyz),Vh(r[2].xyz));return $1(s).mul(t.mul(o))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),Txe=Tt(([n,e])=>n.mul(gc(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),Cxe=z$(),Mxe=z$(),J7=Tt(([n,e,t],{material:i})=>{const s=(i.side==Cl?Cxe:Mxe).uv(n),o=rc(GR.x).mul(Txe(e,t));return Exe(s,o)}),eB=Tt(([n,e,t])=>(ls(t.notEqual(0),()=>{const i=p$(e).negate().div(t);return d$(i.negate().mul(n))}),Xe(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),Rxe=Tt(([n,e,t,i,r,s,o,a,l,u,c,h,A,v,_])=>{let S,w;if(_){S=wn().toVar(),w=Xe().toVar();const B=c.sub(1).mul(_.mul(.025)),T=Xe(c.sub(B),c,c.add(B));jl({start:0,end:3},({i:D})=>{const F=T.element(D),L=Z7(n,e,h,F,a),O=o.add(L),z=u.mul(l.mul(wn(O,1))),Q=Pt(z.xy.div(z.w)).toVar();Q.addAssign(1),Q.divAssign(2),Q.assign(Pt(Q.x,Q.y.oneMinus()));const j=J7(Q,t,F);S.element(D).assign(j.element(D)),S.a.addAssign(j.a),w.element(D).assign(i.element(D).mul(eB(Vh(L),A,v).element(D)))}),S.a.divAssign(3)}else{const B=Z7(n,e,h,c,a),T=o.add(B),D=u.mul(l.mul(wn(T,1))),F=Pt(D.xy.div(D.w)).toVar();F.addAssign(1),F.divAssign(2),F.assign(Pt(F.x,F.y.oneMinus())),S=J7(F,t,c),w=i.mul(eB(Vh(B),A,v))}const x=w.rgb.mul(S.rgb),M=n.dot(e).clamp(),R=Xe(J$({dotNV:M,specularColor:r,specularF90:s,roughness:t})),N=w.r.add(w.g,w.b).div(3);return wn(R.oneMinus().mul(x),S.a.oneMinus().mul(N).oneMinus())}),Pxe=no(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),Nxe=n=>{const e=n.sqrt();return Xe(1).add(e).div(Xe(1).sub(e))},tB=(n,e)=>n.sub(e).div(n.add(e)).pow2(),Ixe=(n,e)=>{const t=n.mul(2*Math.PI*1e-9),i=Xe(54856e-17,44201e-17,52481e-17),r=Xe(1681e3,1795300,2208400),s=Xe(43278e5,93046e5,66121e5),o=Qe(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let a=i.mul(s.mul(2*Math.PI).sqrt()).mul(r.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return a=Xe(a.x.add(o),a.y,a.z).div(10685e-11),Pxe.mul(a)},Dxe=Tt(({outsideIOR:n,eta2:e,cosTheta1:t,thinFilmThickness:i,baseF0:r})=>{const s=Bi(n,e,zd(0,.03,i)),a=n.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();ls(a.lessThan(0),()=>Xe(1));const l=a.sqrt(),u=tB(s,n),c=K1({f0:u,f90:1,dotVH:t}),h=c.oneMinus(),A=s.lessThan(n).select(Math.PI,0),v=Qe(Math.PI).sub(A),_=Nxe(r.clamp(0,.9999)),S=tB(_,s.toVec3()),w=K1({f0:S,f90:1,dotVH:l}),x=Xe(_.x.lessThan(s).select(Math.PI,0),_.y.lessThan(s).select(Math.PI,0),_.z.lessThan(s).select(Math.PI,0)),M=s.mul(i,l,2),R=Xe(v).add(x),N=c.mul(w).clamp(1e-5,.9999),B=N.sqrt(),T=h.pow2().mul(w).div(Xe(1).sub(N)),F=c.add(T).toVar(),L=T.sub(h).toVar();return jl({start:1,end:2,condition:"<=",name:"m"},({m:O})=>{L.mulAssign(B);const z=Ixe(Qe(O).mul(M),Qe(O).mul(R)).mul(2);F.addAssign(L.mul(z))}),F.max(Xe(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),kxe=Tt(({normal:n,viewDir:e,roughness:t})=>{const i=n.dot(e).saturate(),r=t.pow2(),s=Eo(t.lessThan(.25),Qe(-339.2).mul(r).add(Qe(161.4).mul(t)).sub(25.9),Qe(-8.48).mul(r).add(Qe(14.3).mul(t)).sub(9.95)),o=Eo(t.lessThan(.25),Qe(44).mul(r).sub(Qe(23.7).mul(t)).add(3.26),Qe(1.97).mul(r).sub(Qe(3.27).mul(t)).add(.72));return Eo(t.lessThan(.25),0,Qe(.1).mul(t).sub(.025)).add(s.mul(i).add(o).exp()).mul(1/Math.PI).saturate()}),pT=Xe(.04),AT=Qe(1);class nj extends gw{constructor(e=!1,t=!1,i=!1,r=!1,s=!1,o=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=i,this.anisotropy=r,this.transmission=s,this.dispersion=o,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=Xe().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=Xe().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=Xe().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=Xe().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=Xe().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=Tr.dot(er).clamp();this.iridescenceFresnel=Dxe({outsideIOR:Qe(1),eta2:s$,cosTheta1:t,thinFilmThickness:o$,baseF0:Yo}),this.iridescenceF0=yxe({f:this.iridescenceFresnel,f90:1,dotVH:t})}if(this.transmission===!0){const t=zR,i=x_e.sub(zR).normalize(),r=nN;e.backdrop=Rxe(r,i,Ou,ui,Yo,Vb,t,Vd,Pc,Gb,J2,a$,u$,l$,this.dispersion?c$:null),e.backdropAlpha=UR,ui.a.mulAssign(Bi(1,e.backdrop.a,UR))}}computeMultiscattering(e,t,i){const r=Tr.dot(er).clamp(),s=Z$({roughness:Ou,dotNV:r}),a=(this.iridescenceF0?Y6.mix(Yo,this.iridescenceF0):Yo).mul(s.x).add(i.mul(s.y)),u=s.x.add(s.y).oneMinus(),c=Yo.add(Yo.oneMinus().mul(.047619)),h=a.mul(c).div(u.mul(c).oneMinus());e.addAssign(a),t.addAssign(h.mul(u))}direct({lightDirection:e,lightColor:t,reflectedLight:i}){const s=Tr.dot(e).clamp().mul(t);if(this.sheen===!0&&this.sheenSpecularDirect.addAssign(s.mul(bxe({lightDirection:e}))),this.clearcoat===!0){const a=_g.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(a.mul($7({lightDirection:e,f0:pT,f90:AT,roughness:zb,normalView:_g})))}i.directDiffuse.addAssign(s.mul(L0({diffuseColor:ui.rgb}))),i.directSpecular.addAssign(s.mul($7({lightDirection:e,f0:Yo,f90:1,roughness:Ou,iridescence:this.iridescence,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:i,halfHeight:r,reflectedLight:s,ltc_1:o,ltc_2:a}){const l=t.add(i).sub(r),u=t.sub(i).sub(r),c=t.sub(i).add(r),h=t.add(i).add(r),A=Tr,v=er,_=os.toVar(),S=Sxe({N:A,V:v,roughness:Ou}),w=o.uv(S).toVar(),x=a.uv(S).toVar(),M=no(Xe(w.x,0,w.y),Xe(0,1,0),Xe(w.z,0,w.w)).toVar(),R=Yo.mul(x.x).add(Yo.oneMinus().mul(x.y)).toVar();s.directSpecular.addAssign(e.mul(R).mul(j7({N:A,V:v,P:_,mInv:M,p0:l,p1:u,p2:c,p3:h}))),s.directDiffuse.addAssign(e.mul(ui).mul(j7({N:A,V:v,P:_,mInv:no(1,0,0,0,1,0,0,0,1),p0:l,p1:u,p2:c,p3:h})))}indirect(e,t,i){this.indirectDiffuse(e,t,i),this.indirectSpecular(e,t,i),this.ambientOcclusion(e,t,i)}indirectDiffuse({irradiance:e,reflectedLight:t}){t.indirectDiffuse.addAssign(e.mul(L0({diffuseColor:ui})))}indirectSpecular({radiance:e,iblIrradiance:t,reflectedLight:i}){if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(t.mul(NA,kxe({normal:Tr,viewDir:er,roughness:X6}))),this.clearcoat===!0){const u=_g.dot(er).clamp(),c=J$({dotNV:u,specularColor:pT,specularF90:AT,roughness:zb});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(c))}const r=Xe().toVar("singleScattering"),s=Xe().toVar("multiScattering"),o=t.mul(1/Math.PI);this.computeMultiscattering(r,s,Vb);const a=r.add(s),l=ui.mul(a.r.max(a.g).max(a.b).oneMinus());i.indirectSpecular.addAssign(e.mul(r)),i.indirectSpecular.addAssign(s.mul(o)),i.indirectDiffuse.addAssign(l.mul(o))}ambientOcclusion({ambientOcclusion:e,reflectedLight:t}){const r=Tr.dot(er).clamp().add(e),s=Ou.mul(-16).oneMinus().negate().exp2(),o=e.sub(r.pow(s).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(e),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(e),t.indirectDiffuse.mulAssign(e),t.indirectSpecular.mulAssign(o)}finish(e){const{outgoingLight:t}=e;if(this.clearcoat===!0){const i=_g.dot(er).clamp(),r=K1({dotVH:i,f0:pT,f90:AT}),s=t.mul(FR.mul(r).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(FR));t.assign(s)}if(this.sheen===!0){const i=NA.r.max(NA.g).max(NA.b).mul(.157).oneMinus(),r=t.mul(i).add(this.sheenSpecularDirect,this.sheenSpecularIndirect);t.assign(r)}}}const nB=Qe(1),$R=Qe(-2),j_=Qe(.8),mT=Qe(-1),W_=Qe(.4),gT=Qe(2),X_=Qe(.305),vT=Qe(3),iB=Qe(.21),Lxe=Qe(4),rB=Qe(4),Fxe=Qe(16),Bxe=Tt(([n])=>{const e=Xe(ll(n)).toVar(),t=Qe(-1).toVar();return ls(e.x.greaterThan(e.z),()=>{ls(e.x.greaterThan(e.y),()=>{t.assign(Eo(n.x.greaterThan(0),0,3))}).Else(()=>{t.assign(Eo(n.y.greaterThan(0),1,4))})}).Else(()=>{ls(e.z.greaterThan(e.y),()=>{t.assign(Eo(n.z.greaterThan(0),2,5))}).Else(()=>{t.assign(Eo(n.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),Oxe=Tt(([n,e])=>{const t=Pt().toVar();return ls(e.equal(0),()=>{t.assign(Pt(n.z,n.y).div(ll(n.x)))}).ElseIf(e.equal(1),()=>{t.assign(Pt(n.x.negate(),n.z.negate()).div(ll(n.y)))}).ElseIf(e.equal(2),()=>{t.assign(Pt(n.x.negate(),n.y).div(ll(n.z)))}).ElseIf(e.equal(3),()=>{t.assign(Pt(n.z.negate(),n.y).div(ll(n.x)))}).ElseIf(e.equal(4),()=>{t.assign(Pt(n.x.negate(),n.z).div(ll(n.y)))}).Else(()=>{t.assign(Pt(n.x,n.y).div(ll(n.z)))}),Un(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),Uxe=Tt(([n])=>{const e=Qe(0).toVar();return ls(n.greaterThanEqual(j_),()=>{e.assign(nB.sub(n).mul(mT.sub($R)).div(nB.sub(j_)).add($R))}).ElseIf(n.greaterThanEqual(W_),()=>{e.assign(j_.sub(n).mul(gT.sub(mT)).div(j_.sub(W_)).add(mT))}).ElseIf(n.greaterThanEqual(X_),()=>{e.assign(W_.sub(n).mul(vT.sub(gT)).div(W_.sub(X_)).add(gT))}).ElseIf(n.greaterThanEqual(iB),()=>{e.assign(X_.sub(n).mul(Lxe.sub(vT)).div(X_.sub(iB)).add(vT))}).Else(()=>{e.assign(Qe(-2).mul(rc(Un(1.16,n))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),zxe=Tt(([n,e])=>{const t=n.toVar();t.assign(Un(2,t).sub(1));const i=Xe(t,1).toVar();return ls(e.equal(0),()=>{i.assign(i.zyx)}).ElseIf(e.equal(1),()=>{i.assign(i.xzy),i.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{i.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{i.assign(i.zyx),i.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{i.assign(i.xzy),i.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{i.z.mulAssign(-1)}),i}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),Vxe=Tt(([n,e,t,i,r,s])=>{const o=Qe(t),a=Xe(e),l=gc(Uxe(o),$R,s),u=pf(l),c=Ed(l),h=Xe(jR(n,a,c,i,r,s)).toVar();return ls(u.notEqual(0),()=>{const A=Xe(jR(n,a,c.add(1),i,r,s)).toVar();h.assign(Bi(h,A,u))}),h}),jR=Tt(([n,e,t,i,r,s])=>{const o=Qe(t).toVar(),a=Xe(e),l=Qe(Bxe(a)).toVar(),u=Qe(Ua(rB.sub(o),0)).toVar();o.assign(Ua(o,rB));const c=Qe(H1(o)).toVar(),h=Pt(Oxe(a,l).mul(c.sub(2)).add(1)).toVar();return ls(l.greaterThan(2),()=>{h.y.addAssign(c),l.subAssign(3)}),h.x.addAssign(l.mul(c)),h.x.addAssign(u.mul(Un(3,Fxe))),h.y.addAssign(Un(4,H1(s).sub(c))),h.x.mulAssign(i),h.y.mulAssign(r),n.uv(h).grad(Pt(),Pt())}),yT=Tt(({envMap:n,mipInt:e,outputDirection:t,theta:i,axis:r,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:a})=>{const l=fh(i),u=t.mul(l).add(r.cross(t).mul(al(i))).add(r.mul(r.dot(t).mul(l.oneMinus())));return jR(n,u,e,s,o,a)}),Gxe=Tt(({n,latitudinal:e,poleAxis:t,outputDirection:i,weights:r,samples:s,dTheta:o,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:c,CUBEUV_MAX_MIP:h})=>{const A=Xe(Eo(e,t,_$(t,i))).toVar();ls(f$(A.equals(Xe(0))),()=>{A.assign(Xe(i.z,0,i.x.negate()))}),A.assign($1(A));const v=Xe().toVar();return v.addAssign(r.element(dr(0)).mul(yT({theta:0,axis:A,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:c,CUBEUV_MAX_MIP:h}))),jl({start:dr(1),end:n},({i:_})=>{ls(_.greaterThanEqual(s),()=>{N2e()});const S=Qe(o.mul(Qe(_))).toVar();v.addAssign(r.element(_).mul(yT({theta:S.mul(-1),axis:A,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:c,CUBEUV_MAX_MIP:h}))),v.addAssign(r.element(_).mul(yT({theta:S,axis:A,outputDirection:i,mipInt:a,envMap:l,CUBEUV_TEXEL_WIDTH:u,CUBEUV_TEXEL_HEIGHT:c,CUBEUV_MAX_MIP:h})))}),wn(v,1)});let qb=null;const sB=new WeakMap;function qxe(n){const e=Math.log2(n)-2,t=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:t,maxMip:e}}function Hxe(n){let e=sB.get(n);if((e!==void 0?e.pmremVersion:-1)!==n.pmremVersion){const i=n.image;if(n.isCubeTexture)if(jxe(i))e=qb.fromCubemap(n,e);else return null;else if(Wxe(i))e=qb.fromEquirectangular(n,e);else return null;e.pmremVersion=n.pmremVersion,sB.set(n,e)}return e.texture}class $xe extends Nr{static get type(){return"PMREMNode"}constructor(e,t=null,i=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=i,this._generator=null;const r=new to;r.isRenderTargetTexture=!0,this._texture=pr(r),this._width=En(0),this._height=En(0),this._maxMip=En(0),this.updateBeforeType=Nn.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=qxe(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(){let e=this._pmrem;const t=e?e.pmremVersion:-1,i=this._value;t!==i.pmremVersion&&(i.isPMREMTexture===!0?e=i:e=Hxe(i),e!==null&&(this._pmrem=e,this.updateFromTexture(e)))}setup(e){qb===null&&(qb=e.createPMREMGenerator()),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this));const i=this.value;e.renderer.coordinateSystem===ml&&i.isPMREMTexture!==!0&&i.isRenderTargetTexture===!0&&(t=Xe(t.x.negate(),t.yz));let r=this.levelNode;return r===null&&e.context.getTextureLevel&&(r=e.context.getTextureLevel(this)),Vxe(this._texture,t,r,this._width,this._height,this._maxMip)}}function jxe(n){if(n==null)return!1;let e=0;const t=6;for(let i=0;i<t;i++)n[i]!==void 0&&e++;return e===t}function Wxe(n){return n==null?!1:n.height>0}const ij=Je($xe),oB=new WeakMap;class Xxe extends nm{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const v=i.isTextureNode?i.value:t[i.property];let _=oB.get(v);_===void 0&&(_=ij(v),oB.set(v,_)),i=_}const s=t.envMap?tr("envMapIntensity","float",e.material):tr("environmentIntensity","float",e.scene),a=t.useAnisotropy===!0||t.anisotropy>0?U_e:Tr,l=i.context(aB(Ou,a)).mul(s),u=i.context(Yxe(nN)).mul(Math.PI).mul(s),c=ex(l),h=ex(u);e.context.radiance.addAssign(c),e.context.iblIrradiance.addAssign(h);const A=e.context.lightingModel.clearcoatRadiance;if(A){const v=i.context(aB(zb,_g)).mul(s),_=ex(v);A.addAssign(_)}}}const aB=(n,e)=>{let t=null;return{getUV:()=>(t===null&&(t=er.negate().reflect(e),t=n.mul(n).mix(t,e).normalize(),t=t.transformDirection(Pc)),t),getTextureLevel:()=>n}},Yxe=n=>({getUV:()=>n,getTextureLevel:()=>Qe(1)}),Qxe=new z6;class rj extends Pr{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(Qxe),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new Xxe(t):null}setupLightingModel(){return new nj}setupSpecular(){const e=Bi(Xe(.04),ui.rgb,Ub);Yo.assign(e),Vb.assign(1)}setupVariants(){const e=this.metalnessNode?Qe(this.metalnessNode):J_e;Ub.assign(e);let t=this.roughnessNode?Qe(this.roughnessNode):Z_e;t=K$({roughness:t}),Ou.assign(t),this.setupSpecular(),ui.assign(wn(ui.rgb.mul(e.oneMinus()),ui.a))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const Kxe=new zH;class Zxe extends rj{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(Kxe),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?Qe(this.iorNode):d2e;J2.assign(e),Yo.assign(Bi(j1(x$(J2.sub(1).div(J2.add(1))).mul(K_e),Xe(1)).mul(U7),ui.rgb,Ub)),Vb.assign(Bi(U7,1,Ub))}setupLightingModel(){return new nj(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?Qe(this.clearcoatNode):t2e,i=this.clearcoatRoughnessNode?Qe(this.clearcoatRoughnessNode):n2e;FR.assign(t),zb.assign(K$({roughness:i}))}if(this.useSheen){const t=this.sheenNode?Xe(this.sheenNode):s2e,i=this.sheenRoughnessNode?Qe(this.sheenRoughnessNode):o2e;NA.assign(t),X6.assign(i)}if(this.useIridescence){const t=this.iridescenceNode?Qe(this.iridescenceNode):l2e,i=this.iridescenceIORNode?Qe(this.iridescenceIORNode):u2e,r=this.iridescenceThicknessNode?Qe(this.iridescenceThicknessNode):c2e;Y6.assign(t),s$.assign(i),o$.assign(r)}if(this.useAnisotropy){const t=(this.anisotropyNode?Pt(this.anisotropyNode):a2e).toVar();Wf.assign(t.length()),ls(Wf.equal(0),()=>{t.assign(Pt(1,0))}).Else(()=>{t.divAssign(Pt(Wf)),Wf.assign(Wf.saturate())}),BR.assign(Wf.pow2().mix(Ou.pow2(),1)),Z2.assign(xg[0].mul(t.x).add(xg[1].mul(t.y))),e0.assign(xg[1].mul(t.x).sub(xg[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?Qe(this.transmissionNode):h2e,i=this.thicknessNode?Qe(this.thicknessNode):f2e,r=this.attenuationDistanceNode?Qe(this.attenuationDistanceNode):p2e,s=this.attenuationColorNode?Xe(this.attenuationColorNode):A2e;if(UR.assign(t),a$.assign(i),l$.assign(r),u$.assign(s),this.useDispersion){const o=this.dispersionNode?Qe(this.dispersionNode):y2e;c$.assign(o)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?Xe(this.clearcoatNormalNode):i2e}setup(e){e.context.setupClearcoatNormal=()=>this.setupClearcoatNormal(e),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const Jxe=Tt(({normal:n,lightDirection:e,builder:t})=>{const i=n.dot(e),r=Pt(i.mul(.5).add(.5),0);if(t.material.gradientMap){const s=vh("gradientMap","texture").context({getUV:()=>r});return Xe(s.r)}else{const s=r.fwidth().mul(.5);return Bi(Xe(.7),Xe(1),zd(Qe(.7).sub(s.x),Qe(.7).add(s.x),r.x))}});class ebe extends gw{direct({lightDirection:e,lightColor:t,reflectedLight:i},r,s){const o=Jxe({normal:P$,lightDirection:e,builder:s}).mul(t);i.directDiffuse.addAssign(o.mul(L0({diffuseColor:ui.rgb})))}indirect({ambientOcclusion:e,irradiance:t,reflectedLight:i}){i.indirectDiffuse.addAssign(t.mul(L0({diffuseColor:ui}))),i.indirectDiffuse.mulAssign(e)}}const tbe=new GH;class nbe extends Pr{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(tbe),this.setValues(e)}setupLightingModel(){return new ebe}}class ibe extends Nr{static get type(){return"MatcapUVNode"}constructor(){super("vec2")}setup(){const e=Xe(er.z,0,er.x.negate()).normalize(),t=er.cross(e);return Pt(e.dot(Tr),t.dot(Tr)).mul(.495).add(.5)}}const rbe=gt(ibe),sbe=new $H;class obe extends Pr{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.lights=!1,this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(sbe),this.setValues(e)}setupVariants(e){const t=rbe;let i;e.material.matcap?i=vh("matcap","texture").context({getUV:()=>t}):i=Xe(Bi(.2,.8,t.y)),ui.rgb.mulAssign(i.rgb)}}const abe=new OH;class lbe extends Pr{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.isPointsNodeMaterial=!0,this.lights=!1,this.transparent=!0,this.sizeNode=null,this.setDefaultValues(abe),this.setValues(e)}copy(e){return this.sizeNode=e.sizeNode,super.copy(e)}}class ube extends Nr{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:i}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),o=t.sin();return W6(s,o,o.negate(),s).mul(i)}else{const s=t,o=JA(wn(1,0,0,0),wn(0,fh(s.x),al(s.x).negate(),0),wn(0,al(s.x),fh(s.x),0),wn(0,0,0,1)),a=JA(wn(fh(s.y),0,al(s.y),0),wn(0,1,0,0),wn(al(s.y).negate(),0,fh(s.y),0),wn(0,0,0,1)),l=JA(wn(fh(s.z),al(s.z).negate(),0,0),wn(al(s.z),fh(s.z),0,0),wn(0,0,1,0),wn(0,0,0,1));return o.mul(a).mul(l).mul(wn(i,1)).xyz}}}const cbe=Je(ube),hbe=new FH;class fbe extends Pr{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this.lights=!1,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.setDefaultValues(hbe),this.setValues(e)}setupPosition({object:e,camera:t,context:i}){const r=this.sizeAttenuation,{positionNode:s,rotationNode:o,scaleNode:a}=this,l=us;let u=pw.mul(Xe(s||0)),c=Pt(Vd[0].xyz.length(),Vd[1].xyz.length());if(a!==null&&(c=c.mul(a)),!r)if(t.isPerspectiveCamera)c=c.mul(u.z.negate());else{const S=Qe(2).div(Gb.element(1).element(1));c=c.mul(S.mul(2))}let h=l.xy;if(e.center&&e.center.isVector2===!0){const S=Zye("center","vec2");h=h.sub(S.sub(.5))}h=h.mul(c);const A=Qe(o||r2e),v=cbe(h,A);u=wn(u.xy.add(v),u.zw);const _=Gb.mul(u);return i.vertex=l,_}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}class dbe extends gw{constructor(){super(),this.shadowNode=Qe(1).toVar("shadowMask")}direct({shadowMask:e}){this.shadowNode.mulAssign(e)}finish(e){ui.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(ui.rgb)}}const pbe=new UH;class Abe extends Pr{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.setDefaultValues(pbe),this.setValues(e)}setupLightingModel(){return new dbe}}Tt(({texture:n,uv:e})=>{const i=Xe().toVar();return ls(e.x.lessThan(1e-4),()=>{i.assign(Xe(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{i.assign(Xe(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{i.assign(Xe(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{i.assign(Xe(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{i.assign(Xe(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{i.assign(Xe(0,0,-1))}).Else(()=>{const s=n.uv(e.add(Xe(-.01,0,0))).r.sub(n.uv(e.add(Xe(.01,0,0))).r),o=n.uv(e.add(Xe(0,-.01,0))).r.sub(n.uv(e.add(Xe(0,.01,0))).r),a=n.uv(e.add(Xe(0,0,-.01))).r.sub(n.uv(e.add(Xe(0,0,.01))).r);i.assign(Xe(s,o,a))}),i.normalize()});class mbe{constructor(e,t){this.nodes=e,this.info=t,this.animationLoop=null,this.requestId=null,this._init()}_init(){const e=(t,i)=>{this.requestId=self.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.animationLoop!==null&&this.animationLoop(t,i)};e()}dispose(){self.cancelAnimationFrame(this.requestId),this.requestId=null}setAnimationLoop(e){this.animationLoop=e}}class ou{constructor(){this.weakMap=new WeakMap}get(e){let t=this.weakMap;for(let i=0;i<e.length;i++)if(t=t.get(e[i]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let i=this.weakMap;for(let r=0;r<e.length;r++){const s=e[r];i.has(s)===!1&&i.set(s,new WeakMap),i=i.get(s)}return i.set(e[e.length-1],t)}delete(e){let t=this.weakMap;for(let i=0;i<e.length;i++)if(t=t.get(e[i]),t===void 0)return!1;return t.delete(e[e.length-1])}}const _T=new hh;class WR{constructor(){this.version=0,this.globalClippingCount=0,this.localClippingCount=0,this.localClippingEnabled=!1,this.localClipIntersection=!1,this.planes=[],this.parentVersion=0,this.viewNormalMatrix=new zo,this.cacheKey=0}projectPlanes(e,t){const i=e.length,r=this.planes;for(let s=0;s<i;s++){_T.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const o=r[t+s],a=_T.normal;o.x=-a.x,o.y=-a.y,o.z=-a.z,o.w=_T.constant}}updateGlobal(e,t){const i=e.clippingPlanes;this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix);let r=!1;if(Array.isArray(i)&&i.length!==0){const s=i.length;if(s!==this.globalClippingCount){const o=[];for(let a=0;a<s;a++)o.push(new pi);this.globalClippingCount=s,this.planes=o,r=!0}this.projectPlanes(i,0)}else this.globalClippingCount!==0&&(this.globalClippingCount=0,this.planes=[],r=!0);e.localClippingEnabled!==this.localClippingEnabled&&(this.localClippingEnabled=e.localClippingEnabled,r=!0),r&&(this.version++,this.cacheKey=kb(this.globalClippingCount,this.localClippingEnabled===!0?1:0))}update(e,t){let i=!1;if(this!==e&&e.version!==this.parentVersion&&(this.globalClippingCount=t.isShadowNodeMaterial?0:e.globalClippingCount,this.localClippingEnabled=e.localClippingEnabled,this.planes=Array.from(e.planes),this.parentVersion=e.version,this.viewMatrix=e.viewMatrix,this.viewNormalMatrix=e.viewNormalMatrix,i=!0),this.localClippingEnabled){const r=t.clippingPlanes;if(Array.isArray(r)&&r.length!==0){const s=r.length,o=this.planes,a=this.globalClippingCount;if(i||s!==this.localClippingCount){o.length=a+s;for(let l=0;l<s;l++)o[a+l]=new pi;this.localClippingCount=s,i=!0}this.projectPlanes(r,a)}else this.localClippingCount!==0&&(this.localClippingCount=0,i=!0);this.localClipIntersection!==t.clipIntersection&&(this.localClipIntersection=t.clipIntersection,i=!0)}i&&(this.version+=e.version,this.cacheKey=kb(e.cacheKey,this.localClippingCount,this.localClipIntersection===!0?1:0))}}let gbe=0;function vbe(n){const e=Object.keys(n);let t=Object.getPrototypeOf(n);for(;t;){const i=Object.getOwnPropertyDescriptors(t);for(const r in i)if(i[r]!==void 0){const s=i[r];s&&typeof s.get=="function"&&e.push(r)}t=Object.getPrototypeOf(t)}return e}class ybe{constructor(e,t,i,r,s,o,a,l,u){this._nodes=e,this._geometries=t,this.id=gbe++,this.renderer=i,this.object=r,this.material=s,this.scene=o,this.camera=a,this.lightsNode=l,this.context=u,this.geometry=r.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.pipeline=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.updateClipping(u.clippingContext),this.clippingContextVersion=this.clippingContext.version,this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.material.addEventListener("dispose",this.onMaterialDispose)}updateClipping(e){const t=this.material;let i=this.clippingContext;Array.isArray(t.clippingPlanes)?((i===e||!i)&&(i=new WR,this.clippingContext=i),i.update(e,t)):this.clippingContext!==e&&(this.clippingContext=e)}get clippingNeedsUpdate(){return this.clippingContext.version===this.clippingContextVersion?!1:(this.clippingContextVersion=this.clippingContext.version,!0)}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().monitor)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,i=[],r=new Set;for(const s of e){const o=s.node&&s.node.attribute?s.node.attribute:t.getAttribute(s.name);if(o===void 0)continue;i.push(o);const a=o.isInterleavedBufferAttribute?o.data:o;r.add(a)}return this.attributes=i,this.vertexBuffers=Array.from(r.values()),i}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:i,group:r,drawRange:s}=this,o=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),a=this.getIndex(),l=a!==null,u=i.isInstancedBufferGeometry?i.instanceCount:e.count>1?e.count:1;if(u===0)return null;if(o.instanceCount=u,e.isBatchedMesh===!0)return o;let c=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(c=2);let h=s.start*c,A=(s.start+s.count)*c;r!==null&&(h=Math.max(h,r.start*c),A=Math.min(A,(r.start+r.count)*c));const v=i.attributes.position;let _=1/0;l?_=a.count:v!=null&&(_=v.count),h=Math.max(h,0),A=Math.min(A,_);const S=A-h;return S<0||S===1/0?null:(o.vertexCount=S,o.firstVertex=h,o)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const i of Object.keys(e.attributes).sort()){const r=e.attributes[i];t+=i+",",r.data&&(t+=r.data.stride+","),r.offset&&(t+=r.offset+","),r.itemSize&&(t+=r.itemSize+","),r.normalized&&(t+="n,")}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t}=this;let i=t.customProgramCacheKey();for(const r of vbe(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(r))continue;const s=t[r];let o;if(s!==null){const a=typeof s;a==="number"?o=s!==0?"1":"0":a==="object"?(o="{",s.isTexture&&(o+=s.mapping),o+="}"):o=String(s)}else o=String(s);i+=o+","}return i+=this.clippingContext.cacheKey+",",e.geometry&&(i+=this.getGeometryCacheKey()),e.skeleton&&(i+=e.skeleton.bones.length+","),e.morphTargetInfluences&&(i+=e.morphTargetInfluences.length+","),e.isBatchedMesh&&(i+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(i+=e._colorsTexture.uuid+",")),e.count>1&&(i+=e.uuid+","),ive(i)}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=this._nodes.getCacheKey(this.scene,this.lightsNode);return this.object.receiveShadow&&(e+=1),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.onDispose()}}const Yp=[];class _be{constructor(e,t,i,r,s,o){this.renderer=e,this.nodes=t,this.geometries=i,this.pipelines=r,this.bindings=s,this.info=o,this.chainMaps={}}get(e,t,i,r,s,o,a){const l=this.getChainMap(a);Yp[0]=e,Yp[1]=t,Yp[2]=o,Yp[3]=s;let u=l.get(Yp);return u===void 0?(u=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,i,r,s,o,a),l.set(Yp,u)):(u.updateClipping(o.clippingContext),(u.version!==t.version||u.needsUpdate)&&(u.initialCacheKey!==u.getCacheKey()?(u.dispose(),u=this.get(e,t,i,r,s,o,a)):u.version=t.version)),u}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new ou)}dispose(){this.chainMaps={}}createRenderObject(e,t,i,r,s,o,a,l,u,c){const h=this.getChainMap(c),A=new ybe(e,t,i,r,s,o,a,l,u);return A.onDispose=()=>{this.pipelines.delete(A),this.bindings.delete(A),this.nodes.delete(A),h.delete(A.getChainArray())},A}}class Af{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const Wl={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},yh=16,xbe=211,bbe=212;class Sbe extends Af{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==void 0&&this.backend.destroyAttribute(e),t}update(e,t){const i=this.get(e);if(i.version===void 0)t===Wl.VERTEX?this.backend.createAttribute(e):t===Wl.INDEX?this.backend.createIndexAttribute(e):t===Wl.STORAGE?this.backend.createStorageAttribute(e):t===Wl.INDIRECT&&this.backend.createIndirectStorageAttribute(e),i.version=this._getBufferAttribute(e).version;else{const r=this._getBufferAttribute(e);(i.version<r.version||r.usage===RA)&&(this.backend.updateAttribute(e),i.version=r.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function wbe(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}function sj(n){return n.index!==null?n.index.version:n.attributes.position.version}function lB(n){const e=[],t=n.index,i=n.attributes.position;if(t!==null){const s=t.array;for(let o=0,a=s.length;o<a;o+=3){const l=s[o+0],u=s[o+1],c=s[o+2];e.push(l,u,u,c,c,l)}}else{const s=i.array;for(let o=0,a=s.length/3-1;o<a;o+=3){const l=o+0,u=o+1,c=o+2;e.push(l,u,u,c,c,l)}}const r=new(wbe(e)?RH:MH)(e,1);return r.version=sj(n),r}class Ebe extends Af{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,i=this.get(t);i.initialized=!0,this.info.memory.geometries++;const r=()=>{this.info.memory.geometries--;const s=t.index,o=e.getAttributes();s!==null&&this.attributes.delete(s);for(const l of o)this.attributes.delete(l);const a=this.wireframes.get(t);a!==void 0&&this.attributes.delete(a),t.removeEventListener("dispose",r)};t.addEventListener("dispose",r)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,Wl.STORAGE):this.updateAttribute(s,Wl.VERTEX);const i=this.getIndex(e);i!==null&&this.updateAttribute(i,Wl.INDEX);const r=e.geometry.indirect;r!==null&&this.updateAttribute(r,Wl.INDIRECT)}updateAttribute(e,t){const i=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,i)):this.attributeCall.get(e.data)!==i&&(this.attributes.update(e,t),this.attributeCall.set(e.data,i),this.attributeCall.set(e,i)):this.attributeCall.get(e)!==i&&(this.attributes.update(e,t),this.attributeCall.set(e,i))}getIndirect(e){return e.geometry.indirect}getIndex(e){const{geometry:t,material:i}=e;let r=t.index;if(i.wireframe===!0){const s=this.wireframes;let o=s.get(t);o===void 0?(o=lB(t),s.set(t,o)):o.version!==sj(t)&&(this.attributes.delete(o),o=lB(t),s.set(t,o)),r=o}return r}}class Tbe{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.compute={calls:0,frameCalls:0,timestamp:0,previousFrameCalls:0,timestampCalls:0},this.memory={geometries:0,textures:0}}update(e,t,i){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=i*(t/3):e.isPoints?this.render.points+=i*t:e.isLineSegments?this.render.lines+=i*(t/2):e.isLine?this.render.lines+=i*(t-1):console.error("THREE.WebGPUInfo: Unknown object type.")}updateTimestamp(e,t){this[e].timestampCalls===0&&(this[e].timestamp=0),this[e].timestamp+=t,this[e].timestampCalls++,this[e].timestampCalls>=this[e].previousFrameCalls&&(this[e].timestampCalls=0)}reset(){const e=this.render.frameCalls;this.render.previousFrameCalls=e;const t=this.compute.frameCalls;this.compute.previousFrameCalls=t,this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class oj{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Cbe extends oj{constructor(e,t,i){super(e),this.vertexProgram=t,this.fragmentProgram=i}}class Mbe extends oj{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let Rbe=0;class xT{constructor(e,t,i=null,r=null){this.id=Rbe++,this.code=e,this.stage=t,this.transforms=i,this.attributes=r,this.usedTimes=0}}class Pbe extends Af{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:i}=this,r=this.get(e);if(this._needsComputeUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const o=this.nodes.getForCompute(e);let a=this.programs.compute.get(o.computeShader);a===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),a=new xT(o.computeShader,"compute",o.transforms,o.nodeAttributes),this.programs.compute.set(o.computeShader,a),i.createProgram(a));const l=this._getComputeCacheKey(e,a);let u=this.caches.get(l);u===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),u=this._getComputePipeline(e,a,l,t)),u.usedTimes++,a.usedTimes++,r.version=e.version,r.pipeline=u}return r.pipeline}getForRender(e,t=null){const{backend:i}=this,r=this.get(e);if(this._needsRenderUpdate(e)){const s=r.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const o=e.getNodeBuilderState();let a=this.programs.vertex.get(o.vertexShader);a===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),a=new xT(o.vertexShader,"vertex"),this.programs.vertex.set(o.vertexShader,a),i.createProgram(a));let l=this.programs.fragment.get(o.fragmentShader);l===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),l=new xT(o.fragmentShader,"fragment"),this.programs.fragment.set(o.fragmentShader,l),i.createProgram(l));const u=this._getRenderCacheKey(e,a,l);let c=this.caches.get(u);c===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),c=this._getRenderPipeline(e,a,l,u,t)):e.pipeline=c,c.usedTimes++,a.usedTimes++,l.usedTimes++,r.pipeline=c}return r.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,i,r){i=i||this._getComputeCacheKey(e,t);let s=this.caches.get(i);return s===void 0&&(s=new Mbe(i,t),this.caches.set(i,s),this.backend.createComputePipeline(s,r)),s}_getRenderPipeline(e,t,i,r,s){r=r||this._getRenderCacheKey(e,t,i);let o=this.caches.get(r);return o===void 0&&(o=new Cbe(r,t,i),this.caches.set(r,o),e.pipeline=o,this.backend.createRenderPipeline(e,s)),o}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,i){return t.id+","+i.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,i=e.stage;this.programs[i].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class Nbe extends Af{constructor(e,t,i,r,s,o){super(),this.backend=e,this.textures=i,this.pipelines=s,this.attributes=r,this.nodes=t,this.info=o,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const i of t){const r=this.get(i);r.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,t),r.bindGroup=i)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const i of t){const r=this.get(i);r.bindGroup===void 0&&(this._init(i),this.backend.createBindings(i,t),r.bindGroup=i)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isStorageBuffer){const i=t.attribute,r=i.isIndirectStorageBufferAttribute?Wl.INDIRECT:Wl.STORAGE;this.attributes.update(i,r)}}_update(e,t){const{backend:i}=this;let r=!1;for(const s of e.bindings)if(!(s.isNodeUniformsGroup&&!this.nodes.updateGroup(s))){if(s.isUniformBuffer)s.update()&&i.updateBinding(s);else if(s.isSampler)s.update();else if(s.isSampledTexture){s.needsBindingsUpdate(this.textures.get(s.texture).generation)&&(r=!0);const o=s.update(),a=s.texture;o&&this.textures.updateTexture(a);const l=i.get(a);if(i.isWebGPUBackend===!0&&l.texture===void 0&&l.externalTexture===void 0&&(console.error("Bindings._update: binding should be available:",s,o,a,s.textureNode.value,r),this.textures.updateTexture(a),r=!0),a.isStorageTexture===!0){const u=this.get(a);s.store===!0?u.needsMipmap=!0:this.textures.needsMipmaps(a)&&u.needsMipmap===!0&&(this.backend.generateMipmaps(a),u.needsMipmap=!1)}}}r===!0&&this.backend.updateBindings(e,t)}}function Ibe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function uB(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function cB(n){return(n.transmission>0||n.transmissionNode)&&n.side===XA&&n.forceSinglePass===!1}class Dbe{constructor(e,t,i){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,i),this.lightsArray=[],this.scene=t,this.camera=i,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,i,r,s,o){let a=this.renderItems[this.renderItemsIndex];return a===void 0?(a={id:e.id,object:e,geometry:t,material:i,groupOrder:r,renderOrder:e.renderOrder,z:s,group:o},this.renderItems[this.renderItemsIndex]=a):(a.id=e.id,a.object=e,a.geometry=t,a.material=i,a.groupOrder=r,a.renderOrder=e.renderOrder,a.z=s,a.group=o),this.renderItemsIndex++,a}push(e,t,i,r,s,o){const a=this.getNextRenderItem(e,t,i,r,s,o);e.occlusionTest===!0&&this.occlusionQueryCount++,i.transparent===!0||i.transmission>0?(cB(i)&&this.transparentDoublePass.push(a),this.transparent.push(a)):this.opaque.push(a)}unshift(e,t,i,r,s,o){const a=this.getNextRenderItem(e,t,i,r,s,o);i.transparent===!0||i.transmission>0?(cB(i)&&this.transparentDoublePass.unshift(a),this.transparent.unshift(a)):this.opaque.unshift(a)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||Ibe),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||uB),this.transparent.length>1&&this.transparent.sort(t||uB)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const i=this.renderItems[e];if(i.id===null)break;i.id=null,i.object=null,i.geometry=null,i.material=null,i.groupOrder=null,i.renderOrder=null,i.z=null,i.group=null}}}class kbe{constructor(e){this.lighting=e,this.lists=new ou}get(e,t){const i=this.lists,r=[e,t];let s=i.get(r);return s===void 0&&(s=new Dbe(this.lighting,e,t),i.set(r,s)),s}dispose(){this.lists=new ou}}let Lbe=0;class Fbe{constructor(){this.id=Lbe++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new pi,this.scissor=!1,this.scissorValue=new pi,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.sampleCount=1,this.width=0,this.height=0,this.isRenderContext=!0}getCacheKey(){return aj(this)}}function aj(n){const{textures:e,activeCubeFace:t}=n,i=[t];for(const r of e)i.push(r.id);return XH(i)}class Bbe{constructor(){this.chainMaps={}}get(e,t,i=null){const r=[e,t];let s;if(i===null)s="default";else{const l=i.texture.format;s=`${i.textures.length}:${l}:${i.samples}:${i.depthBuffer}:${i.stencilBuffer}`}const o=this.getChainMap(s);let a=o.get(r);return a===void 0&&(a=new Fbe,o.set(r,a)),i!==null&&(a.sampleCount=i.samples===0?1:i.samples),a}getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new ou)}dispose(){this.chainMaps={}}}const Obe=new Pe;class Ube extends Af{constructor(e,t,i){super(),this.renderer=e,this.backend=t,this.info=i}updateRenderTarget(e,t=0){const i=this.get(e),r=e.samples===0?1:e.samples,s=i.depthTextureMips||(i.depthTextureMips={}),o=e.textures,a=this.getSize(o[0]),l=a.width>>t,u=a.height>>t;let c=e.depthTexture||s[t];const h=e.depthBuffer===!0||e.stencilBuffer===!0;let A=!1;c===void 0&&h&&(c=new em,c.format=e.stencilBuffer?D0:wd,c.type=e.stencilBuffer?Iv:rs,c.image.width=l,c.image.height=u,s[t]=c),(i.width!==a.width||a.height!==i.height)&&(A=!0,c&&(c.needsUpdate=!0,c.image.width=l,c.image.height=u)),i.width=a.width,i.height=a.height,i.textures=o,i.depthTexture=c||null,i.depth=e.depthBuffer,i.stencil=e.stencilBuffer,i.renderTarget=e,i.sampleCount!==r&&(A=!0,c&&(c.needsUpdate=!0),i.sampleCount=r);const v={sampleCount:r};for(let _=0;_<o.length;_++){const S=o[_];A&&(S.needsUpdate=!0),this.updateTexture(S,v)}if(c&&this.updateTexture(c,v),i.initialized!==!0){i.initialized=!0;const _=()=>{e.removeEventListener("dispose",_);for(let S=0;S<o.length;S++)this._destroyTexture(o[S]);c&&this._destroyTexture(c),this.delete(e)};e.addEventListener("dispose",_)}}updateTexture(e,t={}){const i=this.get(e);if(i.initialized===!0&&i.version===e.version)return;const r=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(r&&i.initialized===!0&&(s.destroySampler(e),s.destroyTexture(e)),e.isFramebufferTexture){const u=this.renderer.getRenderTarget();u?e.type=u.texture.type:e.type=Uh}const{width:o,height:a,depth:l}=this.getSize(e);if(t.width=o,t.height=a,t.depth=l,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,o,a):1,r||e.isStorageTexture===!0)s.createSampler(e),s.createTexture(e,t),i.generation=e.version;else if(i.initialized!==!0&&s.createSampler(e),e.version>0){const c=e.image;if(c===void 0)console.warn("THREE.Renderer: Texture marked for update but image is undefined.");else if(c.complete===!1)console.warn("THREE.Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const h=[];for(const A of e.images)h.push(A);t.images=h}else t.image=c;(i.isDefaultTexture===void 0||i.isDefaultTexture===!0)&&(s.createTexture(e,t),i.isDefaultTexture=!1,i.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t),t.needsMipmaps&&e.mipmaps.length===0&&s.generateMipmaps(e)}}else s.createDefaultTexture(e),i.isDefaultTexture=!0,i.generation=e.version;if(i.initialized!==!0){i.initialized=!0,i.generation=e.version,this.info.memory.textures++;const u=()=>{e.removeEventListener("dispose",u),this._destroyTexture(e),this.info.memory.textures--};e.addEventListener("dispose",u)}i.version=e.version}getSize(e,t=Obe){let i=e.images?e.images[0]:e.image;return i?(i.image!==void 0&&(i=i.image),t.width=i.width,t.height=i.height,t.depth=e.isCubeTexture?6:i.depth||1):t.width=t.height=t.depth=1,t}getMipLevels(e,t,i){let r;return e.isCompressedTexture?r=e.mipmaps.length:r=Math.floor(Math.log2(Math.max(t,i)))+1,r}needsMipmaps(e){return this.isEnvironmentTexture(e)||e.isCompressedTexture===!0||e.generateMipmaps}isEnvironmentTexture(e){const t=e.mapping;return t===Pv||t===Nv||t===Fd||t===I0}_destroyTexture(e){this.backend.destroySampler(e),this.backend.destroyTexture(e),this.delete(e)}}class lN extends mi{constructor(e,t,i,r=1){super(e,t,i),this.a=r}set(e,t,i,r=1){return this.a=r,super.set(e,t,i)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class zbe extends gi{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getHash(){return this.uuid}generate(){return this.name}}class Vbe extends Cn{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this.isStackNode=!0}getNodeType(e){return this.outputNode?this.outputNode.getNodeType(e):"void"}add(e){return this.nodes.push(e),this}If(e,t){const i=new K2(t);return this._currentCond=Eo(e,i),this.add(this._currentCond)}ElseIf(e,t){const i=new K2(t),r=Eo(e,i);return this._currentCond.elseNode=r,this._currentCond=r,this}Else(e){return this._currentCond.elseNode=new K2(e),this}build(e,...t){const i=t$();Bb(this);for(const r of this.nodes)r.build(e,"void");return Bb(i),this.outputNode?this.outputNode.build(e,...t):super.build(e,...t)}else(...e){return console.warn("TSL.StackNode: .else() has been renamed to .Else()."),this.Else(...e)}elseif(...e){return console.warn("TSL.StackNode: .elseif() has been renamed to .ElseIf()."),this.ElseIf(...e)}}const bT=Je(Vbe);new hh;new Pe;new Pe;new Pe;new ji;new Pe(0,0,-1);new pi;new Pe;new Pe;new pi;new Jn;const Gbe=new J0;Q1.flipX();Gbe.depthTexture=new em(1,1);const ST=new G6(-1,1,1,-1,0,1);class qbe extends np{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new ic([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new ic(t,2))}}const Hbe=new qbe;class lj extends Ud{constructor(e=null){super(Hbe,e),this.camera=ST,this.isQuadMesh=!0}renderAsync(e){return e.renderAsync(this,ST)}render(e){e.render(this,ST)}}const Jm=new Ml,wT=new ji;class Co extends Cn{static get type(){return"SceneNode"}constructor(e=Co.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,i=this.scene!==null?this.scene:e.scene;let r;return t===Co.BACKGROUND_BLURRINESS?r=tr("backgroundBlurriness","float",i):t===Co.BACKGROUND_INTENSITY?r=tr("backgroundIntensity","float",i):t===Co.BACKGROUND_ROTATION?r=En("mat4").label("backgroundRotation").setGroup($n).onRenderUpdate(()=>{const s=i.background;return s!==null&&s.isTexture&&s.mapping!==C6?(Jm.copy(i.backgroundRotation),Jm.x*=-1,Jm.y*=-1,Jm.z*=-1,wT.makeRotationFromEuler(Jm)):wT.identity(),wT}):console.error("THREE.SceneNode: Unknown scope:",t),r}}Co.BACKGROUND_BLURRINESS="backgroundBlurriness";Co.BACKGROUND_INTENSITY="backgroundIntensity";Co.BACKGROUND_ROTATION="backgroundRotation";const $be=gt(Co,Co.BACKGROUND_BLURRINESS),hB=gt(Co,Co.BACKGROUND_INTENSITY),jbe=gt(Co,Co.BACKGROUND_ROTATION),IA={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},es={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},ts={Store:"store",Discard:"discard"},Sr={Load:"load",Clear:"clear"},ET={CCW:"ccw",CW:"cw"},TT={None:"none",Front:"front",Back:"back"},F0={Uint16:"uint16",Uint32:"uint32"},Ae={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10uFloat:"rgb10a2unorm",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Stencil8:"stencil8",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},CT={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},id={Linear:"linear",Nearest:"nearest"},vn={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDstColor:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},Uf={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},fB={None:0,Red:1,Green:2,Blue:4,Alpha:8,All:15},nh={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},XR={Uniform:"uniform",Storage:"storage",ReadOnlyStorage:"read-only-storage"},dB={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},eg={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},pB={OneD:"1d",TwoD:"2d",ThreeD:"3d"},Sa={OneD:"1d",TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",CubeArray:"cube-array",ThreeD:"3d"},Wbe={All:"all",StencilOnly:"stencil-only",DepthOnly:"depth-only"},Y_={Vertex:"vertex",Instance:"instance"},YR={DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups"},Xbe=new Jn;class Ybe extends Uv{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return e.object.isQuadMesh&&this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class AB extends Ybe{static get type(){return"PassMultipleTextureNode"}constructor(e,t,i=!1){super(e,null),this.textureName=t,this.previousTexture=i}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){return new this.constructor(this.passNode,this.textureName,this.previousTexture)}}class yw extends Nr{static get type(){return"PassNode"}constructor(e,t,i,r={}){super("vec4"),this.scope=e,this.scene=t,this.camera=i,this.options=r,this._pixelRatio=1,this._width=1,this._height=1;const s=new em;s.isRenderTargetTexture=!0,s.name="depth";const o=new J0(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:ec,...r});o.texture.name="output",o.depthTexture=s,this.renderTarget=o,this.updateBeforeType=Nn.FRAME,this._textures={output:o.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=En(0),this._cameraFar=En(0),this._mrt=null,this.isPassNode=!0}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}isGlobal(){return!0}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.isRenderTargetTexture=!0,t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),t.isRenderTargetTexture=!0,this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const i=this._textures[e],r=this.renderTarget.textures.indexOf(i);this.renderTarget.textures[r]=t,this._textures[e]=t,this._previousTextures[e]=i,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=pt(new AB(this,e)),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=pt(new AB(this,e,!0)),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const i=this._cameraNear,r=this._cameraFar;this._viewZNodes[e]=t=V$(this.getTextureNode(e),i,r)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const i=this._cameraNear,r=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=Wg(s,i,r)}return t}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,e.backend.isWebGLBackend===!0&&(this.renderTarget.samples=0),this.renderTarget.depthTexture.isMultisampleRenderTargetTexture=this.renderTarget.samples>1,this.scope===yw.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:i,camera:r}=this;this._pixelRatio=t.getPixelRatio();const s=t.getSize(Xbe);this.setSize(s.width,s.height);const o=t.getRenderTarget(),a=t.getMRT();this._cameraNear.value=r.near,this._cameraFar.value=r.far;for(const l in this._previousTextures)this.toggleTexture(l);t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.render(i,r),t.setRenderTarget(o),t.setMRT(a)}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget.setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}yw.COLOR="color";yw.DEPTH="depth";const Qbe=Tt(([n,e])=>n.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Kbe=Tt(([n,e])=>(n=n.mul(e),n.div(n.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Zbe=Tt(([n,e])=>{n=n.mul(e),n=n.sub(.004).max(0);const t=n.mul(n.mul(6.2).add(.5)),i=n.mul(n.mul(6.2).add(1.7)).add(.06);return t.div(i).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Jbe=Tt(([n])=>{const e=n.mul(n.add(.0245786)).sub(90537e-9),t=n.mul(n.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),eSe=Tt(([n,e])=>{const t=no(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),i=no(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return n=n.mul(e).div(.6),n=t.mul(n),n=Jbe(n),n=i.mul(n),n.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),tSe=no(Xe(1.6605,-.1246,-.0182),Xe(-.5876,1.1329,-.1006),Xe(-.0728,-.0083,1.1187)),nSe=no(Xe(.6274,.0691,.0164),Xe(.3293,.9195,.088),Xe(.0433,.0113,.8956)),iSe=Tt(([n])=>{const e=Xe(n).toVar(),t=Xe(e.mul(e)).toVar(),i=Xe(t.mul(t)).toVar();return Qe(15.5).mul(i.mul(t)).sub(Un(40.14,i.mul(e))).add(Un(31.96,i).sub(Un(6.868,t.mul(e))).add(Un(.4298,t).add(Un(.1191,e).sub(.00232))))}),rSe=Tt(([n,e])=>{const t=Xe(n).toVar(),i=no(Xe(.856627153315983,.137318972929847,.11189821299995),Xe(.0951212405381588,.761241990602591,.0767994186031903),Xe(.0482516061458583,.101439036467562,.811302368396859)),r=no(Xe(1.1271005818144368,-.1413297634984383,-.14132976349843826),Xe(-.11060664309660323,1.157823702216272,-.11060664309660294),Xe(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=Qe(-12.47393),o=Qe(4.026069);return t.mulAssign(e),t.assign(nSe.mul(t)),t.assign(i.mul(t)),t.assign(Ua(t,1e-10)),t.assign(rc(t)),t.assign(t.sub(s).div(o.sub(s))),t.assign(gc(t,0,1)),t.assign(iSe(t)),t.assign(r.mul(t)),t.assign(hw(Ua(Xe(0),t),Xe(2.2))),t.assign(tSe.mul(t)),t.assign(gc(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),sSe=Tt(([n,e])=>{const t=Qe(.76),i=Qe(.15);n=n.mul(e);const r=j1(n.r,j1(n.g,n.b)),s=Eo(r.lessThan(.08),r.sub(Un(6.25,r.mul(r))),.04);n.subAssign(s);const o=Ua(n.r,Ua(n.g,n.b));ls(o.lessThan(t),()=>n);const a=ta(1,t),l=ta(1,a.mul(a).div(o.add(a.sub(t))));n.mulAssign(l.div(o));const u=ta(1,tf(1,i.mul(o.sub(l)).add(1)));return Bi(n,Xe(l),u)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class Cs extends Cn{static get type(){return"CodeNode"}constructor(e="",t=[],i=""){super("code"),this.isCodeNode=!0,this.code=e,this.language=i,this.includes=t}isGlobal(){return!0}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const r of t)r.build(e);const i=e.getCodeFromNode(this,this.getNodeType(e));return i.code=this.code,i.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}class oSe extends Cs{static get type(){return"FunctionNode"}constructor(e="",t=[],i=""){super(e,t,i)}getNodeType(e){return this.getNodeFunction(e).type}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let i=t.nodeFunction;return i===void 0&&(i=e.parser.parseFunction(this.code),t.nodeFunction=i),i}generate(e,t){super.generate(e);const i=this.getNodeFunction(e),r=i.name,s=i.type,o=e.getCodeFromNode(this,s);r!==""&&(o.name=r);const a=e.getPropertyName(o),l=this.getNodeFunction(e).getCode(a);return o.code=l+`
`,t==="property"?a:e.format(`${a}()`,s,t)}}class uj extends Cn{static get type(){return"FogNode"}constructor(e,t){super("float"),this.isFogNode=!0,this.colorNode=e,this.factorNode=t}getViewZNode(e){let t;const i=e.context.getViewZ;return i!==void 0&&(t=i(this)),(t||os.z).negate()}setup(){return this.factorNode}}class aSe extends uj{static get type(){return"FogRangeNode"}constructor(e,t,i){super(e),this.isFogRangeNode=!0,this.nearNode=t,this.farNode=i}setup(e){const t=this.getViewZNode(e);return zd(this.nearNode,this.farNode,t)}}const lSe=Je(aSe);class uSe extends uj{static get type(){return"FogExp2Node"}constructor(e,t){super(e),this.isFogExp2Node=!0,this.densityNode=t}setup(e){const t=this.getViewZNode(e),i=this.densityNode;return i.mul(i,t,t).negate().exp().oneMinus()}}const cSe=Je(uSe);class hSe extends Cn{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:i}=e;i.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}Je(hSe);class cu extends Nr{static get type(){return"AtomicFunctionNode"}constructor(e,t,i,r=null){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=i,this.storeNode=r}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=this.method,i=this.getNodeType(e),r=this.getInputType(e),s=this.pointerNode,o=this.valueNode,a=[];a.push(`&${s.build(e,r)}`),a.push(o.build(e,r));const l=`${e.getMethod(t,i)}( ${a.join(", ")} )`;if(this.storeNode!==null){const u=this.storeNode.build(e,r);e.addLineFlowCode(`${u} = ${l}`,this)}else e.addLineFlowCode(l,this)}}cu.ATOMIC_LOAD="atomicLoad";cu.ATOMIC_STORE="atomicStore";cu.ATOMIC_ADD="atomicAdd";cu.ATOMIC_SUB="atomicSub";cu.ATOMIC_MAX="atomicMax";cu.ATOMIC_MIN="atomicMin";cu.ATOMIC_AND="atomicAnd";cu.ATOMIC_OR="atomicOr";cu.ATOMIC_XOR="atomicXor";Je(cu);let Q_;function uN(n){Q_=Q_||new WeakMap;let e=Q_.get(n);return e===void 0&&Q_.set(n,e={}),e}function cj(n){const e=uN(n);return e.position||(e.position=En(new Pe).setGroup($n).onRenderUpdate((t,i)=>i.value.setFromMatrixPosition(n.matrixWorld)))}function fSe(n){const e=uN(n);return e.targetPosition||(e.targetPosition=En(new Pe).setGroup($n).onRenderUpdate((t,i)=>i.value.setFromMatrixPosition(n.target.matrixWorld)))}function cN(n){const e=uN(n);return e.viewPosition||(e.viewPosition=En(new Pe).setGroup($n).onRenderUpdate(({camera:t},i)=>{i.value=i.value||new Pe,i.value.setFromMatrixPosition(n.matrixWorld),i.value.applyMatrix4(t.matrixWorldInverse)}))}const hj=n=>Pc.transformDirection(cj(n).sub(fSe(n))),dSe=n=>n.sort((e,t)=>e.id-t.id),pSe=(n,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===n)return t;return null},MT=new WeakMap;class fj extends Cn{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Xe().toVar("totalDiffuse"),this.totalSpecularNode=Xe().toVar("totalSpecular"),this.outgoingLightNode=Xe().toVar("outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const i of this._lightNodes)t.push(i.getSelf().getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getDataFromNode(this);for(const i of t.nodes)i.build(e)}setupLightsNode(e){const t=[],i=this._lightNodes,r=dSe(this._lights),s=e.renderer.library;for(const o of r)if(o.isNode)t.push(pt(o));else{let a=null;if(i!==null&&(a=pSe(o.id,i)),a===null){const l=s.getLightNodeClass(o.constructor);if(l===null){console.warn(`LightsNode.setupNodeLights: Light node not found for ${o.constructor.name}`);continue}let u=null;MT.has(o)?u=MT.get(o):(u=pt(new l(o)),MT.set(o,u)),t.push(u)}}this._lightNodes=t}setupLights(e,t){for(const i of t)i.build(e)}setup(e){this._lightNodes===null&&this.setupLightsNode(e);const t=e.context,i=t.lightingModel;let r=this.outgoingLightNode;if(i){const{_lightNodes:s,totalDiffuseNode:o,totalSpecularNode:a}=this;t.outgoingLight=r;const l=e.addStack(),u=e.getDataFromNode(this);u.nodes=l.nodes,i.start(t,l,e),this.setupLights(e,s),i.indirect(t,l,e);const{backdrop:c,backdropAlpha:h}=t,{directDiffuse:A,directSpecular:v,indirectDiffuse:_,indirectSpecular:S}=t.reflectedLight;let w=A.add(_);c!==null&&(h!==null?w=Xe(h.mix(w,c)):w=Xe(c),t.material.transparent=!0),o.assign(w),a.assign(v.add(S)),r.assign(o.add(a)),i.finish(t,l,e),r=r.bypass(e.removeStack())}return r}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const ASe=Tt(({depthTexture:n,shadowCoord:e})=>pr(n,e.xy).compare(e.z)),mSe=Tt(({depthTexture:n,shadowCoord:e,shadow:t})=>{const i=(S,w)=>pr(n,S).compare(w),r=tr("mapSize","vec2",t).setGroup($n),s=tr("radius","float",t).setGroup($n),o=Pt(1).div(r),a=o.x.negate().mul(s),l=o.y.negate().mul(s),u=o.x.mul(s),c=o.y.mul(s),h=a.div(2),A=l.div(2),v=u.div(2),_=c.div(2);return io(i(e.xy.add(Pt(a,l)),e.z),i(e.xy.add(Pt(0,l)),e.z),i(e.xy.add(Pt(u,l)),e.z),i(e.xy.add(Pt(h,A)),e.z),i(e.xy.add(Pt(0,A)),e.z),i(e.xy.add(Pt(v,A)),e.z),i(e.xy.add(Pt(a,0)),e.z),i(e.xy.add(Pt(h,0)),e.z),i(e.xy,e.z),i(e.xy.add(Pt(v,0)),e.z),i(e.xy.add(Pt(u,0)),e.z),i(e.xy.add(Pt(h,_)),e.z),i(e.xy.add(Pt(0,_)),e.z),i(e.xy.add(Pt(v,_)),e.z),i(e.xy.add(Pt(a,c)),e.z),i(e.xy.add(Pt(0,c)),e.z),i(e.xy.add(Pt(u,c)),e.z)).mul(1/17)}),gSe=Tt(({depthTexture:n,shadowCoord:e,shadow:t})=>{const i=(c,h)=>pr(n,c).compare(h),r=tr("mapSize","vec2",t).setGroup($n),s=Pt(1).div(r),o=s.x,a=s.y,l=e.xy,u=pf(l.mul(r).add(.5));return l.subAssign(u.mul(s)),io(i(l,e.z),i(l.add(Pt(o,0)),e.z),i(l.add(Pt(0,a)),e.z),i(l.add(s),e.z),Bi(i(l.add(Pt(o.negate(),0)),e.z),i(l.add(Pt(o.mul(2),0)),e.z),u.x),Bi(i(l.add(Pt(o.negate(),a)),e.z),i(l.add(Pt(o.mul(2),a)),e.z),u.x),Bi(i(l.add(Pt(0,a.negate())),e.z),i(l.add(Pt(0,a.mul(2))),e.z),u.y),Bi(i(l.add(Pt(o,a.negate())),e.z),i(l.add(Pt(o,a.mul(2))),e.z),u.y),Bi(Bi(i(l.add(Pt(o.negate(),a.negate())),e.z),i(l.add(Pt(o.mul(2),a.negate())),e.z),u.x),Bi(i(l.add(Pt(o.negate(),a.mul(2))),e.z),i(l.add(Pt(o.mul(2),a.mul(2))),e.z),u.x),u.y)).mul(1/9)}),vSe=Tt(({depthTexture:n,shadowCoord:e})=>{const t=Qe(1).toVar(),i=pr(n).uv(e.xy).rg,r=y$(e.z,i.x);return ls(r.notEqual(Qe(1)),()=>{const s=e.z.sub(i.x),o=Ua(0,i.y.mul(i.y));let a=o.div(o.add(s.mul(s)));a=gc(ta(a,.3).div(.95-.3)),t.assign(gc(Ua(r,a)))}),t}),ySe=Tt(({samples:n,radius:e,size:t,shadowPass:i})=>{const r=Qe(0).toVar(),s=Qe(0).toVar(),o=n.lessThanEqual(Qe(1)).select(Qe(0),Qe(2).div(n.sub(1))),a=n.lessThanEqual(Qe(1)).select(Qe(0),Qe(-1));jl({start:dr(0),end:dr(n),type:"int",condition:"<"},({i:u})=>{const c=a.add(Qe(u).mul(o)),h=i.uv(io(mw.xy,Pt(0,c).mul(e)).div(t)).x;r.addAssign(h),s.addAssign(h.mul(h))}),r.divAssign(n),s.divAssign(n);const l=Q6(s.sub(r.mul(r)));return Pt(r,l)}),_Se=Tt(({samples:n,radius:e,size:t,shadowPass:i})=>{const r=Qe(0).toVar(),s=Qe(0).toVar(),o=n.lessThanEqual(Qe(1)).select(Qe(0),Qe(2).div(n.sub(1))),a=n.lessThanEqual(Qe(1)).select(Qe(0),Qe(-1));jl({start:dr(0),end:dr(n),type:"int",condition:"<"},({i:u})=>{const c=a.add(Qe(u).mul(o)),h=i.uv(io(mw.xy,Pt(c,0).mul(e)).div(t));r.addAssign(h.x),s.addAssign(io(h.y.mul(h.y),h.x.mul(h.x)))}),r.divAssign(n),s.divAssign(n);const l=Q6(s.sub(r.mul(r)));return Pt(r,l)}),xSe=[ASe,mSe,gSe,vSe];let Qp=null;const K_=new lj;class bSe extends Cn{static get type(){return"ShadowNode"}constructor(e,t=null){super(),this.light=e,this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this.updateBeforeType=Nn.RENDER,this._node=null,this.isShadowNode=!0}setupShadow(e){const{object:t,renderer:i}=e;Qp===null&&(Qp=new Pr,Qp.fragmentNode=wn(0,0,0,1),Qp.isShadowNodeMaterial=!0,Qp.name="ShadowMaterial");const r=this.shadow,s=i.shadowMap.type,o=new em(r.mapSize.width,r.mapSize.height);o.compareFunction=D6;const a=e.createRenderTarget(r.mapSize.width,r.mapSize.height);if(a.depthTexture=o,r.camera.updateProjectionMatrix(),s===T_){o.compareFunction=null,this.vsmShadowMapVertical=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:z1,type:ec}),this.vsmShadowMapHorizontal=e.createRenderTarget(r.mapSize.width,r.mapSize.height,{format:z1,type:ec});const M=pr(o),R=pr(this.vsmShadowMapVertical.texture),N=tr("blurSamples","float",r).setGroup($n),B=tr("radius","float",r).setGroup($n),T=tr("mapSize","vec2",r).setGroup($n);let D=this.vsmMaterialVertical||(this.vsmMaterialVertical=new Pr);D.fragmentNode=ySe({samples:N,radius:B,size:T,shadowPass:M}).context(e.getSharedContext()),D.name="VSMVertical",D=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new Pr),D.fragmentNode=_Se({samples:N,radius:B,size:T,shadowPass:R}).context(e.getSharedContext()),D.name="VSMHorizontal"}const l=tr("intensity","float",r).setGroup($n),u=tr("bias","float",r).setGroup($n),c=tr("normalBias","float",r).setGroup($n),h=t.material.shadowPositionNode||zR;let A=En(r.matrix).setGroup($n).mul(h.add(nN.mul(c))),v;if(r.camera.isOrthographicCamera||i.logarithmicDepthBuffer!==!0)A=A.xyz.div(A.w),v=A.z,i.coordinateSystem===Od&&(v=v.mul(2).sub(1));else{const M=A.w;A=A.xy.div(M);const R=En("float").onRenderUpdate(()=>r.camera.near),N=En("float").onRenderUpdate(()=>r.camera.far);v=G$(M,R,N)}A=Xe(A.x,A.y.oneMinus(),v.add(u));const _=A.x.greaterThanEqual(0).and(A.x.lessThanEqual(1)).and(A.y.greaterThanEqual(0)).and(A.y.lessThanEqual(1)).and(A.z.lessThanEqual(1)),S=r.filterNode||xSe[i.shadowMap.type]||null;if(S===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const w=pr(a.texture,A),x=_.select(S({depthTexture:s===T_?this.vsmShadowMapHorizontal.texture:o,shadowCoord:A,shadow:r}),Qe(1));return this.shadowMap=a,this.shadow.map=a,Bi(1,x.rgb.mix(w,1),l.mul(w.a))}setup(e){if(e.renderer.shadowMap.enabled!==!1)return this._node!==null?this._node:this._node=this.setupShadow(e)}updateShadow(e){const{shadowMap:t,light:i,shadow:r}=this,{renderer:s,scene:o,camera:a}=e,l=s.shadowMap.type,u=t.depthTexture.version;this._depthVersionCached=u;const c=o.overrideMaterial;o.overrideMaterial=Qp,t.setSize(r.mapSize.width,r.mapSize.height),r.updateMatrices(i),r.camera.layers.mask=a.layers.mask;const h=s.getRenderTarget(),A=s.getRenderObjectFunction();s.setRenderObjectFunction((v,..._)=>{(v.castShadow===!0||v.receiveShadow&&l===T_)&&s.renderObject(v,..._)}),s.setRenderTarget(t),s.render(o,r.camera),s.setRenderObjectFunction(A),i.isPointLight!==!0&&l===T_&&this.vsmPass(s),s.setRenderTarget(h),o.overrideMaterial=c}vsmPass(e){const{shadow:t}=this;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height),e.setRenderTarget(this.vsmShadowMapVertical),K_.material=this.vsmMaterialVertical,K_.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),K_.material=this.vsmMaterialHorizontal,K_.render(e)}dispose(){this.shadowMap.dispose(),this.shadowMap=null,this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null),this.updateBeforeType=Nn.NONE}updateBefore(e){const{shadow:t}=this;(t.needsUpdate||t.autoUpdate)&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const SSe=(n,e)=>pt(new bSe(n,e));class rp extends nm{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.updateType=Nn.FRAME,this.light=e,this.color=new mi,this.colorNode=En(this.color).setGroup($n),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0}getCacheKey(){return kb(super.getCacheKey(),this.light.id,this.light.castShadow?1:0)}getHash(){return this.light.uuid}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let i=this.shadowColorNode;if(i===null){const r=this.light.shadow.shadowNode;let s;r!==void 0?s=pt(r):s=SSe(this.light),this.shadowNode=s,this.shadowColorNode=i=this.colorNode.mul(s),this.baseColorNode=this.colorNode}this.colorNode=i}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&this.shadowNode.dispose()}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const dj=Tt(n=>{const{lightDistance:e,cutoffDistance:t,decayExponent:i}=n,r=e.pow(i).max(.01).reciprocal();return t.greaterThan(0).select(r.mul(e.div(t).pow4().oneMinus().clamp().pow2()),r)}),wSe=Tt(({color:n,lightViewPosition:e,cutoffDistance:t,decayExponent:i},r)=>{const s=r.context.lightingModel,o=e.sub(os),a=o.normalize(),l=o.length(),u=dj({lightDistance:l,cutoffDistance:t,decayExponent:i}),c=n.mul(u),h=r.context.reflectedLight;s.direct({lightDirection:a,lightColor:c,reflectedLight:h},r.stack,r)});class ESe extends rp{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=En(0).setGroup($n),this.decayExponentNode=En(0).setGroup($n)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setup(){wSe({color:this.colorNode,lightViewPosition:cN(this.light),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode}).append()}}const TSe=Tt(([n,e])=>{const t=n.x,i=n.y,r=n.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(i)),s=s.add(e.element(2).mul(2*.511664).mul(r)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(i)),s=s.add(e.element(5).mul(2*.429043).mul(i).mul(r)),s=s.add(e.element(6).mul(r.mul(r).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(r)),s=s.add(e.element(8).mul(.429043).mul(Un(t,t).sub(Un(i,i)))),s}),Ru=new lN;class CSe extends Af{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,i){const r=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let o=!1;if(s===null)r._clearColor.getRGB(Ru,zh),Ru.a=r._clearColor.a;else if(s.isColor===!0)s.getRGB(Ru,zh),Ru.a=1,o=!0;else if(s.isNode===!0){const a=this.get(e),l=s;Ru.copy(r._clearColor);let u=a.backgroundMesh;if(u===void 0){const h=J6(wn(l).mul(hB),{getUV:()=>jbe.mul(N$),getTextureLevel:()=>$be});let A=VR();A=A.setZ(A.w);const v=new Pr;v.name="Background.material",v.side=Cl,v.depthTest=!1,v.depthWrite=!1,v.fog=!1,v.lights=!1,v.vertexNode=A,v.colorNode=h,a.backgroundMeshNode=h,a.backgroundMesh=u=new Ud(new U6(1,32,32),v),u.frustumCulled=!1,u.name="Background.mesh",u.onBeforeRender=function(_,S,w){this.matrixWorld.copyPosition(w.matrixWorld)}}const c=l.getCacheKey();a.backgroundCacheKey!==c&&(a.backgroundMeshNode.node=wn(l).mul(hB),a.backgroundMeshNode.needsUpdate=!0,u.material.needsUpdate=!0,a.backgroundCacheKey=c),t.unshift(u,u.geometry,u.material,0,0,null)}else console.error("THREE.Renderer: Unsupported background configuration.",s);if(r.autoClear===!0||o===!0){const a=i.clearColorValue;a.r=Ru.r,a.g=Ru.g,a.b=Ru.b,a.a=Ru.a,(r.backend.isWebGLBackend===!0||r.alpha===!0)&&(a.r*=a.a,a.g*=a.a,a.b*=a.a),i.depthClearValue=r._clearDepth,i.stencilClearValue=r._clearStencil,i.clearColor=r.autoClearColor===!0,i.clearDepth=r.autoClearDepth===!0,i.clearStencil=r.autoClearStencil===!0}else i.clearColor=!1,i.clearDepth=!1,i.clearStencil=!1}}let MSe=0;class QR{constructor(e="",t=[],i=0,r=[]){this.name=e,this.bindings=t,this.index=i,this.bindingsReference=r,this.id=MSe++}}class RSe{constructor(e,t,i,r,s,o,a,l,u,c=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=i,this.transforms=c,this.nodeAttributes=r,this.bindings=s,this.updateNodes=o,this.updateBeforeNodes=a,this.updateAfterNodes=l,this.monitor=u,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const r=new QR(t.name,[],t.index,t);e.push(r);for(const s of t.bindings)r.bindings.push(s.clone())}else e.push(t);return e}}class mB{constructor(e,t,i=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=i}}class PSe{constructor(e,t,i){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=i.getSelf()}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class pj{constructor(e,t){this.isNodeVar=!0,this.name=e,this.type=t}}class NSe extends pj{constructor(e,t){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0}}class ISe{constructor(e,t,i=""){this.name=e,this.type=t,this.code=i,Object.defineProperty(this,"isNodeCode",{value:!0})}}let DSe=0;class RT{constructor(e=null){this.id=DSe++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class sp{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class kSe extends sp{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class LSe extends sp{constructor(e,t=new Jn){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class FSe extends sp{constructor(e,t=new Pe){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class BSe extends sp{constructor(e,t=new pi){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class OSe extends sp{constructor(e,t=new mi){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class USe extends sp{constructor(e,t=new zo){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class zSe extends sp{constructor(e,t=new ji){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class VSe extends kSe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class GSe extends LSe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class qSe extends FSe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class HSe extends BSe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class $Se extends OSe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class jSe extends USe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}class WSe extends zSe{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}}const DA=4,gB=[.125,.215,.35,.446,.526,.582],rd=20,PT=new G6(-1,1,1,-1,0,1),XSe=new Lu(90,1),vB=new mi;let NT=null,IT=0,DT=0;const Xf=(1+Math.sqrt(5))/2,Kp=1/Xf,yB=[new Pe(-Xf,Kp,0),new Pe(Xf,Kp,0),new Pe(-Kp,0,Xf),new Pe(Kp,0,Xf),new Pe(0,Xf,-Kp),new Pe(0,Xf,Kp),new Pe(-1,1,-1),new Pe(1,1,-1),new Pe(-1,1,1),new Pe(1,1,1)],YSe=[3,1,5,0,4,2],kT=zxe(dw(),vc("faceIndex")).normalize(),hN=Xe(kT.x,kT.y.negate(),kT.z);class QSe{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}fromScene(e,t=0,i=.1,r=100){NT=this._renderer.getRenderTarget(),IT=this._renderer.getActiveCubeFace(),DT=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=xB(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=bB(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(NT,IT,DT),e.scissorTest=!1,Z_(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Fd||e.mapping===I0?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),NT=this._renderer.getRenderTarget(),IT=this._renderer.getActiveCubeFace(),DT=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:ua,minFilter:ua,generateMipmaps:!1,type:ec,format:K0,colorSpace:zh},r=_B(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_B(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas,lodMeshes:this._lodMeshes}=KSe(s)),this._blurMaterial=ZSe(s,e,t)}return r}async _compileMaterial(e){const t=new Ud(this._lodPlanes[0],e);await this._renderer.compile(t,PT)}_sceneToCubeUV(e,t,i,r){const s=XSe;s.near=t,s.far=i;const o=[-1,1,-1,-1,-1,-1],a=[1,1,1,-1,-1,-1],l=this._renderer,u=l.autoClear;l.getClearColor(vB),l.autoClear=!1;let c=this._backgroundBox;if(c===null){const v=new aw({name:"PMREM.Background",side:Cl,depthWrite:!1,depthTest:!1});c=new Ud(new Lv,v)}let h=!1;const A=e.background;A?A.isColor&&(c.material.color.copy(A),e.background=null,h=!0):(c.material.color.copy(vB),h=!0),l.setRenderTarget(r),l.clear(),h&&l.render(c,s);for(let v=0;v<6;v++){const _=v%3;_===0?(s.up.set(0,o[v],0),s.lookAt(a[v],0,0)):_===1?(s.up.set(0,0,o[v]),s.lookAt(0,a[v],0)):(s.up.set(0,o[v],0),s.lookAt(0,0,a[v]));const S=this._cubeSize;Z_(r,_*S,v>2?S:0,S,S),l.render(e,s)}l.autoClear=u,e.background=A}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Fd||e.mapping===I0;r?this._cubemapMaterial===null&&(this._cubemapMaterial=xB(e)):this._equirectMaterial===null&&(this._equirectMaterial=bB(e));const s=r?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const o=this._lodMeshes[0];o.material=s;const a=this._cubeSize;Z_(t,0,0,3*a,2*a),i.setRenderTarget(t),i.render(o,PT)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=yB[(r-s-1)%yB.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=this._lodMeshes[r];h.material=u;const A=u.uniforms,v=this._sizeLods[i]-1,_=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*rd-1),S=s/_,w=isFinite(s)?1+Math.floor(c*S):rd;w>rd&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${w} samples when the maximum is set to ${rd}`);const x=[];let M=0;for(let D=0;D<rd;++D){const F=D/S,L=Math.exp(-F*F/2);x.push(L),D===0?M+=L:D<w&&(M+=2*L)}for(let D=0;D<x.length;D++)x[D]=x[D]/M;e.texture.frame=(e.texture.frame||0)+1,A.envMap.value=e.texture,A.samples.value=w,A.weights.array=x,A.latitudinal.value=o==="latitudinal"?1:0,a&&(A.poleAxis.value=a);const{_lodMax:R}=this;A.dTheta.value=_,A.mipInt.value=R-i;const N=this._sizeLods[r],B=3*N*(r>R-DA?r-R+DA:0),T=4*(this._cubeSize-N);Z_(t,B,T,3*N,2*N),l.setRenderTarget(t),l.render(h,PT)}}function KSe(n){const e=[],t=[],i=[],r=[];let s=n;const o=n-DA+1+gB.length;for(let a=0;a<o;a++){const l=Math.pow(2,s);t.push(l);let u=1/l;a>n-DA?u=gB[a-n+DA-1]:a===0&&(u=0),i.push(u);const c=1/(l-2),h=-c,A=1+c,v=[h,h,A,h,A,A,h,h,A,A,h,A],_=6,S=6,w=3,x=2,M=1,R=new Float32Array(w*S*_),N=new Float32Array(x*S*_),B=new Float32Array(M*S*_);for(let D=0;D<_;D++){const F=D%3*2/3-1,L=D>2?0:-1,O=[F,L,0,F+2/3,L,0,F+2/3,L+1,0,F,L,0,F+2/3,L+1,0,F,L+1,0],z=YSe[D];R.set(O,w*S*z),N.set(v,x*S*z);const Q=[z,z,z,z,z,z];B.set(Q,M*S*z)}const T=new np;T.setAttribute("position",new La(R,w)),T.setAttribute("uv",new La(N,x)),T.setAttribute("faceIndex",new La(B,M)),e.push(T),r.push(new Ud(T,null)),s>DA&&s--}return{lodPlanes:e,sizeLods:t,sigmas:i,lodMeshes:r}}function _B(n,e,t){const i=new J0(n,e,t);return i.texture.mapping=pR,i.texture.name="PMREM.cubeUv",i.texture.isPMREMTexture=!0,i.scissorTest=!0,i}function Z_(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function fN(n){const e=new Pr;return e.depthTest=!1,e.depthWrite=!1,e.blending=N0,e.name=`PMREM_${n}`,e}function ZSe(n,e,t){const i=Y1(new Array(rd).fill(0)),r=En(new Pe(0,1,0)),s=En(0),o=Qe(rd),a=En(0),l=En(1),u=pr(null),c=En(0),h=Qe(1/e),A=Qe(1/t),v=Qe(n),_={n:o,latitudinal:a,weights:i,poleAxis:r,outputDirection:hN,dTheta:s,samples:l,envMap:u,mipInt:c,CUBEUV_TEXEL_WIDTH:h,CUBEUV_TEXEL_HEIGHT:A,CUBEUV_MAX_MIP:v},S=fN("blur");return S.uniforms=_,S.fragmentNode=Gxe({..._,latitudinal:a.equal(1)}),S}function xB(n){const e=fN("cubemap");return e.fragmentNode=X1(n,hN),e}function bB(n){const e=fN("equirect");return e.fragmentNode=pr(n,$$(hN),0),e}const SB=new WeakMap,JSe=new Map([[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),ewe=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),J_=n=>/e/g.test(n)?String(n).replace(/\+/g,""):(n=Number(n),n+(n%1?"":".0"));class Aj{constructor(e,t,i){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=i,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.monitor=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.flow={code:""},this.chaining=[],this.stack=bT(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new RT,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.useComparisonMethod=!1}getBindGroupsCache(){let e=SB.get(this.renderer);return e===void 0&&(e=new ou,SB.set(this.renderer,e)),e}createRenderTarget(e,t,i){return new J0(e,t,i)}createCubeRenderTarget(e,t){return new j$(e,t)}createPMREMGenerator(){return new QSe(this.renderer)}includes(e){return this.nodes.includes(e)}_getBindGroup(e,t){const i=this.getBindGroupsCache(),r=[];let s=!0;for(const a of t)r.push(a),s=s&&a.groupNode.shared!==!0;let o;return s?(o=i.get(r),o===void 0&&(o=new QR(e,r,this.bindingsIndexes[e].group,r),i.set(r,o))):o=new QR(e,r,this.bindingsIndexes[e].group,r),o}getBindGroupArray(e,t){const i=this.bindings[t];let r=i[e];return r===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),i[e]=r=[]),r}getBindings(){let e=this.bindGroups;if(e===null){const t={},i=this.bindings;for(const r of E7)for(const s in i[r]){const o=i[r][s];(t[s]||(t[s]=[])).push(...o)}e=[];for(const r in t){const s=t[r],o=this._getBindGroup(r,s);e.push(o)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,i)=>t.bindings[0].groupNode.order-i.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const i=e[t];this.bindingsIndexes[i.name].group=t,i.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==Nn.NONE&&this.updateNodes.push(e.getSelf());for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),i=e.getUpdateAfterType();t!==Nn.NONE&&this.updateBeforeNodes.push(e.getSelf()),i!==Nn.NONE&&this.updateAfterNodes.push(e.getSelf())}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===ua||e.magFilter===mR||e.magFilter===QA||e.magFilter===Ju||e.minFilter===ua||e.minFilter===mR||e.minFilter===QA||e.minFilter===Ju}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}getSharedContext(){return{...this.context},this.context}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const i=this.getDataFromNode(e);return i.cache===void 0&&(i.cache=new RT(t?this.getCache():null)),i.cache}isAvailable(){return!1}getVertexIndex(){console.warn("Abstract function.")}getInstanceIndex(){console.warn("Abstract function.")}getDrawIndex(){console.warn("Abstract function.")}getFrontFacing(){console.warn("Abstract function.")}getFragCoord(){console.warn("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){console.warn("Abstract function.")}generateTextureLod(){console.warn("Abstract function.")}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new mi:e==="vec2"?t=new Jn:e==="vec3"?t=new Pe:e==="vec4"&&(t=new pi)),e==="float")return J_(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${J_(t.r)}, ${J_(t.g)}, ${J_(t.b)} )`;const i=this.getTypeLength(e),r=this.getComponentType(e),s=o=>this.generateConst(r,o);if(i===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(i===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(i===4)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(i>4&&t&&(t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(i>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const i=this.attributes;for(const s of i)if(s.name===e)return s;const r=new mB(e,t);return i.push(r),r}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Qs)return"int";if(t===rs)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;const i=JSe.get(e);return(t==="float"?"":t[0])+i}getTypeFromArray(e){return ewe.get(e.constructor)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const i=t.array,r=e.itemSize,s=e.normalized;let o;return!(e instanceof PH)&&s!==!0&&(o=this.getTypeFromArray(i)),this.getTypeFromLength(r,o)}getTypeLength(e){const t=this.getVectorType(e),i=/vec([2-4])/.exec(t);return i!==null?Number(i[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}addStack(){return this.stack=bT(this.stack),this.stacks.push(t$()||this.stack),Bb(this.stack),this.stack}removeStack(){const e=this.stack;return this.stack=e.parent,Bb(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,i=null){i=i===null?e.isGlobal(this)?this.globalCache:this.cache:i;let r=i.getData(e);return r===void 0&&(r={},i.setData(e,r)),r[t]===void 0&&(r[t]={}),r[t]}getNodeProperties(e,t="any"){const i=this.getDataFromNode(e,t);return i.properties||(i.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const i=this.getDataFromNode(e);let r=i.bufferAttribute;if(r===void 0){const s=this.uniforms.index++;r=new mB("nodeAttribute"+s,t,e),this.bufferAttributes.push(r),i.bufferAttribute=r}return r}getStructTypeFromNode(e,t=this.shaderStage){const i=this.getDataFromNode(e,t);if(i.structType===void 0){const r=this.structs.index++;e.name=`StructType${r}`,this.structs[t].push(e),i.structType=e}return e}getUniformFromNode(e,t,i=this.shaderStage,r=null){const s=this.getDataFromNode(e,i,this.globalCache);let o=s.uniform;if(o===void 0){const a=this.uniforms.index++;o=new PSe(r||"nodeUniform"+a,t,e),this.uniforms[i].push(o),s.uniform=o}return o}getVarFromNode(e,t=null,i=e.getNodeType(this),r=this.shaderStage){const s=this.getDataFromNode(e,r);let o=s.variable;if(o===void 0){const a=this.vars[r]||(this.vars[r]=[]);t===null&&(t="nodeVar"+a.length),o=new pj(t,i),a.push(o),s.variable=o}return o}getVaryingFromNode(e,t=null,i=e.getNodeType(this)){const r=this.getDataFromNode(e,"any");let s=r.varying;if(s===void 0){const o=this.varyings,a=o.length;t===null&&(t="nodeVarying"+a),s=new NSe(t,i),o.push(s),r.varying=s}return s}getCodeFromNode(e,t,i=this.shaderStage){const r=this.getDataFromNode(e);let s=r.code;if(s===void 0){const o=this.codes[i]||(this.codes[i]=[]),a=o.length;s=new ISe("nodeCode"+a,t),o.push(s),r.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:i,flowCodeBlock:r}=this.getDataFromNode(e);let s=!0,o=t;for(;o;){if(r.get(o)===!0){s=!1;break}o=this.getDataFromNode(o).parentNodeBlock}if(s)for(const a of i)this.addLineFlowCode(a)}addLineFlowCodeBlock(e,t,i){const r=this.getDataFromNode(e),s=r.flowCodes||(r.flowCodes=[]),o=r.flowCodeBlock||(r.flowCodeBlock=new WeakMap);s.push(t),o.set(i,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),i=this.flowChildNode(e,t);return this.flowsData.set(e,i),i}buildFunctionNode(e){const t=new oSe,i=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=i,t}flowShaderNode(e){const t=e.layout,i={[Symbol.iterator](){let o=0;const a=Object.values(this);return{next:()=>({value:a[o],done:o++>=a.length})}}};for(const o of t.inputs)i[o.name]=new zbe(o.type,o.name);e.layout=null;const r=e.call(i),s=this.flowStagesNode(r,t.type);return e.layout=t,s}flowStagesNode(e,t=null){const i=this.flow,r=this.vars,s=this.cache,o=this.buildStage,a=this.stack,l={code:""};this.flow=l,this.vars={},this.cache=new RT,this.stack=bT();for(const u of w7)this.setBuildStage(u),l.result=e.build(this,t);return l.vars=this.getVars(this.shaderStage),this.flow=i,this.vars=r,this.cache=s,this.stack=a,this.setBuildStage(o),l}getFunctionOperator(){return null}flowChildNode(e,t=null){const i=this.flow,r={code:""};return this.flow=r,r.result=e.build(this,t),this.flow=i,r}flowNodeFromShaderStage(e,t,i=null,r=null){const s=this.shaderStage;this.setShaderStage(e);const o=this.flowChildNode(t,i);return r!==null&&(o.code+=`${this.tab+r} = ${o.result};
`),this.flowCode[e]=this.flowCode[e]+o.code,this.setShaderStage(s),o}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){console.warn("Abstract function.")}getVaryings(){console.warn("Abstract function.")}getVar(e,t){return`${this.getType(e)} ${t}`}getVars(e){let t="";const i=this.vars[e];if(i!==void 0)for(const r of i)t+=`${this.getVar(r.type,r.name)}; `;return t}getUniforms(){console.warn("Abstract function.")}getCodes(e){const t=this.codes[e];let i="";if(t!==void 0)for(const r of t)i+=r.code+`
`;return i}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){console.warn("Abstract function.")}build(){const{object:e,material:t,renderer:i}=this;if(t!==null){let r=i.library.fromMaterial(t);r===null&&(console.error(`NodeMaterial: Material "${t.type}" is not compatible.`),r=new Pr),r.build(this)}else this.addFlow("compute",e);for(const r of w7){this.setBuildStage(r),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of E7){this.setShaderStage(s);const o=this.flowNodes[s];for(const a of o)r==="generate"?this.flowNode(a):a.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getNodeUniform(e,t){if(t==="float"||t==="int"||t==="uint")return new VSe(e);if(t==="vec2"||t==="ivec2"||t==="uvec2")return new GSe(e);if(t==="vec3"||t==="ivec3"||t==="uvec3")return new qSe(e);if(t==="vec4"||t==="ivec4"||t==="uvec4")return new HSe(e);if(t==="color")return new $Se(e);if(t==="mat3")return new jSe(e);if(t==="mat4")return new WSe(e);throw new Error(`Uniform "${t}" not declared.`)}createNodeMaterial(e="NodeMaterial"){throw new Error(`THREE.NodeBuilder: createNodeMaterial() was deprecated. Use new ${e}() instead.`)}format(e,t,i){if(t=this.getVectorType(t),i=this.getVectorType(i),t===i||i===null||this.isReference(i))return e;const r=this.getTypeLength(t),s=this.getTypeLength(i);return r===16&&s===9?`${this.getType(i)}(${e}[0].xyz, ${e}[1].xyz, ${e}[2].xyz)`:r===9&&s===4?`${this.getType(i)}(${e}[0].xy, ${e}[1].xy)`:r>4||s>4||s===0?e:r===s?`${this.getType(i)}( ${e} )`:r>s?this.format(`${e}.${"xyz".slice(0,s)}`,this.getTypeFromLength(s,this.getComponentType(t)),i):s===4&&r>1?`${this.getType(i)}( ${this.format(e,t,"vec3")}, 1.0 )`:r===2?`${this.getType(i)}( ${this.format(e,t,"vec2")}, 0.0 )`:(r===1&&s>1&&t!==this.getComponentType(i)&&(e=`${this.getType(this.getComponentType(i))}( ${e} )`),`${this.getType(i)}( ${e} )`)}getSignature(){return`// Three.js r${sw} - Node System
`}}class wB{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.startTime=null,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let i=e.get(t);return i===void 0&&(i={renderMap:new WeakMap,frameMap:new WeakMap},e.set(t,i)),i}updateBeforeNode(e){const t=e.getUpdateBeforeType(),i=e.updateReference(this);if(t===Nn.FRAME){const{frameMap:r}=this._getMaps(this.updateBeforeMap,i);r.get(i)!==this.frameId&&e.updateBefore(this)!==!1&&r.set(i,this.frameId)}else if(t===Nn.RENDER){const{renderMap:r}=this._getMaps(this.updateBeforeMap,i);r.get(i)!==this.renderId&&e.updateBefore(this)!==!1&&r.set(i,this.renderId)}else t===Nn.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),i=e.updateReference(this);if(t===Nn.FRAME){const{frameMap:r}=this._getMaps(this.updateAfterMap,i);r.get(i)!==this.frameId&&e.updateAfter(this)!==!1&&r.set(i,this.frameId)}else if(t===Nn.RENDER){const{renderMap:r}=this._getMaps(this.updateAfterMap,i);r.get(i)!==this.renderId&&e.updateAfter(this)!==!1&&r.set(i,this.renderId)}else t===Nn.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),i=e.updateReference(this);if(t===Nn.FRAME){const{frameMap:r}=this._getMaps(this.updateMap,i);r.get(i)!==this.frameId&&e.update(this)!==!1&&r.set(i,this.frameId)}else if(t===Nn.RENDER){const{renderMap:r}=this._getMaps(this.updateMap,i);r.get(i)!==this.renderId&&e.update(this)!==!1&&r.set(i,this.renderId)}else t===Nn.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class dN{constructor(e,t,i=null,r="",s=!1){this.type=e,this.name=t,this.count=i,this.qualifier=r,this.isConst=s}}dN.isNodeFunctionInput=!0;class twe extends rp{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setup(e){super.setup(e);const t=e.context.lightingModel,i=this.colorNode,r=hj(this.light),s=e.context.reflectedLight;t.direct({lightDirection:r,lightColor:i,reflectedLight:s},e.stack,e)}}const LT=new ji,e2=new ji;let tg=null;class nwe extends rp{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=En(new Pe).setGroup($n),this.halfWidth=En(new Pe).setGroup($n),this.updateType=Nn.RENDER}update(e){super.update(e);const{light:t}=this,i=e.camera.matrixWorldInverse;e2.identity(),LT.copy(t.matrixWorld),LT.premultiply(i),e2.extractRotation(LT),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(e2),this.halfHeight.value.applyMatrix4(e2)}setup(e){super.setup(e);let t,i;e.isAvailable("float32Filterable")?(t=pr(tg.LTC_FLOAT_1),i=pr(tg.LTC_FLOAT_2)):(t=pr(tg.LTC_HALF_1),i=pr(tg.LTC_HALF_2));const{colorNode:r,light:s}=this,o=e.context.lightingModel,a=cN(s),l=e.context.reflectedLight;o.directRectArea({lightColor:r,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,reflectedLight:l,ltc_1:t,ltc_2:i},e.stack,e)}static setLTC(e){tg=e}}class mj extends rp{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=En(0).setGroup($n),this.penumbraCosNode=En(0).setGroup($n),this.cutoffDistanceNode=En(0).setGroup($n),this.decayExponentNode=En(0).setGroup($n)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e){const{coneCosNode:t,penumbraCosNode:i}=this;return zd(t,i,e)}setup(e){super.setup(e);const t=e.context.lightingModel,{colorNode:i,cutoffDistanceNode:r,decayExponentNode:s,light:o}=this,a=cN(o).sub(os),l=a.normalize(),u=l.dot(hj(o)),c=this.getSpotAttenuation(u),h=a.length(),A=dj({lightDistance:h,cutoffDistance:r,decayExponent:s}),v=i.mul(c).mul(A),_=e.context.reflectedLight;t.direct({lightDirection:l,lightColor:v,reflectedLight:_},e.stack,e)}}class iwe extends mj{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e){const t=this.light.iesMap;let i=null;if(t&&t.isTexture===!0){const r=e.acos().mul(1/Math.PI);i=pr(t,Pt(r,0),0).r}else i=super.getSpotAttenuation(e);return i}}class rwe extends rp{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class swe extends rp{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=cj(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=En(new mi).setGroup($n)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:i,lightDirectionNode:r}=this,o=Rl.dot(r).mul(.5).add(.5),a=Bi(i,t,o);e.context.irradiance.addAssign(a)}}class owe extends rp{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let i=0;i<9;i++)t.push(new Pe);this.lightProbe=Y1(t)}update(e){const{light:t}=this;super.update(e);for(let i=0;i<9;i++)this.lightProbe.array[i].copy(t.sh.coefficients[i]).multiplyScalar(t.intensity)}setup(e){const t=TSe(N$,this.lightProbe);e.context.irradiance.addAssign(t)}}class gj{parseFunction(){console.warn("Abstract function.")}}class pN{constructor(e,t,i="",r=""){this.type=e,this.inputs=t,this.name=i,this.precision=r}getCode(){console.warn("Abstract function.")}}pN.isNodeFunction=!0;const awe=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,lwe=/[a-z_0-9]+/ig,EB="#pragma main",uwe=n=>{n=n.trim();const e=n.indexOf(EB),t=e!==-1?n.slice(e+EB.length):n,i=t.match(awe);if(i!==null&&i.length===5){const r=i[4],s=[];let o=null;for(;(o=lwe.exec(r))!==null;)s.push(o);const a=[];let l=0;for(;l<s.length;){const _=s[l][0]==="const";_===!0&&l++;let S=s[l][0];S==="in"||S==="out"||S==="inout"?l++:S="";const w=s[l++][0];let x=Number.parseInt(s[l][0]);Number.isNaN(x)===!1?l++:x=null;const M=s[l++][0];a.push(new dN(w,M,x,S,_))}const u=t.substring(i[0].length),c=i[3]!==void 0?i[3]:"",h=i[2],A=i[1]!==void 0?i[1]:"",v=e!==-1?n.slice(0,e):"";return{type:h,inputs:a,name:c,precision:A,inputsCode:r,blockCode:u,headerCode:v}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class cwe extends pN{constructor(e){const{type:t,inputs:i,name:r,precision:s,inputsCode:o,blockCode:a,headerCode:l}=uwe(e);super(t,i,r,s),this.inputsCode=o,this.blockCode=a,this.headerCode=l}getCode(e=this.name){let t;const i=this.blockCode;if(i!==""){const{type:r,inputsCode:s,headerCode:o,precision:a}=this;let l=`${r} ${e} ( ${s.trim()} )`;a!==""&&(l=`${a} ${l}`),t=o+l+i}else t="";return t}}class hwe extends gj{parseFunction(e){return new cwe(e)}}const TB=new WeakMap;class fwe extends Af{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new wB,this.nodeBuilderCache=new Map,this.callHashCache=new ou,this.groupsData=new ou}updateGroup(e){const t=e.groupNode,i=t.name;if(i===r$.name)return!0;if(i===$n.name){const o=this.get(e),a=this.nodeFrame.renderId;return o.renderId!==a?(o.renderId=a,!0):!1}if(i===Uve.name){const o=this.get(e),a=this.nodeFrame.frameId;return o.frameId!==a?(o.frameId=a,!0):!1}const r=[t,e];let s=this.groupsData.get(r);return s===void 0&&this.groupsData.set(r,s={}),s.version!==t.version?(s.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let i=t.nodeBuilderState;if(i===void 0){const{nodeBuilderCache:r}=this,s=this.getForRenderCacheKey(e);if(i=r.get(s),i===void 0){const o=this.backend.createNodeBuilder(e.object,this.renderer);o.scene=e.scene,o.material=e.material,o.camera=e.camera,o.context.material=e.material,o.lightsNode=e.lightsNode,o.environmentNode=this.getEnvironmentNode(e.scene),o.fogNode=this.getFogNode(e.scene),o.clippingContext=e.clippingContext,o.build(),i=this._createNodeBuilderState(o),r.set(s,i)}i.usedTimes++,t.nodeBuilderState=i}return i}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let i=t.nodeBuilderState;if(i===void 0){const r=this.backend.createNodeBuilder(e,this.renderer);r.build(),i=this._createNodeBuilderState(r),t.nodeBuilderState=i}return i}_createNodeBuilderState(e){return new RSe(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.monitor,e.transforms)}getEnvironmentNode(e){return e.environmentNode||this.get(e).environmentNode||null}getBackgroundNode(e){return e.backgroundNode||this.get(e).backgroundNode||null}getFogNode(e){return e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){const i=[e,t],r=this.renderer.info.calls;let s=this.callHashCache.get(i);if(s===void 0||s.callId!==r){const o=this.getEnvironmentNode(e),a=this.getFogNode(e),l=[];t&&l.push(t.getCacheKey(!0)),o&&l.push(o.getCacheKey()),a&&l.push(a.getCacheKey()),l.push(this.renderer.shadowMap.enabled?1:0),s={callId:r,cacheKey:XH(l)},this.callHashCache.set(i,s)}return s.cacheKey}updateScene(e){this.updateEnvironment(e),this.updateFog(e),this.updateBackground(e)}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),i=e.background;if(i){const r=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==i||r){let s=null;if(i.isCubeTexture===!0||i.mapping===Pv||i.mapping===Nv||i.mapping===pR)if(e.backgroundBlurriness>0||i.mapping===pR)s=ij(i);else{let o;i.isCubeTexture===!0?o=X1(i):o=pr(i),s=X$(o)}else i.isTexture===!0?s=pr(i,Q1.flipY()).setUpdateMatrix(!0):i.isColor!==!0&&console.error("WebGPUNodes: Unsupported background configuration.",i);t.backgroundNode=s,t.background=i,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}updateFog(e){const t=this.get(e),i=e.fog;if(i){if(t.fog!==i){let r=null;if(i.isFogExp2){const s=tr("color","color",i).setGroup($n),o=tr("density","float",i).setGroup($n);r=cSe(s,o)}else if(i.isFog){const s=tr("color","color",i).setGroup($n),o=tr("near","float",i).setGroup($n),a=tr("far","float",i).setGroup($n);r=lSe(s,o,a)}else console.error("WebGPUNodes: Unsupported fog configuration.",i);t.fogNode=r,t.fog=i}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),i=e.environment;if(i){if(t.environment!==i){let r=null;i.isCubeTexture===!0?r=X1(i):i.isTexture===!0?r=pr(i):console.error("Nodes: Unsupported environment configuration.",i),t.environmentNode=r,t.environment=i}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,i=null,r=null,s=null){const o=this.nodeFrame;return o.renderer=e,o.scene=t,o.object=i,o.camera=r,o.material=s,o}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace}hasOutputChange(e){return TB.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,i=this.getOutputCacheKey(),r=pr(e,Q1).renderOutput(t.toneMapping,t.currentColorSpace);return TB.set(e,i),r}updateBefore(e){const t=e.getNodeBuilderState();for(const i of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(i)}updateAfter(e){const t=e.getNodeBuilderState();for(const i of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(i)}updateForCompute(e){const t=this.getNodeFrame(),i=this.getForCompute(e);for(const r of i.updateNodes)t.updateNode(r)}updateForRender(e){const t=this.getNodeFrameForRender(e),i=e.getNodeBuilderState();for(const r of i.updateNodes)t.updateNode(r)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new wB,this.nodeBuilderCache=new Map}}class dwe{constructor(e,t){this.scene=e,this.camera=t}clone(){return Object.assign(new this.constructor,this)}}class pwe{constructor(){this.lists=new ou}get(e,t){const i=this.lists,r=[e,t];let s=i.get(r);return s===void 0&&(s=new dwe(e,t),i.set(r,s)),s}dispose(){this.lists=new ou}}class vj{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const i=this.getMaterialNodeClass(e.type);if(i!==null){t=new i;for(const r in e)t[r]=e[r]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t.type,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,i){if(i.has(t)){console.warn(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);i.set(t,e)}addClass(e,t,i){if(i.has(t)){console.warn(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);i.set(t,e)}}const Awe=new fj;class mwe extends ou{constructor(){super()}createNode(e=[]){return new fj().setLights(e)}getNode(e,t){if(e.isQuadMesh)return Awe;const i=[e,t];let r=this.get(i);return r===void 0&&(r=this.createNode(),this.set(i,r)),r}}const CB=new kH,t2=new Jn,FT=new pi,BT=new BH,n2=new ji,ih=new pi;class gwe{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:i=!1,alpha:r=!0,depth:s=!0,stencil:o=!1,antialias:a=!1,samples:l=0,getFallback:u=null}=t;this.domElement=e.getDomElement(),this.backend=e,this.samples=l||a===!0?4:0,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=r,this.logarithmicDepthBuffer=i,this.outputColorSpace=Jt,this.toneMapping=YA,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=o,this.clippingPlanes=[],this.info=new Tbe,this.nodes={modelViewMatrix:null,modelNormalViewMatrix:null},this.library=new vj,this.lighting=new mwe,this._getFallback=u,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new pi(0,0,this._width,this._height),this._scissor=new pi(0,0,this._width,this._height),this._scissorTest=!1,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new lj(new Pr),this._quad.material.type="Renderer_output",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const c=this.alpha===!0?0:1;this._clearColor=new lN(0,0,0,c),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:gge},this.xr={enabled:!1},this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(h,A,v)=>{await this.compileAsync(h,A);const _=this._renderLists.get(h,A),S=this._renderContexts.get(h,A,this._renderTarget),w=h.overrideMaterial||v.material,x=this._objects.get(v,w,h,A,_.lightsNode,S),{fragmentShader:M,vertexShader:R}=x.getNodeBuilderState();return{fragmentShader:M,vertexShader:R}}}}async init(){if(this._initialized)throw new Error("Renderer: Backend has already been initialized.");return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let i=this.backend;try{await i.init(this)}catch(r){if(this._getFallback!==null)try{this.backend=i=this._getFallback(r),await i.init(this)}catch(s){t(s);return}else{t(r);return}}this._nodes=new fwe(this,i),this._animation=new mbe(this._nodes,this.info),this._attributes=new Sbe(i),this._background=new CSe(this,this._nodes),this._geometries=new Ebe(this._attributes,this.info),this._textures=new Ube(this,i,this.info),this._pipelines=new Pbe(i,this._nodes),this._bindings=new Nbe(i,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new _be(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new kbe(this.lighting),this._bundles=new pwe,this._renderContexts=new Bbe,this._initialized=!0,e()}),this._initPromise)}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,i=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const r=this._nodes.nodeFrame,s=r.renderId,o=this._currentRenderContext,a=this._currentRenderObjectFunction,l=this._compilationPromises,u=e.isScene===!0?e:CB;i===null&&(i=e);const c=this._renderTarget,h=this._renderContexts.get(i,t,c),A=this._activeMipmapLevel,v=[];this._currentRenderContext=h,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=v,r.renderId++,r.update(),h.depth=this.depth,h.stencil=this.stencil,h.clippingContext||(h.clippingContext=new WR),h.clippingContext.updateGlobal(this,t),u.onBeforeRender(this,e,t,c);const _=this._renderLists.get(e,t);if(_.begin(),this._projectObject(e,t,0,_),i!==e&&i.traverseVisible(function(M){M.isLight&&M.layers.test(t.layers)&&_.pushLight(M)}),_.finish(),c!==null){this._textures.updateRenderTarget(c,A);const M=this._textures.get(c);h.textures=M.textures,h.depthTexture=M.depthTexture}else h.textures=null,h.depthTexture=null;this._nodes.updateScene(u),this._background.update(u,_,h);const S=_.opaque,w=_.transparent,x=_.lightsNode;this.opaque===!0&&S.length>0&&this._renderObjects(S,t,u,x),this.transparent===!0&&w.length>0&&this._renderTransparents(w,t,u,x),r.renderId=s,this._currentRenderContext=o,this._currentRenderObjectFunction=a,this._compilationPromises=l,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(v)}async renderAsync(e,t){this._initialized===!1&&await this.init();const i=this._renderScene(e,t);await this.backend.resolveTimestampAsync(i,"render")}async waitForGPU(){await this.backend.waitForGPU()}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),console.error(t),this._isDeviceLost=!0}_renderBundle(e,t,i){const{bundleGroup:r,camera:s,renderList:o}=e,a=this._currentRenderContext,l=this._bundles.get(r,s),u=this.backend.get(l);u.renderContexts===void 0&&(u.renderContexts=new Set);const c=r.version!==u.version,h=u.renderContexts.has(a)===!1||c;if(u.renderContexts.add(a),h){this.backend.beginBundle(a),(u.renderObjects===void 0||c)&&(u.renderObjects=[]),this._currentRenderBundle=l;const A=o.opaque;this.opaque===!0&&A.length>0&&this._renderObjects(A,s,t,i),this._currentRenderBundle=null,this.backend.finishBundle(a,l),u.version=r.version}else{const{renderObjects:A}=u;for(let v=0,_=A.length;v<_;v++){const S=A[v];this._nodes.needsRefresh(S)&&(this._nodes.updateBefore(S),this._nodes.updateForRender(S),this._bindings.updateForRender(S),this._nodes.updateAfter(S))}}this.backend.addBundle(a,l)}render(e,t){if(this._initialized===!1)return console.warn("THREE.Renderer: .render() called before the backend is initialized. Try using .renderAsync() instead."),this.renderAsync(e,t);this._renderScene(e,t)}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this;if(e!==YA===!1&&t!==zh===!1)return null;const{width:s,height:o}=this.getDrawingBufferSize(t2),{depth:a,stencil:l}=this;let u=this._frameBufferTarget;return u===null&&(u=new J0(s,o,{depthBuffer:a,stencilBuffer:l,type:ec,format:K0,colorSpace:zh,generateMipmaps:!1,minFilter:ua,magFilter:ua,samples:this.samples}),u.isPostProcessingRenderTarget=!0,this._frameBufferTarget=u),u.depthBuffer=a,u.stencilBuffer=l,u.setSize(s,o),u.viewport.copy(this._viewport),u.scissor.copy(this._scissor),u.viewport.multiplyScalar(this._pixelRatio),u.scissor.multiplyScalar(this._pixelRatio),u.scissorTest=this._scissorTest,u}_renderScene(e,t,i=!0){if(this._isDeviceLost===!0)return;const r=i?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,o=s.renderId,a=this._currentRenderContext,l=this._currentRenderObjectFunction,u=e.isScene===!0?e:CB,c=this._renderTarget,h=this._activeCubeFace,A=this._activeMipmapLevel;let v;r!==null?(v=r,this.setRenderTarget(v)):v=c;const _=this._renderContexts.get(e,t,v);this._currentRenderContext=_,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls;const S=this.coordinateSystem;t.coordinateSystem!==S&&(t.coordinateSystem=S,t.updateProjectionMatrix()),e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld();let w=this._viewport,x=this._scissor,M=this._pixelRatio;v!==null&&(w=v.viewport,x=v.scissor,M=1),this.getDrawingBufferSize(t2),FT.set(0,0,t2.width,t2.height);const R=w.minDepth===void 0?0:w.minDepth,N=w.maxDepth===void 0?1:w.maxDepth;_.viewportValue.copy(w).multiplyScalar(M).floor(),_.viewportValue.width>>=A,_.viewportValue.height>>=A,_.viewportValue.minDepth=R,_.viewportValue.maxDepth=N,_.viewport=_.viewportValue.equals(FT)===!1,_.scissorValue.copy(x).multiplyScalar(M).floor(),_.scissor=this._scissorTest&&_.scissorValue.equals(FT)===!1,_.scissorValue.width>>=A,_.scissorValue.height>>=A,_.clippingContext||(_.clippingContext=new WR),_.clippingContext.updateGlobal(this,t),u.onBeforeRender(this,e,t,v),n2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),BT.setFromProjectionMatrix(n2,S);const B=this._renderLists.get(e,t);if(B.begin(),this._projectObject(e,t,0,B),B.finish(),this.sortObjects===!0&&B.sort(this._opaqueSort,this._transparentSort),v!==null){this._textures.updateRenderTarget(v,A);const z=this._textures.get(v);_.textures=z.textures,_.depthTexture=z.depthTexture,_.width=z.width,_.height=z.height,_.renderTarget=v,_.depth=v.depthBuffer,_.stencil=v.stencilBuffer}else _.textures=null,_.depthTexture=null,_.width=this.domElement.width,_.height=this.domElement.height,_.depth=this.depth,_.stencil=this.stencil;_.width>>=A,_.height>>=A,_.activeCubeFace=h,_.activeMipmapLevel=A,_.occlusionQueryCount=B.occlusionQueryCount,this._nodes.updateScene(u),this._background.update(u,B,_),this.backend.beginRender(_);const{bundles:T,lightsNode:D,transparentDoublePass:F,transparent:L,opaque:O}=B;if(T.length>0&&this._renderBundles(T,u,D),this.opaque===!0&&O.length>0&&this._renderObjects(O,t,u,D),this.transparent===!0&&L.length>0&&this._renderTransparents(L,F,t,u,D),this.backend.finishRender(_),s.renderId=o,this._currentRenderContext=a,this._currentRenderObjectFunction=l,r!==null){this.setRenderTarget(c,h,A);const z=this._quad;this._nodes.hasOutputChange(v.texture)&&(z.material.fragmentNode=this._nodes.getOutputNode(v.texture),z.material.needsUpdate=!0),this._renderScene(z,z.camera,!1)}return u.onAfterRender(this,e,t,v),_}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,i){this._width=e,this._height=t,this._pixelRatio=i,this.domElement.width=Math.floor(e*i),this.domElement.height=Math.floor(t*i),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize()}setSize(e,t,i=!0){this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),i===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._initialized&&this.backend.updateSize()}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,i,r){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,i,r)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e,this.backend.setScissorTest(e)}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,i,r,s=0,o=1){const a=this._viewport;e.isVector4?a.copy(e):a.set(e,t,i,r),a.minDepth=s,a.maxDepth=o}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,i=!0){if(this._initialized===!1)return console.warn("THREE.Renderer: .clear() called before the backend is initialized. Try using .clearAsync() instead."),this.clearAsync(e,t,i);const r=this._renderTarget||this._getFrameBufferTarget();let s=null;if(r!==null&&(this._textures.updateRenderTarget(r),s=this._textures.get(r)),this.backend.clear(e,t,i,s),r!==null&&this._renderTarget===null){const o=this._quad;this._nodes.hasOutputChange(r.texture)&&(o.material.fragmentNode=this._nodes.getOutputNode(r.texture),o.material.needsUpdate=!0),this._renderScene(o,o.camera,!1)}}clearColor(){return this.clear(!0,!1,!1)}clearDepth(){return this.clear(!1,!0,!1)}clearStencil(){return this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,i=!0){this._initialized===!1&&await this.init(),this.clear(e,t,i)}clearColorAsync(){return this.clearAsync(!0,!1,!1)}clearDepthAsync(){return this.clearAsync(!1,!0,!1)}clearStencilAsync(){return this.clearAsync(!1,!1,!0)}get currentToneMapping(){return this._renderTarget!==null?YA:this.toneMapping}get currentColorSpace(){return this._renderTarget!==null?zh:this.outputColorSpace}dispose(){this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,i=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=i}getRenderTarget(){return this._renderTarget}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e){if(this.isDeviceLost===!0)return;if(this._initialized===!1)return console.warn("THREE.Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e);const t=this._nodes.nodeFrame,i=t.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,t.renderId=this.info.calls;const r=this.backend,s=this._pipelines,o=this._bindings,a=this._nodes,l=Array.isArray(e)?e:[e];if(l[0]===void 0||l[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");r.beginCompute(e);for(const u of l){if(s.has(u)===!1){const A=()=>{u.removeEventListener("dispose",A),s.delete(u),o.delete(u),a.delete(u)};u.addEventListener("dispose",A);const v=u.onInitFunction;v!==null&&v.call(u,{renderer:this})}a.updateForCompute(u),o.updateForCompute(u);const c=o.getForCompute(u),h=s.getForCompute(u,c);r.compute(e,u,c,h)}r.finishCompute(e),t.renderId=i}async computeAsync(e){this._initialized===!1&&await this.init(),this.compute(e),await this.backend.resolveTimestampAsync(e,"compute")}async hasFeatureAsync(e){return this._initialized===!1&&await this.init(),this.backend.hasFeature(e)}hasFeature(e){return this._initialized===!1?(console.warn("THREE.Renderer: .hasFeature() called before the backend is initialized. Try using .hasFeatureAsync() instead."),!1):this.backend.hasFeature(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=ih.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=ih.copy(t).floor();else{console.error("THREE.Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=ih.set(0,0,e.image.width,e.image.height);let i=this._currentRenderContext,r;i!==null?r=i.renderTarget:(r=this._renderTarget||this._getFrameBufferTarget(),r!==null&&(this._textures.updateRenderTarget(r),i=this._textures.get(r))),this._textures.updateTexture(e,{renderTarget:r}),this.backend.copyFramebufferToTexture(e,i,t)}copyTextureToTexture(e,t,i=null,r=null,s=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,i,r,s)}readRenderTargetPixelsAsync(e,t,i,r,s,o=0,a=0){return this.backend.copyTextureToBuffer(e.textures[o],t,i,r,s,a)}_projectObject(e,t,i,r){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)i=e.renderOrder;else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)r.pushLight(e);else if(e.isSprite){if(!e.frustumCulled||BT.intersectsSprite(e)){this.sortObjects===!0&&ih.setFromMatrixPosition(e.matrixWorld).applyMatrix4(n2);const{geometry:a,material:l}=e;l.visible&&r.push(e,a,l,i,ih.z,null)}}else if(e.isLineLoop)console.error("THREE.Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||BT.intersectsObject(e))){const{geometry:a,material:l}=e;if(this.sortObjects===!0&&(a.boundingSphere===null&&a.computeBoundingSphere(),ih.copy(a.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(n2)),Array.isArray(l)){const u=a.groups;for(let c=0,h=u.length;c<h;c++){const A=u[c],v=l[A.materialIndex];v&&v.visible&&r.push(e,a,v,i,ih.z,A)}}else l.visible&&r.push(e,a,l,i,ih.z,null)}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const a=r;r=this._renderLists.get(e,t),r.begin(),a.pushBundle({bundleGroup:e,camera:t,renderList:r}),r.finish()}const o=e.children;for(let a=0,l=o.length;a<l;a++)this._projectObject(o[a],t,i,r)}_renderBundles(e,t,i){for(const r of e)this._renderBundle(r,t,i)}_renderTransparents(e,t,i,r,s){if(t.length>0){for(const{material:o}of t)o.side=Cl;this._renderObjects(t,i,r,s,"backSide");for(const{material:o}of t)o.side=P0;this._renderObjects(e,i,r,s);for(const{material:o}of t)o.side=XA}else this._renderObjects(e,i,r,s)}_renderObjects(e,t,i,r,s=null){for(let o=0,a=e.length;o<a;o++){const l=e[o],{object:u,geometry:c,material:h,group:A}=l;if(t.isArrayCamera){const v=t.cameras;for(let _=0,S=v.length;_<S;_++){const w=v[_];if(u.layers.test(w.layers)){const x=w.viewport,M=x.minDepth===void 0?0:x.minDepth,R=x.maxDepth===void 0?1:x.maxDepth,N=this._currentRenderContext.viewportValue;N.copy(x).multiplyScalar(this._pixelRatio).floor(),N.minDepth=M,N.maxDepth=R,this.backend.updateViewport(this._currentRenderContext),this._currentRenderObjectFunction(u,i,w,c,h,A,r,s)}}}else this._currentRenderObjectFunction(u,i,t,c,h,A,r,s)}}renderObject(e,t,i,r,s,o,a,l=null){let u,c,h;if(e.onBeforeRender(this,t,i,r,s,o),t.overrideMaterial!==null){const A=t.overrideMaterial;s.positionNode&&s.positionNode.isNode&&(u=A.positionNode,A.positionNode=s.positionNode),A.isShadowNodeMaterial&&(A.side=s.shadowSide===null?s.side:s.shadowSide,s.depthNode&&s.depthNode.isNode&&(h=A.depthNode,A.depthNode=s.depthNode),s.shadowNode&&s.shadowNode.isNode&&(c=A.fragmentNode,A.fragmentNode=s.shadowNode),this.localClippingEnabled&&(s.clipShadows?(A.clippingPlanes!==s.clippingPlanes&&(A.clippingPlanes=s.clippingPlanes,A.needsUpdate=!0),A.clipIntersection!==s.clipIntersection&&(A.clipIntersection=s.clipIntersection)):Array.isArray(A.clippingPlanes)&&(A.clippingPlanes=null,A.needsUpdate=!0))),s=A}s.transparent===!0&&s.side===XA&&s.forceSinglePass===!1?(s.side=Cl,this._handleObjectFunction(e,s,t,i,a,o,"backSide"),s.side=P0,this._handleObjectFunction(e,s,t,i,a,o,l),s.side=XA):this._handleObjectFunction(e,s,t,i,a,o,l),u!==void 0&&(t.overrideMaterial.positionNode=u),h!==void 0&&(t.overrideMaterial.depthNode=h),c!==void 0&&(t.overrideMaterial.fragmentNode=c),e.onAfterRender(this,t,i,r,s,o)}_renderObjectDirect(e,t,i,r,s,o,a){const l=this._objects.get(e,t,i,r,s,this._currentRenderContext,a);l.drawRange=e.geometry.drawRange,l.group=o;const u=this._nodes.needsRefresh(l);u&&(this._nodes.updateBefore(l),this._geometries.updateForRender(l),this._nodes.updateForRender(l),this._bindings.updateForRender(l)),this._pipelines.updateForRender(l),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(l),l.bundle=this._currentRenderBundle.scene),this.backend.draw(l,this.info),u&&this._nodes.updateAfter(l)}_createObjectPipeline(e,t,i,r,s,o){const a=this._objects.get(e,t,i,r,s,this._currentRenderContext,o);this._nodes.updateBefore(a),this._geometries.updateForRender(a),this._nodes.updateForRender(a),this._bindings.updateForRender(a),this._pipelines.getForRender(a,this._compilationPromises),this._nodes.updateAfter(a)}get compile(){return this.compileAsync}}class AN{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}clone(){return Object.assign(new this.constructor,this)}}function vwe(n){return n+(yh-n%yh)%yh}class yj extends AN{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t}get byteLength(){return vwe(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class _j extends yj{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let ywe=0;class xj extends _j{constructor(e,t){super("UniformBuffer_"+ywe++,e?e.value:null),this.nodeUniform=e,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class _we extends _j{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){let e=0;for(let t=0,i=this.uniforms.length;t<i;t++){const r=this.uniforms[t],{boundary:s,itemSize:o}=r,a=e%yh,l=yh-a;a!==0&&l-s<0?e+=yh-a:a%s!==0&&(e+=a%s),r.offset=e/this.bytesPerElement,e+=o*this.bytesPerElement}return Math.ceil(e/yh)*yh}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);console.error("THREE.WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s]!==r){const o=this.buffer;o[s]=i[s]=r,t=!0}return t}updateVector2(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s+0]!==r.x||i[s+1]!==r.y){const o=this.buffer;o[s+0]=i[s+0]=r.x,o[s+1]=i[s+1]=r.y,t=!0}return t}updateVector3(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s+0]!==r.x||i[s+1]!==r.y||i[s+2]!==r.z){const o=this.buffer;o[s+0]=i[s+0]=r.x,o[s+1]=i[s+1]=r.y,o[s+2]=i[s+2]=r.z,t=!0}return t}updateVector4(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s+0]!==r.x||i[s+1]!==r.y||i[s+2]!==r.z||i[s+4]!==r.w){const o=this.buffer;o[s+0]=i[s+0]=r.x,o[s+1]=i[s+1]=r.y,o[s+2]=i[s+2]=r.z,o[s+3]=i[s+3]=r.w,t=!0}return t}updateColor(e){let t=!1;const i=this.values,r=e.getValue(),s=e.offset;if(i[s+0]!==r.r||i[s+1]!==r.g||i[s+2]!==r.b){const o=this.buffer;o[s+0]=i[s+0]=r.r,o[s+1]=i[s+1]=r.g,o[s+2]=i[s+2]=r.b,t=!0}return t}updateMatrix3(e){let t=!1;const i=this.values,r=e.getValue().elements,s=e.offset;if(i[s+0]!==r[0]||i[s+1]!==r[1]||i[s+2]!==r[2]||i[s+4]!==r[3]||i[s+5]!==r[4]||i[s+6]!==r[5]||i[s+8]!==r[6]||i[s+9]!==r[7]||i[s+10]!==r[8]){const o=this.buffer;o[s+0]=i[s+0]=r[0],o[s+1]=i[s+1]=r[1],o[s+2]=i[s+2]=r[2],o[s+4]=i[s+4]=r[3],o[s+5]=i[s+5]=r[4],o[s+6]=i[s+6]=r[5],o[s+8]=i[s+8]=r[6],o[s+9]=i[s+9]=r[7],o[s+10]=i[s+10]=r[8],t=!0}return t}updateMatrix4(e){let t=!1;const i=this.values,r=e.getValue().elements,s=e.offset;return bwe(i,r,s)===!1&&(this.buffer.set(r,s),xwe(i,r,s),t=!0),t}}function xwe(n,e,t){for(let i=0,r=e.length;i<r;i++)n[t+i]=e[i]}function bwe(n,e,t){for(let i=0,r=e.length;i<r;i++)if(n[t+i]!==e[i])return!1;return!0}let Swe=0;class bj extends _we{constructor(e,t){super(e),this.id=Swe++,this.groupNode=t,this.isNodeUniformsGroup=!0}getNodes(){const e=[];for(const t of this.uniforms){const i=t.nodeUniform.node;if(!i)throw new Error("NodeUniformsGroup: Uniform has no node.");e.push(i)}return e}}let wwe=0;class Ewe extends AN{constructor(e,t){super(e),this.id=wwe++,this.texture=t,this.version=t?t.version:0,this.store=!1,this.generation=null,this.isSampledTexture=!0}needsBindingsUpdate(e){const{texture:t}=this;return e!==this.generation?(this.generation=e,!0):t.isVideoTexture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}}class _w extends Ewe{constructor(e,t,i,r=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=i,this.access=r}needsBindingsUpdate(e){return this.textureNode.value!==this.texture||super.needsBindingsUpdate(e)}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class Sj extends _w{constructor(e,t,i,r){super(e,t,i,r),this.isSampledCubeTexture=!0}}class wj extends _w{constructor(e,t,i,r){super(e,t,i,r),this.isSampledTexture3D=!0}}const Twe={atan2:"atan",textureDimensions:"textureSize",equals:"equal"},Cwe={low:"lowp",medium:"mediump",high:"highp"},MB={swizzleAssign:!0,storageBuffer:!1},RB=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
`;class Mwe extends Aj{constructor(e,t){super(e,t,new hwe),this.uniformGroups={},this.transforms=[],this.extensions={},this.useComparisonMethod=!0}needsColorSpaceToLinearSRGB(e){return e.isVideoTexture===!0&&e.colorSpace!==Bd}getMethod(e){return Twe[e]||e}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,i=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(this.getType(o.type)+" "+o.name);return`${this.getType(t.type)} ${t.name}( ${r.join(", ")} ) {

	${i.vars}

${i.code}
	return ${i.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const i=t.array,r=t.count*t.itemSize,{itemSize:s}=t,o=t.array.constructor.name.toLowerCase().includes("int");let a=o?P6:R6;s===2?a=o?N6:z1:s===3?a=o?Dge:M6:s===4&&(a=o?I6:K0);const l={Float32Array:na,Uint8Array:Uh,Uint16Array:MA,Uint32Array:rs,Int8Array:Gg,Int16Array:qg,Int32Array:Qs,Uint8ClampedArray:Uh},u=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(r/s))));let c=Math.ceil(r/s/u);u*c*s<r&&c++;const h=u*c*s,A=new i.constructor(h);A.set(i,0),t.array=A;const v=new U1e(t.array,u,c,a,l[t.array.constructor.name]||na);v.needsUpdate=!0,v.isPBOTexture=!0;const _=new Uv(v,null,null);_.setPrecision("high"),t.pboNode=_,t.pbo=_.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.label)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:i}=e,r=t.value;if(this.renderer.backend.has(r)){const c=this.renderer.backend.get(r);c.pbo=r.pbo}const s=this.getUniformFromNode(r.pboNode,"texture",this.shaderStage,this.context.label),o=this.getPropertyName(s);this.increaseUsage(i);const a=i.build(this,"uint"),l=this.getDataFromNode(e);let u=l.propertyName;if(u===void 0){const c=this.getVarFromNode(e);u=this.getPropertyName(c);const h=this.getDataFromNode(t);let A=h.propertySizeName;A===void 0&&(A=u+"Size",this.getVarFromNode(t,A,"uint"),this.addLineFlowCode(`${A} = uint( textureSize( ${o}, 0 ).x )`,e),h.propertySizeName=A);const{itemSize:v}=r,_="."+tm.join("").slice(0,v),S=`ivec2(${a} % ${A}, ${a} / ${A})`,w=this.generateTextureLoad(null,o,S,null,"0");let x="vec4";r.pbo.type===rs?x="uvec4":r.pbo.type===Qs&&(x="ivec4"),this.addLineFlowCode(`${u} = ${x}(${w})${_}`,e),l.propertyName=u}return u}generateTextureLoad(e,t,i,r,s="0"){return r?`texelFetch( ${t}, ivec3( ${i}, ${r} ), ${s} )`:`texelFetch( ${t}, ${i}, ${s} )`}generateTexture(e,t,i,r){return e.isDepthTexture?`texture( ${t}, ${i} ).x`:(r&&(i=`vec3( ${i}, ${r} )`),`texture( ${t}, ${i} )`)}generateTextureLevel(e,t,i,r){return`textureLod( ${t}, ${i}, ${r} )`}generateTextureBias(e,t,i,r){return`texture( ${t}, ${i}, ${r} )`}generateTextureGrad(e,t,i,r){return`textureGrad( ${t}, ${i}, ${r[0]}, ${r[1]} )`}generateTextureCompare(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`texture( ${t}, vec3( ${i}, ${r} ) )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],i=this.vars[e];if(i!==void 0)for(const r of i)t.push(`${this.getVar(r.type,r.name)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],i=[],r={};for(const o of t){let a=null,l=!1;if(o.type==="texture"){const c=o.node.value;let h="";c.isDataTexture===!0&&(c.type===rs?h="u":c.type===Qs&&(h="i")),c.compareFunction?a=`sampler2DShadow ${o.name};`:c.isDataArrayTexture===!0||c.isCompressedArrayTexture===!0?a=`${h}sampler2DArray ${o.name};`:a=`${h}sampler2D ${o.name};`}else if(o.type==="cubeTexture")a=`samplerCube ${o.name};`;else if(o.type==="texture3D")a=`sampler3D ${o.name};`;else if(o.type==="buffer"){const c=o.node,h=this.getType(c.bufferType),A=c.bufferCount,v=A>0?A:"";a=`${c.name} {
	${h} ${o.name}[${v}];
};
`}else a=`${this.getVectorType(o.type)} ${this.getPropertyName(o,e)};`,l=!0;const u=o.node.precision;if(u!==null&&(a=Cwe[u]+" "+a),l){a="	"+a;const c=o.groupNode.name;(r[c]||(r[c]=[])).push(a)}else a="uniform "+a,i.push(a)}let s="";for(const o in r){const a=r[o];s+=this._getGLSLUniformStruct(e+"_"+o,a.join(`
`))+`
`}return s+=i.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Qs){let i=e;e.isInterleavedBufferAttribute&&(i=e.data);const r=i.array;r instanceof Uint32Array||r instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const i=this.getAttributesArray();let r=0;for(const s of i)t+=`layout( location = ${r++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[],i=e.getMemberTypes();for(let r=0;r<i.length;r++){const s=i[r];t.push(`layout( location = ${r} ) out ${s} m${r};`)}return t.join(`
`)}getStructs(e){const t=[],i=this.structs[e];if(i.length===0)return`layout( location = 0 ) out vec4 fragColor;
`;for(let r=0,s=i.length;r<s;r++){const o=i[r];let a=`
`;a+=this.getStructMembers(o),a+=`
`,t.push(a)}return t.join(`

`)}getVaryings(e){let t="";const i=this.varyings;if(e==="vertex"||e==="compute")for(const r of i){e==="compute"&&(r.needsInterpolation=!0);const s=r.type,o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}${r.needsInterpolation?"out":"/*out*/"} ${s} ${r.name};
`}else if(e==="fragment"){for(const r of i)if(r.needsInterpolation){const s=r.type,o=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${o}in ${s} ${r.name};
`}}return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((i,r)=>i*r,1)}u`}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,i=this.shaderStage){const r=this.extensions[i]||(this.extensions[i]=new Map);r.has(e)===!1&&r.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const r=this.renderer.backend.extensions;this.object.isBatchedMesh&&r.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const i=this.extensions[e];if(i!==void 0)for(const{name:r,behavior:s}of i.values())t.push(`#extension ${r} : ${s}`);return t.join(`
`)}isAvailable(e){let t=MB[e];if(t===void 0){if(e==="float32Filterable"){const i=this.renderer.backend.extensions;i.has("OES_texture_float_linear")?(i.get("OES_texture_float_linear"),t=!0):t=!1}MB[e]=t}return t}isFlipY(){return!0}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let i=0;i<e.length;i++){const r=e[i],s=this.getPropertyName(r.attributeNode);t+=`${r.varyingName} = ${s};
	`}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions 
${e.extensions}

// precision
${RB}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// precision
${RB}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

${e.structs}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let i=`// code

`;i+=this.flowCode[t];const r=this.flowNodes[t],s=r[r.length-1];for(const a of r){const l=this.getFlowData(a),u=a.name;u&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${u}
	`),i+=`${l.code}
	`,a===s&&t!=="compute"&&(i+=`// result
	`,t==="vertex"?(i+="gl_Position = ",i+=`${l.result};`):t==="fragment"&&(a.outputNode.isOutputStructNode||(i+="fragColor = ",i+=`${l.result};`)))}const o=e[t];o.extensions=this.getExtensions(t),o.uniforms=this.getUniforms(t),o.attributes=this.getAttributes(t),o.varyings=this.getVaryings(t),o.vars=this.getVars(t),o.structs=this.getStructs(t),o.codes=this.getCodes(t),o.transforms=this.getTransforms(t),o.flow=i}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,i,r=null){const s=super.getUniformFromNode(e,t,i,r),o=this.getDataFromNode(e,i,this.globalCache);let a=o.uniformGPU;if(a===void 0){const l=e.groupNode,u=l.name,c=this.getBindGroupArray(u,i);if(t==="texture")a=new _w(s.name,s.node,l),c.push(a);else if(t==="cubeTexture")a=new Sj(s.name,s.node,l),c.push(a);else if(t==="texture3D")a=new wj(s.name,s.node,l),c.push(a);else if(t==="buffer"){e.name=`NodeBuffer_${e.id}`,s.name=`buffer${e.id}`;const h=new xj(e,l);h.name=e.name,c.push(h),a=h}else{const h=this.uniformGroups[i]||(this.uniformGroups[i]={});let A=h[u];A===void 0&&(A=new bj(i+"_"+u,l),h[u]=A,c.push(A)),a=this.getNodeUniform(s,t),A.addUniform(a)}o.uniformGPU=a}return s}}let OT=null,UT=null,Zp=null;class Ej{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null}async init(e){this.renderer=e}begin(){}finish(){}draw(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}createRenderPipeline(){}createComputePipeline(){}destroyPipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}createSampler(){}createDefaultTexture(){}createTexture(){}copyTextureToBuffer(){}createAttribute(){}createIndexAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}resolveTimestampAsync(){}hasFeatureAsync(){}hasFeature(){}getInstanceCount(e){const{object:t,geometry:i}=e;return i.isInstancedBufferGeometry?i.instanceCount:t.count>1?t.count:1}getDrawingBufferSize(){return OT=OT||new Jn,this.renderer.getDrawingBufferSize(OT)}getScissor(){return UT=UT||new pi,this.renderer.getScissor(UT)}setScissorTest(){}getClearColor(){const e=this.renderer;return Zp=Zp||new lN,e.getClearColor(Zp),Zp.getRGB(Zp,this.renderer.currentColorSpace),Zp}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:p1e(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${sw} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}dispose(){}}let Rwe=0;class Pwe{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class Nwe{constructor(e){this.backend=e}createAttribute(e,t){const i=this.backend,{gl:r}=i,s=e.array,o=e.usage||r.STATIC_DRAW,a=e.isInterleavedBufferAttribute?e.data:e,l=i.get(a);let u=l.bufferGPU;u===void 0&&(u=this._createBuffer(r,t,s,o),l.bufferGPU=u,l.bufferType=t,l.version=a.version);let c;if(s instanceof Float32Array)c=r.FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?c=r.HALF_FLOAT:c=r.UNSIGNED_SHORT;else if(s instanceof Int16Array)c=r.SHORT;else if(s instanceof Uint32Array)c=r.UNSIGNED_INT;else if(s instanceof Int32Array)c=r.INT;else if(s instanceof Int8Array)c=r.BYTE;else if(s instanceof Uint8Array)c=r.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)c=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let h={bufferGPU:u,bufferType:t,type:c,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:c===r.INT||c===r.UNSIGNED_INT||e.gpuType===Qs,id:Rwe++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const A=this._createBuffer(r,t,s,o);h=new Pwe(h,A)}i.set(e,h)}updateAttribute(e){const t=this.backend,{gl:i}=t,r=e.array,s=e.isInterleavedBufferAttribute?e.data:e,o=t.get(s),a=o.bufferType,l=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(i.bindBuffer(a,o.bufferGPU),l.length===0)i.bufferSubData(a,0,r);else{for(let u=0,c=l.length;u<c;u++){const h=l[u];i.bufferSubData(a,h.start*r.BYTES_PER_ELEMENT,r,h.start,h.count)}s.clearUpdateRanges()}i.bindBuffer(a,null),o.version=s.version}destroyAttribute(e){const t=this.backend,{gl:i}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const r=t.get(e);i.deleteBuffer(r.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:i}=t,r=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(r),o=e.array,a=o.byteLength;i.bindBuffer(i.COPY_READ_BUFFER,s);const l=i.createBuffer();i.bindBuffer(i.COPY_WRITE_BUFFER,l),i.bufferData(i.COPY_WRITE_BUFFER,a,i.STREAM_READ),i.copyBufferSubData(i.COPY_READ_BUFFER,i.COPY_WRITE_BUFFER,0,0,a),await t.utils._clientWaitAsync();const u=new e.array.constructor(o.length);return i.bindBuffer(i.COPY_WRITE_BUFFER,l),i.getBufferSubData(i.COPY_WRITE_BUFFER,0,u),i.deleteBuffer(l),i.bindBuffer(i.COPY_READ_BUFFER,null),i.bindBuffer(i.COPY_WRITE_BUFFER,null),u.buffer}_createBuffer(e,t,i,r){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,i,r),e.bindBuffer(t,null),s}}let PB=!1,zT,ng;class Iwe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},PB===!1&&(this._init(this.gl),PB=!0)}_init(e){zT={[gh]:e.FUNC_ADD,[Jq]:e.FUNC_SUBTRACT,[eH]:e.FUNC_REVERSE_SUBTRACT},ng={[tH]:e.ZERO,[nH]:e.ONE,[iH]:e.SRC_COLOR,[Mb]:e.SRC_ALPHA,[uH]:e.SRC_ALPHA_SATURATE,[aH]:e.DST_COLOR,[sH]:e.DST_ALPHA,[rH]:e.ONE_MINUS_SRC_COLOR,[Rb]:e.ONE_MINUS_SRC_ALPHA,[lH]:e.ONE_MINUS_DST_COLOR,[oH]:e.ONE_MINUS_DST_ALPHA}}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==pge?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===Age?t.cullFace(t.BACK):e===mge?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:i}=this;e!==t&&(i.lineWidth(e),this.currentLineWidth=e)}setBlending(e,t,i,r,s,o,a,l){const{gl:u}=this;if(e===N0){this.currentBlendingEnabled===!0&&(this.disable(u.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(u.BLEND),this.currentBlendingEnabled=!0),e!==Zq){if(e!==this.currentBlending||l!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==gh||this.currentBlendEquationAlpha!==gh)&&(u.blendEquation(u.FUNC_ADD),this.currentBlendEquation=gh,this.currentBlendEquationAlpha=gh),l)switch(e){case Oh:u.blendFuncSeparate(u.ONE,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Eb:u.blendFunc(u.ONE,u.ONE);break;case Tb:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Cb:u.blendFuncSeparate(u.ZERO,u.SRC_COLOR,u.ZERO,u.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}else switch(e){case Oh:u.blendFuncSeparate(u.SRC_ALPHA,u.ONE_MINUS_SRC_ALPHA,u.ONE,u.ONE_MINUS_SRC_ALPHA);break;case Eb:u.blendFunc(u.SRC_ALPHA,u.ONE);break;case Tb:u.blendFuncSeparate(u.ZERO,u.ONE_MINUS_SRC_COLOR,u.ZERO,u.ONE);break;case Cb:u.blendFunc(u.ZERO,u.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=l}return}s=s||t,o=o||i,a=a||r,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(u.blendEquationSeparate(zT[t],zT[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(i!==this.currentBlendSrc||r!==this.currentBlendDst||o!==this.currentBlendSrcAlpha||a!==this.currentBlendDstAlpha)&&(u.blendFuncSeparate(ng[i],ng[r],ng[o],ng[a]),this.currentBlendSrc=i,this.currentBlendDst=r,this.currentBlendSrcAlpha=o,this.currentBlendDstAlpha=a),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case cH:t.depthFunc(t.NEVER);break;case hH:t.depthFunc(t.ALWAYS);break;case fH:t.depthFunc(t.LESS);break;case Pb:t.depthFunc(t.LEQUAL);break;case dH:t.depthFunc(t.EQUAL);break;case pH:t.depthFunc(t.GEQUAL);break;case AH:t.depthFunc(t.GREATER);break;case mH:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,i){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==i)&&(this.gl.stencilFunc(e,t,i),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=i)}setStencilOp(e,t,i){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==i)&&(this.gl.stencilOp(e,t,i),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=i)}setMaterial(e,t){const{gl:i}=this;e.side===XA?this.disable(i.CULL_FACE):this.enable(i.CULL_FACE);let r=e.side===Cl;t&&(r=!r),this.setFlipSided(r),e.blending===Oh&&e.transparent===!1?this.setBlending(N0):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const s=e.stencilWrite;this.setStencilTest(s),s&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.samples>1?this.enable(i.SAMPLE_ALPHA_TO_COVERAGE):this.disable(i.SAMPLE_ALPHA_TO_COVERAGE)}setPolygonOffset(e,t,i){const{gl:r}=this;e?(this.enable(r.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==i)&&(r.polygonOffset(t,i),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=i)):this.disable(r.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}bindFramebuffer(e,t){const{gl:i,currentBoundFramebuffers:r}=this;return r[e]!==t?(i.bindFramebuffer(e,t),r[e]=t,e===i.DRAW_FRAMEBUFFER&&(r[i.FRAMEBUFFER]=t),e===i.FRAMEBUFFER&&(r[i.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:i}=this;let r=[],s=!1;if(e.textures!==null){r=this.currentDrawbuffers.get(t),r===void 0&&(r=[],this.currentDrawbuffers.set(t,r));const o=e.textures;if(r.length!==o.length||r[0]!==i.COLOR_ATTACHMENT0){for(let a=0,l=o.length;a<l;a++)r[a]=i.COLOR_ATTACHMENT0+a;r.length=o.length,s=!0}}else r[0]!==i.BACK&&(r[0]=i.BACK,s=!0);s&&i.drawBuffers(r)}activeTexture(e){const{gl:t,currentTextureSlot:i,maxTextures:r}=this;e===void 0&&(e=t.TEXTURE0+r-1),i!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,i){const{gl:r,currentTextureSlot:s,currentBoundTextures:o,maxTextures:a}=this;i===void 0&&(s===null?i=r.TEXTURE0+a-1:i=s);let l=o[i];l===void 0&&(l={type:void 0,texture:void 0},o[i]=l),(l.type!==e||l.texture!==t)&&(s!==i&&(r.activeTexture(i),this.currentTextureSlot=i),r.bindTexture(e,t),l.type=e,l.texture=t)}bindBufferBase(e,t,i){const{gl:r}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==i?(r.bindBufferBase(e,t,i),this.currentBoundBufferBases[s]=i,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:i}=this,r=i[t];r!==void 0&&r.type!==void 0&&(e.bindTexture(r.type,null),r.type=void 0,r.texture=void 0)}}class Dwe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Bd){const{gl:i,extensions:r}=this;let s;if(e===Uh)return i.UNSIGNED_BYTE;if(e===Mge)return i.UNSIGNED_SHORT_4_4_4_4;if(e===Rge)return i.UNSIGNED_SHORT_5_5_5_1;if(e===gH)return i.UNSIGNED_INT_5_9_9_9_REV;if(e===Gg)return i.BYTE;if(e===qg)return i.SHORT;if(e===MA)return i.UNSIGNED_SHORT;if(e===Qs)return i.INT;if(e===rs)return i.UNSIGNED_INT;if(e===na)return i.FLOAT;if(e===ec)return i.HALF_FLOAT;if(e===Pge)return i.ALPHA;if(e===M6)return i.RGB;if(e===K0)return i.RGBA;if(e===Nge)return i.LUMINANCE;if(e===Ige)return i.LUMINANCE_ALPHA;if(e===wd)return i.DEPTH_COMPONENT;if(e===D0)return i.DEPTH_STENCIL;if(e===R6)return i.RED;if(e===P6)return i.RED_INTEGER;if(e===z1)return i.RG;if(e===N6)return i.RG_INTEGER;if(e===I6)return i.RGBA_INTEGER;if(e===U3||e===X2||e===Y2||e===Q2)if(t===Jt)if(s=r.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===U3)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===X2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Y2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Q2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=r.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===U3)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===X2)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Y2)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Q2)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===$F||e===jF||e===WF||e===XF)if(s=r.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===$F)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===jF)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===WF)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===XF)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===YF||e===gR||e===vR)if(s=r.get("WEBGL_compressed_texture_etc"),s!==null){if(e===YF||e===gR)return t===Jt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===vR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(e===yR||e===_R||e===xR||e===bR||e===SR||e===wR||e===ER||e===TR||e===CR||e===MR||e===RR||e===PR||e===NR||e===IR)if(s=r.get("WEBGL_compressed_texture_astc"),s!==null){if(e===yR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===_R)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===xR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===bR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===SR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===wR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===ER)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===TR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===CR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===MR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===RR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===PR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===NR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===IR)return t===Jt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===z3)if(s=r.get("EXT_texture_compression_bptc"),s!==null){if(e===z3)return t===Jt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===kge||e===QF||e===KF||e===ZF)if(s=r.get("EXT_texture_compression_rgtc"),s!==null){if(e===z3)return s.COMPRESSED_RED_RGTC1_EXT;if(e===QF)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===KF)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===ZF)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===Iv?i.UNSIGNED_INT_24_8:i[e]!==void 0?i[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((i,r)=>{function s(){const o=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(o===e.WAIT_FAILED){e.deleteSync(t),r();return}if(o===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),i()}s()})}}let NB=!1,i2,VT,IB;class kwe{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},NB===!1&&(this._init(this.gl),NB=!0)}_init(e){i2={[Nb]:e.REPEAT,[CA]:e.CLAMP_TO_EDGE,[Ib]:e.MIRRORED_REPEAT},VT={[Ps]:e.NEAREST,[AR]:e.NEAREST_MIPMAP_NEAREST,[QA]:e.NEAREST_MIPMAP_LINEAR,[ua]:e.LINEAR,[mR]:e.LINEAR_MIPMAP_NEAREST,[Ju]:e.LINEAR_MIPMAP_LINEAR},IB={[yH]:e.NEVER,[EH]:e.ALWAYS,[D6]:e.LESS,[xH]:e.LEQUAL,[_H]:e.EQUAL,[wH]:e.GEQUAL,[bH]:e.GREATER,[SH]:e.NOTEQUAL}}filterFallback(e){const{gl:t}=this;return e===Ps||e===AR||e===QA?t.NEAREST:t.LINEAR}getGLTextureType(e){const{gl:t}=this;let i;return e.isCubeTexture===!0?i=t.TEXTURE_CUBE_MAP:e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?i=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?i=t.TEXTURE_3D:i=t.TEXTURE_2D,i}getInternalFormat(e,t,i,r,s=!1){const{gl:o,extensions:a}=this;if(e!==null){if(o[e]!==void 0)return o[e];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+e+"'")}let l=t;return t===o.RED&&(i===o.FLOAT&&(l=o.R32F),i===o.HALF_FLOAT&&(l=o.R16F),i===o.UNSIGNED_BYTE&&(l=o.R8),i===o.UNSIGNED_SHORT&&(l=o.R16),i===o.UNSIGNED_INT&&(l=o.R32UI),i===o.BYTE&&(l=o.R8I),i===o.SHORT&&(l=o.R16I),i===o.INT&&(l=o.R32I)),t===o.RED_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.R8UI),i===o.UNSIGNED_SHORT&&(l=o.R16UI),i===o.UNSIGNED_INT&&(l=o.R32UI),i===o.BYTE&&(l=o.R8I),i===o.SHORT&&(l=o.R16I),i===o.INT&&(l=o.R32I)),t===o.RG&&(i===o.FLOAT&&(l=o.RG32F),i===o.HALF_FLOAT&&(l=o.RG16F),i===o.UNSIGNED_BYTE&&(l=o.RG8),i===o.UNSIGNED_SHORT&&(l=o.RG16),i===o.UNSIGNED_INT&&(l=o.RG32UI),i===o.BYTE&&(l=o.RG8I),i===o.SHORT&&(l=o.RG16I),i===o.INT&&(l=o.RG32I)),t===o.RG_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RG8UI),i===o.UNSIGNED_SHORT&&(l=o.RG16UI),i===o.UNSIGNED_INT&&(l=o.RG32UI),i===o.BYTE&&(l=o.RG8I),i===o.SHORT&&(l=o.RG16I),i===o.INT&&(l=o.RG32I)),t===o.RGB&&(i===o.FLOAT&&(l=o.RGB32F),i===o.HALF_FLOAT&&(l=o.RGB16F),i===o.UNSIGNED_BYTE&&(l=o.RGB8),i===o.UNSIGNED_SHORT&&(l=o.RGB16),i===o.UNSIGNED_INT&&(l=o.RGB32UI),i===o.BYTE&&(l=o.RGB8I),i===o.SHORT&&(l=o.RGB16I),i===o.INT&&(l=o.RGB32I),i===o.UNSIGNED_BYTE&&(l=r===Jt&&s===!1?o.SRGB8:o.RGB8),i===o.UNSIGNED_SHORT_5_6_5&&(l=o.RGB565),i===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1),i===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGB4),i===o.UNSIGNED_INT_5_9_9_9_REV&&(l=o.RGB9_E5)),t===o.RGB_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RGB8UI),i===o.UNSIGNED_SHORT&&(l=o.RGB16UI),i===o.UNSIGNED_INT&&(l=o.RGB32UI),i===o.BYTE&&(l=o.RGB8I),i===o.SHORT&&(l=o.RGB16I),i===o.INT&&(l=o.RGB32I)),t===o.RGBA&&(i===o.FLOAT&&(l=o.RGBA32F),i===o.HALF_FLOAT&&(l=o.RGBA16F),i===o.UNSIGNED_BYTE&&(l=o.RGBA8),i===o.UNSIGNED_SHORT&&(l=o.RGBA16),i===o.UNSIGNED_INT&&(l=o.RGBA32UI),i===o.BYTE&&(l=o.RGBA8I),i===o.SHORT&&(l=o.RGBA16I),i===o.INT&&(l=o.RGBA32I),i===o.UNSIGNED_BYTE&&(l=r===Jt&&s===!1?o.SRGB8_ALPHA8:o.RGBA8),i===o.UNSIGNED_SHORT_4_4_4_4&&(l=o.RGBA4),i===o.UNSIGNED_SHORT_5_5_5_1&&(l=o.RGB5_A1)),t===o.RGBA_INTEGER&&(i===o.UNSIGNED_BYTE&&(l=o.RGBA8UI),i===o.UNSIGNED_SHORT&&(l=o.RGBA16UI),i===o.UNSIGNED_INT&&(l=o.RGBA32UI),i===o.BYTE&&(l=o.RGBA8I),i===o.SHORT&&(l=o.RGBA16I),i===o.INT&&(l=o.RGBA32I)),t===o.DEPTH_COMPONENT&&(i===o.UNSIGNED_INT&&(l=o.DEPTH24_STENCIL8),i===o.FLOAT&&(l=o.DEPTH_COMPONENT32F)),t===o.DEPTH_STENCIL&&i===o.UNSIGNED_INT_24_8&&(l=o.DEPTH24_STENCIL8),(l===o.R16F||l===o.R32F||l===o.RG16F||l===o.RG32F||l===o.RGBA16F||l===o.RGBA32F)&&a.get("EXT_color_buffer_float"),l}setTextureParameters(e,t){const{gl:i,extensions:r,backend:s}=this;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,t.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,t.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,i.NONE),i.texParameteri(e,i.TEXTURE_WRAP_S,i2[t.wrapS]),i.texParameteri(e,i.TEXTURE_WRAP_T,i2[t.wrapT]),(e===i.TEXTURE_3D||e===i.TEXTURE_2D_ARRAY)&&i.texParameteri(e,i.TEXTURE_WRAP_R,i2[t.wrapR]),i.texParameteri(e,i.TEXTURE_MAG_FILTER,VT[t.magFilter]);const o=t.mipmaps!==void 0&&t.mipmaps.length>0,a=t.minFilter===ua&&o?Ju:t.minFilter;if(i.texParameteri(e,i.TEXTURE_MIN_FILTER,VT[a]),t.compareFunction&&(i.texParameteri(e,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(e,i.TEXTURE_COMPARE_FUNC,IB[t.compareFunction])),r.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Ps||t.minFilter!==QA&&t.minFilter!==Ju||t.type===na&&r.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const l=r.get("EXT_texture_filter_anisotropic");i.texParameterf(e,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:i,defaultTextures:r}=this,s=this.getGLTextureType(e);let o=r[s];o===void 0&&(o=t.createTexture(),i.state.bindTexture(s,o),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),r[s]=o),i.set(e,{textureGPU:o,glTextureType:s,isDefault:!0})}createTexture(e,t){const{gl:i,backend:r}=this,{levels:s,width:o,height:a,depth:l}=t,u=r.utils.convert(e.format,e.colorSpace),c=r.utils.convert(e.type),h=this.getInternalFormat(e.internalFormat,u,c,e.colorSpace,e.isVideoTexture),A=i.createTexture(),v=this.getGLTextureType(e);r.state.bindTexture(v,A),this.setTextureParameters(v,e),e.isDataArrayTexture||e.isCompressedArrayTexture?i.texStorage3D(i.TEXTURE_2D_ARRAY,s,h,o,a,l):e.isData3DTexture?i.texStorage3D(i.TEXTURE_3D,s,h,o,a,l):e.isVideoTexture||i.texStorage2D(v,s,h,o,a),r.set(e,{textureGPU:A,glTextureType:v,glFormat:u,glType:c,glInternalFormat:h})}copyBufferToTexture(e,t){const{gl:i,backend:r}=this,{textureGPU:s,glTextureType:o,glFormat:a,glType:l}=r.get(t),{width:u,height:c}=t.source.data;i.bindBuffer(i.PIXEL_UNPACK_BUFFER,e),r.state.bindTexture(o,s),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texSubImage2D(o,0,0,0,u,c,a,l,0),i.bindBuffer(i.PIXEL_UNPACK_BUFFER,null),r.state.unbindTexture()}updateTexture(e,t){const{gl:i}=this,{width:r,height:s}=t,{textureGPU:o,glTextureType:a,glFormat:l,glType:u,glInternalFormat:c}=this.backend.get(e);if(e.isRenderTargetTexture||o===void 0)return;const h=A=>A.isDataTexture?A.image.data:A instanceof ImageBitmap||A instanceof OffscreenCanvas||A instanceof HTMLImageElement||A instanceof HTMLCanvasElement?A:A.data;if(this.backend.state.bindTexture(a,o),this.setTextureParameters(a,e),e.isCompressedTexture){const A=e.mipmaps,v=t.image;for(let _=0;_<A.length;_++){const S=A[_];e.isCompressedArrayTexture?e.format!==i.RGBA?l!==null?i.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,_,0,0,0,S.width,S.height,v.depth,l,S.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texSubImage3D(i.TEXTURE_2D_ARRAY,_,0,0,0,S.width,S.height,v.depth,l,u,S.data):l!==null?i.compressedTexSubImage2D(i.TEXTURE_2D,_,0,0,S.width,S.height,l,S.data):console.warn("Unsupported compressed texture format")}}else if(e.isCubeTexture){const A=t.images;for(let v=0;v<6;v++){const _=h(A[v]);i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,0,0,r,s,l,u,_)}}else if(e.isDataArrayTexture){const A=t.image;i.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,A.width,A.height,A.depth,l,u,A.data)}else if(e.isData3DTexture){const A=t.image;i.texSubImage3D(i.TEXTURE_3D,0,0,0,0,A.width,A.height,A.depth,l,u,A.data)}else if(e.isVideoTexture)e.update(),i.texImage2D(a,0,c,l,u,t.image);else{const A=h(t.image);i.texSubImage2D(a,0,0,0,r,s,l,u,A)}}generateMipmaps(e){const{gl:t,backend:i}=this,{textureGPU:r,glTextureType:s}=i.get(e);i.state.bindTexture(s,r),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:i}=this;if(e){const r=i.get(e);if(r.renderBufferStorageSetup=void 0,r.framebuffers){for(const s in r.framebuffers)t.deleteFramebuffer(r.framebuffers[s]);delete r.framebuffers}if(r.depthRenderbuffer&&(t.deleteRenderbuffer(r.depthRenderbuffer),delete r.depthRenderbuffer),r.stencilRenderbuffer&&(t.deleteRenderbuffer(r.stencilRenderbuffer),delete r.stencilRenderbuffer),r.msaaFrameBuffer&&(t.deleteFramebuffer(r.msaaFrameBuffer),delete r.msaaFrameBuffer),r.msaaRenderbuffers){for(let s=0;s<r.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(r.msaaRenderbuffers[s]);delete r.msaaRenderbuffers}}}destroyTexture(e){const{gl:t,backend:i}=this,{textureGPU:r,renderTarget:s}=i.get(e);this.deallocateRenderBuffers(s),t.deleteTexture(r),i.delete(e)}copyTextureToTexture(e,t,i=null,r=null,s=0){const{gl:o,backend:a}=this,{state:l}=this.backend,{textureGPU:u,glTextureType:c,glType:h,glFormat:A}=a.get(t);let v,_,S,w,x,M;i!==null?(v=i.max.x-i.min.x,_=i.max.y-i.min.y,S=i.min.x,w=i.min.y):(v=e.image.width,_=e.image.height,S=0,w=0),r!==null?(x=r.x,M=r.y):(x=0,M=0),l.bindTexture(c,u),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment);const R=o.getParameter(o.UNPACK_ROW_LENGTH),N=o.getParameter(o.UNPACK_IMAGE_HEIGHT),B=o.getParameter(o.UNPACK_SKIP_PIXELS),T=o.getParameter(o.UNPACK_SKIP_ROWS),D=o.getParameter(o.UNPACK_SKIP_IMAGES),F=e.isCompressedTexture?e.mipmaps[s]:e.image;if(o.pixelStorei(o.UNPACK_ROW_LENGTH,F.width),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,F.height),o.pixelStorei(o.UNPACK_SKIP_PIXELS,S),o.pixelStorei(o.UNPACK_SKIP_ROWS,w),e.isRenderTargetTexture||e.isDepthTexture){const L=a.get(e),O=a.get(t),z=a.get(L.renderTarget),Q=a.get(O.renderTarget),j=z.framebuffers[L.cacheKey],ee=Q.framebuffers[O.cacheKey];l.bindFramebuffer(o.READ_FRAMEBUFFER,j),l.bindFramebuffer(o.DRAW_FRAMEBUFFER,ee);let $=o.COLOR_BUFFER_BIT;e.isDepthTexture&&($=o.DEPTH_BUFFER_BIT),o.blitFramebuffer(S,w,v,_,x,M,v,_,$,o.NEAREST),l.bindFramebuffer(o.READ_FRAMEBUFFER,null),l.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}else e.isDataTexture?o.texSubImage2D(o.TEXTURE_2D,s,x,M,v,_,A,h,F.data):e.isCompressedTexture?o.compressedTexSubImage2D(o.TEXTURE_2D,s,x,M,F.width,F.height,A,F.data):o.texSubImage2D(o.TEXTURE_2D,s,x,M,v,_,A,h,F);o.pixelStorei(o.UNPACK_ROW_LENGTH,R),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,N),o.pixelStorei(o.UNPACK_SKIP_PIXELS,B),o.pixelStorei(o.UNPACK_SKIP_ROWS,T),o.pixelStorei(o.UNPACK_SKIP_IMAGES,D),s===0&&t.generateMipmaps&&o.generateMipmap(o.TEXTURE_2D),l.unbindTexture()}copyFramebufferToTexture(e,t,i){const{gl:r}=this,{state:s}=this.backend,{textureGPU:o}=this.backend.get(e),{x:a,y:l,z:u,w:c}=i,h=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,A=t.renderTarget?t.renderTarget.height:this.backend.gerDrawingBufferSize().y;if(h){const v=a!==0||l!==0;let _,S;if(e.isDepthTexture===!0?(_=r.DEPTH_BUFFER_BIT,S=r.DEPTH_ATTACHMENT,t.stencil&&(_|=r.STENCIL_BUFFER_BIT)):(_=r.COLOR_BUFFER_BIT,S=r.COLOR_ATTACHMENT0),v){const w=this.backend.get(t.renderTarget),x=w.framebuffers[t.getCacheKey()],M=w.msaaFrameBuffer;s.bindFramebuffer(r.DRAW_FRAMEBUFFER,x),s.bindFramebuffer(r.READ_FRAMEBUFFER,M);const R=A-l-c;r.blitFramebuffer(a,R,a+u,R+c,a,R,a+u,R+c,_,r.NEAREST),s.bindFramebuffer(r.READ_FRAMEBUFFER,x),s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,R,u,c),s.unbindTexture()}else{const w=r.createFramebuffer();s.bindFramebuffer(r.DRAW_FRAMEBUFFER,w),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,S,r.TEXTURE_2D,o,0),r.blitFramebuffer(0,0,u,c,0,0,u,c,_,r.NEAREST),r.deleteFramebuffer(w)}}else s.bindTexture(r.TEXTURE_2D,o),r.copyTexSubImage2D(r.TEXTURE_2D,0,0,0,a,A-c-l,u,c),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t){const{gl:i}=this,r=t.renderTarget,{samples:s,depthTexture:o,depthBuffer:a,stencilBuffer:l,width:u,height:c}=r;if(i.bindRenderbuffer(i.RENDERBUFFER,e),a&&!l){let h=i.DEPTH_COMPONENT24;s>0?(o&&o.isDepthTexture&&o.type===i.FLOAT&&(h=i.DEPTH_COMPONENT32F),i.renderbufferStorageMultisample(i.RENDERBUFFER,s,h,u,c)):i.renderbufferStorage(i.RENDERBUFFER,h,u,c),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,e)}else a&&l&&(s>0?i.renderbufferStorageMultisample(i.RENDERBUFFER,s,i.DEPTH24_STENCIL8,u,c):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,u,c),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,e))}async copyTextureToBuffer(e,t,i,r,s,o){const{backend:a,gl:l}=this,{textureGPU:u,glFormat:c,glType:h}=this.backend.get(e),A=l.createFramebuffer();l.bindFramebuffer(l.READ_FRAMEBUFFER,A);const v=e.isCubeTexture?l.TEXTURE_CUBE_MAP_POSITIVE_X+o:l.TEXTURE_2D;l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,v,u,0);const _=this._getTypedArrayType(h),S=this._getBytesPerTexel(h,c),x=r*s*S,M=l.createBuffer();l.bindBuffer(l.PIXEL_PACK_BUFFER,M),l.bufferData(l.PIXEL_PACK_BUFFER,x,l.STREAM_READ),l.readPixels(t,i,r,s,c,h,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),await a.utils._clientWaitAsync();const R=new _(x/_.BYTES_PER_ELEMENT);return l.bindBuffer(l.PIXEL_PACK_BUFFER,M),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,R),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),l.deleteFramebuffer(A),R}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:i}=this;let r=0;if(e===i.UNSIGNED_BYTE&&(r=1),(e===i.UNSIGNED_SHORT_4_4_4_4||e===i.UNSIGNED_SHORT_5_5_5_1||e===i.UNSIGNED_SHORT_5_6_5||e===i.UNSIGNED_SHORT||e===i.HALF_FLOAT)&&(r=2),(e===i.UNSIGNED_INT||e===i.FLOAT)&&(r=4),t===i.RGBA)return r*4;if(t===i.RGB)return r*3;if(t===i.ALPHA)return r}}class Lwe{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class Fwe{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const i=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const DB={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBKIT_WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-bc",EXT_texture_compression_bptc:"texture-compression-bptc",EXT_disjoint_timer_query_webgl2:"timestamp-query"};class Bwe{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:i,mode:r,object:s,type:o,info:a,index:l}=this;l!==0?i.drawElements(r,t,o,e):i.drawArrays(r,e,t),a.update(s,t,r,1)}renderInstances(e,t,i){const{gl:r,mode:s,type:o,index:a,object:l,info:u}=this;i!==0&&(a!==0?r.drawElementsInstanced(s,t,o,e,i):r.drawArraysInstanced(s,e,t,i),u.update(l,t,s,i))}renderMultiDraw(e,t,i){const{extensions:r,mode:s,object:o,info:a}=this;if(i===0)return;const l=r.get("WEBGL_multi_draw");if(l===null)for(let u=0;u<i;u++)this.render(e[u],t[u]);else{this.index!==0?l.multiDrawElementsWEBGL(s,t,0,this.type,e,0,i):l.multiDrawArraysWEBGL(s,e,0,t,0,i);let u=0;for(let c=0;c<i;c++)u+=t[c];a.update(o,u,s,1)}}renderMultiDrawInstances(e,t,i,r){const{extensions:s,mode:o,object:a,info:l}=this;if(i===0)return;const u=s.get("WEBGL_multi_draw");if(u===null)for(let c=0;c<i;c++)this.renderInstances(e[c],t[c],r[c]);else{this.index!==0?u.multiDrawElementsInstancedWEBGL(o,t,0,this.type,e,0,r,0,i):u.multiDrawArraysInstancedWEBGL(o,e,0,t,0,r,0,i);let c=0;for(let h=0;h<i;h++)c+=t[h]*r[h];l.update(a,c,o,1)}}}class kB extends Ej{constructor(e={}){super(e),this.isWebGLBackend=!0}init(e){super.init(e);const t=this.parameters,i=t.context!==void 0?t.context:e.domElement.getContext("webgl2");function r(s){s.preventDefault();const o={api:"WebGL",message:s.statusMessage||"Unknown reason",reason:null,originalEvent:s};e.onDeviceLost(o)}this._onContextLost=r,e.domElement.addEventListener("webglcontextlost",r,!1),this.gl=i,this.extensions=new Lwe(this),this.capabilities=new Fwe(this),this.attributeUtils=new Nwe(this),this.textureUtils=new kwe(this),this.bufferRenderer=new Bwe(this),this.state=new Iwe(this),this.utils=new Dwe(this),this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.trackTimestamp=t.trackTimestamp===!0,this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this._knownBindings=new WeakSet,this._currentContext=null}get coordinateSystem(){return ml}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async waitForGPU(){await this.utils._clientWaitAsync()}initTimestampQuery(e){if(!this.disjoint||!this.trackTimestamp)return;const t=this.get(e);if(this.queryRunning){t.queryQueue||(t.queryQueue=[]),t.queryQueue.push(e);return}t.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),t.activeQuery=null),t.activeQuery=this.gl.createQuery(),t.activeQuery!==null&&(this.gl.beginQuery(this.disjoint.TIME_ELAPSED_EXT,t.activeQuery),this.queryRunning=!0)}prepareTimestampBuffer(e){if(!this.disjoint||!this.trackTimestamp)return;const t=this.get(e);if(t.activeQuery&&(this.gl.endQuery(this.disjoint.TIME_ELAPSED_EXT),t.gpuQueries||(t.gpuQueries=[]),t.gpuQueries.push({query:t.activeQuery}),t.activeQuery=null,this.queryRunning=!1,t.queryQueue&&t.queryQueue.length>0)){const i=t.queryQueue.shift();this.initTimestampQuery(i)}}async resolveTimestampAsync(e,t="render"){if(!this.disjoint||!this.trackTimestamp)return;const i=this.get(e);i.gpuQueries||(i.gpuQueries=[]);for(let r=0;r<i.gpuQueries.length;r++){const s=i.gpuQueries[r],o=this.gl.getQueryParameter(s.query,this.gl.QUERY_RESULT_AVAILABLE),a=this.gl.getParameter(this.disjoint.GPU_DISJOINT_EXT);if(o&&!a){const l=this.gl.getQueryParameter(s.query,this.gl.QUERY_RESULT),u=Number(l)/1e6;this.gl.deleteQuery(s.query),i.gpuQueries.splice(r,1),r--,this.renderer.info.updateTimestamp(t,u)}}}getContext(){return this.gl}beginRender(e){const{gl:t}=this,i=this.get(e);if(this.initTimestampQuery(e),i.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1),e.viewport?this.updateViewport(e):t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),e.scissor){const{x:s,y:o,width:a,height:l}=e.scissorValue;t.scissor(s,e.height-l-o,a,l)}const r=e.occlusionQueryCount;r>0&&(i.currentOcclusionQueries=i.occlusionQueries,i.currentOcclusionQueryObjects=i.occlusionQueryObjects,i.lastOcclusionObject=null,i.occlusionQueries=new Array(r),i.occlusionQueryObjects=new Array(r),i.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:i}=this,r=this.get(e),s=r.previousContext,o=e.occlusionQueryCount;o>0&&(o>r.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const a=e.textures;if(a!==null)for(let l=0;l<a.length;l++){const u=a[l];u.generateMipmaps&&this.generateMipmaps(u)}if(this._currentContext=s,e.textures!==null&&e.renderTarget){const l=this.get(e.renderTarget),{samples:u}=e.renderTarget;if(u>0){const c=l.framebuffers[e.getCacheKey()],h=t.COLOR_BUFFER_BIT,A=l.msaaFrameBuffer,v=e.textures;i.bindFramebuffer(t.READ_FRAMEBUFFER,A),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,c);for(let _=0;_<v.length;_++)if(e.scissor){const{x:S,y:w,width:x,height:M}=e.scissorValue,R=e.height-M-w;t.blitFramebuffer(S,R,S+x,R+M,S,R,S+x,R+M,h,t.NEAREST),t.invalidateSubFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray,S,R,x,M)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,h,t.NEAREST),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l.invalidationArray)}}s!==null&&(this._setFramebuffer(s),s.viewport?this.updateViewport(s):t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),this.prepareTimestampBuffer(e)}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:i,currentOcclusionQueryObjects:r}=t;if(i&&r){const s=new WeakSet,{gl:o}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const a=()=>{let l=0;for(let u=0;u<i.length;u++){const c=i[u];c!==null&&o.getQueryParameter(c,o.QUERY_RESULT_AVAILABLE)&&(o.getQueryParameter(c,o.QUERY_RESULT)>0&&s.add(r[u]),i[u]=null,o.deleteQuery(c),l++)}l<i.length?requestAnimationFrame(a):t.occluded=s};a()}}isOccluded(e,t){const i=this.get(e);return i.occluded&&i.occluded.has(t)}updateViewport(e){const t=this.gl,{x:i,y:r,width:s,height:o}=e.viewportValue;t.viewport(i,e.height-o-r,s,o)}setScissorTest(e){const t=this.gl;e?t.enable(t.SCISSOR_TEST):t.disable(t.SCISSOR_TEST)}clear(e,t,i,r=null,s=!0){const{gl:o}=this;if(r===null){const l=this.getClearColor();l.r*=l.a,l.g*=l.a,l.b*=l.a,r={textures:null,clearColorValue:l}}let a=0;if(e&&(a|=o.COLOR_BUFFER_BIT),t&&(a|=o.DEPTH_BUFFER_BIT),i&&(a|=o.STENCIL_BUFFER_BIT),a!==0){let l;if(r.clearColorValue?l=r.clearColorValue:(l=this.getClearColor(),l.r*=l.a,l.g*=l.a,l.b*=l.a),t&&this.state.setDepthMask(!0),r.textures===null)o.clearColor(l.r,l.g,l.b,l.a),o.clear(a);else{if(s&&this._setFramebuffer(r),e)for(let u=0;u<r.textures.length;u++)o.clearBufferfv(o.COLOR,u,[l.r,l.g,l.b,l.a]);t&&i?o.clearBufferfi(o.DEPTH_STENCIL,0,1,0):t?o.clearBufferfv(o.DEPTH,0,[1]):i&&o.clearBufferiv(o.STENCIL,0,[0])}}}beginCompute(e){const{state:t,gl:i}=this;t.bindFramebuffer(i.FRAMEBUFFER,null),this.initTimestampQuery(e)}compute(e,t,i,r){const{state:s,gl:o}=this;this.discard||(o.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:a,transformBuffers:l,attributes:u}=this.get(r),c=this._getVaoKey(null,u),h=this.vaoCache[c];h===void 0?this._createVao(null,u):o.bindVertexArray(h),s.useProgram(a),this._bindUniforms(i);const A=this._getTransformFeedback(l);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,A),o.beginTransformFeedback(o.POINTS),u[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,t.count):o.drawArrays(o.POINTS,0,t.count),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let v=0;v<l.length;v++){const _=l[v];_.pbo&&this.textureUtils.copyBufferToTexture(_.transformBuffer,_.pbo),_.switchBuffers()}}finishCompute(e){const t=this.gl;this.discard=!1,t.disable(t.RASTERIZER_DISCARD),this.prepareTimestampBuffer(e),this._currentContext&&this._setFramebuffer(this._currentContext)}draw(e){const{object:t,pipeline:i,material:r,context:s}=e,{programGPU:o}=this.get(i),{gl:a,state:l}=this,u=this.get(s),c=e.getDrawParameters();if(c===null)return;this._bindUniforms(e.getBindings());const h=t.isMesh&&t.matrixWorld.determinant()<0;l.setMaterial(r,h),l.useProgram(o);let A=e.staticVao;if(A===void 0){const R=this._getVaoKey(e.getIndex(),e.getAttributes());if(A=this.vaoCache[R],A===void 0){let N;({vaoGPU:A,staticVao:N}=this._createVao(e.getIndex(),e.getAttributes())),N&&(e.staticVao=A)}}a.bindVertexArray(A);const v=e.getIndex(),_=u.lastOcclusionObject;if(_!==t&&_!==void 0){if(_!==null&&_.occlusionTest===!0&&(a.endQuery(a.ANY_SAMPLES_PASSED),u.occlusionQueryIndex++),t.occlusionTest===!0){const R=a.createQuery();a.beginQuery(a.ANY_SAMPLES_PASSED,R),u.occlusionQueries[u.occlusionQueryIndex]=R,u.occlusionQueryObjects[u.occlusionQueryIndex]=t}u.lastOcclusionObject=t}const S=this.bufferRenderer;t.isPoints?S.mode=a.POINTS:t.isLineSegments?S.mode=a.LINES:t.isLine?S.mode=a.LINE_STRIP:t.isLineLoop?S.mode=a.LINE_LOOP:r.wireframe===!0?(l.setLineWidth(r.wireframeLinewidth*this.renderer.getPixelRatio()),S.mode=a.LINES):S.mode=a.TRIANGLES;const{vertexCount:w,instanceCount:x}=c;let{firstVertex:M}=c;if(S.object=t,v!==null){M*=v.array.BYTES_PER_ELEMENT;const R=this.get(v);S.index=v.count,S.type=R.type}else S.index=0;t.isBatchedMesh?t._multiDrawInstances!==null?S.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances):this.hasFeature("WEBGL_multi_draw")?S.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):A1e("THREE.WebGLRenderer: WEBGL_multi_draw not supported."):x>1?S.renderInstances(M,w,x):S.render(M,w),a.bindVertexArray(null)}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,t,i,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,i,r,s,o)}createSampler(){}destroySampler(){}createNodeBuilder(e,t){return new Mwe(e,t)}createProgram(e){const t=this.gl,{stage:i,code:r}=e,s=i==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,r),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(){console.warn("Abstract class.")}createRenderPipeline(e,t){const i=this.gl,r=e.pipeline,{fragmentProgram:s,vertexProgram:o}=r,a=i.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU;if(i.attachShader(a,l),i.attachShader(a,u),i.linkProgram(a),this.set(r,{programGPU:a,fragmentShader:l,vertexShader:u}),t!==null&&this.parallel){const c=new Promise(h=>{const A=this.parallel,v=()=>{i.getProgramParameter(a,A.COMPLETION_STATUS_KHR)?(this._completeCompile(e,r),h()):requestAnimationFrame(v)};v()});t.push(c);return}this._completeCompile(e,r)}_handleSource(e,t){const i=e.split(`
`),r=[],s=Math.max(t-6,0),o=Math.min(t+6,i.length);for(let a=s;a<o;a++){const l=a+1;r.push(`${l===t?">":" "} ${l}: ${i[a]}`)}return r.join(`
`)}_getShaderErrors(e,t,i){const r=e.getShaderParameter(t,e.COMPILE_STATUS),s=e.getShaderInfoLog(t).trim();if(r&&s==="")return"";const o=/ERROR: 0:(\d+)/.exec(s);if(o){const a=parseInt(o[1]);return i.toUpperCase()+`

`+s+`

`+this._handleSource(e.getShaderSource(t),a)}else return s}_logProgramError(e,t,i){if(this.renderer.debug.checkShaderErrors){const r=this.gl,s=r.getProgramInfoLog(e).trim();if(r.getProgramParameter(e,r.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(r,e,i,t);else{const o=this._getShaderErrors(r,i,"vertex"),a=this._getShaderErrors(r,t,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(e,r.VALIDATE_STATUS)+`

Program Info Log: `+s+`
`+o+`
`+a)}else s!==""&&console.warn("THREE.WebGLProgram: Program Info Log:",s)}}_completeCompile(e,t){const{state:i,gl:r}=this,s=this.get(t),{programGPU:o,fragmentShader:a,vertexShader:l}=s;r.getProgramParameter(o,r.LINK_STATUS)===!1&&this._logProgramError(o,a,l),i.useProgram(o);const u=e.getBindings();this._setupBindings(u,o),this.set(t,{programGPU:o})}createComputePipeline(e,t){const{state:i,gl:r}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:o}=e,a=r.createProgram(),l=this.get(s).shaderGPU,u=this.get(o).shaderGPU,c=o.transforms,h=[],A=[];for(let w=0;w<c.length;w++){const x=c[w];h.push(x.varyingName),A.push(x.attributeNode)}r.attachShader(a,l),r.attachShader(a,u),r.transformFeedbackVaryings(a,h,r.SEPARATE_ATTRIBS),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)===!1&&this._logProgramError(a,l,u),i.useProgram(a),this._setupBindings(t,a);const v=o.attributes,_=[],S=[];for(let w=0;w<v.length;w++){const x=v[w].node.attribute;_.push(x),this.has(x)||this.attributeUtils.createAttribute(x,r.ARRAY_BUFFER)}for(let w=0;w<A.length;w++){const x=A[w].attribute;this.has(x)||this.attributeUtils.createAttribute(x,r.ARRAY_BUFFER);const M=this.get(x);S.push(M)}this.set(e,{programGPU:a,transformBuffers:S,attributes:_})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let i=0,r=0;for(const s of t){this.set(s,{textures:r,uniformBuffers:i});for(const o of s.bindings)o.isUniformBuffer&&i++,o.isSampledTexture&&r++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,i=this.get(e);let r=i.uniformBuffers,s=i.textures;for(const o of e.bindings)if(o.isUniformsGroup||o.isUniformBuffer){const a=o.buffer,l=t.createBuffer();t.bindBuffer(t.UNIFORM_BUFFER,l),t.bufferData(t.UNIFORM_BUFFER,a,t.DYNAMIC_DRAW),this.set(o,{index:r++,bufferGPU:l})}else if(o.isSampledTexture){const{textureGPU:a,glTextureType:l}=this.get(o.texture);this.set(o,{index:s++,textureGPU:a,glTextureType:l})}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const r=this.get(e).bufferGPU,s=e.buffer;t.bindBuffer(t.UNIFORM_BUFFER,r),t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW)}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){}hasFeature(e){const t=Object.keys(DB).filter(r=>DB[r]===e),i=this.extensions;for(let r=0;r<t.length;r++)if(i.has(t[r]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,i,r,s){this.textureUtils.copyTextureToTexture(e,t,i,r,s)}copyFramebufferToTexture(e,t,i){this.textureUtils.copyFramebufferToTexture(e,t,i)}_setFramebuffer(e){const{gl:t,state:i}=this;let r=null;if(e.textures!==null){const s=e.renderTarget,o=this.get(s),{samples:a,depthBuffer:l,stencilBuffer:u}=s,c=s.isWebGLCubeRenderTarget===!0;let h=o.msaaFrameBuffer,A=o.depthRenderbuffer;const v=aj(e);let _;if(c?(o.cubeFramebuffers||(o.cubeFramebuffers={}),_=o.cubeFramebuffers[v]):(o.framebuffers||(o.framebuffers={}),_=o.framebuffers[v]),_===void 0){_=t.createFramebuffer(),i.bindFramebuffer(t.FRAMEBUFFER,_);const S=e.textures;if(c){o.cubeFramebuffers[v]=_;const{textureGPU:w}=this.get(S[0]),x=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+x,w,0)}else{o.framebuffers[v]=_;for(let w=0;w<S.length;w++){const x=S[w],M=this.get(x);M.renderTarget=e.renderTarget,M.cacheKey=v;const R=t.COLOR_ATTACHMENT0+w;t.framebufferTexture2D(t.FRAMEBUFFER,R,t.TEXTURE_2D,M.textureGPU,0)}i.drawBuffers(e,_)}if(e.depthTexture!==null){const w=this.get(e.depthTexture),x=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;w.renderTarget=e.renderTarget,w.cacheKey=v,t.framebufferTexture2D(t.FRAMEBUFFER,x,t.TEXTURE_2D,w.textureGPU,0)}}if(a>0){if(h===void 0){const S=[];h=t.createFramebuffer(),i.bindFramebuffer(t.FRAMEBUFFER,h);const w=[],x=e.textures;for(let M=0;M<x.length;M++){if(w[M]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,w[M]),S.push(t.COLOR_ATTACHMENT0+M),l){const B=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;S.push(B)}const R=e.textures[M],N=this.get(R);t.renderbufferStorageMultisample(t.RENDERBUFFER,a,N.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+M,t.RENDERBUFFER,w[M])}if(o.msaaFrameBuffer=h,o.msaaRenderbuffers=w,A===void 0){A=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(A,e),o.depthRenderbuffer=A;const M=u?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;S.push(M)}o.invalidationArray=S}r=o.msaaFrameBuffer}else r=_}i.bindFramebuffer(t.FRAMEBUFFER,r)}_getVaoKey(e,t){let i=[];if(e!==null){const r=this.get(e);i+=":"+r.id}for(let r=0;r<t.length;r++){const s=this.get(t[r]);i+=":"+s.id}return i}_createVao(e,t){const{gl:i}=this,r=i.createVertexArray();let s="",o=!0;if(i.bindVertexArray(r),e!==null){const a=this.get(e);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,a.bufferGPU),s+=":"+a.id}for(let a=0;a<t.length;a++){const l=t[a],u=this.get(l);s+=":"+u.id,i.bindBuffer(i.ARRAY_BUFFER,u.bufferGPU),i.enableVertexAttribArray(a),(l.isStorageBufferAttribute||l.isStorageInstancedBufferAttribute)&&(o=!1);let c,h;l.isInterleavedBufferAttribute===!0?(c=l.data.stride*u.bytesPerElement,h=l.offset*u.bytesPerElement):(c=0,h=0),u.isInteger?i.vertexAttribIPointer(a,l.itemSize,u.type,c,h):i.vertexAttribPointer(a,l.itemSize,u.type,l.normalized,c,h),l.isInstancedBufferAttribute&&!l.isInterleavedBufferAttribute?i.vertexAttribDivisor(a,l.meshPerAttribute):l.isInterleavedBufferAttribute&&l.data.isInstancedInterleavedBuffer&&i.vertexAttribDivisor(a,l.data.meshPerAttribute)}return i.bindBuffer(i.ARRAY_BUFFER,null),this.vaoCache[s]=r,{vaoGPU:r,staticVao:o}}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let i=this.transformFeedbackCache[t];if(i!==void 0)return i;const{gl:r}=this;i=r.createTransformFeedback(),r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,i);for(let s=0;s<e.length;s++){const o=e[s];r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,s,o.transformBuffer)}return r.bindTransformFeedback(r.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=i,i}_setupBindings(e,t){const i=this.gl;for(const r of e)for(const s of r.bindings){const a=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const l=i.getUniformBlockIndex(t,s.name);i.uniformBlockBinding(t,l,a)}else if(s.isSampledTexture){const l=i.getUniformLocation(t,s.name);i.uniform1i(l,a)}}}_bindUniforms(e){const{gl:t,state:i}=this;for(const r of e)for(const s of r.bindings){const o=this.get(s),a=o.index;s.isUniformsGroup||s.isUniformBuffer?i.bindBufferBase(t.UNIFORM_BUFFER,a,o.bufferGPU):s.isSampledTexture&&i.bindTexture(o.glTextureType,o.textureGPU,t.TEXTURE0+a)}}dispose(){this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}class Owe extends AN{constructor(e,t){super(e),this.texture=t,this.version=t?t.version:0,this.isSampler=!0}}class Uwe extends Owe{constructor(e,t,i){super(e,t?t.value:null),this.textureNode=t,this.groupNode=i}update(){this.texture=this.textureNode.value}}class zwe extends yj{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let Vwe=0;class Gwe extends zwe{constructor(e,t){super("StorageBuffer_"+Vwe++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:XR.Storage,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class qwe extends Af{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,r=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:id.Linear}),this.flipYSampler=e.createSampler({minFilter:id.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:i}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:r})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:IA.TriangleStrip,stripIndexFormat:F0.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:IA.TriangleStrip,stripIndexFormat:F0.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,i=0){const r=t.format,{width:s,height:o}=t.size,a=this.getTransferPipeline(r),l=this.getFlipYPipeline(r),u=this.device.createTexture({size:{width:s,height:o,depthOrArrayLayers:1},format:r,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),c=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Sa.TwoD,baseArrayLayer:i}),h=u.createView({baseMipLevel:0,mipLevelCount:1,dimension:Sa.TwoD,baseArrayLayer:0}),A=this.device.createCommandEncoder({}),v=(_,S,w)=>{const x=_.getBindGroupLayout(0),M=this.device.createBindGroup({layout:x,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:S}]}),R=A.beginRenderPass({colorAttachments:[{view:w,loadOp:Sr.Clear,storeOp:ts.Store,clearValue:[0,0,0,0]}]});R.setPipeline(_),R.setBindGroup(0,M),R.draw(4,1,0,0),R.end()};v(a,c,h),v(l,h,c),this.device.queue.submit([A.finish()]),u.destroy()}generateMipmaps(e,t,i=0){const r=this.get(e);r.useCount===void 0&&(r.useCount=0,r.layers=[]);const s=r.layers[i]||this._mipmapCreateBundles(e,t,i),o=this.device.createCommandEncoder({});this._mipmapRunBundles(o,s),this.device.queue.submit([o.finish()]),r.useCount!==0&&(r.layers[i]=s),r.useCount++}_mipmapCreateBundles(e,t,i){const r=this.getTransferPipeline(t.format),s=r.getBindGroupLayout(0);let o=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Sa.TwoD,baseArrayLayer:i});const a=[];for(let l=1;l<t.mipLevelCount;l++){const u=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:o}]}),c=e.createView({baseMipLevel:l,mipLevelCount:1,dimension:Sa.TwoD,baseArrayLayer:i}),h={colorAttachments:[{view:c,loadOp:Sr.Clear,storeOp:ts.Store,clearValue:[0,0,0,0]}]},A=this.device.createRenderBundleEncoder({colorFormats:[t.format]});A.setPipeline(r),A.setBindGroup(0,u),A.draw(4,1,0,0),a.push({renderBundles:[A.finish()],passDescriptor:h}),o=c}return a}_mipmapRunBundles(e,t){const i=t.length;for(let r=0;r<i;r++){const s=t[r],o=e.beginRenderPass(s.passDescriptor);o.executeBundles(s.renderBundles),o.end()}}}const Hwe={[yH]:"never",[D6]:"less",[_H]:"equal",[xH]:"less-equal",[bH]:"greater",[wH]:"greater-equal",[EH]:"always",[SH]:"not-equal"},$we=[0,1,3,2,4,5];class jwe{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this.colorBuffer=null,this.depthTexture=new em,this.depthTexture.name="depthBuffer"}createSampler(e){const t=this.backend,i=t.device,r=t.get(e),s={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};s.magFilter===id.Linear&&s.minFilter===id.Linear&&s.mipmapFilter===id.Linear&&(s.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(s.compare=Hwe[e.compareFunction]),r.sampler=i.createSampler(s)}createDefaultTexture(e){let t;const i=KR(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(i):e.isVideoTexture?this.backend.get(e).externalTexture=this._getDefaultVideoFrame():t=this._getDefaultTextureGPU(i),this.backend.get(e).texture=t}createTexture(e,t={}){const i=this.backend,r=i.get(e);if(r.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:o,depth:a,levels:l}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const u=this._getDimension(e),c=e.internalFormat||t.format||KR(e,i.device);r.format=c;let h=t.sampleCount!==void 0?t.sampleCount:1;h=i.utils.getSampleCount(h);const A=e.isRenderTargetTexture&&!e.isMultisampleRenderTargetTexture?1:h;let v=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(v|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&(v|=GPUTextureUsage.RENDER_ATTACHMENT);const _={label:e.name,size:{width:s,height:o,depthOrArrayLayers:a},mipLevelCount:l,sampleCount:A,dimension:u,format:c,usage:v};if(e.isVideoTexture){const S=e.source.data,w=new VideoFrame(S);_.size.width=w.displayWidth,_.size.height=w.displayHeight,w.close(),r.externalTexture=S}else{if(c===void 0)return console.warn("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);r.texture=i.device.createTexture(_)}if(e.isRenderTargetTexture&&h>1&&!e.isMultisampleRenderTargetTexture){const S=Object.assign({},_);S.label=S.label+"-msaa",S.sampleCount=h,r.msaaTexture=i.device.createTexture(S)}r.initialized=!0,r.textureDescriptorGPU=_}destroyTexture(e){const t=this.backend,i=t.get(e);i.texture.destroy(),i.msaaTexture!==void 0&&i.msaaTexture.destroy(),t.delete(e)}destroySampler(e){const i=this.backend.get(e);delete i.sampler}generateMipmaps(e){const t=this.backend.get(e);if(e.isCubeTexture)for(let i=0;i<6;i++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,i);else{const i=e.image.depth||1;for(let r=0;r<i;r++)this._generateMipmaps(t.texture,t.textureDescriptorGPU,r)}}getColorBuffer(){this.colorBuffer&&this.colorBuffer.destroy();const e=this.backend,{width:t,height:i}=e.getDrawingBufferSize();return this.colorBuffer=e.device.createTexture({label:"colorBuffer",size:{width:t,height:i,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.samples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),this.colorBuffer}getDepthBuffer(e=!0,t=!1){const i=this.backend,{width:r,height:s}=i.getDrawingBufferSize(),o=this.depthTexture,a=i.get(o).texture;let l,u;if(t?(l=D0,u=Iv):e&&(l=wd,u=rs),a!==void 0){if(o.image.width===r&&o.image.height===s&&o.format===l&&o.type===u)return a;this.destroyTexture(o)}return o.name="depthBuffer",o.format=l,o.type=u,o.image.width=r,o.image.height=s,this.createTexture(o,{sampleCount:i.utils.getSampleCount(i.renderer.samples),width:r,height:s}),i.get(o).texture}updateTexture(e,t){const i=this.backend.get(e),{textureDescriptorGPU:r}=i;if(!(e.isRenderTargetTexture||r===void 0)){if(e.isDataTexture)this._copyBufferToTexture(t.image,i.texture,r,0,e.flipY);else if(e.isDataArrayTexture||e.isData3DTexture)for(let s=0;s<t.image.depth;s++)this._copyBufferToTexture(t.image,i.texture,r,s,e.flipY,s);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,i.texture,r);else if(e.isCubeTexture)this._copyCubeMapToTexture(t.images,i.texture,r,e.flipY);else if(e.isVideoTexture){const s=e.source.data;i.externalTexture=s}else this._copyImageToTexture(t.image,i.texture,r,0,e.flipY);i.version=e.version,e.onUpdate&&e.onUpdate(e)}}async copyTextureToBuffer(e,t,i,r,s,o){const a=this.backend.device,l=this.backend.get(e),u=l.texture,c=l.textureDescriptorGPU.format,h=this._getBytesPerTexel(c);let A=r*h;A=Math.ceil(A/256)*256;const v=a.createBuffer({size:r*s*h,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),_=a.createCommandEncoder();_.copyTextureToBuffer({texture:u,origin:{x:t,y:i,z:o}},{buffer:v,bytesPerRow:A},{width:r,height:s});const S=this._getTypedArrayType(c);a.queue.submit([_.finish()]),await v.mapAsync(GPUMapMode.READ);const w=v.getMappedRange();return new S(w)}_isEnvironmentTexture(e){const t=e.mapping;return t===Pv||t===Nv||t===Fd||t===I0}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const i=new to;i.minFilter=Ps,i.magFilter=Ps,this.createTexture(i,{width:1,height:1,format:e}),this.defaultTexture[e]=t=i}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const i=new F6;i.minFilter=Ps,i.magFilter=Ps,this.createTexture(i,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=i}return this.backend.get(t).texture}_getDefaultVideoFrame(){let e=this.defaultVideoFrame;if(e===null){const t={timestamp:0,codedWidth:1,codedHeight:1,format:"RGBA"};this.defaultVideoFrame=e=new VideoFrame(new Uint8Array([0,0,0,255]),t)}return e}_copyCubeMapToTexture(e,t,i,r){for(let s=0;s<6;s++){const o=e[s],a=r===!0?$we[s]:s;o.isDataTexture?this._copyBufferToTexture(o.image,t,i,a,r):this._copyImageToTexture(o,t,i,a,r)}}_copyImageToTexture(e,t,i,r,s){this.backend.device.queue.copyExternalImageToTexture({source:e},{texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,i,r)}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new qwe(this.backend.device)),e}_generateMipmaps(e,t,i=0){this._getPassUtils().generateMipmaps(e,t,i)}_flipY(e,t,i=0){this._getPassUtils().flipY(e,t,i)}_copyBufferToTexture(e,t,i,r,s,o=0){const a=this.backend.device,l=e.data,u=this._getBytesPerTexel(i.format),c=e.width*u;a.queue.writeTexture({texture:t,mipLevel:0,origin:{x:0,y:0,z:r}},l,{offset:e.width*e.height*u*o,bytesPerRow:c},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,i,r)}_copyCompressedBufferToTexture(e,t,i){const r=this.backend.device,s=this._getBlockData(i.format),o=i.size.depthOrArrayLayers>1;for(let a=0;a<e.length;a++){const l=e[a],u=l.width,c=l.height,h=o?i.size.depthOrArrayLayers:1,A=Math.ceil(u/s.width)*s.byteLength,v=A*Math.ceil(c/s.height);for(let _=0;_<h;_++)r.queue.writeTexture({texture:t,mipLevel:a,origin:{x:0,y:0,z:_}},l.data,{offset:_*v,bytesPerRow:A,rowsPerImage:Math.ceil(c/s.height)},{width:Math.ceil(u/s.width)*s.width,height:Math.ceil(c/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===Ae.BC1RGBAUnorm||e===Ae.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ae.BC2RGBAUnorm||e===Ae.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ae.BC3RGBAUnorm||e===Ae.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ae.BC4RUnorm||e===Ae.BC4RSNorm)return{byteLength:8,width:4,height:4};if(e===Ae.BC5RGUnorm||e===Ae.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===Ae.BC6HRGBUFloat||e===Ae.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===Ae.BC7RGBAUnorm||e===Ae.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ae.ETC2RGB8Unorm||e===Ae.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ae.ETC2RGB8A1Unorm||e===Ae.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===Ae.ETC2RGBA8Unorm||e===Ae.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ae.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===Ae.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===Ae.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===Ae.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===Ae.ASTC4x4Unorm||e===Ae.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===Ae.ASTC5x4Unorm||e===Ae.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===Ae.ASTC5x5Unorm||e===Ae.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===Ae.ASTC6x5Unorm||e===Ae.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===Ae.ASTC6x6Unorm||e===Ae.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===Ae.ASTC8x5Unorm||e===Ae.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===Ae.ASTC8x6Unorm||e===Ae.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===Ae.ASTC8x8Unorm||e===Ae.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===Ae.ASTC10x5Unorm||e===Ae.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===Ae.ASTC10x6Unorm||e===Ae.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===Ae.ASTC10x8Unorm||e===Ae.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===Ae.ASTC10x10Unorm||e===Ae.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===Ae.ASTC12x10Unorm||e===Ae.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===Ae.ASTC12x12Unorm||e===Ae.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=CT.ClampToEdge;return e===Nb?t=CT.Repeat:e===Ib&&(t=CT.MirrorRepeat),t}_convertFilterMode(e){let t=id.Linear;return(e===Ps||e===AR||e===QA)&&(t=id.Nearest),t}_getBytesPerTexel(e){if(e===Ae.R8Unorm||e===Ae.R8Snorm||e===Ae.R8Uint||e===Ae.R8Sint)return 1;if(e===Ae.R16Uint||e===Ae.R16Sint||e===Ae.R16Float||e===Ae.RG8Unorm||e===Ae.RG8Snorm||e===Ae.RG8Uint||e===Ae.RG8Sint)return 2;if(e===Ae.R32Uint||e===Ae.R32Sint||e===Ae.R32Float||e===Ae.RG16Uint||e===Ae.RG16Sint||e===Ae.RG16Float||e===Ae.RGBA8Unorm||e===Ae.RGBA8UnormSRGB||e===Ae.RGBA8Snorm||e===Ae.RGBA8Uint||e===Ae.RGBA8Sint||e===Ae.BGRA8Unorm||e===Ae.BGRA8UnormSRGB||e===Ae.RGB9E5UFloat||e===Ae.RGB10A2Unorm||e===Ae.RG11B10UFloat||e===Ae.Depth32Float||e===Ae.Depth24Plus||e===Ae.Depth24PlusStencil8||e===Ae.Depth32FloatStencil8)return 4;if(e===Ae.RG32Uint||e===Ae.RG32Sint||e===Ae.RG32Float||e===Ae.RGBA16Uint||e===Ae.RGBA16Sint||e===Ae.RGBA16Float)return 8;if(e===Ae.RGBA32Uint||e===Ae.RGBA32Sint||e===Ae.RGBA32Float)return 16}_getTypedArrayType(e){if(e===Ae.R8Uint)return Uint8Array;if(e===Ae.R8Sint)return Int8Array;if(e===Ae.R8Unorm)return Uint8Array;if(e===Ae.R8Snorm)return Int8Array;if(e===Ae.RG8Uint)return Uint8Array;if(e===Ae.RG8Sint)return Int8Array;if(e===Ae.RG8Unorm)return Uint8Array;if(e===Ae.RG8Snorm)return Int8Array;if(e===Ae.RGBA8Uint)return Uint8Array;if(e===Ae.RGBA8Sint)return Int8Array;if(e===Ae.RGBA8Unorm)return Uint8Array;if(e===Ae.RGBA8Snorm)return Int8Array;if(e===Ae.R16Uint)return Uint16Array;if(e===Ae.R16Sint)return Int16Array;if(e===Ae.RG16Uint)return Uint16Array;if(e===Ae.RG16Sint)return Int16Array;if(e===Ae.RGBA16Uint)return Uint16Array;if(e===Ae.RGBA16Sint)return Int16Array;if(e===Ae.R16Float||e===Ae.RG16Float||e===Ae.RGBA16Float)return Uint16Array;if(e===Ae.R32Uint)return Uint32Array;if(e===Ae.R32Sint)return Int32Array;if(e===Ae.R32Float)return Float32Array;if(e===Ae.RG32Uint)return Uint32Array;if(e===Ae.RG32Sint)return Int32Array;if(e===Ae.RG32Float)return Float32Array;if(e===Ae.RGBA32Uint)return Uint32Array;if(e===Ae.RGBA32Sint)return Int32Array;if(e===Ae.RGBA32Float)return Float32Array;if(e===Ae.BGRA8Unorm||e===Ae.BGRA8UnormSRGB)return Uint8Array;if(e===Ae.RGB10A2Unorm||e===Ae.RGB9E5UFloat||e===Ae.RG11B10UFloat)return Uint32Array;if(e===Ae.Depth32Float)return Float32Array;if(e===Ae.Depth24Plus||e===Ae.Depth24PlusStencil8)return Uint32Array;if(e===Ae.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.isData3DTexture?t=pB.ThreeD:t=pB.TwoD,t}}function KR(n,e=null){const t=n.format,i=n.type,r=n.colorSpace;let s;if(n.isCompressedTexture===!0||n.isCompressedArrayTexture===!0)switch(t){case X2:s=r===Jt?Ae.BC1RGBAUnormSRGB:Ae.BC1RGBAUnorm;break;case Y2:s=r===Jt?Ae.BC2RGBAUnormSRGB:Ae.BC2RGBAUnorm;break;case Q2:s=r===Jt?Ae.BC3RGBAUnormSRGB:Ae.BC3RGBAUnorm;break;case gR:s=r===Jt?Ae.ETC2RGB8UnormSRGB:Ae.ETC2RGB8Unorm;break;case vR:s=r===Jt?Ae.ETC2RGBA8UnormSRGB:Ae.ETC2RGBA8Unorm;break;case yR:s=r===Jt?Ae.ASTC4x4UnormSRGB:Ae.ASTC4x4Unorm;break;case _R:s=r===Jt?Ae.ASTC5x4UnormSRGB:Ae.ASTC5x4Unorm;break;case xR:s=r===Jt?Ae.ASTC5x5UnormSRGB:Ae.ASTC5x5Unorm;break;case bR:s=r===Jt?Ae.ASTC6x5UnormSRGB:Ae.ASTC6x5Unorm;break;case SR:s=r===Jt?Ae.ASTC6x6UnormSRGB:Ae.ASTC6x6Unorm;break;case wR:s=r===Jt?Ae.ASTC8x5UnormSRGB:Ae.ASTC8x5Unorm;break;case ER:s=r===Jt?Ae.ASTC8x6UnormSRGB:Ae.ASTC8x6Unorm;break;case TR:s=r===Jt?Ae.ASTC8x8UnormSRGB:Ae.ASTC8x8Unorm;break;case CR:s=r===Jt?Ae.ASTC10x5UnormSRGB:Ae.ASTC10x5Unorm;break;case MR:s=r===Jt?Ae.ASTC10x6UnormSRGB:Ae.ASTC10x6Unorm;break;case RR:s=r===Jt?Ae.ASTC10x8UnormSRGB:Ae.ASTC10x8Unorm;break;case PR:s=r===Jt?Ae.ASTC10x10UnormSRGB:Ae.ASTC10x10Unorm;break;case NR:s=r===Jt?Ae.ASTC12x10UnormSRGB:Ae.ASTC12x10Unorm;break;case IR:s=r===Jt?Ae.ASTC12x12UnormSRGB:Ae.ASTC12x12Unorm;break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case K0:switch(i){case Gg:s=Ae.RGBA8Snorm;break;case qg:s=Ae.RGBA16Sint;break;case MA:s=Ae.RGBA16Uint;break;case rs:s=Ae.RGBA32Uint;break;case Qs:s=Ae.RGBA32Sint;break;case Uh:s=r===Jt?Ae.RGBA8UnormSRGB:Ae.RGBA8Unorm;break;case ec:s=Ae.RGBA16Float;break;case na:s=Ae.RGBA32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAFormat.",i)}break;case M6:switch(i){case gH:s=Ae.RGB9E5UFloat;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBFormat.",i)}break;case R6:switch(i){case Gg:s=Ae.R8Snorm;break;case qg:s=Ae.R16Sint;break;case MA:s=Ae.R16Uint;break;case rs:s=Ae.R32Uint;break;case Qs:s=Ae.R32Sint;break;case Uh:s=Ae.R8Unorm;break;case ec:s=Ae.R16Float;break;case na:s=Ae.R32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RedFormat.",i)}break;case z1:switch(i){case Gg:s=Ae.RG8Snorm;break;case qg:s=Ae.RG16Sint;break;case MA:s=Ae.RG16Uint;break;case rs:s=Ae.RG32Uint;break;case Qs:s=Ae.RG32Sint;break;case Uh:s=Ae.RG8Unorm;break;case ec:s=Ae.RG16Float;break;case na:s=Ae.RG32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with RGFormat.",i)}break;case wd:switch(i){case MA:s=Ae.Depth16Unorm;break;case rs:s=Ae.Depth24Plus;break;case na:s=Ae.Depth32Float;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthFormat.",i)}break;case D0:switch(i){case Iv:s=Ae.Depth24PlusStencil8;break;case na:e&&e.features.has(YR.Depth32FloatStencil8)===!1&&console.error('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),s=Ae.Depth32FloatStencil8;break;default:console.error("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",i)}break;case P6:switch(i){case Qs:s=Ae.R32Sint;break;case rs:s=Ae.R32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",i)}break;case N6:switch(i){case Qs:s=Ae.RG32Sint;break;case rs:s=Ae.RG32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",i)}break;case I6:switch(i){case Qs:s=Ae.RGBA32Sint;break;case rs:s=Ae.RGBA32Uint;break;default:console.error("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",i)}break;default:console.error("WebGPURenderer: Unsupported texture format.",t)}return s}const Wwe=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,Xwe=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,LB={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},Ywe=n=>{n=n.trim();const e=n.match(Wwe);if(e!==null&&e.length===4){const t=e[2],i=[];let r=null;for(;(r=Xwe.exec(t))!==null;)i.push({name:r[1],type:r[2]});const s=[];for(let c=0;c<i.length;c++){const{name:h,type:A}=i[c];let v=A;v.startsWith("ptr")?v="pointer":(v.startsWith("texture")&&(v=A.split("<")[0]),v=LB[v]),s.push(new dN(v,h))}const o=n.substring(e[0].length),a=e[3]||"void",l=e[1]!==void 0?e[1]:"";return{type:LB[a]||a,inputs:s,name:l,inputsCode:t,blockCode:o,outputType:a}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class Qwe extends pN{constructor(e){const{type:t,inputs:i,name:r,inputsCode:s,blockCode:o,outputType:a}=Ywe(e);super(t,i,r),this.inputsCode=s,this.blockCode=o,this.outputType=a}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class Kwe extends gj{parseFunction(e){return new Qwe(e)}}const Jp=self.GPUShaderStage,r2={vertex:Jp?Jp.VERTEX:1,fragment:Jp?Jp.FRAGMENT:2,compute:Jp?Jp.COMPUTE:4},FB={instance:!0,swizzleAssign:!1,storageBuffer:!0},Zwe={"^^":"tsl_xor"},Jwe={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},Iu={tsl_xor:new Cs("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new Cs("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new Cs("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new Cs("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new Cs("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new Cs("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new Cs("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new Cs("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new Cs("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping:new Cs(`
fn tsl_repeatWrapping( uv : vec2<f32>, dimension : vec2<u32> ) -> vec2<u32> {

	let uvScaled = vec2<u32>( uv * vec2<f32>( dimension ) );

	return ( ( uvScaled % dimension ) + dimension ) % dimension;

}
`),biquadraticTexture:new Cs(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, level : i32 ) -> vec4f {

	let iRes = vec2i( textureDimensions( map, level ) );
	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2i( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2i( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2i( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2i( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},bg={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>"};/Windows/g.test(navigator.userAgent)&&(Iu.pow_float=new Cs("fn tsl_pow_float( a : f32, b : f32 ) -> f32 { return select( -pow( -a, b ), pow( a, b ), a > 0.0 ); }"),Iu.pow_vec2=new Cs("fn tsl_pow_vec2( a : vec2f, b : vec2f ) -> vec2f { return vec2f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ) ); }",[Iu.pow_float]),Iu.pow_vec3=new Cs("fn tsl_pow_vec3( a : vec3f, b : vec3f ) -> vec3f { return vec3f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ) ); }",[Iu.pow_float]),Iu.pow_vec4=new Cs("fn tsl_pow_vec4( a : vec4f, b : vec4f ) -> vec4f { return vec4f( tsl_pow_float( a.x, b.x ), tsl_pow_float( a.y, b.y ), tsl_pow_float( a.z, b.z ), tsl_pow_float( a.w, b.w ) ); }",[Iu.pow_float]),bg.pow_float="tsl_pow_float",bg.pow_vec2="tsl_pow_vec2",bg.pow_vec3="tsl_pow_vec3",bg.pow_vec4="tsl_pow_vec4");let Tj="";/Firefox|Deno/g.test(navigator.userAgent)!==!0&&(Tj+=`diagnostic( off, derivative_uniformity );
`);class eEe extends Aj{constructor(e,t){super(e,t,new Kwe),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Bd}_generateTextureSample(e,t,i,r,s=this.shaderStage){return s==="fragment"?r?`textureSample( ${t}, ${t}_sampler, ${i}, ${r} )`:`textureSample( ${t}, ${t}_sampler, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,i):this.generateTextureLod(e,t,i,"0")}_generateVideoSample(e,t,i=this.shaderStage){if(i==="fragment")return`textureSampleBaseClampToEdge( ${e}, ${e}_sampler, vec2<f32>( ${t}.x, 1.0 - ${t}.y ) )`;console.error(`WebGPURenderer: THREE.VideoTexture does not support ${i} shader.`)}_generateTextureSampleLevel(e,t,i,r,s,o=this.shaderStage){return o==="fragment"&&this.isUnfilterable(e)===!1?`textureSampleLevel( ${t}, ${t}_sampler, ${i}, ${r} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,i,r):this.generateTextureLod(e,t,i,r)}generateFilteredTexture(e,t,i,r="0"){return this._include("biquadraticTexture"),`tsl_biquadraticTexture( ${t}, ${i}, i32( ${r} ) )`}generateTextureLod(e,t,i,r="0"){this._include("repeatWrapping");const s=e.isMultisampleRenderTargetTexture===!0?`textureDimensions( ${t} )`:`textureDimensions( ${t}, 0 )`;return`textureLoad( ${t}, tsl_repeatWrapping( ${i}, ${s} ), i32( ${r} ) )`}generateTextureLoad(e,t,i,r,s="0u"){return r?`textureLoad( ${t}, ${i}, ${r}, ${s} )`:`textureLoad( ${t}, ${i}, ${s} )`}generateTextureStore(e,t,i,r){return`textureStore( ${t}, ${i}, ${r} )`}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===na||e.isMultisampleRenderTargetTexture===!0}generateTexture(e,t,i,r,s=this.shaderStage){let o=null;return e.isVideoTexture===!0?o=this._generateVideoSample(t,i,s):this.isUnfilterable(e)?o=this.generateTextureLod(e,t,i,"0",r,s):o=this._generateTextureSample(e,t,i,r,s),o}generateTextureGrad(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleGrad( ${t}, ${t}_sampler, ${i},  ${r[0]}, ${r[1]} )`;console.error(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleCompare( ${t}, ${t}_sampler, ${i}, ${r} )`;console.error(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,i,r,s,o=this.shaderStage){let a=null;return e.isVideoTexture===!0?a=this._generateVideoSample(t,i,o):a=this._generateTextureSampleLevel(e,t,i,r,s,o),a}generateTextureBias(e,t,i,r,s,o=this.shaderStage){if(o==="fragment")return`textureSampleBias( ${t}, ${t}_sampler, ${i}, ${r} )`;console.error(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const i=e.name,r=e.type;return r==="texture"||r==="cubeTexture"||r==="storageTexture"||r==="texture3D"?i:r==="buffer"||r==="storageBuffer"||r==="indirectStorageBuffer"?`NodeBuffer_${e.id}.${i}`:e.groupNode.name+"."+i}return super.getPropertyName(e)}getOutputStructName(){return"output"}_getUniformGroupCount(e){return Object.keys(this.uniforms[e]).length}getFunctionOperator(e){const t=Zwe[e];return t!==void 0?(this._include(t),t):null}getStorageAccess(e){if(e.isStorageTextureNode)switch(e.access){case dB.ReadOnly:return"read";case dB.WriteOnly:return"write";default:return"read_write"}else switch(e.access){case XR.Storage:return"read_write";case XR.ReadOnlyStorage:return"read";default:return"write"}}getUniformFromNode(e,t,i,r=null){const s=super.getUniformFromNode(e,t,i,r),o=this.getDataFromNode(e,i,this.globalCache);if(o.uniformGPU===void 0){let a;const l=e.groupNode,u=l.name,c=this.getBindGroupArray(u,i);if(t==="texture"||t==="cubeTexture"||t==="storageTexture"||t==="texture3D"){let h=null;if(t==="texture"||t==="storageTexture"?h=new _w(s.name,s.node,l,e.access?e.access:null):t==="cubeTexture"?h=new Sj(s.name,s.node,l,e.access?e.access:null):t==="texture3D"&&(h=new wj(s.name,s.node,l,e.access?e.access:null)),h.store=e.isStorageTextureNode===!0,h.setVisibility(r2[i]),i==="fragment"&&this.isUnfilterable(e.value)===!1&&h.store===!1){const A=new Uwe(`${s.name}_sampler`,s.node,l);A.setVisibility(r2[i]),c.push(A,h),a=[A,h]}else c.push(h),a=[h]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const h=t==="buffer"?xj:Gwe,A=new h(e,l);A.setVisibility(r2[i]),c.push(A),a=A}else{const h=this.uniformGroups[i]||(this.uniformGroups[i]={});let A=h[u];A===void 0&&(A=new bj(u,l),A.setVisibility(r2[i]),h[u]=A,c.push(A)),a=this.getNodeUniform(s,t),A.addUniform(a)}o.uniformGPU=a}return s}getBuiltin(e,t,i,r=this.shaderStage){const s=this.builtins[r]||(this.builtins[r]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:i}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,i=this.flowShaderNode(e),r=[];for(const o of t.inputs)r.push(o.name+" : "+this.getType(o.type));let s=`fn ${t.name}( ${r.join(", ")} ) -> ${this.getType(t.type)} {
${i.vars}
${i.code}
`;return i.result&&(s+=`	return ${i.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],i=this.directives[e];if(i!==void 0)for(const r of i)t.push(`enable ${r};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}getBuiltins(e){const t=[],i=this.builtins[e];if(i!==void 0)for(const{name:r,property:s,type:o}of i.values())t.push(`@builtin( ${r} ) ${s} : ${o}`);return t.join(`,
	`)}getScopedArray(e,t,i,r){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:i,bufferCount:r}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:i,scope:r,bufferType:s,bufferCount:o}of this.scopedArrays.values()){const a=this.getType(s);t.push(`var<${r}> ${i}: array< ${a}, ${o} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","id","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const i=this.getBuiltins("attribute");i&&t.push(i);const r=this.getAttributesArray();for(let s=0,o=r.length;s<o;s++){const a=r[s],l=a.name,u=this.getType(a.type);t.push(`@location( ${s} ) ${l} : ${u}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[],i=e.getMemberTypes();for(let s=0;s<i.length;s++){const o=i[s];t.push(`	@location( ${s} ) m${s} : ${o}<f32>`)}const r=this.getBuiltins("output");return r&&t.push("	"+r),t.join(`,
`)}getStructs(e){const t=[],i=this.structs[e];for(let r=0,s=i.length;r<s;r++){const o=i[r],a=o.name;let l=`struct ${a} {
`;l+=this.getStructMembers(o),l+=`
}`,t.push(l),t.push(`
var<private> output : ${a};

`)}return t.join(`

`)}getVar(e,t){return`var ${t} : ${this.getType(e)}`}getVars(e){const t=[],i=this.vars[e];if(i!==void 0)for(const r of i)t.push(`	${this.getVar(r.type,r.name)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,o=this.vars[e];for(let a=0;a<s.length;a++){const l=s[a];if(l.needsInterpolation){let u=`@location( ${a} )`;/^(int|uint|ivec|uvec)/.test(l.type)&&(u+=" @interpolate( flat )"),t.push(`${u} ${l.name} : ${this.getType(l.type)}`)}else e==="vertex"&&o.includes(l)===!1&&o.push(l)}}const i=this.getBuiltins(e);i&&t.push(i);const r=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+r):r}getUniforms(e){const t=this.uniforms[e],i=[],r=[],s=[],o={};for(const l of t){const u=l.groupNode.name,c=this.bindingsIndexes[u];if(l.type==="texture"||l.type==="cubeTexture"||l.type==="storageTexture"||l.type==="texture3D"){const h=l.node.value;e==="fragment"&&this.isUnfilterable(h)===!1&&l.node.isStorageTextureNode!==!0&&(h.isDepthTexture===!0&&h.compareFunction!==null?i.push(`@binding( ${c.binding++} ) @group( ${c.group} ) var ${l.name}_sampler : sampler_comparison;`):i.push(`@binding( ${c.binding++} ) @group( ${c.group} ) var ${l.name}_sampler : sampler;`));let A,v="";if(h.isMultisampleRenderTargetTexture===!0&&(v="_multisampled"),h.isCubeTexture===!0)A="texture_cube<f32>";else if(h.isDataArrayTexture===!0||h.isCompressedArrayTexture===!0)A="texture_2d_array<f32>";else if(h.isDepthTexture===!0)A=`texture_depth${v}_2d`;else if(h.isVideoTexture===!0)A="texture_external";else if(h.isData3DTexture===!0)A="texture_3d<f32>";else if(l.node.isStorageTextureNode===!0){const _=KR(h),S=this.getStorageAccess(l.node);A=`texture_storage_2d<${_}, ${S}>`}else{const _=this.getComponentTypeFromTexture(h).charAt(0);A=`texture${v}_2d<${_}32>`}i.push(`@binding( ${c.binding++} ) @group( ${c.group} ) var ${l.name} : ${A};`)}else if(l.type==="buffer"||l.type==="storageBuffer"||l.type==="indirectStorageBuffer"){const h=l.node,A=this.getType(h.bufferType),v=h.bufferCount,_=v>0&&l.type==="buffer"?", "+v:"",S=h.isAtomic?`atomic<${A}>`:`${A}`,w=`	${l.name} : array< ${S}${_} >
`,x=h.isStorageBufferNode?`storage, ${this.getStorageAccess(h)}`:"uniform";r.push(this._getWGSLStructBinding("NodeBuffer_"+h.id,w,x,c.binding++,c.group))}else{const h=this.getType(this.getVectorType(l.type)),A=l.groupNode.name;(o[A]||(o[A]={index:c.binding++,id:c.group,snippets:[]})).snippets.push(`	${l.name} : ${h}`)}}for(const l in o){const u=o[l];s.push(this._getWGSLStructBinding(l,u.snippets.join(`,
`),"uniform",u.index,u.id))}let a=i.join(`
`);return a+=r.join(`
`),a+=s.join(`
`),a}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){const i=e[t];i.uniforms=this.getUniforms(t),i.attributes=this.getAttributes(t),i.varyings=this.getVaryings(t),i.structs=this.getStructs(t),i.vars=this.getVars(t),i.codes=this.getCodes(t),i.directives=this.getDirectives(t),i.scopedArrays=this.getScopedArrays(t);let r=`// code

`;r+=this.flowCode[t];const s=this.flowNodes[t],o=s[s.length-1],a=o.outputNode,l=a!==void 0&&a.isOutputStructNode===!0;for(const u of s){const c=this.getFlowData(u),h=u.name;if(h&&(r.length>0&&(r+=`
`),r+=`	// flow -> ${h}
	`),r+=`${c.code}
	`,u===o&&t!=="compute"){if(r+=`// result

	`,t==="vertex")r+=`varyings.Vertex = ${c.result};`;else if(t==="fragment")if(l)i.returnType=a.nodeType,r+=`return ${c.result};`;else{let A="	@location(0) color: vec4<f32>";const v=this.getBuiltins("output");v&&(A+=`,
	`+v),i.returnType="OutputStruct",i.structs+=this._getWGSLStruct("OutputStruct",A),i.structs+=`
var<private> output : OutputStruct;

`,r+=`output.color = ${c.result};

	return output;`}}}i.flow=r}this.material!==null?(this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment)):this.computeShader=this._getWGSLComputeCode(e.compute,(this.object.workgroupSize||[64]).join(", "))}getMethod(e,t=null){let i;return t!==null&&(i=this._getWGSLMethod(e+"_"+t)),i===void 0&&(i=this._getWGSLMethod(e)),i||e}getType(e){return Jwe[e]||e}isAvailable(e){let t=FB[e];return t===void 0&&(e==="float32Filterable"&&(t=this.renderer.hasFeature("float32-filterable")),FB[e]=t),t}_getWGSLMethod(e){return Iu[e]!==void 0&&this._include(e),bg[e]}_include(e){const t=Iu[e];return t.build(this),this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${Tj}

// uniforms
${e.uniforms}

// structs
${e.structs}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${t} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = id.x + id.y * numWorkgroups.x * u32(${t}) + id.z * numWorkgroups.x * numWorkgroups.y * u32(${t});

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,i,r=0,s=0){const o=e+"Struct";return`${this._getWGSLStruct(o,t)}
@binding( ${r} ) @group( ${s} )
var<${i}> ${e} : ${o};`}}class tEe{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=Ae.Depth24PlusStencil8:e.depth&&(t=Ae.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return IA.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return IA.LineList;if(e.isLine)return IA.LineStrip;if(e.isMesh)return IA.TriangleList}getSampleCount(e){let t=1;return e>1&&(t=Math.pow(2,Math.floor(Math.log2(e))),t===2&&(t=4)),t}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.samples)}getPreferredCanvasFormat(){return navigator.userAgent.includes("Quest")?Ae.BGRA8Unorm:navigator.gpu.getPreferredCanvasFormat()}}const nEe=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]),iEe=new Map([[PH,["float16"]]]),rEe=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class sEe{constructor(e){this.backend=e}createAttribute(e,t){const i=this._getBufferAttribute(e),r=this.backend,s=r.get(i);let o=s.buffer;if(o===void 0){const a=r.device;let l=i.array;if(e.normalized===!1&&(l.constructor===Int16Array||l.constructor===Uint16Array)){const c=new Uint32Array(l.length);for(let h=0;h<l.length;h++)c[h]=l[h];l=c}if(i.array=l,(i.isStorageBufferAttribute||i.isStorageInstancedBufferAttribute)&&i.itemSize===3){l=new l.constructor(i.count*4);for(let c=0;c<i.count;c++)l.set(i.array.subarray(c*3,c*3+3),c*4);i.itemSize=4,i.array=l}const u=l.byteLength+(4-l.byteLength%4)%4;o=a.createBuffer({label:i.name,size:u,usage:t,mappedAtCreation:!0}),new l.constructor(o.getMappedRange()).set(l),o.unmap(),s.buffer=o}}updateAttribute(e){const t=this._getBufferAttribute(e),i=this.backend,r=i.device,s=i.get(t).buffer,o=t.array,a=t.updateRanges;if(a.length===0)r.queue.writeBuffer(s,0,o,0);else{for(let l=0,u=a.length;l<u;l++){const c=a[l];r.queue.writeBuffer(s,0,o,c.start*o.BYTES_PER_ELEMENT,c.count*o.BYTES_PER_ELEMENT)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),i=new Map;for(let r=0;r<t.length;r++){const s=t[r],o=s.array.BYTES_PER_ELEMENT,a=this._getBufferAttribute(s);let l=i.get(a);if(l===void 0){let h,A;s.isInterleavedBufferAttribute===!0?(h=s.data.stride*o,A=s.data.isInstancedInterleavedBuffer?Y_.Instance:Y_.Vertex):(h=s.itemSize*o,A=s.isInstancedBufferAttribute?Y_.Instance:Y_.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(h=4),l={arrayStride:h,attributes:[],stepMode:A},i.set(a,l)}const u=this._getVertexFormat(s),c=s.isInterleavedBufferAttribute===!0?s.offset*o:0;l.attributes.push({shaderLocation:r,offset:c,format:u})}return Array.from(i.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,i=t.device,s=t.get(this._getBufferAttribute(e)).buffer,o=s.size,a=i.createBuffer({label:e.name,size:o,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),l=i.createCommandEncoder({});l.copyBufferToBuffer(s,0,a,0,o),a.unmap();const u=l.finish();return i.queue.submit([u]),await a.mapAsync(GPUMapMode.READ),a.getMappedRange()}_getVertexFormat(e){const{itemSize:t,normalized:i}=e,r=e.array.constructor,s=e.constructor;let o;if(t==1)o=rEe.get(r);else{const l=(iEe.get(s)||nEe.get(r))[i?1:0];if(l){const u=r.BYTES_PER_ELEMENT*t,h=Math.floor((u+3)/4)*4/r.BYTES_PER_ELEMENT;if(h%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");o=`${l}x${h}`}}return o||console.error("THREE.WebGPUAttributeUtils: Vertex format not supported yet."),o}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class oEe{constructor(e){this.backend=e,this.bindGroupLayoutCache=new WeakMap}createBindingsLayout(e){const i=this.backend.device,r=[];let s=0;for(const o of e.bindings){const a={binding:s++,visibility:o.visibility};if(o.isUniformBuffer||o.isStorageBuffer){const l={};o.isStorageBuffer&&(l.type=o.access),a.buffer=l}else if(o.isSampler){const l={};o.texture.isDepthTexture&&o.texture.compareFunction!==null&&(l.type="comparison"),a.sampler=l}else if(o.isSampledTexture&&o.texture.isVideoTexture)a.externalTexture={};else if(o.isSampledTexture&&o.store){const l=this.backend.get(o.texture).texture.format,u=o.access;a.storageTexture={format:l,access:u}}else if(o.isSampledTexture){const l={};if(o.texture.isMultisampleRenderTargetTexture===!0&&(l.multisampled=!0),o.texture.isDepthTexture)l.sampleType=eg.Depth;else if(o.texture.isDataTexture||o.texture.isDataArrayTexture||o.texture.isData3DTexture){const u=o.texture.type;u===Qs?l.sampleType=eg.SInt:u===rs?l.sampleType=eg.UInt:u===na&&(this.backend.hasFeature("float32-filterable")?l.sampleType=eg.Float:l.sampleType=eg.UnfilterableFloat)}o.isSampledCubeTexture?l.viewDimension=Sa.Cube:o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?l.viewDimension=Sa.TwoDArray:o.isSampledTexture3D&&(l.viewDimension=Sa.ThreeD),a.texture=l}else console.error(`WebGPUBindingUtils: Unsupported binding "${o}".`);r.push(a)}return i.createBindGroupLayout({entries:r})}createBindings(e){const{backend:t,bindGroupLayoutCache:i}=this,r=t.get(e);let s=i.get(e.bindingsReference);s===void 0&&(s=this.createBindingsLayout(e),i.set(e.bindingsReference,s));const o=this.createBindGroup(e,s);r.layout=s,r.group=o}updateBinding(e){const t=this.backend,i=t.device,r=e.buffer,s=t.get(e).buffer;i.queue.writeBuffer(s,0,r,0)}createBindGroup(e,t){const i=this.backend,r=i.device;let s=0;const o=[];for(const a of e.bindings){if(a.isUniformBuffer){const l=i.get(a);if(l.buffer===void 0){const u=a.byteLength,c=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,h=r.createBuffer({label:"bindingBuffer_"+a.name,size:u,usage:c});l.buffer=h}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isStorageBuffer){const l=i.get(a);if(l.buffer===void 0){const u=a.attribute;l.buffer=i.get(u).buffer}o.push({binding:s,resource:{buffer:l.buffer}})}else if(a.isSampler){const l=i.get(a.texture);o.push({binding:s,resource:l.sampler})}else if(a.isSampledTexture){const l=i.get(a.texture);let u;if(l.externalTexture!==void 0)u=r.importExternalTexture({source:l.externalTexture});else{const c=a.store?1:l.texture.mipLevelCount,h=`view-${l.texture.width}-${l.texture.height}-${c}`;if(u=l[h],u===void 0){const A=Wbe.All;let v;a.isSampledCubeTexture?v=Sa.Cube:a.isSampledTexture3D?v=Sa.ThreeD:a.texture.isDataArrayTexture||a.texture.isCompressedArrayTexture?v=Sa.TwoDArray:v=Sa.TwoD,u=l[h]=l.texture.createView({aspect:A,dimension:v,mipLevelCount:c})}}o.push({binding:s,resource:u})}s++}return r.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:o})}}class aEe{constructor(e){this.backend=e}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:i,material:r,geometry:s,pipeline:o}=e,{vertexProgram:a,fragmentProgram:l}=o,u=this.backend,c=u.device,h=u.utils,A=u.get(o),v=[];for(const j of e.getBindings()){const ee=u.get(j);v.push(ee.layout)}const _=u.attributeUtils.createShaderVertexBuffers(e);let S;r.transparent===!0&&r.blending!==N0&&(S=this._getBlending(r));let w={};r.stencilWrite===!0&&(w={compare:this._getStencilCompare(r),failOp:this._getStencilOperation(r.stencilFail),depthFailOp:this._getStencilOperation(r.stencilZFail),passOp:this._getStencilOperation(r.stencilZPass)});const x=this._getColorWriteMask(r),M=[];if(e.context.textures!==null){const j=e.context.textures;for(let ee=0;ee<j.length;ee++){const $=h.getTextureFormatGPU(j[ee]);M.push({format:$,blend:S,writeMask:x})}}else{const j=h.getCurrentColorFormat(e.context);M.push({format:j,blend:S,writeMask:x})}const R=u.get(a).module,N=u.get(l).module,B=this._getPrimitiveState(i,s,r),T=this._getDepthCompare(r),D=h.getCurrentDepthStencilFormat(e.context),F=this._getSampleCount(e.context),L={label:`renderPipeline_${r.name||r.type}_${r.id}`,vertex:Object.assign({},R,{buffers:_}),fragment:Object.assign({},N,{targets:M}),primitive:B,multisample:{count:F,alphaToCoverageEnabled:r.alphaToCoverage&&F>1},layout:c.createPipelineLayout({bindGroupLayouts:v})},O={},z=e.context.depth,Q=e.context.stencil;if((z===!0||Q===!0)&&(z===!0&&(O.format=D,O.depthWriteEnabled=r.depthWrite,O.depthCompare=T),Q===!0&&(O.stencilFront=w,O.stencilBack={},O.stencilReadMask=r.stencilFuncMask,O.stencilWriteMask=r.stencilWriteMask),L.depthStencil=O),t===null)A.pipeline=c.createRenderPipeline(L);else{const j=new Promise(ee=>{c.createRenderPipelineAsync(L).then($=>{A.pipeline=$,ee()})});t.push(j)}}createBundleEncoder(e){const t=this.backend,{utils:i,device:r}=t,s=i.getCurrentDepthStencilFormat(e),o=i.getCurrentColorFormat(e),a=this._getSampleCount(e),l={label:"renderBundleEncoder",colorFormats:[o],depthStencilFormat:s,sampleCount:a};return r.createRenderBundleEncoder(l)}createComputePipeline(e,t){const i=this.backend,r=i.device,s=i.get(e.computeProgram).module,o=i.get(e),a=[];for(const l of t){const u=i.get(l);a.push(u.layout)}o.pipeline=r.createComputePipeline({compute:s,layout:r.createPipelineLayout({bindGroupLayouts:a})})}_getBlending(e){let t,i;const r=e.blending,s=e.blendSrc,o=e.blendDst,a=e.blendEquation;if(r===Zq){const l=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,u=e.blendDstAlpha!==null?e.blendDstAlpha:o,c=e.blendEquationAlpha!==null?e.blendEquationAlpha:a;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(o),operation:this._getBlendOperation(a)},i={srcFactor:this._getBlendFactor(l),dstFactor:this._getBlendFactor(u),operation:this._getBlendOperation(c)}}else{const l=e.premultipliedAlpha,u=(c,h,A,v)=>{t={srcFactor:c,dstFactor:h,operation:Uf.Add},i={srcFactor:A,dstFactor:v,operation:Uf.Add}};if(l)switch(r){case Oh:u(vn.One,vn.OneMinusSrcAlpha,vn.One,vn.OneMinusSrcAlpha);break;case Eb:u(vn.One,vn.One,vn.One,vn.One);break;case Tb:u(vn.Zero,vn.OneMinusSrc,vn.Zero,vn.One);break;case Cb:u(vn.Zero,vn.Src,vn.Zero,vn.SrcAlpha);break}else switch(r){case Oh:u(vn.SrcAlpha,vn.OneMinusSrcAlpha,vn.One,vn.OneMinusSrcAlpha);break;case Eb:u(vn.SrcAlpha,vn.One,vn.SrcAlpha,vn.One);break;case Tb:u(vn.Zero,vn.OneMinusSrc,vn.Zero,vn.One);break;case Cb:u(vn.Zero,vn.Src,vn.Zero,vn.Src);break}}if(t!==void 0&&i!==void 0)return{color:t,alpha:i};console.error("THREE.WebGPURenderer: Invalid blending: ",r)}_getBlendFactor(e){let t;switch(e){case tH:t=vn.Zero;break;case nH:t=vn.One;break;case iH:t=vn.Src;break;case rH:t=vn.OneMinusSrc;break;case Mb:t=vn.SrcAlpha;break;case Rb:t=vn.OneMinusSrcAlpha;break;case aH:t=vn.Dst;break;case lH:t=vn.OneMinusDstColor;break;case sH:t=vn.DstAlpha;break;case oH:t=vn.OneMinusDstAlpha;break;case uH:t=vn.SrcAlphaSaturated;break;case xbe:t=vn.Constant;break;case bbe:t=vn.OneMinusConstant;break;default:console.error("THREE.WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const i=e.stencilFunc;switch(i){case qge:t=es.Never;break;case DR:t=es.Always;break;case Hge:t=es.Less;break;case jge:t=es.LessEqual;break;case $ge:t=es.Equal;break;case Yge:t=es.GreaterEqual;break;case Wge:t=es.Greater;break;case Xge:t=es.NotEqual;break;default:console.error("THREE.WebGPURenderer: Invalid stencil function.",i)}return t}_getStencilOperation(e){let t;switch(e){case jf:t=nh.Keep;break;case Fge:t=nh.Zero;break;case Bge:t=nh.Replace;break;case Gge:t=nh.Invert;break;case Oge:t=nh.IncrementClamp;break;case Uge:t=nh.DecrementClamp;break;case zge:t=nh.IncrementWrap;break;case Vge:t=nh.DecrementWrap;break;default:console.error("THREE.WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case gh:t=Uf.Add;break;case Jq:t=Uf.Subtract;break;case eH:t=Uf.ReverseSubtract;break;case vge:t=Uf.Min;break;case yge:t=Uf.Max;break;default:console.error("THREE.WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,i){const r={},s=this.backend.utils;switch(r.topology=s.getPrimitiveTopology(e,i),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(r.stripIndexFormat=t.index.array instanceof Uint16Array?F0.Uint16:F0.Uint32),i.side){case P0:r.frontFace=ET.CCW,r.cullMode=TT.Back;break;case Cl:r.frontFace=ET.CCW,r.cullMode=TT.Front;break;case XA:r.frontFace=ET.CCW,r.cullMode=TT.None;break;default:console.error("THREE.WebGPUPipelineUtils: Unknown material.side value.",i.side);break}return r}_getColorWriteMask(e){return e.colorWrite===!0?fB.All:fB.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=es.Always;else{const i=e.depthFunc;switch(i){case cH:t=es.Never;break;case hH:t=es.Always;break;case fH:t=es.Less;break;case Pb:t=es.LessEqual;break;case dH:t=es.Equal;break;case pH:t=es.GreaterEqual;break;case AH:t=es.Greater;break;case mH:t=es.NotEqual;break;default:console.error("THREE.WebGPUPipelineUtils: Invalid depth function.",i)}}return t}}class lEe extends Ej{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.trackTimestamp=e.trackTimestamp===!0,this.device=null,this.context=null,this.colorBuffer=null,this.defaultRenderPassdescriptor=null,this.utils=new tEe(this),this.attributeUtils=new sEe(this),this.bindingUtils=new oEe(this),this.pipelineUtils=new aEe(this),this.textureUtils=new jwe(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let i;if(t.device===void 0){const o={powerPreference:t.powerPreference},a=await navigator.gpu.requestAdapter(o);if(a===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const l=Object.values(YR),u=[];for(const h of l)a.features.has(h)&&u.push(h);const c={requiredFeatures:u,requiredLimits:t.requiredLimits};i=await a.requestDevice(c)}else i=t.device;i.lost.then(o=>{const a={api:"WebGPU",message:o.message||"Unknown reason",reason:o.reason||null,originalEvent:o};e.onDeviceLost(a)});const r=t.context!==void 0?t.context:e.domElement.getContext("webgpu");this.device=i,this.context=r;const s=t.alpha?"premultiplied":"opaque";this.trackTimestamp=this.trackTimestamp&&this.hasFeature(YR.TimestampQuery),this.context.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s}),this.updateSize()}get coordinateSystem(){return Od}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){let e=this.defaultRenderPassdescriptor;if(e===null){const i=this.renderer;e={colorAttachments:[{view:null}]},(this.renderer.depth===!0||this.renderer.stencil===!0)&&(e.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(i.depth,i.stencil).createView()});const r=e.colorAttachments[0];this.renderer.samples>0?r.view=this.colorBuffer.createView():r.resolveTarget=void 0,this.defaultRenderPassdescriptor=e}const t=e.colorAttachments[0];return this.renderer.samples>0?t.resolveTarget=this.context.getCurrentTexture().createView():t.view=this.context.getCurrentTexture().createView(),e}_getRenderPassDescriptor(e){const t=e.renderTarget,i=this.get(t);let r=i.descriptors;if(r===void 0||i.width!==t.width||i.height!==t.height||i.activeMipmapLevel!==t.activeMipmapLevel||i.samples!==t.samples){r={},i.descriptors=r;const a=()=>{t.removeEventListener("dispose",a),this.delete(t)};t.addEventListener("dispose",a)}const s=e.getCacheKey();let o=r[s];if(o===void 0){const a=e.textures,l=[];for(let u=0;u<a.length;u++){const c=this.get(a[u]),h=c.texture.createView({baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,dimension:Sa.TwoD});let A,v;c.msaaTexture!==void 0?(A=c.msaaTexture.createView(),v=h):(A=h,v=void 0),l.push({view:A,resolveTarget:v,loadOp:Sr.Load,storeOp:ts.Store})}if(o={colorAttachments:l},e.depth){const c={view:this.get(e.depthTexture).texture.createView()};o.depthStencilAttachment=c}r[s]=o,i.width=t.width,i.height=t.height,i.samples=t.samples,i.activeMipmapLevel=t.activeMipmapLevel}return o}beginRender(e){const t=this.get(e),i=this.device,r=e.occlusionQueryCount;let s;r>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=i.createQuerySet({type:"occlusion",count:r}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(r),t.lastOcclusionObject=null);let o;e.textures===null?o=this._getDefaultRenderPassDescriptor():o=this._getRenderPassDescriptor(e),this.initTimestampQuery(e,o),o.occlusionQuerySet=s;const a=o.depthStencilAttachment;if(e.textures!==null){const c=o.colorAttachments;for(let h=0;h<c.length;h++){const A=c[h];e.clearColor?(A.clearValue=h===0?e.clearColorValue:{r:0,g:0,b:0,a:1},A.loadOp=Sr.Clear,A.storeOp=ts.Store):(A.loadOp=Sr.Load,A.storeOp=ts.Store)}}else{const c=o.colorAttachments[0];e.clearColor?(c.clearValue=e.clearColorValue,c.loadOp=Sr.Clear,c.storeOp=ts.Store):(c.loadOp=Sr.Load,c.storeOp=ts.Store)}e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=Sr.Clear,a.depthStoreOp=ts.Store):(a.depthLoadOp=Sr.Load,a.depthStoreOp=ts.Store)),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=Sr.Clear,a.stencilStoreOp=ts.Store):(a.stencilLoadOp=Sr.Load,a.stencilStoreOp=ts.Store));const l=i.createCommandEncoder({label:"renderContext_"+e.id}),u=l.beginRenderPass(o);if(t.descriptor=o,t.encoder=l,t.currentPass=u,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[],e.viewport&&this.updateViewport(e),e.scissor){const{x:c,y:h,width:A,height:v}=e.scissorValue;u.setScissorRect(c,h,A,v)}}finishRender(e){const t=this.get(e),i=e.occlusionQueryCount;if(t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),i>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery(),t.currentPass.end(),i>0){const r=i*8;let s=this.occludedResolveCache.get(r);s===void 0&&(s=this.device.createBuffer({size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(r,s));const o=this.device.createBuffer({size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,i,s,0),t.encoder.copyBufferToBuffer(s,0,o,0,r),t.occlusionQueryBuffer=o,this.resolveOccludedAsync(e)}if(this.prepareTimestampBuffer(e,t.encoder),this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const r=e.textures;for(let s=0;s<r.length;s++){const o=r[s];o.generateMipmaps===!0&&this.textureUtils.generateMipmaps(o)}}}isOccluded(e,t){const i=this.get(e);return i.occluded&&i.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:i,currentOcclusionQueryObjects:r}=t;if(i&&r){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await i.mapAsync(GPUMapMode.READ);const o=i.getMappedRange(),a=new BigUint64Array(o);for(let l=0;l<r.length;l++)a[l]!==BigInt(0)&&s.add(r[l]);i.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:i,y:r,width:s,height:o,minDepth:a,maxDepth:l}=e.viewportValue;t.setViewport(i,r,s,o,a,l)}clear(e,t,i,r=null){const s=this.device,o=this.renderer;let a=[],l,u,c,h;if(e){const _=this.getClearColor();if(this.renderer.alpha===!0){const S=_.a;u={r:_.r*S,g:_.g*S,b:_.b*S,a:S}}else u={r:_.r,g:_.g,b:_.b,a:_.a}}if(r===null){c=o.depth,h=o.stencil;const _=this._getDefaultRenderPassDescriptor();if(e){a=_.colorAttachments;const S=a[0];S.clearValue=u,S.loadOp=Sr.Clear,S.storeOp=ts.Store}(c||h)&&(l=_.depthStencilAttachment)}else{if(c=r.depth,h=r.stencil,e)for(const _ of r.textures){const S=this.get(_),w=S.texture.createView();let x,M;S.msaaTexture!==void 0?(x=S.msaaTexture.createView(),M=w):(x=w,M=void 0),a.push({view:x,resolveTarget:M,clearValue:u,loadOp:Sr.Clear,storeOp:ts.Store})}(c||h)&&(l={view:this.get(r.depthTexture).texture.createView()})}c&&(t?(l.depthLoadOp=Sr.Clear,l.depthClearValue=o.getClearDepth(),l.depthStoreOp=ts.Store):(l.depthLoadOp=Sr.Load,l.depthStoreOp=ts.Store)),h&&(i?(l.stencilLoadOp=Sr.Clear,l.stencilClearValue=o.getClearStencil(),l.stencilStoreOp=ts.Store):(l.stencilLoadOp=Sr.Load,l.stencilStoreOp=ts.Store));const A=s.createCommandEncoder({});A.beginRenderPass({colorAttachments:a,depthStencilAttachment:l}).end(),s.queue.submit([A.finish()])}beginCompute(e){const t=this.get(e),i={};this.initTimestampQuery(e,i),t.cmdEncoderGPU=this.device.createCommandEncoder(),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(i)}compute(e,t,i,r){const{passEncoderGPU:s}=this.get(e),o=this.get(r).pipeline;s.setPipeline(o);for(let c=0,h=i.length;c<h;c++){const A=i[c],v=this.get(A);s.setBindGroup(c,v.group)}const a=this.device.limits.maxComputeWorkgroupsPerDimension,l=this.get(t);l.dispatchSize===void 0&&(l.dispatchSize={x:0,y:1,z:1});const{dispatchSize:u}=l;t.dispatchCount>a?(u.x=Math.min(t.dispatchCount,a),u.y=Math.ceil(t.dispatchCount/a)):u.x=t.dispatchCount,s.dispatchWorkgroups(u.x,u.y,u.z)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.prepareTimestampBuffer(e,t.cmdEncoderGPU),this.device.queue.submit([t.cmdEncoderGPU.finish()])}async waitForGPU(){await this.device.queue.onSubmittedWorkDone()}draw(e,t){const{object:i,context:r,pipeline:s}=e,o=e.getBindings(),a=this.get(r),l=this.get(s).pipeline,u=a.currentSets,c=a.currentPass,h=e.getDrawParameters();if(h===null)return;u.pipeline!==l&&(c.setPipeline(l),u.pipeline=l);const A=u.bindingGroups;for(let w=0,x=o.length;w<x;w++){const M=o[w],R=this.get(M);A[M.index]!==M.id&&(c.setBindGroup(M.index,R.group),A[M.index]=M.id)}const v=e.getIndex(),_=v!==null;if(_===!0&&u.index!==v){const w=this.get(v).buffer,x=v.array instanceof Uint16Array?F0.Uint16:F0.Uint32;c.setIndexBuffer(w,x),u.index=v}const S=e.getVertexBuffers();for(let w=0,x=S.length;w<x;w++){const M=S[w];if(u.attributes[w]!==M){const R=this.get(M).buffer;c.setVertexBuffer(w,R),u.attributes[w]=M}}if(a.occlusionQuerySet!==void 0){const w=a.lastOcclusionObject;w!==i&&(w!==null&&w.occlusionTest===!0&&(c.endOcclusionQuery(),a.occlusionQueryIndex++),i.occlusionTest===!0&&(c.beginOcclusionQuery(a.occlusionQueryIndex),a.occlusionQueryObjects[a.occlusionQueryIndex]=i),a.lastOcclusionObject=i)}if(i.isBatchedMesh===!0){const w=i._multiDrawStarts,x=i._multiDrawCounts,M=i._multiDrawCount,R=i._multiDrawInstances,N=_?v.array.BYTES_PER_ELEMENT:1;for(let B=0;B<M;B++){const T=R?R[B]:1,D=T>1?0:B;c.drawIndexed(x[B],T,w[B]/N,0,D)}}else if(_===!0){const{vertexCount:w,instanceCount:x,firstVertex:M}=h,R=e.getIndirect();if(R!==null){const N=this.get(R).buffer;c.drawIndexedIndirect(N,0)}else c.drawIndexed(w,x,M,0,0);t.update(i,w,x)}else{const{vertexCount:w,instanceCount:x,firstVertex:M}=h,R=e.getIndirect();if(R!==null){const N=this.get(R).buffer;c.drawIndirect(N,0)}else c.draw(w,x,M,0);t.update(i,w,x)}}needsRenderUpdate(e){const t=this.get(e),{object:i,material:r}=e,s=this.utils,o=s.getSampleCountRenderContext(e.context),a=s.getCurrentColorSpace(e.context),l=s.getCurrentColorFormat(e.context),u=s.getCurrentDepthStencilFormat(e.context),c=s.getPrimitiveTopology(i,r);let h=!1;return(t.material!==r||t.materialVersion!==r.version||t.transparent!==r.transparent||t.blending!==r.blending||t.premultipliedAlpha!==r.premultipliedAlpha||t.blendSrc!==r.blendSrc||t.blendDst!==r.blendDst||t.blendEquation!==r.blendEquation||t.blendSrcAlpha!==r.blendSrcAlpha||t.blendDstAlpha!==r.blendDstAlpha||t.blendEquationAlpha!==r.blendEquationAlpha||t.colorWrite!==r.colorWrite||t.depthWrite!==r.depthWrite||t.depthTest!==r.depthTest||t.depthFunc!==r.depthFunc||t.stencilWrite!==r.stencilWrite||t.stencilFunc!==r.stencilFunc||t.stencilFail!==r.stencilFail||t.stencilZFail!==r.stencilZFail||t.stencilZPass!==r.stencilZPass||t.stencilFuncMask!==r.stencilFuncMask||t.stencilWriteMask!==r.stencilWriteMask||t.side!==r.side||t.alphaToCoverage!==r.alphaToCoverage||t.sampleCount!==o||t.colorSpace!==a||t.colorFormat!==l||t.depthStencilFormat!==u||t.primitiveTopology!==c||t.clippingContextCacheKey!==e.clippingContext.cacheKey)&&(t.material=r,t.materialVersion=r.version,t.transparent=r.transparent,t.blending=r.blending,t.premultipliedAlpha=r.premultipliedAlpha,t.blendSrc=r.blendSrc,t.blendDst=r.blendDst,t.blendEquation=r.blendEquation,t.blendSrcAlpha=r.blendSrcAlpha,t.blendDstAlpha=r.blendDstAlpha,t.blendEquationAlpha=r.blendEquationAlpha,t.colorWrite=r.colorWrite,t.depthWrite=r.depthWrite,t.depthTest=r.depthTest,t.depthFunc=r.depthFunc,t.stencilWrite=r.stencilWrite,t.stencilFunc=r.stencilFunc,t.stencilFail=r.stencilFail,t.stencilZFail=r.stencilZFail,t.stencilZPass=r.stencilZPass,t.stencilFuncMask=r.stencilFuncMask,t.stencilWriteMask=r.stencilWriteMask,t.side=r.side,t.alphaToCoverage=r.alphaToCoverage,t.sampleCount=o,t.colorSpace=a,t.colorFormat=l,t.depthStencilFormat=u,t.primitiveTopology=c,t.clippingContextCacheKey=e.clippingContext.cacheKey,h=!0),h}getRenderCacheKey(e){const{object:t,material:i}=e,r=this.utils,s=e.context;return[i.transparent,i.blending,i.premultipliedAlpha,i.blendSrc,i.blendDst,i.blendEquation,i.blendSrcAlpha,i.blendDstAlpha,i.blendEquationAlpha,i.colorWrite,i.depthWrite,i.depthTest,i.depthFunc,i.stencilWrite,i.stencilFunc,i.stencilFail,i.stencilZFail,i.stencilZPass,i.stencilFuncMask,i.stencilWriteMask,i.side,r.getSampleCountRenderContext(s),r.getCurrentColorSpace(s),r.getCurrentColorFormat(s),r.getCurrentDepthStencilFormat(s),r.getPrimitiveTopology(t,i),e.getGeometryCacheKey(),e.clippingContext.cacheKey].join()}createSampler(e){this.textureUtils.createSampler(e)}destroySampler(e){this.textureUtils.destroySampler(e)}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e){this.textureUtils.destroyTexture(e)}copyTextureToBuffer(e,t,i,r,s,o){return this.textureUtils.copyTextureToBuffer(e,t,i,r,s,o)}initTimestampQuery(e,t){if(!this.trackTimestamp)return;const i=this.get(e);if(!i.timeStampQuerySet){const r=this.device.createQuerySet({type:"timestamp",count:2});Object.assign(t,{timestampWrites:{querySet:r,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1}}),i.timeStampQuerySet=r}}prepareTimestampBuffer(e,t){if(!this.trackTimestamp)return;const i=this.get(e),r=2*BigInt64Array.BYTES_PER_ELEMENT;i.currentTimestampQueryBuffers===void 0&&(i.currentTimestampQueryBuffers={resolveBuffer:this.device.createBuffer({label:"timestamp resolve buffer",size:r,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),resultBuffer:this.device.createBuffer({label:"timestamp result buffer",size:r,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),isMappingPending:!1});const{resolveBuffer:s,resultBuffer:o,isMappingPending:a}=i.currentTimestampQueryBuffers;a!==!0&&(t.resolveQuerySet(i.timeStampQuerySet,0,2,s,0),t.copyBufferToBuffer(s,0,o,0,r))}async resolveTimestampAsync(e,t="render"){if(!this.trackTimestamp)return;const i=this.get(e);if(i.currentTimestampQueryBuffers===void 0)return;const{resultBuffer:r,isMappingPending:s}=i.currentTimestampQueryBuffers;s!==!0&&(i.currentTimestampQueryBuffers.isMappingPending=!0,r.mapAsync(GPUMapMode.READ).then(()=>{const o=new BigUint64Array(r.getMappedRange()),a=Number(o[1]-o[0])/1e6;this.renderer.info.updateTimestamp(t,a),r.unmap(),i.currentTimestampQueryBuffers.isMappingPending=!1}))}createNodeBuilder(e,t){return new eEe(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const i=this.get(e),s=i.currentPass.finish();this.get(t).bundleGPU=s,i.currentSets=i._currentSets,i.currentPass=i._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e){this.bindingUtils.createBindings(e)}updateBindings(e){this.bindingUtils.createBindings(e)}updateBinding(e){this.bindingUtils.updateBinding(e)}createIndexAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.colorBuffer=this.textureUtils.getColorBuffer(),this.defaultRenderPassdescriptor=null}getMaxAnisotropy(){return 16}hasFeature(e){return this.device.features.has(e)}copyTextureToTexture(e,t,i=null,r=null,s=0){let o=0,a=0,l=0,u=0,c=0,h=0,A=e.image.width,v=e.image.height;i!==null&&(u=i.x,c=i.y,h=i.z||0,A=i.width,v=i.height),r!==null&&(o=r.x,a=r.y,l=r.z||0);const _=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),S=this.get(e).texture,w=this.get(t).texture;_.copyTextureToTexture({texture:S,mipLevel:s,origin:{x:u,y:c,z:h}},{texture:w,mipLevel:s,origin:{x:o,y:a,z:l}},[A,v,1]),this.device.queue.submit([_.finish()])}copyFramebufferToTexture(e,t,i){const r=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const o=this.get(e).texture;if(s.format!==o.format){console.error("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,o.format);return}let a;if(r.currentPass?(r.currentPass.end(),a=r.encoder):a=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),a.copyTextureToTexture({texture:s,origin:{x:i.x,y:i.y,z:0}},{texture:o},[i.z,i.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e),r.currentPass){const{descriptor:l}=r;for(let u=0;u<l.colorAttachments.length;u++)l.colorAttachments[u].loadOp=Sr.Load;t.depth&&(l.depthStencilAttachment.depthLoadOp=Sr.Load),t.stencil&&(l.depthStencilAttachment.stencilLoadOp=Sr.Load),r.currentPass=a.beginRenderPass(l),r.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null}}else this.device.queue.submit([a.finish()])}}class uEe extends WH{constructor(e,t,i,r,s,o){super(e,t,i,r,s,o),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class cEe extends vj{constructor(){super(),this.addMaterial(fxe,VH),this.addMaterial(rj,z6),this.addMaterial(Zxe,zH),this.addMaterial(nbe,GH),this.addMaterial(sxe,aw),this.addMaterial(cxe,HH),this.addMaterial(J2e,qH),this.addMaterial(obe,$H),this.addMaterial(X2e,O6),this.addMaterial(Q2e,jH),this.addMaterial(lbe,OH),this.addMaterial(fbe,FH),this.addMaterial(Abe,UH),this.addLight(ESe,W1e),this.addLight(twe,Y1e),this.addLight(nwe,K1e),this.addLight(mj,WH),this.addLight(rwe,Q1e),this.addLight(swe,H1e),this.addLight(owe,J1e),this.addLight(iwe,uEe),this.addToneMapping(Qbe,bge),this.addToneMapping(Kbe,Sge),this.addToneMapping(Zbe,wge),this.addToneMapping(eSe,Ege),this.addToneMapping(rSe,Tge),this.addToneMapping(sSe,Cge)}}class hEe extends gwe{constructor(e={}){let t;e.forceWebGL?t=kB:(t=lEe,e.getFallback=()=>(console.warn("THREE.WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new kB(e)));const i=new t(e);super(i,e),this.library=new cEe,this.isWebGPURenderer=!0}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:sw}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=sw);const GT={type:"change"},mN={type:"start"},gN={type:"end"},BB=1e-6,ci={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},s2=new rt,rh=new rt,fEe=new le,o2=new le,qT=new le,eA=new El,OB=new le,a2=new le,HT=new le,l2=new le;class dEe extends i6{constructor(e,t=null){super(e,t),this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:sa.ROTATE,MIDDLE:sa.DOLLY,RIGHT:sa.PAN},this.state=ci.NONE,this.keyState=ci.NONE,this.target=new le,this._lastPosition=new le,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new le,this._movePrev=new rt,this._moveCurr=new rt,this._lastAxis=new le,this._zoomStart=new rt,this._zoomEnd=new rt,this._panStart=new rt,this._panEnd=new rt,this._pointers=[],this._pointerPositions={},this._onPointerMove=AEe.bind(this),this._onPointerDown=pEe.bind(this),this._onPointerUp=mEe.bind(this),this._onPointerCancel=gEe.bind(this),this._onContextMenu=wEe.bind(this),this._onMouseWheel=SEe.bind(this),this._onKeyDown=yEe.bind(this),this._onKeyUp=vEe.bind(this),this._onTouchStart=EEe.bind(this),this._onTouchMove=TEe.bind(this),this._onTouchEnd=CEe.bind(this),this._onMouseDown=_Ee.bind(this),this._onMouseMove=xEe.bind(this),this._onMouseUp=bEe.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,t!==null&&(this.connect(),this.handleResize()),this.update()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){const e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>BB&&(this.dispatchEvent(GT),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>BB||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(GT),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=ci.NONE,this.keyState=ci.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(GT),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(rh.copy(this._panEnd).sub(this._panStart),rh.lengthSq()){if(this.object.isOrthographicCamera){const e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;rh.x*=e,rh.y*=t}rh.multiplyScalar(this._eye.length()*this.panSpeed),o2.copy(this._eye).cross(this.object.up).setLength(rh.x),o2.add(fEe.copy(this.object.up).setLength(rh.y)),this.object.position.add(o2),this.target.add(o2),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(rh.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){l2.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=l2.length();e?(this._eye.copy(this.object.position).sub(this.target),OB.copy(this._eye).normalize(),a2.copy(this.object.up).normalize(),HT.crossVectors(a2,OB).normalize(),a2.setLength(this._moveCurr.y-this._movePrev.y),HT.setLength(this._moveCurr.x-this._movePrev.x),l2.copy(a2.add(HT)),qT.crossVectors(l2,this._eye).normalize(),e*=this.rotateSpeed,eA.setFromAxisAngle(qT,e),this._eye.applyQuaternion(eA),this.object.up.applyQuaternion(eA),this._lastAxis.copy(qT),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),eA.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(eA),this.object.up.applyQuaternion(eA)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===ci.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Fx.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Fx.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return s2.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),s2}_getMouseOnCircle(e,t){return s2.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-t))/this.screen.width),s2}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId){this._pointers.splice(t,1);return}}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new rt,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}}function pEe(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n))}function AEe(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function mEe(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchEnd(n):this._onMouseUp(),this._removePointer(n),this._pointers.length===0&&(this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp)))}function gEe(n){this._removePointer(n)}function vEe(){this.enabled!==!1&&(this.keyState=ci.NONE,window.addEventListener("keydown",this._onKeyDown))}function yEe(n){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===ci.NONE&&(n.code===this.keys[ci.ROTATE]&&!this.noRotate?this.keyState=ci.ROTATE:n.code===this.keys[ci.ZOOM]&&!this.noZoom?this.keyState=ci.ZOOM:n.code===this.keys[ci.PAN]&&!this.noPan&&(this.keyState=ci.PAN)))}function _Ee(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case sa.DOLLY:this.state=ci.ZOOM;break;case sa.ROTATE:this.state=ci.ROTATE;break;case sa.PAN:this.state=ci.PAN;break;default:this.state=ci.NONE}const t=this.keyState!==ci.NONE?this.keyState:this.state;t===ci.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY)),this._movePrev.copy(this._moveCurr)):t===ci.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(n.pageX,n.pageY)),this._zoomEnd.copy(this._zoomStart)):t===ci.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(n.pageX,n.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(mN)}function xEe(n){const e=this.keyState!==ci.NONE?this.keyState:this.state;e===ci.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY))):e===ci.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(n.pageX,n.pageY)):e===ci.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(n.pageX,n.pageY))}function bEe(){this.state=ci.NONE,this.dispatchEvent(gN)}function SEe(n){if(this.enabled!==!1&&this.noZoom!==!0){switch(n.preventDefault(),n.deltaMode){case 2:this._zoomStart.y-=n.deltaY*.025;break;case 1:this._zoomStart.y-=n.deltaY*.01;break;default:this._zoomStart.y-=n.deltaY*25e-5;break}this.dispatchEvent(mN),this.dispatchEvent(gN)}}function wEe(n){this.enabled!==!1&&n.preventDefault()}function EEe(n){switch(this._trackPointer(n),this._pointers.length){case 1:this.state=ci.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=ci.TOUCH_ZOOM_PAN;const e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);const i=(this._pointers[0].pageX+this._pointers[1].pageX)/2,r=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(i,r)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(mN)}function TEe(n){switch(this._trackPointer(n),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY));break;default:const e=this._getSecondPointerPosition(n),t=n.pageX-e.x,i=n.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(t*t+i*i);const r=(n.pageX+e.x)/2,s=(n.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(r,s));break}}function CEe(n){switch(this._pointers.length){case 0:this.state=ci.NONE;break;case 1:this.state=ci.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(n.pageX,n.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=ci.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==n.pointerId){const t=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(t.x,t.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(gN)}const UB={type:"change"},vN={type:"start"},Cj={type:"end"},u2=new jS,zB=new lh,MEe=Math.cos(70*Fx.DEG2RAD),Dr=new le,mo=2*Math.PI,Ti={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},$T=1e-6;class REe extends i6{constructor(e,t=null){super(e,t),this.state=Ti.NONE,this.enabled=!0,this.target=new le,this.cursor=new le,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:sa.ROTATE,MIDDLE:sa.DOLLY,RIGHT:sa.PAN},this.touches={ONE:vA.ROTATE,TWO:vA.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new le,this._lastQuaternion=new El,this._lastTargetPosition=new le,this._quat=new El().setFromUnitVectors(e.up,new le(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new h4,this._sphericalDelta=new h4,this._scale=1,this._panOffset=new le,this._rotateStart=new rt,this._rotateEnd=new rt,this._rotateDelta=new rt,this._panStart=new rt,this._panEnd=new rt,this._panDelta=new rt,this._dollyStart=new rt,this._dollyEnd=new rt,this._dollyDelta=new rt,this._dollyDirection=new le,this._mouse=new rt,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=NEe.bind(this),this._onPointerDown=PEe.bind(this),this._onPointerUp=IEe.bind(this),this._onContextMenu=UEe.bind(this),this._onMouseWheel=LEe.bind(this),this._onKeyDown=FEe.bind(this),this._onTouchStart=BEe.bind(this),this._onTouchMove=OEe.bind(this),this._onMouseDown=DEe.bind(this),this._onMouseMove=kEe.bind(this),this._interceptControlDown=zEe.bind(this),this._interceptControlUp=VEe.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(UB),this.update(),this.state=Ti.NONE}update(e=null){const t=this.object.position;Dr.copy(t).sub(this.target),Dr.applyQuaternion(this._quat),this._spherical.setFromVector3(Dr),this.autoRotate&&this.state===Ti.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(i)&&isFinite(r)&&(i<-Math.PI?i+=mo:i>Math.PI&&(i-=mo),r<-Math.PI?r+=mo:r>Math.PI&&(r-=mo),i<=r?this._spherical.theta=Math.max(i,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+r)/2?Math.max(i,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let s=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),s=o!=this._spherical.radius}if(Dr.setFromSpherical(this._spherical),Dr.applyQuaternion(this._quatInverse),t.copy(this.target).add(Dr),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=Dr.length();o=this._clampDistance(a*this._scale);const l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),s=!!l}else if(this.object.isOrthographicCamera){const a=new le(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),s=l!==this.object.zoom;const u=new le(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),o=Dr.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(u2.origin.copy(this.object.position),u2.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(u2.direction))<MEe?this.object.lookAt(this.target):(zB.setFromNormalAndCoplanarPoint(this.object.up,this.target),u2.intersectPlane(zB,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),s=!0)}return this._scale=1,this._performCursorZoom=!1,s||this._lastPosition.distanceToSquared(this.object.position)>$T||8*(1-this._lastQuaternion.dot(this.object.quaternion))>$T||this._lastTargetPosition.distanceToSquared(this.target)>$T?(this.dispatchEvent(UB),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?mo/60*this.autoRotateSpeed*e:mo/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){Dr.setFromMatrixColumn(t,0),Dr.multiplyScalar(-e),this._panOffset.add(Dr)}_panUp(e,t){this.screenSpacePanning===!0?Dr.setFromMatrixColumn(t,1):(Dr.setFromMatrixColumn(t,0),Dr.crossVectors(this.object.up,Dr)),Dr.multiplyScalar(e),this._panOffset.add(Dr)}_pan(e,t){const i=this.domElement;if(this.object.isPerspectiveCamera){const r=this.object.position;Dr.copy(r).sub(this.target);let s=Dr.length();s*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*s/i.clientHeight,this.object.matrix),this._panUp(2*t*s/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),r=e-i.left,s=t-i.top,o=i.width,a=i.height;this._mouse.x=r/o*2-1,this._mouse.y=-(s/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(mo*this._rotateDelta.x/t.clientHeight),this._rotateUp(mo*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateUp(-mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this._rotateLeft(-mo*this.rotateSpeed/this.domElement.clientHeight):this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(i,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(i,r)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyStart.set(0,s)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),r=.5*(e.pageX+i.x),s=.5*(e.pageY+i.y);this._rotateEnd.set(r,s)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(mo*this._rotateDelta.x/t.clientHeight),this._rotateUp(mo*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),i=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(i,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),i=e.pageX-t.x,r=e.pageY-t.y,s=Math.sqrt(i*i+r*r);this._dollyEnd.set(0,s),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new rt,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,i={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function PEe(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function NEe(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function IEe(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Cj),this.state=Ti.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function DEe(n){let e;switch(n.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case sa.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=Ti.DOLLY;break;case sa.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=Ti.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=Ti.ROTATE}break;case sa.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=Ti.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=Ti.PAN}break;default:this.state=Ti.NONE}this.state!==Ti.NONE&&this.dispatchEvent(vN)}function kEe(n){switch(this.state){case Ti.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case Ti.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case Ti.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function LEe(n){this.enabled===!1||this.enableZoom===!1||this.state!==Ti.NONE||(n.preventDefault(),this.dispatchEvent(vN),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(Cj))}function FEe(n){this.enabled===!1||this.enablePan===!1||this._handleKeyDown(n)}function BEe(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case vA.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=Ti.TOUCH_ROTATE;break;case vA.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=Ti.TOUCH_PAN;break;default:this.state=Ti.NONE}break;case 2:switch(this.touches.TWO){case vA.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=Ti.TOUCH_DOLLY_PAN;break;case vA.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=Ti.TOUCH_DOLLY_ROTATE;break;default:this.state=Ti.NONE}break;default:this.state=Ti.NONE}this.state!==Ti.NONE&&this.dispatchEvent(vN)}function OEe(n){switch(this._trackPointer(n),this.state){case Ti.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case Ti.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case Ti.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case Ti.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=Ti.NONE}}function UEe(n){this.enabled!==!1&&n.preventDefault()}function zEe(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function VEe(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const GEe={type:"change"},VB=1e-6,GB=new El;class qEe extends i6{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new le(0,0,0),this._rotationVector=new le(0,0,0),this._lastQuaternion=new El,this._lastPosition=new le,this._status=0,this._onKeyDown=HEe.bind(this),this._onKeyUp=$Ee.bind(this),this._onPointerMove=WEe.bind(this),this._onPointerDown=jEe.bind(this),this._onPointerUp=XEe.bind(this),this._onPointerCancel=YEe.bind(this),this._onContextMenu=QEe.bind(this),t!==null&&this.connect()}connect(){window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;const t=this.object,i=e*this.movementSpeed,r=e*this.rollSpeed;t.translateX(this._moveVector.x*i),t.translateY(this._moveVector.y*i),t.translateZ(this._moveVector.z*i),GB.set(this._rotationVector.x*r,this._rotationVector.y*r,this._rotationVector.z*r,1).normalize(),t.quaternion.multiply(GB),(this._lastPosition.distanceToSquared(t.position)>VB||8*(1-this._lastQuaternion.dot(t.quaternion))>VB)&&(this.dispatchEvent(GEe),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){const e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}}function HEe(n){if(!(n.altKey||this.enabled===!1)){switch(n.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function $Ee(n){if(this.enabled!==!1){switch(n.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function jEe(n){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(n.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function WEe(n){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){const e=this._getContainerDimensions(),t=e.size[0]/2,i=e.size[1]/2;this._moveState.yawLeft=-(n.pageX-e.offset[0]-t)/t,this._moveState.pitchDown=(n.pageY-e.offset[1]-i)/i,this._updateRotationVector()}}function XEe(n){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(n.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function YEe(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function QEe(n){this.enabled!==!1&&n.preventDefault()}const KEe={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class xw{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const ZEe=new XP(-1,1,1,-1,0,1);class JEe extends ur{constructor(){super(),this.setAttribute("position",new si([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new si([0,2,0,0,2,0],2))}}const e3e=new JEe;class t3e{constructor(e){this._mesh=new rr(e3e,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,ZEe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class n3e extends xw{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof ko?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=YS.clone(e.uniforms),this.material=new ko({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new t3e(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class qB extends xw{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const r=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,a;this.inverse?(o=0,a=1):(o=1,a=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),s.buffers.stencil.setFunc(r.ALWAYS,o,4294967295),s.buffers.stencil.setClear(a),s.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(r.EQUAL,1,4294967295),s.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),s.buffers.stencil.setLocked(!0)}}class i3e extends xw{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class r3e{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const i=e.getSize(new rt);this._width=i.width,this._height=i.height,t=new Kh(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:W0}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new n3e(KEe),this.copyPass.material.blending=Yu,this.clock=new cG}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let r=0,s=this.passes.length;r<s;r++){const o=this.passes[r];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),o.needsSwap){if(i){const a=this.renderer.getContext(),l=this.renderer.state.buffers.stencil;l.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),l.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}qB!==void 0&&(o instanceof qB?i=!0:o instanceof i3e&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new rt);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(i,r),this.renderTarget2.setSize(i,r);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(i,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class s3e extends xw{constructor(e,t,i=null,r=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=r,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new fn}render(e,t,i){const r=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=r}}function ZR(n){return ZR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ZR(n)}function o3e(n){try{return Function.toString.call(n).indexOf("[native code]")!==-1}catch{return typeof n=="function"}}function Mj(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mj=function(){return!!n})()}function a3e(n,e,t){if(Mj())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,e);var r=new(n.bind.apply(n,i));return t&&b1(r,t.prototype),r}function JR(n){var e=typeof Map=="function"?new Map:void 0;return JR=function(i){if(i===null||!o3e(i))return i;if(typeof i!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(i))return e.get(i);e.set(i,r)}function r(){return a3e(i,arguments,ZR(this).constructor)}return r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b1(r,i)},JR(n)}var Xl=function(n){VS(e,n);function e(t){var i;return i=n.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,lV(i)}return e}(JR(Error));function jT(n){return Math.round(n*255)}function l3e(n,e,t){return jT(n)+","+jT(e)+","+jT(t)}function Z1(n,e,t,i){if(i===void 0&&(i=l3e),e===0)return i(t,t,t);var r=(n%360+360)%360/60,s=(1-Math.abs(2*t-1))*e,o=s*(1-Math.abs(r%2-1)),a=0,l=0,u=0;r>=0&&r<1?(a=s,l=o):r>=1&&r<2?(a=o,l=s):r>=2&&r<3?(l=s,u=o):r>=3&&r<4?(l=o,u=s):r>=4&&r<5?(a=o,u=s):r>=5&&r<6&&(a=s,u=o);var c=t-s/2,h=a+c,A=l+c,v=u+c;return i(h,A,v)}var HB={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function u3e(n){if(typeof n!="string")return n;var e=n.toLowerCase();return HB[e]?"#"+HB[e]:n}var c3e=/^#[a-fA-F0-9]{6}$/,h3e=/^#[a-fA-F0-9]{8}$/,f3e=/^#[a-fA-F0-9]{3}$/,d3e=/^#[a-fA-F0-9]{4}$/,WT=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,p3e=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,A3e=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,m3e=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function Gd(n){if(typeof n!="string")throw new Xl(3);var e=u3e(n);if(e.match(c3e))return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16)};if(e.match(h3e)){var t=parseFloat((parseInt(""+e[7]+e[8],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[2],16),green:parseInt(""+e[3]+e[4],16),blue:parseInt(""+e[5]+e[6],16),alpha:t}}if(e.match(f3e))return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16)};if(e.match(d3e)){var i=parseFloat((parseInt(""+e[4]+e[4],16)/255).toFixed(2));return{red:parseInt(""+e[1]+e[1],16),green:parseInt(""+e[2]+e[2],16),blue:parseInt(""+e[3]+e[3],16),alpha:i}}var r=WT.exec(e);if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10)};var s=p3e.exec(e.substring(0,50));if(s)return{red:parseInt(""+s[1],10),green:parseInt(""+s[2],10),blue:parseInt(""+s[3],10),alpha:parseFloat(""+s[4])>1?parseFloat(""+s[4])/100:parseFloat(""+s[4])};var o=A3e.exec(e);if(o){var a=parseInt(""+o[1],10),l=parseInt(""+o[2],10)/100,u=parseInt(""+o[3],10)/100,c="rgb("+Z1(a,l,u)+")",h=WT.exec(c);if(!h)throw new Xl(4,e,c);return{red:parseInt(""+h[1],10),green:parseInt(""+h[2],10),blue:parseInt(""+h[3],10)}}var A=m3e.exec(e.substring(0,50));if(A){var v=parseInt(""+A[1],10),_=parseInt(""+A[2],10)/100,S=parseInt(""+A[3],10)/100,w="rgb("+Z1(v,_,S)+")",x=WT.exec(w);if(!x)throw new Xl(4,e,w);return{red:parseInt(""+x[1],10),green:parseInt(""+x[2],10),blue:parseInt(""+x[3],10),alpha:parseFloat(""+A[4])>1?parseFloat(""+A[4])/100:parseFloat(""+A[4])}}throw new Xl(5)}function g3e(n){var e=n.red/255,t=n.green/255,i=n.blue/255,r=Math.max(e,t,i),s=Math.min(e,t,i),o=(r+s)/2;if(r===s)return n.alpha!==void 0?{hue:0,saturation:0,lightness:o,alpha:n.alpha}:{hue:0,saturation:0,lightness:o};var a,l=r-s,u=o>.5?l/(2-r-s):l/(r+s);switch(r){case e:a=(t-i)/l+(t<i?6:0);break;case t:a=(i-e)/l+2;break;default:a=(e-t)/l+4;break}return a*=60,n.alpha!==void 0?{hue:a,saturation:u,lightness:o,alpha:n.alpha}:{hue:a,saturation:u,lightness:o}}function mf(n){return g3e(Gd(n))}var v3e=function(e){return e.length===7&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},e5=v3e;function Yf(n){var e=n.toString(16);return e.length===1?"0"+e:e}function XT(n){return Yf(Math.round(n*255))}function y3e(n,e,t){return e5("#"+XT(n)+XT(e)+XT(t))}function Hb(n,e,t){return Z1(n,e,t,y3e)}function _3e(n,e,t){if(typeof n=="number"&&typeof e=="number"&&typeof t=="number")return Hb(n,e,t);if(typeof n=="object"&&e===void 0&&t===void 0)return Hb(n.hue,n.saturation,n.lightness);throw new Xl(1)}function x3e(n,e,t,i){if(typeof n=="number"&&typeof e=="number"&&typeof t=="number"&&typeof i=="number")return i>=1?Hb(n,e,t):"rgba("+Z1(n,e,t)+","+i+")";if(typeof n=="object"&&e===void 0&&t===void 0&&i===void 0)return n.alpha>=1?Hb(n.hue,n.saturation,n.lightness):"rgba("+Z1(n.hue,n.saturation,n.lightness)+","+n.alpha+")";throw new Xl(2)}function t5(n,e,t){if(typeof n=="number"&&typeof e=="number"&&typeof t=="number")return e5("#"+Yf(n)+Yf(e)+Yf(t));if(typeof n=="object"&&e===void 0&&t===void 0)return e5("#"+Yf(n.red)+Yf(n.green)+Yf(n.blue));throw new Xl(6)}function bw(n,e,t,i){if(typeof n=="string"&&typeof e=="number"){var r=Gd(n);return"rgba("+r.red+","+r.green+","+r.blue+","+e+")"}else{if(typeof n=="number"&&typeof e=="number"&&typeof t=="number"&&typeof i=="number")return i>=1?t5(n,e,t):"rgba("+n+","+e+","+t+","+i+")";if(typeof n=="object"&&e===void 0&&t===void 0&&i===void 0)return n.alpha>=1?t5(n.red,n.green,n.blue):"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"}throw new Xl(7)}var b3e=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},S3e=function(e){return typeof e.red=="number"&&typeof e.green=="number"&&typeof e.blue=="number"&&typeof e.alpha=="number"},w3e=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&(typeof e.alpha!="number"||typeof e.alpha>"u")},E3e=function(e){return typeof e.hue=="number"&&typeof e.saturation=="number"&&typeof e.lightness=="number"&&typeof e.alpha=="number"};function gf(n){if(typeof n!="object")throw new Xl(8);if(S3e(n))return bw(n);if(b3e(n))return t5(n);if(E3e(n))return x3e(n);if(w3e(n))return _3e(n);throw new Xl(8)}function Rj(n,e,t){return function(){var r=t.concat(Array.prototype.slice.call(arguments));return r.length>=e?n.apply(this,r):Rj(n,e,r)}}function da(n){return Rj(n,n.length,[])}function T3e(n,e){if(e==="transparent")return e;var t=mf(e);return gf(Ls({},t,{hue:t.hue+parseFloat(n)}))}da(T3e);function im(n,e,t){return Math.max(n,Math.min(e,t))}function C3e(n,e){if(e==="transparent")return e;var t=mf(e);return gf(Ls({},t,{lightness:im(0,1,t.lightness-parseFloat(n))}))}da(C3e);function M3e(n,e){if(e==="transparent")return e;var t=mf(e);return gf(Ls({},t,{saturation:im(0,1,t.saturation-parseFloat(n))}))}da(M3e);function R3e(n,e){if(e==="transparent")return e;var t=mf(e);return gf(Ls({},t,{lightness:im(0,1,t.lightness+parseFloat(n))}))}da(R3e);function P3e(n,e,t){if(e==="transparent")return t;if(t==="transparent")return e;if(n===0)return t;var i=Gd(e),r=Ls({},i,{alpha:typeof i.alpha=="number"?i.alpha:1}),s=Gd(t),o=Ls({},s,{alpha:typeof s.alpha=="number"?s.alpha:1}),a=r.alpha-o.alpha,l=parseFloat(n)*2-1,u=l*a===-1?l:l+a,c=1+l*a,h=(u/c+1)/2,A=1-h,v={red:Math.floor(r.red*h+o.red*A),green:Math.floor(r.green*h+o.green*A),blue:Math.floor(r.blue*h+o.blue*A),alpha:r.alpha*parseFloat(n)+o.alpha*(1-parseFloat(n))};return bw(v)}var N3e=da(P3e),Pj=N3e;function I3e(n,e){if(e==="transparent")return e;var t=Gd(e),i=typeof t.alpha=="number"?t.alpha:1,r=Ls({},t,{alpha:im(0,1,(i*100+parseFloat(n)*100)/100)});return bw(r)}var D3e=da(I3e),k3e=D3e;function L3e(n,e){if(e==="transparent")return e;var t=mf(e);return gf(Ls({},t,{saturation:im(0,1,t.saturation+parseFloat(n))}))}da(L3e);function F3e(n,e){return e==="transparent"?e:gf(Ls({},mf(e),{hue:parseFloat(n)}))}da(F3e);function B3e(n,e){return e==="transparent"?e:gf(Ls({},mf(e),{lightness:parseFloat(n)}))}da(B3e);function O3e(n,e){return e==="transparent"?e:gf(Ls({},mf(e),{saturation:parseFloat(n)}))}da(O3e);function U3e(n,e){return e==="transparent"?e:Pj(parseFloat(n),"rgb(0, 0, 0)",e)}da(U3e);function z3e(n,e){return e==="transparent"?e:Pj(parseFloat(n),"rgb(255, 255, 255)",e)}da(z3e);function V3e(n,e){if(e==="transparent")return e;var t=Gd(e),i=typeof t.alpha=="number"?t.alpha:1,r=Ls({},t,{alpha:im(0,1,+(i*100-parseFloat(n)*100).toFixed(2)/100)});return bw(r)}da(V3e);function G3e(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}}var q3e=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  top: 0;
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
  user-select: none;
}

.scene-container canvas:focus {
  outline: none;
}`;G3e(q3e);function n5(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function H3e(n){if(Array.isArray(n))return n}function $3e(n){if(Array.isArray(n))return n5(n)}function j3e(n,e,t){return(e=J3e(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function W3e(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function X3e(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var i,r,s,o,a=[],l=!0,u=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(i=s.call(t)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return a}}function Y3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K3e(n,e){return H3e(n)||X3e(n,e)||Nj(n,e)||Y3e()}function ig(n){return $3e(n)||W3e(n)||Nj(n)||Q3e()}function Z3e(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function J3e(n){var e=Z3e(n,"string");return typeof e=="symbol"?e:e+""}function Nj(n,e){if(n){if(typeof n=="string")return n5(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n5(n,e):void 0}}var Vi=window.THREE?window.THREE:{WebGLRenderer:Kle,Scene:Zle,PerspectiveCamera:Ta,Raycaster:Uue,SRGBColorSpace:vo,TextureLoader:lG,Vector2:rt,Vector3:le,Box3:Cc,Color:fn,Mesh:rr,SphereGeometry:Ev,MeshBasicMaterial:WS,BackSide:Ds,EventDispatcher:ff,MOUSE:sa,Quaternion:El,Spherical:h4,Clock:cG},Ij=hs({props:{width:{default:window.innerWidth,onChange:function(e,t,i){isNaN(e)&&(t.width=i)}},height:{default:window.innerHeight,onChange:function(e,t,i){isNaN(e)&&(t.height=i)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},lights:{default:[]},enablePointerInteraction:{default:!0,onChange:function(e,t){t.hoverObj=null,t.toolTipElem&&(t.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(e){if(e.initialised){if(e.controls.update&&e.controls.update(Math.min(1,e.clock.getDelta())),e.postProcessingComposer?e.postProcessingComposer.render():e.renderer.render(e.scene,e.camera),e.extraRenderers.forEach(function(s){return s.render(e.scene,e.camera)}),e.enablePointerInteraction){var t=null;if(e.hoverDuringDrag||!e.isPointerDragging){var i=this.intersectingObjects(e.pointerPos.x,e.pointerPos.y).filter(function(s){return e.hoverFilter(s.object)}).sort(function(s,o){return e.hoverOrderComparator(s.object,o.object)}),r=i.length?i[0]:null;t=r?r.object:null,e.intersectionPoint=r?r.point:null}t!==e.hoverObj&&(e.onHover(t,e.hoverObj),e.toolTipElem.innerHTML=t&&ot(e.tooltipContent)(t)||"",e.hoverObj=t)}e.tweenGroup.update()}return this},getPointerPos:function(e){var t=e.pointerPos,i=t.x,r=t.y;return{x:i,y:r}},cameraPosition:function(e,t,i,r){var s=e.camera;if(t&&e.initialised){var o=t,a=i||{x:0,y:0,z:0};if(!r)c(o),h(a);else{var l=Object.assign({},s.position),u=A();e.tweenGroup.add(new Bs(l).to(o,r).easing(Rr.Quadratic.Out).onUpdate(c).start()),e.tweenGroup.add(new Bs(u).to(a,r/3).easing(Rr.Quadratic.Out).onUpdate(h).start())}return this}return Object.assign({},s.position,{lookAt:A()});function c(v){var _=v.x,S=v.y,w=v.z;_!==void 0&&(s.position.x=_),S!==void 0&&(s.position.y=S),w!==void 0&&(s.position.z=w)}function h(v){var _=new Vi.Vector3(v.x,v.y,v.z);e.controls.target?e.controls.target=_:s.lookAt(_)}function A(){return Object.assign(new Vi.Vector3(0,0,-1e3).applyQuaternion(s.quaternion).add(s.position))}},zoomToFit:function(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,r=arguments.length,s=new Array(r>3?r-3:0),o=3;o<r;o++)s[o-3]=arguments[o];return this.fitToBbox(this.getBbox.apply(this,s),t,i)},fitToBbox:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,s=e.camera;if(t){var o=new Vi.Vector3(0,0,0),a=Math.max.apply(Math,ig(Object.entries(t).map(function(v){var _=K3e(v,2),S=_[0],w=_[1];return Math.max.apply(Math,ig(w.map(function(x){return Math.abs(o[S]-x)})))})))*2,l=(1-r*2/e.height)*s.fov,u=a/Math.atan(l*Math.PI/180),c=u/s.aspect,h=Math.max(u,c);if(h>0){var A=o.clone().sub(s.position).normalize().multiplyScalar(-h);this.cameraPosition(A,o,i)}}return this},getBbox:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},i=new Vi.Box3(new Vi.Vector3(0,0,0),new Vi.Vector3(0,0,0)),r=e.objects.filter(t);return r.length?(r.forEach(function(s){return i.expandByObject(s)}),Object.assign.apply(Object,ig(["x","y","z"].map(function(s){return j3e({},s,[i.min[s],i.max[s]])})))):null},getScreenCoords:function(e,t,i,r){var s=new Vi.Vector3(t,i,r);return s.project(this.camera()),{x:(s.x+1)*e.width/2,y:-(s.y-1)*e.height/2}},getSceneCoords:function(e,t,i){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=new Vi.Vector2(t/e.width*2-1,-(i/e.height)*2+1),o=new Vi.Raycaster;return o.setFromCamera(s,e.camera),Object.assign({},o.ray.at(r,new Vi.Vector3))},intersectingObjects:function(e,t,i){var r=new Vi.Vector2(t/e.width*2-1,-(i/e.height)*2+1),s=new Vi.Raycaster;return s.params.Line.threshold=e.lineHoverPrecision,s.setFromCamera(r,e.camera),s.intersectObjects(e.objects,!0)},renderer:function(e){return e.renderer},scene:function(e){return e.scene},camera:function(e){return e.camera},postProcessingComposer:function(e){return e.postProcessingComposer},controls:function(e){return e.controls},tbControls:function(e){return e.controls}},stateInit:function(){return{scene:new Vi.Scene,camera:new Vi.PerspectiveCamera,clock:new Vi.Clock,tweenGroup:new tw}},init:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=i.controlType,s=r===void 0?"trackball":r,o=i.useWebGPU,a=o===void 0?!1:o,l=i.rendererConfig,u=l===void 0?{}:l,c=i.extraRenderers,h=c===void 0?[]:c,A=i.waitForLoadComplete,v=A===void 0?!0:A;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.className="scene-container",t.container.style.position="relative",t.container.appendChild(t.navInfo=document.createElement("div")),t.navInfo.className="scene-nav-info",t.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[s]||"",t.navInfo.style.display=t.showNavInfo?null:"none",t.toolTipElem=document.createElement("div"),t.toolTipElem.classList.add("scene-tooltip"),t.container.appendChild(t.toolTipElem),t.pointerPos=new Vi.Vector2,t.pointerPos.x=-2,t.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(_){return t.container.addEventListener(_,function(S){if(_==="pointerdown"&&(t.isPointerPressed=!0),!t.isPointerDragging&&S.type==="pointermove"&&(S.pressure>0||t.isPointerPressed)&&(S.pointerType!=="touch"||S.movementX===void 0||[S.movementX,S.movementY].some(function(M){return Math.abs(M)>1}))&&(t.isPointerDragging=!0),t.enablePointerInteraction){var w=x(t.container);t.pointerPos.x=S.pageX-w.left,t.pointerPos.y=S.pageY-w.top,t.toolTipElem.style.top="".concat(t.pointerPos.y,"px"),t.toolTipElem.style.left="".concat(t.pointerPos.x,"px"),t.toolTipElem.style.transform="translate(-".concat(t.pointerPos.x/t.width*100,"%, ").concat(t.height-t.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}function x(M){var R=M.getBoundingClientRect(),N=window.pageXOffset||document.documentElement.scrollLeft,B=window.pageYOffset||document.documentElement.scrollTop;return{top:R.top+B,left:R.left+N}}},{passive:!0})}),t.container.addEventListener("pointerup",function(_){t.isPointerPressed=!1,!(t.isPointerDragging&&(t.isPointerDragging=!1,!t.clickAfterDrag))&&requestAnimationFrame(function(){_.button===0&&t.onClick(t.hoverObj||null,_,t.intersectionPoint),_.button===2&&t.onRightClick&&t.onRightClick(t.hoverObj||null,_,t.intersectionPoint)})},{passive:!0,capture:!0}),t.container.addEventListener("contextmenu",function(_){t.onRightClick&&_.preventDefault()}),t.renderer=new(a?hEe:Vi.WebGLRenderer)(Object.assign({antialias:!0,alpha:!0},u)),t.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),t.container.appendChild(t.renderer.domElement),t.extraRenderers=h,t.extraRenderers.forEach(function(_){_.domElement.style.position="absolute",_.domElement.style.top="0px",_.domElement.style.pointerEvents="none",t.container.appendChild(_.domElement)}),t.postProcessingComposer=new r3e(t.renderer),t.postProcessingComposer.addPass(new s3e(t.scene,t.camera)),t.controls=new{trackball:dEe,orbit:REe,fly:qEe}[s](t.camera,t.renderer.domElement),s==="fly"&&(t.controls.movementSpeed=300,t.controls.rollSpeed=Math.PI/6,t.controls.dragToLook=!0),(s==="trackball"||s==="orbit")&&(t.controls.minDistance=.1,t.controls.maxDistance=t.skyRadius,t.controls.addEventListener("start",function(){t.controlsEngaged=!0}),t.controls.addEventListener("change",function(){t.controlsEngaged&&(t.controlsDragging=!0)}),t.controls.addEventListener("end",function(){t.controlsEngaged=!1,t.controlsDragging=!1})),[t.renderer,t.postProcessingComposer].concat(ig(t.extraRenderers)).forEach(function(_){return _.setSize(t.width,t.height)}),t.camera.aspect=t.width/t.height,t.camera.updateProjectionMatrix(),t.camera.position.z=1e3,t.scene.add(t.skysphere=new Vi.Mesh),t.skysphere.visible=!1,t.loadComplete=t.scene.visible=!v,window.scene=t.scene},update:function(e,t){if(e.width&&e.height&&(t.hasOwnProperty("width")||t.hasOwnProperty("height"))&&(e.container.style.width="".concat(e.width,"px"),e.container.style.height="".concat(e.height,"px"),[e.renderer,e.postProcessingComposer].concat(ig(e.extraRenderers)).forEach(function(s){return s.setSize(e.width,e.height)}),e.camera.aspect=e.width/e.height,e.camera.updateProjectionMatrix()),t.hasOwnProperty("skyRadius")&&e.skyRadius&&(e.controls.hasOwnProperty("maxDistance")&&t.skyRadius&&(e.controls.maxDistance=Math.min(e.controls.maxDistance,e.skyRadius)),e.camera.far=e.skyRadius*2.5,e.camera.updateProjectionMatrix(),e.skysphere.geometry=new Vi.SphereGeometry(e.skyRadius)),t.hasOwnProperty("backgroundColor")){var i=Gd(e.backgroundColor).alpha;i===void 0&&(i=1),e.renderer.setClearColor(new Vi.Color(k3e(1,e.backgroundColor)),i)}t.hasOwnProperty("backgroundImageUrl")&&(e.backgroundImageUrl?new Vi.TextureLoader().load(e.backgroundImageUrl,function(s){s.colorSpace=Vi.SRGBColorSpace,e.skysphere.material=new Vi.MeshBasicMaterial({map:s,side:Vi.BackSide}),e.skysphere.visible=!0,e.onBackgroundImageLoaded&&setTimeout(e.onBackgroundImageLoaded),!e.loadComplete&&r()}):(e.skysphere.visible=!1,e.skysphere.material.map=null,!e.loadComplete&&r())),t.hasOwnProperty("showNavInfo")&&(e.navInfo.style.display=e.showNavInfo?null:"none"),t.hasOwnProperty("lights")&&((t.lights||[]).forEach(function(s){return e.scene.remove(s)}),e.lights.forEach(function(s){return e.scene.add(s)})),t.hasOwnProperty("objects")&&((t.objects||[]).forEach(function(s){return e.scene.remove(s)}),e.objects.forEach(function(s){return e.scene.add(s)}));function r(){e.loadComplete=e.scene.visible=!0}}});function eTe(n,e){e===void 0&&(e={});var t=e.insertAt;if(!(typeof document>"u")){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=n:r.appendChild(document.createTextNode(n))}}var tTe=`.scene-container .clickable {
  cursor: pointer;
}`;eTe(tTe);function i5(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=Array(e);t<e;t++)i[t]=n[t];return i}function nTe(n){if(Array.isArray(n))return i5(n)}function zv(n,e,t){return(e=lTe(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function iTe(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function rTe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $B(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function sd(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$B(Object(t),!0).forEach(function(i){zv(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):$B(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function sTe(n,e){if(n==null)return{};var t,i,r=oTe(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(i=0;i<s.length;i++)t=s[i],e.includes(t)||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function oTe(n,e){if(n==null)return{};var t={};for(var i in n)if({}.hasOwnProperty.call(n,i)){if(e.includes(i))continue;t[i]=n[i]}return t}function Sw(n){return nTe(n)||iTe(n)||uTe(n)||rTe()}function aTe(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lTe(n){var e=aTe(n,"string");return typeof e=="symbol"?e:e+""}function uTe(n,e){if(n){if(typeof n=="string")return i5(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i5(n,e):void 0}}function Dj(n,e){var t=new e;return t._destructor&&t._destructor(),{linkProp:function(r){return{default:t[r](),onChange:function(o,a){a[n][r](o)},triggerUpdate:!1}},linkMethod:function(r){return function(s){for(var o=s[n],a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];var c=o[r].apply(o,l);return c===o?this:c}}}}var cTe=["rendererConfig","waitForGlobeReady"],rg=sd(sd({},window.THREE?window.THREE:{AmbientLight:Bue,DirectionalLight:Fue,Vector2:rt,REVISION:GS}),{},{CSS2DRenderer:que}),kj=Dj("globe",Kq),hTe=Object.assign.apply(Object,Sw(["globeImageUrl","bumpImageUrl","showGlobe","showGraticules","showAtmosphere","atmosphereColor","atmosphereAltitude","onGlobeReady","pointsData","pointLat","pointLng","pointColor","pointAltitude","pointRadius","pointResolution","pointsMerge","pointsTransitionDuration","arcsData","arcStartLat","arcStartLng","arcEndLat","arcEndLng","arcColor","arcAltitude","arcAltitudeAutoScale","arcStroke","arcCurveResolution","arcCircularResolution","arcDashLength","arcDashGap","arcDashInitialGap","arcDashAnimateTime","arcsTransitionDuration","polygonsData","polygonGeoJsonGeometry","polygonCapColor","polygonCapMaterial","polygonSideColor","polygonSideMaterial","polygonStrokeColor","polygonAltitude","polygonCapCurvatureResolution","polygonsTransitionDuration","pathsData","pathPoints","pathPointLat","pathPointLng","pathPointAlt","pathResolution","pathColor","pathStroke","pathDashLength","pathDashGap","pathDashInitialGap","pathDashAnimateTime","pathTransitionDuration","heatmapsData","heatmapPoints","heatmapPointLat","heatmapPointLng","heatmapPointWeight","heatmapBandwidth","heatmapColorFn","heatmapColorSaturation","heatmapBaseAltitude","heatmapTopAltitude","heatmapsTransitionDuration","hexBinPointsData","hexBinPointLat","hexBinPointLng","hexBinPointWeight","hexBinResolution","hexMargin","hexTopCurvatureResolution","hexTopColor","hexSideColor","hexAltitude","hexBinMerge","hexTransitionDuration","hexPolygonsData","hexPolygonGeoJsonGeometry","hexPolygonColor","hexPolygonAltitude","hexPolygonResolution","hexPolygonMargin","hexPolygonUseDots","hexPolygonCurvatureResolution","hexPolygonDotResolution","hexPolygonsTransitionDuration","tilesData","tileLat","tileLng","tileAltitude","tileWidth","tileHeight","tileUseGlobeProjection","tileMaterial","tileCurvatureResolution","tilesTransitionDuration","ringsData","ringLat","ringLng","ringAltitude","ringColor","ringResolution","ringMaxRadius","ringPropagationSpeed","ringRepeatPeriod","labelsData","labelLat","labelLng","labelAltitude","labelRotation","labelText","labelSize","labelTypeFace","labelColor","labelResolution","labelIncludeDot","labelDotRadius","labelDotOrientation","labelsTransitionDuration","htmlElementsData","htmlLat","htmlLng","htmlAltitude","htmlElement","htmlTransitionDuration","objectsData","objectLat","objectLng","objectAltitude","objectRotation","objectFacesSurface","objectThreeObject","customLayerData","customThreeObject","customThreeObjectUpdate"].map(function(n){return zv({},n,kj.linkProp(n))}))),fTe=Object.assign.apply(Object,Sw(["globeMaterial","getGlobeRadius","getCoords","toGeoCoords"].map(function(n){return zv({},n,kj.linkMethod(n))}))),Lj=Dj("renderObjs",Ij),dTe=Object.assign.apply(Object,Sw(["width","height","backgroundColor","backgroundImageUrl","enablePointerInteraction"].map(function(n){return zv({},n,Lj.linkProp(n))}))),pTe=Object.assign.apply(Object,Sw(["lights","postProcessingComposer"].map(function(n){return zv({},n,Lj.linkMethod(n))}))),ATe=hs({props:sd(sd({onZoom:{triggerUpdate:!1},onGlobeClick:{triggerUpdate:!1},onGlobeRightClick:{triggerUpdate:!1},pointLabel:{default:"name",triggerUpdate:!1},onPointClick:{triggerUpdate:!1},onPointRightClick:{triggerUpdate:!1},onPointHover:{triggerUpdate:!1},arcLabel:{default:"name",triggerUpdate:!1},onArcClick:{triggerUpdate:!1},onArcRightClick:{triggerUpdate:!1},onArcHover:{triggerUpdate:!1},polygonLabel:{default:"name",triggerUpdate:!1},onPolygonClick:{triggerUpdate:!1},onPolygonRightClick:{triggerUpdate:!1},onPolygonHover:{triggerUpdate:!1},pathLabel:{default:"name",triggerUpdate:!1},onPathClick:{triggerUpdate:!1},onPathRightClick:{triggerUpdate:!1},onPathHover:{triggerUpdate:!1},onHeatmapClick:{triggerUpdate:!1},onHeatmapRightClick:{triggerUpdate:!1},onHeatmapHover:{triggerUpdate:!1},hexLabel:{triggerUpdate:!1},onHexClick:{triggerUpdate:!1},onHexRightClick:{triggerUpdate:!1},onHexHover:{triggerUpdate:!1},hexPolygonLabel:{triggerUpdate:!1},onHexPolygonClick:{triggerUpdate:!1},onHexPolygonRightClick:{triggerUpdate:!1},onHexPolygonHover:{triggerUpdate:!1},tileLabel:{default:"name",triggerUpdate:!1},onTileClick:{triggerUpdate:!1},onTileRightClick:{triggerUpdate:!1},onTileHover:{triggerUpdate:!1},labelLabel:{triggerUpdate:!1},onLabelClick:{triggerUpdate:!1},onLabelRightClick:{triggerUpdate:!1},onLabelHover:{triggerUpdate:!1},objectLabel:{default:"name",triggerUpdate:!1},onObjectClick:{triggerUpdate:!1},onObjectRightClick:{triggerUpdate:!1},onObjectHover:{triggerUpdate:!1},customLayerLabel:{default:"name",triggerUpdate:!1},onCustomLayerClick:{triggerUpdate:!1},onCustomLayerRightClick:{triggerUpdate:!1},onCustomLayerHover:{triggerUpdate:!1},pointerEventsFilter:{default:function(){return!0},triggerUpdate:!1,onChange:function(e,t){return t.renderObjs.hoverFilter(function(i){return e(i,i.__data)})}},lineHoverPrecision:{default:.2,triggerUpdate:!1,onChange:function(e,t){return t.renderObjs.lineHoverPrecision(e)}}},hTe),dTe),methods:sd(sd({pauseAnimation:function(e){var t;return e.animationFrameRequestId!==null&&(cancelAnimationFrame(e.animationFrameRequestId),e.animationFrameRequestId=null),(t=e.globe)===null||t===void 0||t.pauseAnimation(),this},resumeAnimation:function(e){var t;return e.animationFrameRequestId===null&&this._animationCycle(),(t=e.globe)===null||t===void 0||t.resumeAnimation(),this},_animationCycle:function(e){e.renderObjs.tick(),e.tweenGroup.update(),e.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},pointOfView:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=o();if(t.lat===void 0&&t.lng===void 0&&t.altitude===void 0)return r;var s=Object.assign({},r,t);if(["lat","lng","altitude"].forEach(function(l){return s[l]=+s[l]}),!i)a(s);else{for(;r.lng-s.lng>180;)r.lng-=360;for(;r.lng-s.lng<-180;)r.lng+=360;e.tweenGroup.add(new Bs(r).to(s,i).easing(Rr.Cubic.InOut).onUpdate(a).start())}return this;function o(){return e.globe.toGeoCoords(e.renderObjs.cameraPosition())}function a(l){var u=l.lat,c=l.lng,h=l.altitude;e.renderObjs.cameraPosition(e.globe.getCoords(u,c,h))}},getScreenCoords:function(e){for(var t,i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];var o=(t=e.globe).getCoords.apply(t,r);return e.renderObjs.getScreenCoords(o.x,o.y,o.z)},toGlobeCoords:function(e,t,i){var r=e.renderObjs.intersectingObjects(t,i).find(function(l){return l.object.__globeObjType==="globe"});if(!r)return null;var s=e.globe.toGeoCoords(r.point),o=s.lat,a=s.lng;return{lat:o,lng:a}},scene:function(e){return e.renderObjs.scene()},camera:function(e){return e.renderObjs.camera()},renderer:function(e){return e.renderObjs.renderer()},controls:function(e){return e.renderObjs.controls()},_destructor:function(e){e.globe._destructor(),this.pauseAnimation(),this.pointsData([]),this.arcsData([]),this.polygonsData([]),this.pathsData([]),this.heatmapsData([]),this.hexBinPointsData([]),this.hexPolygonsData([]),this.tilesData([]),this.labelsData([]),this.htmlElementsData([]),this.objectsData([]),this.customLayerData([])}},fTe),pTe),stateInit:function(e){var t=e.rendererConfig,i=e.waitForGlobeReady,r=i===void 0?!0:i,s=sTe(e,cTe),o=new Kq(sd({waitForGlobeReady:r},s));return{globe:o,renderObjs:Ij({controlType:"orbit",rendererConfig:t,waitForLoadComplete:r,extraRenderers:[new rg.CSS2DRenderer]}).skyRadius(o.getGlobeRadius()*500).showNavInfo(!1).objects([o]).lights([new rg.AmbientLight(13421772,Math.PI),new rg.DirectionalLight(16777215,.6*Math.PI)]),tweenGroup:new tw}},init:function(e,t){var i=this;e.innerHTML="",e.appendChild(t.container=document.createElement("div")),t.container.style.position="relative";var r=document.createElement("div");t.container.appendChild(r),t.renderObjs(r),t.globe.rendererSize(t.renderObjs.renderer().getSize(new rg.Vector2)),this.pointOfView({altitude:2.5});var s=t.globe.getGlobeRadius(),o=t.renderObjs.controls();o.minDistance=s*1.01,o.maxDistance=s*100,o.enablePan=!1,o.enableDamping=!0,o.dampingFactor=.1,o.rotateSpeed=.3,o.zoomSpeed=.3,o.addEventListener("change",function(){var u=i.pointOfView();o.rotateSpeed=u.altitude*.2,o.zoomSpeed=(u.altitude+1)*.1,t.globe.setPointOfView(t.renderObjs.camera().position),t.onZoom&&t.onZoom(u)});var a=function(c){for(var h=c;h&&!h.hasOwnProperty("__globeObjType");)h=h.parent;return h},l={point:function(c){return c},arc:function(c){return c},polygon:function(c){return c.data},path:function(c){return c},heatmap:function(c){return c},hexbin:function(c){return c},hexPolygon:function(c){return c},tile:function(c){return c},label:function(c){return c},object:function(c){return c},custom:function(c){return c}};rg.REVISION<155&&(t.renderObjs.renderer().useLegacyLights=!1),t.renderObjs.hoverOrderComparator(function(u,c){var h=a(u),A=a(c),v=function(S){return!S};return v(h)-v(A)}).tooltipContent(function(u){var c={point:t.pointLabel,arc:t.arcLabel,polygon:t.polygonLabel,path:t.pathLabel,hexbin:t.hexLabel,hexPolygon:t.hexPolygonLabel,tile:t.tileLabel,label:t.labelLabel,object:t.objectLabel,custom:t.customLayerLabel},h=a(u),A=h&&h.__globeObjType;return h&&A&&c.hasOwnProperty(A)&&l.hasOwnProperty(A)&&ot(c[A])(l[A](h.__data))||""}).onHover(function(u){var c={point:t.onPointHover,arc:t.onArcHover,polygon:t.onPolygonHover,path:t.onPathHover,heatmap:t.onHeatmapHover,hexbin:t.onHexHover,hexPolygon:t.onHexPolygonHover,tile:t.onTileHover,label:t.onLabelHover,object:t.onObjectHover,custom:t.onCustomLayerHover},h={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},A=a(u);if(A&&!c.hasOwnProperty(A.__globeObjType)&&(A=null),A!==t.hoverObj){var v=t.hoverObj?t.hoverObj.__globeObjType:null,_=t.hoverObj?l[v](t.hoverObj.__data):null,S=A?A.__globeObjType:null,w=A?l[S](A.__data):null;v&&v!==S&&c[v]&&c[v](null,_),S&&c[S]&&c[S](w,v===S?_:null),t.renderObjs.renderer().domElement.classList[S&&h[S]?"add":"remove"]("clickable"),t.hoverObj=A}}).onClick(function(u,c,h){if(u){var A={globe:t.onGlobeClick,point:t.onPointClick,arc:t.onArcClick,polygon:t.onPolygonClick,path:t.onPathClick,heatmap:t.onHeatmapClick,hexbin:t.onHexClick,hexPolygon:t.onHexPolygonClick,tile:t.onTileClick,label:t.onLabelClick,object:t.onObjectClick,custom:t.onCustomLayerClick},v=a(u),_=v.__globeObjType;if(v&&A.hasOwnProperty(_)&&A[_]){var S=[c];if(_==="globe"){var w=i.toGeoCoords(h),x=w.lat,M=w.lng;S.unshift({lat:x,lng:M})}else S.push(i.toGeoCoords(h));l.hasOwnProperty(_)&&S.unshift(l[_](v.__data)),A[_].apply(A,S)}}}).onRightClick(function(u,c,h){if(u){var A={globe:t.onGlobeRightClick,point:t.onPointRightClick,arc:t.onArcRightClick,polygon:t.onPolygonRightClick,path:t.onPathRightClick,heatmap:t.onHeatmapRightClick,hexbin:t.onHexRightClick,hexPolygon:t.onHexPolygonRightClick,tile:t.onTileRightClick,label:t.onLabelRightClick,object:t.onObjectRightClick,custom:t.onCustomLayerRightClick},v=a(u),_=v.__globeObjType;if(v&&A.hasOwnProperty(_)&&A[_]){var S=[c];if(_==="globe"){var w=i.toGeoCoords(h),x=w.lat,M=w.lng;S.unshift({lat:x,lng:M})}else S.push(i.toGeoCoords(h));l.hasOwnProperty(_)&&S.unshift(l[_](v.__data)),A[_].apply(A,S)}}}),this._animationCycle()}}),mTe={width:V.number,height:V.number,backgroundColor:V.string,backgroundImageUrl:V.string,globeImageUrl:V.string,bumpImageUrl:V.string,showGlobe:V.bool,showGraticules:V.bool,showAtmosphere:V.bool,atmosphereColor:V.string,atmosphereAltitude:V.number,globeMaterial:V.object,onGlobeReady:V.func,onGlobeClick:V.func,onGlobeRightClick:V.func,pointsData:V.arrayOf(V.object),pointLat:V.oneOfType([V.number,V.string,V.func]),pointLng:V.oneOfType([V.number,V.string,V.func]),pointColor:V.oneOfType([V.string,V.func]),pointAltitude:V.oneOfType([V.number,V.string,V.func]),pointRadius:V.oneOfType([V.number,V.string,V.func]),pointResolution:V.number,pointsMerge:V.bool,pointsTransitionDuration:V.number,pointLabel:V.oneOfType([V.string,V.func]),onPointClick:V.func,onPointRightClick:V.func,onPointHover:V.func,arcsData:V.arrayOf(V.object),arcStartLat:V.oneOfType([V.number,V.string,V.func]),arcStartLng:V.oneOfType([V.number,V.string,V.func]),arcEndLat:V.oneOfType([V.number,V.string,V.func]),arcEndLng:V.oneOfType([V.number,V.string,V.func]),arcColor:V.oneOfType([V.string,V.arrayOf(V.string),V.func]),arcAltitude:V.oneOfType([V.number,V.string,V.func]),arcAltitudeAutoScale:V.oneOfType([V.number,V.string,V.func]),arcStroke:V.oneOfType([V.number,V.string,V.func]),arcCurveResolution:V.number,arcCircularResolution:V.number,arcDashLength:V.oneOfType([V.number,V.string,V.func]),arcDashGap:V.oneOfType([V.number,V.string,V.func]),arcDashInitialGap:V.oneOfType([V.number,V.string,V.func]),arcDashAnimateTime:V.oneOfType([V.number,V.string,V.func]),arcsTransitionDuration:V.number,arcLabel:V.oneOfType([V.string,V.func]),onArcClick:V.func,onArcRightClick:V.func,onArcHover:V.func,polygonsData:V.arrayOf(V.object),polygonGeoJsonGeometry:V.oneOfType([V.string,V.func]),polygonCapColor:V.oneOfType([V.string,V.func]),polygonCapMaterial:V.oneOfType([V.object,V.string,V.func]),polygonSideColor:V.oneOfType([V.string,V.func]),polygonSideMaterial:V.oneOfType([V.object,V.string,V.func]),polygonStrokeColor:V.oneOfType([V.string,V.func]),polygonAltitude:V.oneOfType([V.number,V.string,V.func]),polygonCapCurvatureResolution:V.oneOfType([V.number,V.string,V.func]),polygonsTransitionDuration:V.number,polygonLabel:V.oneOfType([V.string,V.func]),onPolygonClick:V.func,onPolygonRightClick:V.func,onPolygonHover:V.func,pathsData:V.array,pathPoints:V.oneOfType([V.array,V.string,V.func]),pathPointLat:V.oneOfType([V.number,V.string,V.func]),pathPointLng:V.oneOfType([V.number,V.string,V.func]),pathPointAlt:V.oneOfType([V.number,V.string,V.func]),pathResolution:V.number,pathColor:V.oneOfType([V.string,V.arrayOf(V.string),V.func]),pathStroke:V.oneOfType([V.number,V.string,V.func]),pathDashLength:V.oneOfType([V.number,V.string,V.func]),pathDashGap:V.oneOfType([V.number,V.string,V.func]),pathDashInitialGap:V.oneOfType([V.number,V.string,V.func]),pathDashAnimateTime:V.oneOfType([V.number,V.string,V.func]),pathTransitionDuration:V.number,pathLabel:V.oneOfType([V.string,V.func]),onPathClick:V.func,onPathRightClick:V.func,onPathHover:V.func,heatmapsData:V.array,heatmapPoints:V.oneOfType([V.array,V.string,V.func]),heatmapPointLat:V.oneOfType([V.number,V.string,V.func]),heatmapPointLng:V.oneOfType([V.number,V.string,V.func]),heatmapPointWeight:V.oneOfType([V.number,V.string,V.func]),heatmapBandwidth:V.oneOfType([V.number,V.string,V.func]),heatmapColorFn:V.oneOfType([V.string,V.func]),heatmapColorSaturation:V.oneOfType([V.number,V.string,V.func]),heatmapBaseAltitude:V.oneOfType([V.number,V.string,V.func]),heatmapTopAltitude:V.oneOfType([V.number,V.string,V.func]),heatmapsTransitionDuration:V.number,onHeatmapClick:V.func,onHeatmapRightClick:V.func,onHeatmapHover:V.func,hexBinPointsData:V.arrayOf(V.object),hexBinPointLat:V.oneOfType([V.number,V.string,V.func]),hexBinPointLng:V.oneOfType([V.number,V.string,V.func]),hexBinPointWeight:V.oneOfType([V.number,V.string,V.func]),hexBinResolution:V.number,hexMargin:V.oneOfType([V.number,V.func]),hexTopColor:V.func,hexSideColor:V.func,hexAltitude:V.oneOfType([V.number,V.func]),hexTopCurvatureResolution:V.number,hexBinMerge:V.bool,hexTransitionDuration:V.number,hexLabel:V.oneOfType([V.string,V.func]),onHexClick:V.func,onHexRightClick:V.func,onHexHover:V.func,hexPolygonsData:V.arrayOf(V.object),hexPolygonGeoJsonGeometry:V.oneOfType([V.string,V.func]),hexPolygonColor:V.oneOfType([V.string,V.func]),hexPolygonAltitude:V.oneOfType([V.number,V.string,V.func]),hexPolygonResolution:V.oneOfType([V.number,V.string,V.func]),hexPolygonMargin:V.oneOfType([V.number,V.string,V.func]),hexPolygonUseDots:V.oneOfType([V.bool,V.string,V.func]),hexPolygonCurvatureResolution:V.oneOfType([V.number,V.string,V.func]),hexPolygonDotResolution:V.oneOfType([V.number,V.string,V.func]),hexPolygonsTransitionDuration:V.number,hexPolygonLabel:V.oneOfType([V.string,V.func]),onHexPolygonClick:V.func,onHexPolygonRightClick:V.func,onHexPolygonHover:V.func,tilesData:V.arrayOf(V.object),tileLat:V.oneOfType([V.number,V.string,V.func]),tileLng:V.oneOfType([V.number,V.string,V.func]),tileAltitude:V.oneOfType([V.number,V.string,V.func]),tileWidth:V.oneOfType([V.number,V.string,V.func]),tileHeight:V.oneOfType([V.number,V.string,V.func]),tileUseGlobeProjection:V.oneOfType([V.bool,V.string,V.func]),tileMaterial:V.oneOfType([V.object,V.string,V.func]),tileCurvatureResolution:V.oneOfType([V.number,V.string,V.func]),tilesTransitionDuration:V.number,tileLabel:V.oneOfType([V.string,V.func]),onTileClick:V.func,onTileRightClick:V.func,onTileHover:V.func,ringsData:V.arrayOf(V.object),ringLat:V.oneOfType([V.number,V.string,V.func]),ringLng:V.oneOfType([V.number,V.string,V.func]),ringAltitude:V.oneOfType([V.number,V.string,V.func]),ringColor:V.oneOfType([V.string,V.arrayOf(V.string),V.func]),ringResolution:V.number,ringMaxRadius:V.oneOfType([V.number,V.string,V.func]),ringPropagationSpeed:V.oneOfType([V.number,V.string,V.func]),ringRepeatPeriod:V.oneOfType([V.number,V.string,V.func]),labelsData:V.arrayOf(V.object),labelLat:V.oneOfType([V.number,V.string,V.func]),labelLng:V.oneOfType([V.number,V.string,V.func]),labelAltitude:V.oneOfType([V.number,V.string,V.func]),labelRotation:V.oneOfType([V.number,V.string,V.func]),labelText:V.oneOfType([V.string,V.func]),labelSize:V.oneOfType([V.number,V.string,V.func]),labelTypeFace:V.object,labelColor:V.oneOfType([V.string,V.func]),labelResolution:V.number,labelIncludeDot:V.oneOfType([V.bool,V.string,V.func]),labelDotRadius:V.oneOfType([V.number,V.string,V.func]),labelDotOrientation:V.oneOfType([V.string,V.func]),labelsTransitionDuration:V.number,labelLabel:V.oneOfType([V.string,V.func]),onLabelClick:V.func,onLabelRightClick:V.func,onLabelHover:V.func,htmlElementsData:V.arrayOf(V.object),htmlLat:V.oneOfType([V.number,V.string,V.func]),htmlLng:V.oneOfType([V.number,V.string,V.func]),htmlAltitude:V.oneOfType([V.number,V.string,V.func]),htmlElement:V.oneOfType([V.string,V.func]),htmlTransitionDuration:V.number,objectsData:V.arrayOf(V.object),objectLat:V.oneOfType([V.number,V.string,V.func]),objectLng:V.oneOfType([V.number,V.string,V.func]),objectAltitude:V.oneOfType([V.number,V.string,V.func]),objectRotation:V.oneOfType([V.shape({x:V.number,y:V.number,z:V.number}),V.string,V.func]),objectFacesSurface:V.oneOfType([V.bool,V.string,V.func]),objectThreeObject:V.oneOfType([V.object,V.string,V.func]),objectLabel:V.oneOfType([V.string,V.func]),onObjectClick:V.func,onObjectRightClick:V.func,onObjectHover:V.func,customLayerData:V.arrayOf(V.object),customThreeObject:V.oneOfType([V.object,V.string,V.func]),customThreeObjectUpdate:V.oneOfType([V.string,V.func]),customLayerLabel:V.oneOfType([V.string,V.func]),onCustomLayerClick:V.func,onCustomLayerRightClick:V.func,onCustomLayerHover:V.func,enablePointerInteraction:V.bool,pointerEventsFilter:V.func,lineHoverPrecision:V.number,onZoom:V.func},yN=kne(ATe,{methodNames:["pauseAnimation","resumeAnimation","pointOfView","lights","scene","camera","renderer","postProcessingComposer","controls","getGlobeRadius","getCoords","getScreenCoords","toGeoCoords","toGlobeCoords"],initPropNames:["animateIn","waitForGlobeReady","rendererConfig"]});yN.displayName="Globe";yN.propTypes=mTe;function gTe(n){return n}function vTe(n){if(n==null)return gTe;var e,t,i=n.scale[0],r=n.scale[1],s=n.translate[0],o=n.translate[1];return function(a,l){l||(e=t=0);var u=2,c=a.length,h=new Array(c);for(h[0]=(e+=a[0])*i+s,h[1]=(t+=a[1])*r+o;u<c;)h[u]=a[u],++u;return h}}function yTe(n,e){for(var t,i=n.length,r=i-e;r<--i;)t=n[r],n[r++]=n[i],n[i]=t}function _Te(n,e){return typeof e=="string"&&(e=n.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(t){return jB(n,t)})}:jB(n,e)}function jB(n,e){var t=e.id,i=e.bbox,r=e.properties==null?{}:e.properties,s=xTe(n,e);return t==null&&i==null?{type:"Feature",properties:r,geometry:s}:i==null?{type:"Feature",id:t,properties:r,geometry:s}:{type:"Feature",id:t,bbox:i,properties:r,geometry:s}}function xTe(n,e){var t=vTe(n.transform),i=n.arcs;function r(c,h){h.length&&h.pop();for(var A=i[c<0?~c:c],v=0,_=A.length;v<_;++v)h.push(t(A[v],v));c<0&&yTe(h,_)}function s(c){return t(c)}function o(c){for(var h=[],A=0,v=c.length;A<v;++A)r(c[A],h);return h.length<2&&h.push(h[0]),h}function a(c){for(var h=o(c);h.length<4;)h.push(h[0]);return h}function l(c){return c.map(a)}function u(c){var h=c.type,A;switch(h){case"GeometryCollection":return{type:h,geometries:c.geometries.map(u)};case"Point":A=s(c.coordinates);break;case"MultiPoint":A=c.coordinates.map(s);break;case"LineString":A=o(c.arcs);break;case"MultiLineString":A=c.arcs.map(o);break;case"Polygon":A=l(c.arcs);break;case"MultiPolygon":A=c.arcs.map(l);break;default:return null}return{type:h,coordinates:A}}return u(e)}const bTe=({color:n})=>{const[e,t]=de.useState({width:0,height:0}),[i,r]=de.useState([]),s=de.useRef(null),o=de.useRef(void 0);de.useLayoutEffect(()=>{const l=()=>{s.current&&t({width:s.current.offsetWidth,height:s.current.offsetHeight})};return l(),window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l)}},[]),de.useEffect(()=>{fetch("//unpkg.com/world-atlas/land-110m.json").then(l=>l.json()).then(l=>{const u=_Te(l,l.objects.land);r(u.features)})},[]),de.useEffect(()=>{(()=>{if(o.current){const u=o.current.controls();u.autoRotate=!0,u.autoRotateSpeed=1,u.minDistance=250,u.maxDistance=1e3,u.update();const c=o.current.camera();c.position.z=250,u.enabled=!1}})()},[]);const a=new df({color:n,side:Ks});return fe.jsx("div",{ref:s,style:{width:"100%",height:"100%",minHeight:"25rem"},children:fe.jsx(yN,{ref:o,backgroundColor:"rgba(0,0,0,0)",showGlobe:!1,showAtmosphere:!1,polygonsData:i,polygonCapMaterial:a,polygonSideColor:()=>"rgba(0, 0, 0, 0)",width:e.width,height:e.height,enablePointerInteraction:!1})})},WB="/maps/241101_WorldMap.webp";function STe(){return de.useEffect(()=>{const n=new Image;n.src=WB},[]),fe.jsx("div",{className:"world-map",children:fe.jsx("img",{src:WB,alt:"World Map"})})}function wTe({setMapSwitch:n,mapSwitch:e}){return fe.jsxs("div",{className:"switch-content",children:[fe.jsx("div",{className:"switch-button",onClick:()=>n(!e),children:fe.jsx("div",{className:`switch-circle ${e?"active":""}`})}),fe.jsx("div",{className:"switch-text",children:e?"Switch to Globe":"Switch to Map"})]})}function ETe({setActiveTab:n,activeTab:e,sections:t,activeSection:i}){const r=s=>{const o=document.getElementById(s);if(o){const a=document.querySelector(".sticky-bar"),l=a?-a.clientHeight:0,u=o.getBoundingClientRect().top+window.scrollY+l;window.scrollTo({top:u,behavior:"smooth"})}};return fe.jsxs("div",{className:"sticky-bar",children:[fe.jsx("div",{className:"sticky-top",children:fe.jsxs("ul",{children:[fe.jsx("li",{onClick:()=>n("Macro"),className:`tab ${e==="Macro"?"active":""}`,children:fe.jsx("div",{className:"text",children:" Macro "})}),fe.jsx("li",{onClick:()=>n("Meso"),className:`tab ${e==="Meso"?"active":""}`,children:fe.jsx("div",{className:"text",children:" Meso"})}),fe.jsx("li",{onClick:()=>n("Micro"),className:`tab ${e==="Micro"?"active":""}`,children:fe.jsx("div",{className:"text",children:" Micro"})})]})}),fe.jsx("div",{className:"sticky-bottom",children:fe.jsx("ul",{children:t.map(s=>fe.jsx("li",{onClick:()=>r(s),className:`section ${i===s?"active":""}`,children:fe.jsx("div",{className:"text",children:s})},s))})})]})}function TTe({sections:n,onActiveSectionChange:e}){return de.useEffect(()=>{const t=()=>{const i=window.scrollY+window.innerHeight/2;let r=n[0];n.forEach(s=>{const o=document.getElementById(s);o&&o.offsetTop<=i&&r!==s&&(r=s)}),e(r)};return window.addEventListener("scroll",t),()=>{window.removeEventListener("scroll",t)}},[n,e]),null}const CTe=de.lazy(()=>DP(()=>import("./Macro-GdX9XakF.js"),__vite__mapDeps([0,1]))),MTe=de.lazy(()=>DP(()=>import("./Meso-Cs_qvvt6.js"),[])),RTe=de.lazy(()=>DP(()=>import("./Micro-W3HjXlcG.js"),[]));function PTe(){const[n,e]=de.useState("Macro"),[t,i]=de.useState(!1),r=["Introduction","Politics","Economics","Society","Physical Displacement","Health + Wellbeing","Built Environment"],[s,o]=de.useState(r[0]),a=()=>{switch(n){case"Macro":return fe.jsx(CTe,{});case"Meso":return fe.jsx(MTe,{});case"Micro":return fe.jsx(RTe,{});default:return null}},l=()=>{switch(n){case"Macro":return t?fe.jsx(STe,{}):fe.jsx(bTe,{color:"#bfbfbf"});case"Meso":return null;case"Micro":return null;default:return null}};return fe.jsxs("div",{className:"page-content",children:[fe.jsx("div",{className:"main-heading",children:fe.jsx(Ane,{})}),fe.jsxs("div",{className:"page-content",children:[fe.jsxs("div",{className:"map-content",children:[l(),fe.jsx(wTe,{setMapSwitch:i,mapSwitch:t})]}),fe.jsx(TTe,{sections:r,onActiveSectionChange:o}),fe.jsx(ETe,{setActiveTab:e,activeTab:n,sections:r,activeSection:s}),fe.jsx(BP,{children:fe.jsx(LP,{timeout:400,classNames:"fade",children:fe.jsx(de.Suspense,{fallback:fe.jsx("div",{children:"Loading..."}),children:a()})},n)})]})]})}var XB={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt=function(n,e){if(!n)throw rm(e)},rm=function(n){return new Error("Firebase Database ("+Fj.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},NTe=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],l=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},_N={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,l=r+2<n.length,u=l?n[r+2]:0,c=s>>2,h=(s&3)<<4|a>>4;let A=(a&15)<<2|u>>6,v=u&63;l||(v=64,o||(A=64)),i.push(t[c],t[h],t[A],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Bj(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):NTe(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const u=r<n.length?t[n.charAt(r)]:64;++r;const h=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||u==null||h==null)throw new ITe;const A=s<<2|a>>4;if(i.push(A),u!==64){const v=a<<4&240|u>>2;if(i.push(v),h!==64){const _=u<<6&192|h;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class ITe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Oj=function(n){const e=Bj(n);return _N.encodeByteArray(e,!0)},$b=function(n){return Oj(n).replace(/\./g,"")},jb=function(n){try{return _N.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DTe(n){return Uj(void 0,n)}function Uj(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!kTe(t)||(n[t]=Uj(n[t],e[t]));return n}function kTe(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LTe(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FTe=()=>LTe().__FIREBASE_DEFAULTS__,BTe=()=>{if(typeof process>"u"||typeof XB>"u")return;const n=XB.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},OTe=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&jb(n[1]);return e&&JSON.parse(e)},xN=()=>{try{return FTe()||BTe()||OTe()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},zj=n=>{var e,t;return(t=(e=xN())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},UTe=n=>{const e=zj(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Vj=()=>{var n;return(n=xN())===null||n===void 0?void 0:n.config},Gj=n=>{var e;return(e=xN())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zTe(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[$b(JSON.stringify(t)),$b(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ro())}function VTe(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qj(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Hj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function GTe(){const n=ro();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function $j(){return Fj.NODE_ADMIN===!0}function jj(){try{return typeof indexedDB=="object"}catch{return!1}}function Wj(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}function qTe(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HTe="FirebaseError";class hu extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=HTe,Object.setPrototypeOf(this,hu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,op.prototype.create)}}class op{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?$Te(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new hu(r,a,i)}}function $Te(n,e){return n.replace(jTe,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const jTe=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J1(n){return JSON.parse(n)}function Fr(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj=function(n){let e={},t={},i={},r="";try{const s=n.split(".");e=J1(jb(s[0])||""),t=J1(jb(s[1])||""),r=s[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:r}},WTe=function(n){const e=Xj(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},XTe=function(n){const e=Xj(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function B0(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function r5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Wb(n,e,t){const i={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=e.call(t,n[r],r,n));return i}function ev(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(YB(s)&&YB(o)){if(!ev(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function YB(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sm(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Sg(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[r,s]=i.split("=");e[decodeURIComponent(r)]=decodeURIComponent(s)}}),e}function wg(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YTe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)i[h]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let h=0;h<16;h++)i[h]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let h=16;h<80;h++){const A=i[h-3]^i[h-8]^i[h-14]^i[h-16];i[h]=(A<<1|A>>>31)&4294967295}let r=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],u,c;for(let h=0;h<80;h++){h<40?h<20?(u=a^s&(o^a),c=1518500249):(u=s^o^a,c=1859775393):h<60?(u=s&o|a&(s|o),c=2400959708):(u=s^o^a,c=3395469782);const A=(r<<5|r>>>27)+u+l+c+i[h]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=r,r=A}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let r=0;const s=this.buf_;let o=this.inbuf_;for(;r<t;){if(o===0)for(;r<=i;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<t;)if(s[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}else for(;r<t;)if(s[o]=e[r],++o,++r,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let r=0;r<5;r++)for(let s=24;s>=0;s-=8)e[i]=this.chain_[r]>>s&255,++i;return e}}function QTe(n,e){const t=new KTe(n,e);return t.subscribe.bind(t)}class KTe{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");ZTe(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=YT),r.error===void 0&&(r.error=YT),r.complete===void 0&&(r.complete=YT);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ZTe(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function YT(){}function SN(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JTe=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);if(r>=55296&&r<=56319){const s=r-55296;i++,yt(i<n.length,"Surrogate pair missing trail surrogate.");const o=n.charCodeAt(i)-56320;r=65536+(s<<10)+o}r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):r<65536?(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},Ew=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eCe=1e3,tCe=2,nCe=4*60*60*1e3,iCe=.5;function QB(n,e=eCe,t=tCe){const i=e*Math.pow(t,n),r=Math.round(iCe*i*(Math.random()-.5)*2);return Math.min(nCe,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(n){return n&&n._delegate?n._delegate:n}class Pl{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rCe{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new ww;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(oCe(e))try{this.getOrInitializeService({instanceIdentifier:Qf})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Qf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Qf){return this.instances.has(e)}getOptions(e=Qf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:sCe(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Qf){return this.component?this.component.multipleInstances?e:Qf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function sCe(n){return n===Qf?void 0:n}function oCe(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aCe{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new rCe(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ei;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ei||(Ei={}));const lCe={debug:Ei.DEBUG,verbose:Ei.VERBOSE,info:Ei.INFO,warn:Ei.WARN,error:Ei.ERROR,silent:Ei.SILENT},uCe=Ei.INFO,cCe={[Ei.DEBUG]:"log",[Ei.VERBOSE]:"log",[Ei.INFO]:"info",[Ei.WARN]:"warn",[Ei.ERROR]:"error"},hCe=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=cCe[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tw{constructor(e){this.name=e,this._logLevel=uCe,this._logHandler=hCe,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ei))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lCe[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ei.DEBUG,...e),this._logHandler(this,Ei.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ei.VERBOSE,...e),this._logHandler(this,Ei.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ei.INFO,...e),this._logHandler(this,Ei.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ei.WARN,...e),this._logHandler(this,Ei.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ei.ERROR,...e),this._logHandler(this,Ei.ERROR,...e)}}const fCe=(n,e)=>e.some(t=>n instanceof t);let KB,ZB;function dCe(){return KB||(KB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pCe(){return ZB||(ZB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Yj=new WeakMap,s5=new WeakMap,Qj=new WeakMap,QT=new WeakMap,wN=new WeakMap;function ACe(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Gh(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Yj.set(t,n)}).catch(()=>{}),wN.set(e,n),e}function mCe(n){if(s5.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});s5.set(n,e)}let o5={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return s5.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Qj.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Gh(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gCe(n){o5=n(o5)}function vCe(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(KT(this),e,...t);return Qj.set(i,e.sort?e.sort():[e]),Gh(i)}:pCe().includes(n)?function(...e){return n.apply(KT(this),e),Gh(Yj.get(this))}:function(...e){return Gh(n.apply(KT(this),e))}}function yCe(n){return typeof n=="function"?vCe(n):(n instanceof IDBTransaction&&mCe(n),fCe(n,dCe())?new Proxy(n,o5):n)}function Gh(n){if(n instanceof IDBRequest)return ACe(n);if(QT.has(n))return QT.get(n);const e=yCe(n);return e!==n&&(QT.set(n,e),wN.set(e,n)),e}const KT=n=>wN.get(n);function Kj(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Gh(o);return i&&o.addEventListener("upgradeneeded",l=>{i(Gh(o.result),l.oldVersion,l.newVersion,Gh(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),r&&l.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const _Ce=["get","getKey","getAll","getAllKeys","count"],xCe=["put","add","delete","clear"],ZT=new Map;function JB(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ZT.get(e))return ZT.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=xCe.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||_Ce.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,r?"readwrite":"readonly");let u=l.store;return i&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),r&&l.done]))[0]};return ZT.set(e,s),s}gCe(n=>({...n,get:(e,t,i)=>JB(e,t)||n.get(e,t,i),has:(e,t)=>!!JB(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bCe{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(SCe(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function SCe(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const a5="@firebase/app",eO="0.11.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc=new Tw("@firebase/app"),wCe="@firebase/app-compat",ECe="@firebase/analytics-compat",TCe="@firebase/analytics",CCe="@firebase/app-check-compat",MCe="@firebase/app-check",RCe="@firebase/auth",PCe="@firebase/auth-compat",NCe="@firebase/database",ICe="@firebase/data-connect",DCe="@firebase/database-compat",kCe="@firebase/functions",LCe="@firebase/functions-compat",FCe="@firebase/installations",BCe="@firebase/installations-compat",OCe="@firebase/messaging",UCe="@firebase/messaging-compat",zCe="@firebase/performance",VCe="@firebase/performance-compat",GCe="@firebase/remote-config",qCe="@firebase/remote-config-compat",HCe="@firebase/storage",$Ce="@firebase/storage-compat",jCe="@firebase/firestore",WCe="@firebase/vertexai",XCe="@firebase/firestore-compat",YCe="firebase",QCe="11.3.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l5="[DEFAULT]",KCe={[a5]:"fire-core",[wCe]:"fire-core-compat",[TCe]:"fire-analytics",[ECe]:"fire-analytics-compat",[MCe]:"fire-app-check",[CCe]:"fire-app-check-compat",[RCe]:"fire-auth",[PCe]:"fire-auth-compat",[NCe]:"fire-rtdb",[ICe]:"fire-data-connect",[DCe]:"fire-rtdb-compat",[kCe]:"fire-fn",[LCe]:"fire-fn-compat",[FCe]:"fire-iid",[BCe]:"fire-iid-compat",[OCe]:"fire-fcm",[UCe]:"fire-fcm-compat",[zCe]:"fire-perf",[VCe]:"fire-perf-compat",[GCe]:"fire-rc",[qCe]:"fire-rc-compat",[HCe]:"fire-gcs",[$Ce]:"fire-gcs-compat",[jCe]:"fire-fst",[XCe]:"fire-fst-compat",[WCe]:"fire-vertex","fire-js":"fire-js",[YCe]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=new Map,ZCe=new Map,u5=new Map;function tO(n,e){try{n.container.addComponent(e)}catch(t){yc.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function au(n){const e=n.name;if(u5.has(e))return yc.debug(`There were multiple attempts to register component ${e}.`),!1;u5.set(e,n);for(const t of Xb.values())tO(t,n);for(const t of ZCe.values())tO(t,n);return!0}function ap(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ra(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JCe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qh=new op("app","Firebase",JCe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eMe{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Pl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qh.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om=QCe;function Zj(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:l5,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw qh.create("bad-app-name",{appName:String(r)});if(t||(t=Vj()),!t)throw qh.create("no-options");const s=Xb.get(r);if(s){if(ev(t,s.options)&&ev(i,s.config))return s;throw qh.create("duplicate-app",{appName:r})}const o=new aCe(r);for(const l of u5.values())o.addComponent(l);const a=new eMe(t,i,o);return Xb.set(r,a),a}function EN(n=l5){const e=Xb.get(n);if(!e&&n===l5&&Vj())return Zj();if(!e)throw qh.create("no-app",{appName:n});return e}function Fa(n,e,t){var i;let r=(i=KCe[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yc.warn(a.join(" "));return}au(new Pl(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tMe="firebase-heartbeat-database",nMe=1,tv="firebase-heartbeat-store";let JT=null;function Jj(){return JT||(JT=Kj(tMe,nMe,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(tv)}catch(t){console.warn(t)}}}}).catch(n=>{throw qh.create("idb-open",{originalErrorMessage:n.message})})),JT}async function iMe(n){try{const t=(await Jj()).transaction(tv),i=await t.objectStore(tv).get(eW(n));return await t.done,i}catch(e){if(e instanceof hu)yc.warn(e.message);else{const t=qh.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yc.warn(t.message)}}}async function nO(n,e){try{const i=(await Jj()).transaction(tv,"readwrite");await i.objectStore(tv).put(e,eW(n)),await i.done}catch(t){if(t instanceof hu)yc.warn(t.message);else{const i=qh.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});yc.warn(i.message)}}}function eW(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rMe=1024,sMe=30;class oMe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new lMe(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=iO();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats.length>sMe){const o=uMe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){yc.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=iO(),{heartbeatsToSend:i,unsentEntries:r}=aMe(this._heartbeatsCache.heartbeats),s=$b(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return yc.warn(t),""}}}function iO(){return new Date().toISOString().substring(0,10)}function aMe(n,e=rMe){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),rO(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),rO(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class lMe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return jj()?Wj().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await iMe(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return nO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return nO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function rO(n){return $b(JSON.stringify({version:2,heartbeats:n})).length}function uMe(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cMe(n){au(new Pl("platform-logger",e=>new bCe(e),"PRIVATE")),au(new Pl("heartbeat",e=>new oMe(e),"PRIVATE")),Fa(a5,eO,n),Fa(a5,eO,"esm2017"),Fa("fire-js","")}cMe("");var hMe="firebase",fMe="11.3.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fa(hMe,fMe,"app");const tW="@firebase/installations",TN="0.6.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nW=1e4,iW=`w:${TN}`,rW="FIS_v2",dMe="https://firebaseinstallations.googleapis.com/v1",pMe=60*60*1e3,AMe="installations",mMe="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gMe={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},qd=new op(AMe,mMe,gMe);function sW(n){return n instanceof hu&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oW({projectId:n}){return`${dMe}/projects/${n}/installations`}function aW(n){return{token:n.token,requestStatus:2,expiresIn:yMe(n.expiresIn),creationTime:Date.now()}}async function lW(n,e){const i=(await e.json()).error;return qd.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function uW({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function vMe(n,{refreshToken:e}){const t=uW(n);return t.append("Authorization",_Me(e)),t}async function cW(n){const e=await n();return e.status>=500&&e.status<600?n():e}function yMe(n){return Number(n.replace("s","000"))}function _Me(n){return`${rW} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xMe({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=oW(n),r=uW(n),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&r.append("x-firebase-client",u)}const o={fid:t,authVersion:rW,appId:n.appId,sdkVersion:iW},a={method:"POST",headers:r,body:JSON.stringify(o)},l=await cW(()=>fetch(i,a));if(l.ok){const u=await l.json();return{fid:u.fid||t,registrationStatus:2,refreshToken:u.refreshToken,authToken:aW(u.authToken)}}else throw await lW("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hW(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bMe(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SMe=/^[cdef][\w-]{21}$/,c5="";function wMe(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=EMe(n);return SMe.test(t)?t:c5}catch{return c5}}function EMe(n){return bMe(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW=new Map;function dW(n,e){const t=Cw(n);pW(t,e),TMe(t,e)}function pW(n,e){const t=fW.get(n);if(t)for(const i of t)i(e)}function TMe(n,e){const t=CMe();t&&t.postMessage({key:n,fid:e}),MMe()}let gd=null;function CMe(){return!gd&&"BroadcastChannel"in self&&(gd=new BroadcastChannel("[Firebase] FID Change"),gd.onmessage=n=>{pW(n.data.key,n.data.fid)}),gd}function MMe(){fW.size===0&&gd&&(gd.close(),gd=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RMe="firebase-installations-database",PMe=1,Hd="firebase-installations-store";let eC=null;function CN(){return eC||(eC=Kj(RMe,PMe,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Hd)}}})),eC}async function Yb(n,e){const t=Cw(n),r=(await CN()).transaction(Hd,"readwrite"),s=r.objectStore(Hd),o=await s.get(t);return await s.put(e,t),await r.done,(!o||o.fid!==e.fid)&&dW(n,e.fid),e}async function AW(n){const e=Cw(n),i=(await CN()).transaction(Hd,"readwrite");await i.objectStore(Hd).delete(e),await i.done}async function Mw(n,e){const t=Cw(n),r=(await CN()).transaction(Hd,"readwrite"),s=r.objectStore(Hd),o=await s.get(t),a=e(o);return a===void 0?await s.delete(t):await s.put(a,t),await r.done,a&&(!o||o.fid!==a.fid)&&dW(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MN(n){let e;const t=await Mw(n.appConfig,i=>{const r=NMe(i),s=IMe(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===c5?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function NMe(n){const e=n||{fid:wMe(),registrationStatus:0};return mW(e)}function IMe(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(qd.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=DMe(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:kMe(n)}:{installationEntry:e}}async function DMe(n,e){try{const t=await xMe(n,e);return Yb(n.appConfig,t)}catch(t){throw sW(t)&&t.customData.serverCode===409?await AW(n.appConfig):await Yb(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function kMe(n){let e=await sO(n.appConfig);for(;e.registrationStatus===1;)await hW(100),e=await sO(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await MN(n);return i||t}return e}function sO(n){return Mw(n,e=>{if(!e)throw qd.create("installation-not-found");return mW(e)})}function mW(n){return LMe(n)?{fid:n.fid,registrationStatus:0}:n}function LMe(n){return n.registrationStatus===1&&n.registrationTime+nW<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FMe({appConfig:n,heartbeatServiceProvider:e},t){const i=BMe(n,t),r=vMe(n,t),s=e.getImmediate({optional:!0});if(s){const u=await s.getHeartbeatsHeader();u&&r.append("x-firebase-client",u)}const o={installation:{sdkVersion:iW,appId:n.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},l=await cW(()=>fetch(i,a));if(l.ok){const u=await l.json();return aW(u)}else throw await lW("Generate Auth Token",l)}function BMe(n,{fid:e}){return`${oW(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RN(n,e=!1){let t;const i=await Mw(n.appConfig,s=>{if(!gW(s))throw qd.create("not-registered");const o=s.authToken;if(!e&&zMe(o))return s;if(o.requestStatus===1)return t=OMe(n,e),s;{if(!navigator.onLine)throw qd.create("app-offline");const a=GMe(s);return t=UMe(n,a),a}});return t?await t:i.authToken}async function OMe(n,e){let t=await oO(n.appConfig);for(;t.authToken.requestStatus===1;)await hW(100),t=await oO(n.appConfig);const i=t.authToken;return i.requestStatus===0?RN(n,e):i}function oO(n){return Mw(n,e=>{if(!gW(e))throw qd.create("not-registered");const t=e.authToken;return qMe(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function UMe(n,e){try{const t=await FMe(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await Yb(n.appConfig,i),t}catch(t){if(sW(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await AW(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Yb(n.appConfig,i)}throw t}}function gW(n){return n!==void 0&&n.registrationStatus===2}function zMe(n){return n.requestStatus===2&&!VMe(n)}function VMe(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+pMe}function GMe(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function qMe(n){return n.requestStatus===1&&n.requestTime+nW<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HMe(n){const e=n,{installationEntry:t,registrationPromise:i}=await MN(e);return i?i.catch(console.error):RN(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $Me(n,e=!1){const t=n;return await jMe(t),(await RN(t,e)).token}async function jMe(n){const{registrationPromise:e}=await MN(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WMe(n){if(!n||!n.options)throw tC("App Configuration");if(!n.name)throw tC("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw tC(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function tC(n){return qd.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vW="installations",XMe="installations-internal",YMe=n=>{const e=n.getProvider("app").getImmediate(),t=WMe(e),i=ap(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},QMe=n=>{const e=n.getProvider("app").getImmediate(),t=ap(e,vW).getImmediate();return{getId:()=>HMe(t),getToken:r=>$Me(t,r)}};function KMe(){au(new Pl(vW,YMe,"PUBLIC")),au(new Pl(XMe,QMe,"PRIVATE"))}KMe();Fa(tW,TN);Fa(tW,TN,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb="analytics",ZMe="firebase_id",JMe="origin",e4e=60*1e3,t4e="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",PN="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io=new Tw("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4e={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},oa=new op("analytics","Analytics",n4e);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i4e(n){if(!n.startsWith(PN)){const e=oa.create("invalid-gtag-resource",{gtagURL:n});return Io.warn(e.message),""}return n}function yW(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function r4e(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function s4e(n,e){const t=r4e("firebase-js-sdk-policy",{createScriptURL:i4e}),i=document.createElement("script"),r=`${PN}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function o4e(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function a4e(n,e,t,i,r,s){const o=i[r];try{if(o)await e[o];else{const l=(await yW(t)).find(u=>u.measurementId===r);l&&await e[l.appId]}}catch(a){Io.error(a)}n("config",r,s)}async function l4e(n,e,t,i,r){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await yW(t);for(const l of o){const u=a.find(h=>h.measurementId===l),c=u&&e[u.appId];if(c)s.push(c);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),n("event",i,r||{})}catch(s){Io.error(s)}}function u4e(n,e,t,i){async function r(s,...o){try{if(s==="event"){const[a,l]=o;await l4e(n,e,t,a,l)}else if(s==="config"){const[a,l]=o;await a4e(n,e,t,i,a,l)}else if(s==="consent"){const[a,l]=o;n("consent",a,l)}else if(s==="get"){const[a,l,u]=o;n("get",a,l,u)}else if(s==="set"){const[a]=o;n("set",a)}else n(s,...o)}catch(a){Io.error(a)}}return r}function c4e(n,e,t,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=u4e(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}function h4e(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(PN)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4e=30,d4e=1e3;class p4e{constructor(e={},t=d4e){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const _W=new p4e;function A4e(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function m4e(n){var e;const{appId:t,apiKey:i}=n,r={method:"GET",headers:A4e(i)},s=t4e.replace("{app-id}",t),o=await fetch(s,r);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw oa.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function g4e(n,e=_W,t){const{appId:i,apiKey:r,measurementId:s}=n.options;if(!i)throw oa.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw oa.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new _4e;return setTimeout(async()=>{a.abort()},e4e),xW({appId:i,apiKey:r,measurementId:s},o,a,e)}async function xW(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=_W){var s;const{appId:o,measurementId:a}=n;try{await v4e(i,e)}catch(l){if(a)return Io.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await m4e(n);return r.deleteThrottleMetadata(o),l}catch(l){const u=l;if(!y4e(u)){if(r.deleteThrottleMetadata(o),a)return Io.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:a};throw l}const c=Number((s=u==null?void 0:u.customData)===null||s===void 0?void 0:s.httpStatus)===503?QB(t,r.intervalMillis,f4e):QB(t,r.intervalMillis),h={throttleEndTimeMillis:Date.now()+c,backoffCount:t+1};return r.setThrottleMetadata(o,h),Io.debug(`Calling attemptFetch again in ${c} millis`),xW(n,h,i,r)}}function v4e(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(oa.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function y4e(n){if(!(n instanceof hu)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class _4e{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function x4e(n,e,t,i,r){if(r&&r.global){n("event",t,i);return}else{const s=await e,o=Object.assign(Object.assign({},i),{send_to:s});n("event",t,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b4e(){if(jj())try{await Wj()}catch(n){return Io.warn(oa.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return Io.warn(oa.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function S4e(n,e,t,i,r,s,o){var a;const l=g4e(n);l.then(v=>{t[v.measurementId]=v.appId,n.options.measurementId&&v.measurementId!==n.options.measurementId&&Io.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>Io.error(v)),e.push(l);const u=b4e().then(v=>{if(v)return i.getId()}),[c,h]=await Promise.all([l,u]);h4e(s)||s4e(s,c.measurementId),r("js",new Date);const A=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return A[JMe]="firebase",A.update=!0,h!=null&&(A[ZMe]=h),r("config",c.measurementId,A),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4e{constructor(e){this.app=e}_delete(){return delete Yg[this.app.options.appId],Promise.resolve()}}let Yg={},aO=[];const lO={};let nC="dataLayer",E4e="gtag",uO,bW,cO=!1;function T4e(){const n=[];if(qj()&&n.push("This is a browser extension environment."),qTe()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=oa.create("invalid-analytics-context",{errorInfo:e});Io.warn(t.message)}}function C4e(n,e,t){T4e();const i=n.options.appId;if(!i)throw oa.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Io.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw oa.create("no-api-key");if(Yg[i]!=null)throw oa.create("already-exists",{id:i});if(!cO){o4e(nC);const{wrappedGtag:s,gtagCore:o}=c4e(Yg,aO,lO,nC,E4e);bW=s,uO=o,cO=!0}return Yg[i]=S4e(n,aO,lO,e,uO,nC,t),new w4e(n)}function M4e(n=EN()){n=ds(n);const e=ap(n,Qb);return e.isInitialized()?e.getImmediate():R4e(n)}function R4e(n,e={}){const t=ap(n,Qb);if(t.isInitialized()){const r=t.getImmediate();if(ev(e,t.getOptions()))return r;throw oa.create("already-initialized")}return t.initialize({options:e})}function P4e(n,e,t,i){n=ds(n),x4e(bW,Yg[n.app.options.appId],e,t,i).catch(r=>Io.error(r))}const hO="@firebase/analytics",fO="0.10.11";function N4e(){au(new Pl(Qb,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return C4e(i,r,t)},"PUBLIC")),au(new Pl("analytics-internal",n,"PRIVATE")),Fa(hO,fO),Fa(hO,fO,"esm2017");function n(e){try{const t=e.getProvider(Qb).getImmediate();return{logEvent:(i,r,s)=>P4e(t,i,r,s)}}catch(t){throw oa.create("interop-component-reg-failed",{reason:t})}}}N4e();var dO={};const pO="@firebase/database",AO="1.0.12";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SW="";function I4e(n){SW=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4e{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Fr(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:J1(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4e{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Nc(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wW=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new D4e(e)}}catch{}return new k4e},vd=wW("localStorage"),L4e=wW("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0=new Tw("@firebase/database"),F4e=function(){let n=1;return function(){return n++}}(),EW=function(n){const e=JTe(n),t=new YTe;t.update(e);const i=t.digest();return _N.encodeByteArray(i)},Vv=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Vv.apply(null,i):typeof i=="object"?e+=Fr(i):e+=i,e+=" "}return e};let Qg=null,mO=!0;const B4e=function(n,e){yt(!e,"Can't turn on custom loggers persistently."),t0.logLevel=Ei.VERBOSE,Qg=t0.log.bind(t0)},Rs=function(...n){if(mO===!0&&(mO=!1,Qg===null&&L4e.get("logging_enabled")===!0&&B4e()),Qg){const e=Vv.apply(null,n);Qg(e)}},Gv=function(n){return function(...e){Rs(n,...e)}},h5=function(...n){const e="FIREBASE INTERNAL ERROR: "+Vv(...n);t0.error(e)},_c=function(...n){const e=`FIREBASE FATAL ERROR: ${Vv(...n)}`;throw t0.error(e),new Error(e)},Do=function(...n){const e="FIREBASE WARNING: "+Vv(...n);t0.warn(e)},O4e=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Do("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},TW=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},U4e=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},O0="[MIN_NAME]",$d="[MAX_NAME]",am=function(n,e){if(n===e)return 0;if(n===O0||e===$d)return-1;if(e===O0||n===$d)return 1;{const t=gO(n),i=gO(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},z4e=function(n,e){return n===e?0:n<e?-1:1},sg=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Fr(e))},NN=function(n){if(typeof n!="object"||n===null)return Fr(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=Fr(e[i]),t+=":",t+=NN(n[e[i]]);return t+="}",t},CW=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let r=0;r<t;r+=e)r+e>t?i.push(n.substring(r,t)):i.push(n.substring(r,r+e));return i};function Oo(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const MW=function(n){yt(!TW(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let r,s,o,a,l;n===0?(s=0,o=0,r=1/n===-1/0?1:0):(r=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),s=a+i,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-i-t))));const u=[];for(l=t;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(r?1:0),u.reverse();const c=u.join("");let h="";for(l=0;l<64;l+=8){let A=parseInt(c.substr(l,8),2).toString(16);A.length===1&&(A="0"+A),h=h+A}return h.toLowerCase()},V4e=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},G4e=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function q4e(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const H4e=new RegExp("^-?(0*)\\d{1,10}$"),$4e=-2147483648,j4e=2147483647,gO=function(n){if(H4e.test(n)){const e=Number(n);if(e>=$4e&&e<=j4e)return e}return null},lm=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Do("Exception was thrown by user callback.",t),e},Math.floor(0))}},W4e=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Kg=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4e{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,Ra(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Do(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4e{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(Rs("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Do(e)}}class nx{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}nx.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IN="5",RW="v",PW="s",NW="r",IW="f",DW=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,kW="ls",LW="p",f5="ac",FW="websocket",BW="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OW{constructor(e,t,i,r,s=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=r,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=vd.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&vd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Q4e(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function UW(n,e,t){yt(typeof e=="string","typeof type must == string"),yt(typeof t=="object","typeof params must == object");let i;if(e===FW)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===BW)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Q4e(n)&&(t.ns=n.namespace);const r=[];return Oo(t,(s,o)=>{r.push(s+"="+o)}),i+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4e{constructor(){this.counters_={}}incrementCounter(e,t=1){Nc(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return DTe(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC={},rC={};function DN(n){const e=n.toString();return iC[e]||(iC[e]=new K4e),iC[e]}function Z4e(n,e){const t=n.toString();return rC[t]||(rC[t]=e()),rC[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4e{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<i.length;++r)i[r]&&lm(()=>{this.onMessage_(i[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vO="start",eRe="close",tRe="pLPCommand",nRe="pRTLPCB",zW="id",VW="pw",GW="ser",iRe="cb",rRe="seg",sRe="ts",oRe="d",aRe="dframe",qW=1870,HW=30,lRe=qW-HW,uRe=25e3,cRe=3e4;class kA{constructor(e,t,i,r,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Gv(e),this.stats_=DN(t),this.urlFn=l=>(this.appCheckToken&&(l[f5]=this.appCheckToken),UW(t,BW,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new J4e(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(cRe)),U4e(()=>{if(this.isClosed_)return;this.scriptTagHolder=new kN((...s)=>{const[o,a,l,u,c]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===vO)this.id=a,this.password=l;else if(o===eRe)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[vO]="t",i[GW]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[iRe]=this.scriptTagHolder.uniqueCallbackIdentifier),i[RW]=IN,this.transportSessionId&&(i[PW]=this.transportSessionId),this.lastSessionId&&(i[kW]=this.lastSessionId),this.applicationId&&(i[LW]=this.applicationId),this.appCheckToken&&(i[f5]=this.appCheckToken),typeof location<"u"&&location.hostname&&DW.test(location.hostname)&&(i[NW]=IW);const r=this.urlFn(i);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){kA.forceAllow_=!0}static forceDisallow(){kA.forceDisallow_=!0}static isAvailable(){return kA.forceAllow_?!0:!kA.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!V4e()&&!G4e()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Fr(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Oj(t),r=CW(i,lRe);for(let s=0;s<r.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[aRe]="t",i[zW]=e,i[VW]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Fr(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class kN{constructor(e,t,i,r){this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=F4e(),window[tRe+this.uniqueCallbackIdentifier]=e,window[nRe+this.uniqueCallbackIdentifier]=t,this.myIFrame=kN.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Rs("frame writing exception"),a.stack&&Rs(a.stack),Rs(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Rs("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[zW]=this.myID,e[VW]=this.myPW,e[GW]=this.currentSerial;let t=this.urlFn(e),i="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+HW+i.length<=qW;){const o=this.pendingSegs.shift();i=i+"&"+rRe+r+"="+o.seg+"&"+sRe+r+"="+o.ts+"&"+oRe+r+"="+o.d,r++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(i,Math.floor(uRe)),s=()=>{clearTimeout(r),i()};this.addTag(e,s)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const r=i.readyState;(!r||r==="loaded"||r==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{Rs("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hRe=16384,fRe=45e3;let Kb=null;typeof MozWebSocket<"u"?Kb=MozWebSocket:typeof WebSocket<"u"&&(Kb=WebSocket);class fl{constructor(e,t,i,r,s,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Gv(this.connId),this.stats_=DN(t),this.connURL=fl.connectionURL_(t,o,a,r,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,r,s){const o={};return o[RW]=IN,typeof location<"u"&&location.hostname&&DW.test(location.hostname)&&(o[NW]=IW),t&&(o[PW]=t),i&&(o[kW]=i),r&&(o[f5]=r),s&&(o[LW]=s),UW(e,FW,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,vd.set("previous_websocket_failure",!0);try{let i;$j(),this.mySock=new Kb(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const r=i.message||i.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){fl.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Kb!==null&&!fl.forceDisallow_}static previouslyFailed(){return vd.isInMemoryStorage||vd.get("previous_websocket_failure")===!0}markConnectionHealthy(){vd.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=J1(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(yt(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=Fr(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=CW(t,hRe);i.length>1&&this.sendString_(String(i.length));for(let r=0;r<i.length;r++)this.sendString_(i[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(fRe))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}fl.responsesRequiredToBeHealthy=2;fl.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{static get ALL_TRANSPORTS(){return[kA,fl]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=fl&&fl.isAvailable();let i=t&&!fl.previouslyFailed();if(e.webSocketOnly&&(t||Do("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[fl];else{const r=this.transports_=[];for(const s of nv.ALL_TRANSPORTS)s&&s.isAvailable()&&r.push(s);nv.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}nv.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dRe=6e4,pRe=5e3,ARe=10*1024,mRe=100*1024,sC="t",yO="d",gRe="s",_O="r",vRe="e",xO="o",bO="a",SO="n",wO="p",yRe="h";class _Re{constructor(e,t,i,r,s,o,a,l,u,c){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=r,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Gv("c:"+this.id+":"),this.transportManager_=new nv(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=Kg(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>mRe?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>ARe?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(sC in e){const t=e[sC];t===bO?this.upgradeIfSecondaryHealthy_():t===_O?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===xO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=sg("t",e),i=sg("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:wO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:bO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:SO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=sg("t",e),i=sg("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=sg(sC,e);if(yO in e){const i=e[yO];if(t===yRe){const r=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(r.h=this.repoInfo_.host),this.onHandshake_(r)}else if(t===SO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===gRe?this.onConnectionShutdown_(i):t===_O?this.onReset_(i):t===vRe?h5("Server Error: "+i):t===xO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):h5("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),IN!==i&&Do("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Kg(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(dRe))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Kg(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(pRe))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:wO,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(vd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{put(e,t,i,r){}merge(e,t,i,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jW{constructor(e){this.allowedEvents_=e,this.listeners_={},yt(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let r=0;r<i.length;r++)i[r].callback.apply(i[r].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const r=this.getInitialEvent(e);r&&t.apply(i,r)}off(e,t,i){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let s=0;s<r.length;s++)if(r[s].callback===t&&(!i||i===r[s].context)){r.splice(s,1);return}}validateEventType_(e){yt(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb extends jW{static getInstance(){return new Zb}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!bN()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return yt(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO=32,TO=768;class Pi{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[i]=this.pieces_[r],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function ai(){return new Pi("")}function Bn(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function rf(n){return n.pieces_.length-n.pieceNum_}function Ii(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Pi(n.pieces_,e)}function WW(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function xRe(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function XW(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function YW(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Pi(e,0)}function Br(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Pi)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let r=0;r<i.length;r++)i[r].length>0&&t.push(i[r])}return new Pi(t,0)}function zn(n){return n.pieceNum_>=n.pieces_.length}function Js(n,e){const t=Bn(n),i=Bn(e);if(t===null)return e;if(t===i)return Js(Ii(n),Ii(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function LN(n,e){if(rf(n)!==rf(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function gl(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(rf(n)>rf(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class bRe{constructor(e,t){this.errorPrefix_=t,this.parts_=XW(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Ew(this.parts_[i]);QW(this)}}function SRe(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ew(e),QW(n)}function wRe(n){const e=n.parts_.pop();n.byteLength_-=Ew(e),n.parts_.length>0&&(n.byteLength_-=1)}function QW(n){if(n.byteLength_>TO)throw new Error(n.errorPrefix_+"has a key path longer than "+TO+" bytes ("+n.byteLength_+").");if(n.parts_.length>EO)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+EO+") or object contains a cycle "+Kf(n))}function Kf(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FN extends jW{static getInstance(){return new FN}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(e){return yt(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=1e3,ERe=60*5*1e3,CO=30*1e3,TRe=1.3,CRe=3e4,MRe="server_kill",MO=3;class sc extends $W{constructor(e,t,i,r,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=r,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=sc.nextPersistentConnectionId_++,this.log_=Gv("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=og,this.maxReconnectDelay_=ERe,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!$j())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");FN.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Zb.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const r=++this.requestNumber_,s={r,a:e,b:t};this.log_(Fr(s)),yt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[r]=i)}get(e){this.initConnection_();const t=new ww,r={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),t.promise}listen(e,t,i,r){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),yt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),yt(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:t,query:e,tag:i};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+i+" for "+r);const s={p:i},o="q";e.tag&&(s.q=t._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,u=a.s;sc.warnOnListenWarnings_(l,t),(this.listens.get(i)&&this.listens.get(i).get(r))===e&&(this.log_("listen response",a),u!=="ok"&&this.removeListen_(i,r),e.onComplete&&e.onComplete(u,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Nc(e,"w")){const i=B0(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',s=t._path.toString();Do(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||XTe(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=CO)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=WTe(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,r=>{const s=r.s,o=r.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+r),yt(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,r)&&this.connected_&&this.sendUnlisten_(i,r,e._queryObject,t)}sendUnlisten_(e,t,i,r){this.log_("Unlisten on "+e+" for "+t);const s={p:e},o="n";r&&(s.q=i,s.t=r),this.sendRequest(o,s)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,r){const s={p:t,d:i};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,t,i,r){this.putInternal("p",e,t,i,r)}merge(e,t,i,r){this.putInternal("m",e,t,i,r)}putInternal(e,t,i,r,s){this.initConnection_();const o={p:t,d:i};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,s=>{this.log_(t+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(s.s,s.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Fr(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):h5("Unrecognized action received from server: "+Fr(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){yt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=og,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=og,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>CRe&&(this.reconnectDelay_=og),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*TRe)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+sc.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},u=function(h){yt(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:u};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,A]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?Rs("getToken() completed but was canceled"):(Rs("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=A&&A.token,a=new _Re(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,v=>{Do(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(MRe)},s))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&Do(h),l())}}}interrupt(e){Rs("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Rs("Resuming connection for reason: "+e),delete this.interruptReasons_[e],r5(this.interruptReasons_)&&(this.reconnectDelay_=og,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(s=>NN(s)).join("$"):i="default";const r=this.removeListen_(e,i);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const i=new Pi(e).toString();let r;if(this.listens.has(i)){const s=this.listens.get(i);r=s.get(t),s.delete(t),s.size===0&&this.listens.delete(i)}else r=void 0;return r}onAuthRevoked_(e,t){Rs("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=MO&&(this.reconnectDelay_=CO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Rs("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=MO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+SW.replace(/\./g,"-")]=1,bN()?e["framework.cordova"]=1:Hj()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Zb.getInstance().currentlyOnline();return r5(this.interruptReasons_)&&e}}sc.nextPersistentConnectionId_=0;sc.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new On(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new On(O0,e),r=new On(O0,t);return this.compare(i,r)!==0}minPost(){return On.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c2;class KW extends Rw{static get __EMPTY_NODE(){return c2}static set __EMPTY_NODE(e){c2=e}compare(e,t){return am(e.name,t.name)}isDefinedOn(e){throw rm("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return On.MIN}maxPost(){return new On($d,c2)}makePost(e,t){return yt(typeof e=="string","KeyIndex indexValue must always be a string."),new On(e,c2)}toString(){return".key"}}const n0=new KW;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,t,i,r,s=null){this.isReverse_=r,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?i(e.key,t):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Wr{constructor(e,t,i,r,s){this.key=e,this.value=t,this.color=i??Wr.RED,this.left=r??Mo.EMPTY_NODE,this.right=s??Mo.EMPTY_NODE}copy(e,t,i,r,s){return new Wr(e??this.key,t??this.value,i??this.color,r??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const s=i(e,r.key);return s<0?r=r.copy(null,null,null,r.left.insert(e,t,i),null):s===0?r=r.copy(null,t,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Mo.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,r;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Mo.EMPTY_NODE;r=i.right.min_(),i=i.copy(r.key,r.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Wr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Wr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Wr.RED=!0;Wr.BLACK=!1;class RRe{copy(e,t,i,r,s){return this}insert(e,t,i){return new Wr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Mo{constructor(e,t=Mo.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Mo(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Wr.BLACK,null,null))}remove(e){return new Mo(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Wr.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,r=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return r?r.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(r=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new h2(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new h2(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new h2(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new h2(this.root_,null,this.comparator_,!0,e)}}Mo.EMPTY_NODE=new RRe;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PRe(n,e){return am(n.name,e.name)}function BN(n,e){return am(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let d5;function NRe(n){d5=n}const ZW=function(n){return typeof n=="number"?"number:"+MW(n):"string:"+n},JW=function(n){if(n.isLeafNode()){const e=n.val();yt(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Nc(e,".sv"),"Priority must be a string or number.")}else yt(n===d5||n.isEmpty(),"priority of unexpected type.");yt(n===d5||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RO;class $r{static set __childrenNodeConstructor(e){RO=e}static get __childrenNodeConstructor(){return RO}constructor(e,t=$r.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,yt(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),JW(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new $r(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:$r.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return zn(e)?this:Bn(e)===".priority"?this.priorityNode_:$r.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:$r.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Bn(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(yt(i!==".priority"||rf(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,$r.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ii(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ZW(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=MW(this.value_):e+=this.value_,this.lazyHash_=EW(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===$r.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof $r.__childrenNodeConstructor?-1:(yt(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,r=$r.VALUE_TYPE_ORDER.indexOf(t),s=$r.VALUE_TYPE_ORDER.indexOf(i);return yt(r>=0,"Unknown leaf type: "+t),yt(s>=0,"Unknown leaf type: "+i),r===s?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}$r.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eX,tX;function IRe(n){eX=n}function DRe(n){tX=n}class kRe extends Rw{compare(e,t){const i=e.node.getPriority(),r=t.node.getPriority(),s=i.compareTo(r);return s===0?am(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return On.MIN}maxPost(){return new On($d,new $r("[PRIORITY-POST]",tX))}makePost(e,t){const i=eX(e);return new On(t,new $r("[PRIORITY-POST]",i))}toString(){return".priority"}}const Ar=new kRe;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LRe=Math.log(2);class FRe{constructor(e){const t=s=>parseInt(Math.log(s)/LRe,10),i=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const r=i(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Jb=function(n,e,t,i){n.sort(e);const r=function(l,u){const c=u-l;let h,A;if(c===0)return null;if(c===1)return h=n[l],A=t?t(h):h,new Wr(A,h.node,Wr.BLACK,null,null);{const v=parseInt(c/2,10)+l,_=r(l,v),S=r(v+1,u);return h=n[v],A=t?t(h):h,new Wr(A,h.node,Wr.BLACK,_,S)}},s=function(l){let u=null,c=null,h=n.length;const A=function(_,S){const w=h-_,x=h;h-=_;const M=r(w+1,x),R=n[w],N=t?t(R):R;v(new Wr(N,R.node,S,null,M))},v=function(_){u?(u.left=_,u=_):(c=_,u=_)};for(let _=0;_<l.count;++_){const S=l.nextBitIsOne(),w=Math.pow(2,l.count-(_+1));S?A(w,Wr.BLACK):(A(w,Wr.BLACK),A(w,Wr.RED))}return c},o=new FRe(n.length),a=s(o);return new Mo(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oC;const tA={};class qu{static get Default(){return yt(tA&&Ar,"ChildrenNode.ts has not been loaded"),oC=oC||new qu({".priority":tA},{".priority":Ar}),oC}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=B0(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Mo?t:null}hasIndex(e){return Nc(this.indexSet_,e.toString())}addIndex(e,t){yt(e!==n0,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let r=!1;const s=t.getIterator(On.Wrap);let o=s.getNext();for(;o;)r=r||e.isDefinedOn(o.node),i.push(o),o=s.getNext();let a;r?a=Jb(i,e.getCompare()):a=tA;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const c=Object.assign({},this.indexes_);return c[l]=a,new qu(c,u)}addToIndexes(e,t){const i=Wb(this.indexes_,(r,s)=>{const o=B0(this.indexSet_,s);if(yt(o,"Missing index implementation for "+s),r===tA)if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(On.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),Jb(a,o.getCompare())}else return tA;else{const a=t.get(e.name);let l=r;return a&&(l=l.remove(new On(e.name,a))),l.insert(e,e.node)}});return new qu(i,this.indexSet_)}removeFromIndexes(e,t){const i=Wb(this.indexes_,r=>{if(r===tA)return r;{const s=t.get(e.name);return s?r.remove(new On(e.name,s)):r}});return new qu(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ag;class sn{static get EMPTY_NODE(){return ag||(ag=new sn(new Mo(BN),null,qu.Default))}constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&JW(this.priorityNode_),this.children_.isEmpty()&&yt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ag}updatePriority(e){return this.children_.isEmpty()?this:new sn(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?ag:t}}getChild(e){const t=Bn(e);return t===null?this:this.getImmediateChild(t).getChild(Ii(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(yt(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new On(e,t);let r,s;t.isEmpty()?(r=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,t),s=this.indexMap_.addToIndexes(i,this.children_));const o=r.isEmpty()?ag:this.priorityNode_;return new sn(r,o,s)}}updateChild(e,t){const i=Bn(e);if(i===null)return t;{yt(Bn(e)!==".priority"||rf(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(i).updateChild(Ii(e),t);return this.updateImmediateChild(i,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,r=0,s=!0;if(this.forEachChild(Ar,(o,a)=>{t[o]=a.val(e),i++,s&&sn.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!e&&s&&r<2*i){const o=[];for(const a in t)o[a]=t[a];return o}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ZW(this.getPriority().val())+":"),this.forEachChild(Ar,(t,i)=>{const r=i.hash();r!==""&&(e+=":"+t+":"+r)}),this.lazyHash_=e===""?"":EW(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const r=this.resolveIndex_(i);if(r){const s=r.getPredecessorKey(new On(e,t));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new On(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new On(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(r=>t(r.name,r.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,On.Wrap);let s=r.peek();for(;s!=null&&t.compare(s,e)<0;)r.getNext(),s=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,On.Wrap);let s=r.peek();for(;s!=null&&t.compare(s,e)>0;)r.getNext(),s=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===qv?-1:0}withIndex(e){if(e===n0||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new sn(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===n0||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(Ar),r=t.getIterator(Ar);let s=i.getNext(),o=r.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=i.getNext(),o=r.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===n0?null:this.indexMap_.get(e.toString())}}sn.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class BRe extends sn{constructor(){super(new Mo(BN),sn.EMPTY_NODE,qu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return sn.EMPTY_NODE}isEmpty(){return!1}}const qv=new BRe;Object.defineProperties(On,{MIN:{value:new On(O0,sn.EMPTY_NODE)},MAX:{value:new On($d,qv)}});KW.__EMPTY_NODE=sn.EMPTY_NODE;$r.__childrenNodeConstructor=sn;NRe(qv);DRe(qv);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ORe=!0;function Xr(n,e=null){if(n===null)return sn.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),yt(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new $r(t,Xr(e))}if(!(n instanceof Array)&&ORe){const t=[];let i=!1;if(Oo(n,(o,a)=>{if(o.substring(0,1)!=="."){const l=Xr(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new On(o,l)))}}),t.length===0)return sn.EMPTY_NODE;const s=Jb(t,PRe,o=>o.name,BN);if(i){const o=Jb(t,Ar.getCompare());return new sn(s,Xr(e),new qu({".priority":o},{".priority":Ar}))}else return new sn(s,Xr(e),qu.Default)}else{let t=sn.EMPTY_NODE;return Oo(n,(i,r)=>{if(Nc(n,i)&&i.substring(0,1)!=="."){const s=Xr(r);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(i,s))}}),t.updatePriority(Xr(e))}}IRe(Xr);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class URe extends Rw{constructor(e){super(),this.indexPath_=e,yt(!zn(e)&&Bn(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),r=this.extractChild(t.node),s=i.compareTo(r);return s===0?am(e.name,t.name):s}makePost(e,t){const i=Xr(e),r=sn.EMPTY_NODE.updateChild(this.indexPath_,i);return new On(t,r)}maxPost(){const e=sn.EMPTY_NODE.updateChild(this.indexPath_,qv);return new On($d,e)}toString(){return XW(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zRe extends Rw{compare(e,t){const i=e.node.compareTo(t.node);return i===0?am(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return On.MIN}maxPost(){return On.MAX}makePost(e,t){const i=Xr(e);return new On(t,i)}toString(){return".value"}}const VRe=new zRe;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nX(n){return{type:"value",snapshotNode:n}}function U0(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function iv(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function rv(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function GRe(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e){this.index_=e}updateChild(e,t,i,r,s,o){yt(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(r).equals(i.getChild(r))&&a.isEmpty()===i.isEmpty()||(o!=null&&(i.isEmpty()?e.hasChild(t)?o.trackChildChange(iv(t,a)):yt(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(U0(t,i)):o.trackChildChange(rv(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(Ar,(r,s)=>{t.hasChild(r)||i.trackChildChange(iv(r,s))}),t.isLeafNode()||t.forEachChild(Ar,(r,s)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(s)||i.trackChildChange(rv(r,s,o))}else i.trackChildChange(U0(r,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?sn.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this.indexedFilter_=new ON(e.getIndex()),this.index_=e.getIndex(),this.startPost_=sv.getStartPost_(e),this.endPost_=sv.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,r,s,o){return this.matches(new On(t,i))||(i=sn.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,r,s,o)}updateFullNode(e,t,i){t.isLeafNode()&&(t=sn.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(sn.EMPTY_NODE);const s=this;return t.forEachChild(Ar,(o,a)=>{s.matches(new On(o,a))||(r=r.updateImmediateChild(o,sn.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qRe{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new sv(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,r,s,o){return this.rangedFilter_.matches(new On(t,i))||(i=sn.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,r,s,o):this.fullLimitUpdateChild_(e,t,i,s,o)}updateFullNode(e,t,i){let r;if(t.isLeafNode()||t.isEmpty())r=sn.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){r=sn.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))r=r.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{r=t.withIndex(this.index_),r=r.updatePriority(sn.EMPTY_NODE);let s;this.reverse_?s=r.getReverseIterator(this.index_):s=r.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:r=r.updateImmediateChild(a.name,sn.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,r,s){let o;if(this.reverse_){const h=this.index_.getCompare();o=(A,v)=>h(v,A)}else o=this.index_.getCompare();const a=e;yt(a.numChildren()===this.limit_,"");const l=new On(t,i),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),c=this.rangedFilter_.matches(l);if(a.hasChild(t)){const h=a.getImmediateChild(t);let A=r.getChildAfterChild(this.index_,u,this.reverse_);for(;A!=null&&(A.name===t||a.hasChild(A.name));)A=r.getChildAfterChild(this.index_,A,this.reverse_);const v=A==null?1:o(A,l);if(c&&!i.isEmpty()&&v>=0)return s!=null&&s.trackChildChange(rv(t,i,h)),a.updateImmediateChild(t,i);{s!=null&&s.trackChildChange(iv(t,h));const S=a.updateImmediateChild(t,sn.EMPTY_NODE);return A!=null&&this.rangedFilter_.matches(A)?(s!=null&&s.trackChildChange(U0(A.name,A.node)),S.updateImmediateChild(A.name,A.node)):S}}else return i.isEmpty()?e:c&&o(u,l)>=0?(s!=null&&(s.trackChildChange(iv(u.name,u.node)),s.trackChildChange(U0(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(u.name,sn.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ar}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return yt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return yt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:O0}hasEnd(){return this.endSet_}getIndexEndValue(){return yt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return yt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$d}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return yt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ar}copy(){const e=new UN;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function HRe(n){return n.loadsAllData()?new ON(n.getIndex()):n.hasLimit()?new qRe(n):new sv(n)}function PO(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Ar?t="$priority":n.index_===VRe?t="$value":n.index_===n0?t="$key":(yt(n.index_ instanceof URe,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Fr(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=Fr(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+Fr(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=Fr(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+Fr(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function NO(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ar&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS extends $W{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(yt(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,i,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=r,this.log_=Gv("p:rest:"),this.listens_={}}listen(e,t,i,r){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=eS.getListenId_(e,i),a={};this.listens_[o]=a;const l=PO(e._queryParams);this.restRequest_(s+".json",l,(u,c)=>{let h=c;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(s,h,!1,i),B0(this.listens_,o)===a){let A;u?u===401?A="permission_denied":A="rest_error:"+u:A="ok",r(A,null)}})}unlisten(e,t){const i=eS.getListenId_(e,t);delete this.listens_[i]}get(e){const t=PO(e._queryParams),i=e._path.toString(),r=new ww;return this.restRequest_(i+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(i,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,s])=>{r&&r.accessToken&&(t.auth=r.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+sm(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=J1(a.responseText)}catch{Do("Failed to parse JSON response for "+o+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&Do("Got unsuccessful REST response for "+o+" Status: "+a.status),i(a.status);i=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $Re{constructor(){this.rootNode_=sn.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(){return{value:null,children:new Map}}function iX(n,e,t){if(zn(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Bn(e);n.children.has(i)||n.children.set(i,tS());const r=n.children.get(i);e=Ii(e),iX(r,e,t)}}function p5(n,e,t){n.value!==null?t(e,n.value):jRe(n,(i,r)=>{const s=new Pi(e.toString()+"/"+i);p5(r,s,t)})}function jRe(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WRe{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Oo(this.last_,(i,r)=>{t[i]=t[i]-r}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=10*1e3,XRe=30*1e3,YRe=5*60*1e3;class QRe{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new WRe(e);const i=IO+(XRe-IO)*Math.random();Kg(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Oo(e,(r,s)=>{s>0&&Nc(this.statsToReport_,r)&&(t[r]=s,i=!0)}),i&&this.server_.reportStats(t),Kg(this.reportStats_.bind(this),Math.floor(Math.random()*2*YRe))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vl;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(vl||(vl={}));function rX(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function zN(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function VN(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=vl.ACK_USER_WRITE,this.source=rX()}operationForChild(e){if(zn(this.path)){if(this.affectedTree.value!=null)return yt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Pi(e));return new nS(ai(),t,this.revert)}}else return yt(Bn(this.path)===e,"operationForChild called for unrelated child."),new nS(Ii(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,t){this.source=e,this.path=t,this.type=vl.LISTEN_COMPLETE}operationForChild(e){return zn(this.path)?new ov(this.source,ai()):new ov(this.source,Ii(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jd{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=vl.OVERWRITE}operationForChild(e){return zn(this.path)?new jd(this.source,ai(),this.snap.getImmediateChild(e)):new jd(this.source,Ii(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=vl.MERGE}operationForChild(e){if(zn(this.path)){const t=this.children.subtree(new Pi(e));return t.isEmpty()?null:t.value?new jd(this.source,ai(),t.value):new av(this.source,ai(),t)}else return yt(Bn(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new av(this.source,Ii(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(zn(e))return this.isFullyInitialized()&&!this.filtered_;const t=Bn(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KRe{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ZRe(n,e,t,i){const r=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(GRe(o.childName,o.snapshotNode))}),lg(n,r,"child_removed",e,i,t),lg(n,r,"child_added",e,i,t),lg(n,r,"child_moved",s,i,t),lg(n,r,"child_changed",e,i,t),lg(n,r,"value",e,i,t),r}function lg(n,e,t,i,r,s){const o=i.filter(a=>a.type===t);o.sort((a,l)=>e5e(n,a,l)),o.forEach(a=>{const l=JRe(n,a,s);r.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,n.query_))})})}function JRe(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function e5e(n,e,t){if(e.childName==null||t.childName==null)throw rm("Should only compare child_ events.");const i=new On(e.childName,e.snapshotNode),r=new On(t.childName,t.snapshotNode);return n.index_.compare(i,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(n,e){return{eventCache:n,serverCache:e}}function Zg(n,e,t,i){return Pw(new sf(e,t,i),n.serverCache)}function sX(n,e,t,i){return Pw(n.eventCache,new sf(e,t,i))}function iS(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Wd(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aC;const t5e=()=>(aC||(aC=new Mo(z4e)),aC);class Fi{static fromObject(e){let t=new Fi(null);return Oo(e,(i,r)=>{t=t.set(new Pi(i),r)}),t}constructor(e,t=t5e()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:ai(),value:this.value};if(zn(e))return null;{const i=Bn(e),r=this.children.get(i);if(r!==null){const s=r.findRootMostMatchingPathAndValue(Ii(e),t);return s!=null?{path:Br(new Pi(i),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(zn(e))return this;{const t=Bn(e),i=this.children.get(t);return i!==null?i.subtree(Ii(e)):new Fi(null)}}set(e,t){if(zn(e))return new Fi(t,this.children);{const i=Bn(e),s=(this.children.get(i)||new Fi(null)).set(Ii(e),t),o=this.children.insert(i,s);return new Fi(this.value,o)}}remove(e){if(zn(e))return this.children.isEmpty()?new Fi(null):new Fi(null,this.children);{const t=Bn(e),i=this.children.get(t);if(i){const r=i.remove(Ii(e));let s;return r.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,r),this.value===null&&s.isEmpty()?new Fi(null):new Fi(this.value,s)}else return this}}get(e){if(zn(e))return this.value;{const t=Bn(e),i=this.children.get(t);return i?i.get(Ii(e)):null}}setTree(e,t){if(zn(e))return t;{const i=Bn(e),s=(this.children.get(i)||new Fi(null)).setTree(Ii(e),t);let o;return s.isEmpty()?o=this.children.remove(i):o=this.children.insert(i,s),new Fi(this.value,o)}}fold(e){return this.fold_(ai(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((r,s)=>{i[r]=s.fold_(Br(e,r),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,ai(),t)}findOnPath_(e,t,i){const r=this.value?i(t,this.value):!1;if(r)return r;if(zn(e))return null;{const s=Bn(e),o=this.children.get(s);return o?o.findOnPath_(Ii(e),Br(t,s),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ai(),t)}foreachOnPath_(e,t,i){if(zn(e))return this;{this.value&&i(t,this.value);const r=Bn(e),s=this.children.get(r);return s?s.foreachOnPath_(Ii(e),Br(t,r),i):new Fi(null)}}foreach(e){this.foreach_(ai(),e)}foreach_(e,t){this.children.inorderTraversal((i,r)=>{r.foreach_(Br(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bl{constructor(e){this.writeTree_=e}static empty(){return new bl(new Fi(null))}}function Jg(n,e,t){if(zn(e))return new bl(new Fi(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const r=i.path;let s=i.value;const o=Js(r,e);return s=s.updateChild(o,t),new bl(n.writeTree_.set(r,s))}else{const r=new Fi(t),s=n.writeTree_.setTree(e,r);return new bl(s)}}}function DO(n,e,t){let i=n;return Oo(t,(r,s)=>{i=Jg(i,Br(e,r),s)}),i}function kO(n,e){if(zn(e))return bl.empty();{const t=n.writeTree_.setTree(e,new Fi(null));return new bl(t)}}function A5(n,e){return lp(n,e)!=null}function lp(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(Js(t.path,e)):null}function LO(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ar,(i,r)=>{e.push(new On(i,r))}):n.writeTree_.children.inorderTraversal((i,r)=>{r.value!=null&&e.push(new On(i,r.value))}),e}function Hh(n,e){if(zn(e))return n;{const t=lp(n,e);return t!=null?new bl(new Fi(t)):new bl(n.writeTree_.subtree(e))}}function m5(n){return n.writeTree_.isEmpty()}function z0(n,e){return oX(ai(),n.writeTree_,e)}function oX(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((r,s)=>{r===".priority"?(yt(s.value!==null,"Priority writes must always be leaf nodes"),i=s.value):t=oX(Br(n,r),s,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(Br(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(n,e){return cX(e,n)}function n5e(n,e,t,i,r){yt(i>n.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:r}),r&&(n.visibleWrites=Jg(n.visibleWrites,e,t)),n.lastWriteId=i}function i5e(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function r5e(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);yt(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let r=i.visible,s=!1,o=n.allWrites.length-1;for(;r&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&s5e(a,i.path)?r=!1:gl(i.path,a.path)&&(s=!0)),o--}if(r){if(s)return o5e(n),!0;if(i.snap)n.visibleWrites=kO(n.visibleWrites,i.path);else{const a=i.children;Oo(a,l=>{n.visibleWrites=kO(n.visibleWrites,Br(i.path,l))})}return!0}else return!1}function s5e(n,e){if(n.snap)return gl(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&gl(Br(n.path,t),e))return!0;return!1}function o5e(n){n.visibleWrites=aX(n.allWrites,a5e,ai()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function a5e(n){return n.visible}function aX(n,e,t){let i=bl.empty();for(let r=0;r<n.length;++r){const s=n[r];if(e(s)){const o=s.path;let a;if(s.snap)gl(t,o)?(a=Js(t,o),i=Jg(i,a,s.snap)):gl(o,t)&&(a=Js(o,t),i=Jg(i,ai(),s.snap.getChild(a)));else if(s.children){if(gl(t,o))a=Js(t,o),i=DO(i,a,s.children);else if(gl(o,t))if(a=Js(o,t),zn(a))i=DO(i,ai(),s.children);else{const l=B0(s.children,Bn(a));if(l){const u=l.getChild(Ii(a));i=Jg(i,ai(),u)}}}else throw rm("WriteRecord should have .snap or .children")}}return i}function lX(n,e,t,i,r){if(!i&&!r){const s=lp(n.visibleWrites,e);if(s!=null)return s;{const o=Hh(n.visibleWrites,e);if(m5(o))return t;if(t==null&&!A5(o,ai()))return null;{const a=t||sn.EMPTY_NODE;return z0(o,a)}}}else{const s=Hh(n.visibleWrites,e);if(!r&&m5(s))return t;if(!r&&t==null&&!A5(s,ai()))return null;{const o=function(u){return(u.visible||r)&&(!i||!~i.indexOf(u.writeId))&&(gl(u.path,e)||gl(e,u.path))},a=aX(n.allWrites,o,e),l=t||sn.EMPTY_NODE;return z0(a,l)}}}function l5e(n,e,t){let i=sn.EMPTY_NODE;const r=lp(n.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Ar,(s,o)=>{i=i.updateImmediateChild(s,o)}),i;if(t){const s=Hh(n.visibleWrites,e);return t.forEachChild(Ar,(o,a)=>{const l=z0(Hh(s,new Pi(o)),a);i=i.updateImmediateChild(o,l)}),LO(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}else{const s=Hh(n.visibleWrites,e);return LO(s).forEach(o=>{i=i.updateImmediateChild(o.name,o.node)}),i}}function u5e(n,e,t,i,r){yt(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Br(e,t);if(A5(n.visibleWrites,s))return null;{const o=Hh(n.visibleWrites,s);return m5(o)?r.getChild(t):z0(o,r.getChild(t))}}function c5e(n,e,t,i){const r=Br(e,t),s=lp(n.visibleWrites,r);if(s!=null)return s;if(i.isCompleteForChild(t)){const o=Hh(n.visibleWrites,r);return z0(o,i.getNode().getImmediateChild(t))}else return null}function h5e(n,e){return lp(n.visibleWrites,e)}function f5e(n,e,t,i,r,s,o){let a;const l=Hh(n.visibleWrites,e),u=lp(l,ai());if(u!=null)a=u;else if(t!=null)a=z0(l,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const c=[],h=o.getCompare(),A=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let v=A.getNext();for(;v&&c.length<r;)h(v,i)!==0&&c.push(v),v=A.getNext();return c}else return[]}function d5e(){return{visibleWrites:bl.empty(),allWrites:[],lastWriteId:-1}}function rS(n,e,t,i){return lX(n.writeTree,n.treePath,e,t,i)}function GN(n,e){return l5e(n.writeTree,n.treePath,e)}function FO(n,e,t,i){return u5e(n.writeTree,n.treePath,e,t,i)}function sS(n,e){return h5e(n.writeTree,Br(n.treePath,e))}function p5e(n,e,t,i,r,s){return f5e(n.writeTree,n.treePath,e,t,i,r,s)}function qN(n,e,t){return c5e(n.writeTree,n.treePath,e,t)}function uX(n,e){return cX(Br(n.treePath,e),n.writeTree)}function cX(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5e{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;yt(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),yt(i!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(i);if(r){const s=r.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(i,rv(i,e.snapshotNode,r.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(i,iv(i,r.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(i,U0(i,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(i,rv(i,e.snapshotNode,r.oldSnap));else throw rm("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5e{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const hX=new m5e;class HN{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new sf(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return qN(this.writes_,e,i)}}getChildAfterChild(e,t,i){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Wd(this.viewCache_),s=p5e(this.writes_,r,t,1,i,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g5e(n){return{filter:n}}function v5e(n,e){yt(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),yt(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function y5e(n,e,t,i,r){const s=new A5e;let o,a;if(t.type===vl.OVERWRITE){const u=t;u.source.fromUser?o=g5(n,e,u.path,u.snap,i,r,s):(yt(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!zn(u.path),o=oS(n,e,u.path,u.snap,i,r,a,s))}else if(t.type===vl.MERGE){const u=t;u.source.fromUser?o=x5e(n,e,u.path,u.children,i,r,s):(yt(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=v5(n,e,u.path,u.children,i,r,a,s))}else if(t.type===vl.ACK_USER_WRITE){const u=t;u.revert?o=w5e(n,e,u.path,i,r,s):o=b5e(n,e,u.path,u.affectedTree,i,r,s)}else if(t.type===vl.LISTEN_COMPLETE)o=S5e(n,e,t.path,i,s);else throw rm("Unknown operation type: "+t.type);const l=s.getChanges();return _5e(e,o,l),{viewCache:o,changes:l}}function _5e(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=iS(n);(t.length>0||!n.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&t.push(nX(iS(e)))}}function fX(n,e,t,i,r,s){const o=e.eventCache;if(sS(i,t)!=null)return e;{let a,l;if(zn(t))if(yt(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Wd(e),c=u instanceof sn?u:sn.EMPTY_NODE,h=GN(i,c);a=n.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{const u=rS(i,Wd(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=Bn(t);if(u===".priority"){yt(rf(t)===1,"Can't have a priority with additional path components");const c=o.getNode();l=e.serverCache.getNode();const h=FO(i,t,c,l);h!=null?a=n.filter.updatePriority(c,h):a=o.getNode()}else{const c=Ii(t);let h;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const A=FO(i,t,o.getNode(),l);A!=null?h=o.getNode().getImmediateChild(u).updateChild(c,A):h=o.getNode().getImmediateChild(u)}else h=qN(i,u,e.serverCache);h!=null?a=n.filter.updateChild(o.getNode(),u,h,c,r,s):a=o.getNode()}}return Zg(e,a,o.isFullyInitialized()||zn(t),n.filter.filtersNodes())}}function oS(n,e,t,i,r,s,o,a){const l=e.serverCache;let u;const c=o?n.filter:n.filter.getIndexedFilter();if(zn(t))u=c.updateFullNode(l.getNode(),i,null);else if(c.filtersNodes()&&!l.isFiltered()){const v=l.getNode().updateChild(t,i);u=c.updateFullNode(l.getNode(),v,null)}else{const v=Bn(t);if(!l.isCompleteForPath(t)&&rf(t)>1)return e;const _=Ii(t),w=l.getNode().getImmediateChild(v).updateChild(_,i);v===".priority"?u=c.updatePriority(l.getNode(),w):u=c.updateChild(l.getNode(),v,w,_,hX,null)}const h=sX(e,u,l.isFullyInitialized()||zn(t),c.filtersNodes()),A=new HN(r,h,s);return fX(n,h,t,r,A,a)}function g5(n,e,t,i,r,s,o){const a=e.eventCache;let l,u;const c=new HN(r,e,s);if(zn(t))u=n.filter.updateFullNode(e.eventCache.getNode(),i,o),l=Zg(e,u,!0,n.filter.filtersNodes());else{const h=Bn(t);if(h===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),i),l=Zg(e,u,a.isFullyInitialized(),a.isFiltered());else{const A=Ii(t),v=a.getNode().getImmediateChild(h);let _;if(zn(A))_=i;else{const S=c.getCompleteChild(h);S!=null?WW(A)===".priority"&&S.getChild(YW(A)).isEmpty()?_=S:_=S.updateChild(A,i):_=sn.EMPTY_NODE}if(v.equals(_))l=e;else{const S=n.filter.updateChild(a.getNode(),h,_,A,c,o);l=Zg(e,S,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function BO(n,e){return n.eventCache.isCompleteForChild(e)}function x5e(n,e,t,i,r,s,o){let a=e;return i.foreach((l,u)=>{const c=Br(t,l);BO(e,Bn(c))&&(a=g5(n,a,c,u,r,s,o))}),i.foreach((l,u)=>{const c=Br(t,l);BO(e,Bn(c))||(a=g5(n,a,c,u,r,s,o))}),a}function OO(n,e,t){return t.foreach((i,r)=>{e=e.updateChild(i,r)}),e}function v5(n,e,t,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,u;zn(t)?u=i:u=new Fi(null).setTree(t,i);const c=e.serverCache.getNode();return u.children.inorderTraversal((h,A)=>{if(c.hasChild(h)){const v=e.serverCache.getNode().getImmediateChild(h),_=OO(n,v,A);l=oS(n,l,new Pi(h),_,r,s,o,a)}}),u.children.inorderTraversal((h,A)=>{const v=!e.serverCache.isCompleteForChild(h)&&A.value===null;if(!c.hasChild(h)&&!v){const _=e.serverCache.getNode().getImmediateChild(h),S=OO(n,_,A);l=oS(n,l,new Pi(h),S,r,s,o,a)}}),l}function b5e(n,e,t,i,r,s,o){if(sS(r,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(zn(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return oS(n,e,t,l.getNode().getChild(t),r,s,a,o);if(zn(t)){let u=new Fi(null);return l.getNode().forEachChild(n0,(c,h)=>{u=u.set(new Pi(c),h)}),v5(n,e,t,u,r,s,a,o)}else return e}else{let u=new Fi(null);return i.foreach((c,h)=>{const A=Br(t,c);l.isCompleteForPath(A)&&(u=u.set(c,l.getNode().getChild(A)))}),v5(n,e,t,u,r,s,a,o)}}function S5e(n,e,t,i,r){const s=e.serverCache,o=sX(e,s.getNode(),s.isFullyInitialized()||zn(t),s.isFiltered());return fX(n,o,t,i,hX,r)}function w5e(n,e,t,i,r,s){let o;if(sS(i,t)!=null)return e;{const a=new HN(i,e,r),l=e.eventCache.getNode();let u;if(zn(t)||Bn(t)===".priority"){let c;if(e.serverCache.isFullyInitialized())c=rS(i,Wd(e));else{const h=e.serverCache.getNode();yt(h instanceof sn,"serverChildren would be complete if leaf node"),c=GN(i,h)}c=c,u=n.filter.updateFullNode(l,c,s)}else{const c=Bn(t);let h=qN(i,c,e.serverCache);h==null&&e.serverCache.isCompleteForChild(c)&&(h=l.getImmediateChild(c)),h!=null?u=n.filter.updateChild(l,c,h,Ii(t),a,s):e.eventCache.getNode().hasChild(c)?u=n.filter.updateChild(l,c,sn.EMPTY_NODE,Ii(t),a,s):u=l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=rS(i,Wd(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||sS(i,ai())!=null,Zg(e,u,o,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5e{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,r=new ON(i.getIndex()),s=HRe(i);this.processor_=g5e(s);const o=t.serverCache,a=t.eventCache,l=r.updateFullNode(sn.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(sn.EMPTY_NODE,a.getNode(),null),c=new sf(l,o.isFullyInitialized(),r.filtersNodes()),h=new sf(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Pw(h,c),this.eventGenerator_=new KRe(this.query_)}get query(){return this.query_}}function T5e(n){return n.viewCache_.serverCache.getNode()}function C5e(n){return iS(n.viewCache_)}function M5e(n,e){const t=Wd(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!zn(e)&&!t.getImmediateChild(Bn(e)).isEmpty())?t.getChild(e):null}function UO(n){return n.eventRegistrations_.length===0}function R5e(n,e){n.eventRegistrations_.push(e)}function zO(n,e,t){const i=[];if(t){yt(e==null,"A cancel should cancel all event registrations.");const r=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,r);o&&i.push(o)})}if(e){let r=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=r}else n.eventRegistrations_=[];return i}function VO(n,e,t,i){e.type===vl.MERGE&&e.source.queryId!==null&&(yt(Wd(n.viewCache_),"We should always have a full cache before handling merges"),yt(iS(n.viewCache_),"Missing event cache, even though we have a server cache"));const r=n.viewCache_,s=y5e(n.processor_,r,e,t,i);return v5e(n.processor_,s.viewCache),yt(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,dX(n,s.changes,s.viewCache.eventCache.getNode(),null)}function P5e(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ar,(s,o)=>{i.push(U0(s,o))}),t.isFullyInitialized()&&i.push(nX(t.getNode())),dX(n,i,t.getNode(),e)}function dX(n,e,t,i){const r=i?[i]:n.eventRegistrations_;return ZRe(n.eventGenerator_,e,t,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aS;class pX{constructor(){this.views=new Map}}function N5e(n){yt(!aS,"__referenceConstructor has already been defined"),aS=n}function I5e(){return yt(aS,"Reference.ts has not been loaded"),aS}function D5e(n){return n.views.size===0}function $N(n,e,t,i){const r=e.source.queryId;if(r!==null){const s=n.views.get(r);return yt(s!=null,"SyncTree gave us an op for an invalid query."),VO(s,e,t,i)}else{let s=[];for(const o of n.views.values())s=s.concat(VO(o,e,t,i));return s}}function AX(n,e,t,i,r){const s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=rS(t,r?i:null),l=!1;a?l=!0:i instanceof sn?(a=GN(t,i),l=!1):(a=sn.EMPTY_NODE,l=!1);const u=Pw(new sf(a,l,!1),new sf(i,r,!1));return new E5e(e,u)}return o}function k5e(n,e,t,i,r,s){const o=AX(n,e,i,r,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),R5e(o,t),P5e(o,t)}function L5e(n,e,t,i){const r=e._queryIdentifier,s=[];let o=[];const a=of(n);if(r==="default")for(const[l,u]of n.views.entries())o=o.concat(zO(u,t,i)),UO(u)&&(n.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const l=n.views.get(r);l&&(o=o.concat(zO(l,t,i)),UO(l)&&(n.views.delete(r),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!of(n)&&s.push(new(I5e())(e._repo,e._path)),{removed:s,events:o}}function mX(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function $h(n,e){let t=null;for(const i of n.views.values())t=t||M5e(i,e);return t}function gX(n,e){if(e._queryParams.loadsAllData())return Iw(n);{const i=e._queryIdentifier;return n.views.get(i)}}function vX(n,e){return gX(n,e)!=null}function of(n){return Iw(n)!=null}function Iw(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lS;function F5e(n){yt(!lS,"__referenceConstructor has already been defined"),lS=n}function B5e(){return yt(lS,"Reference.ts has not been loaded"),lS}let O5e=1;class GO{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Fi(null),this.pendingWriteTree_=d5e(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function yX(n,e,t,i,r){return n5e(n.pendingWriteTree_,e,t,i,r),r?$v(n,new jd(rX(),e,t)):[]}function yd(n,e,t=!1){const i=i5e(n.pendingWriteTree_,e);if(r5e(n.pendingWriteTree_,e)){let s=new Fi(null);return i.snap!=null?s=s.set(ai(),!0):Oo(i.children,o=>{s=s.set(new Pi(o),!0)}),$v(n,new nS(i.path,s,t))}else return[]}function Hv(n,e,t){return $v(n,new jd(zN(),e,t))}function U5e(n,e,t){const i=Fi.fromObject(t);return $v(n,new av(zN(),e,i))}function z5e(n,e){return $v(n,new ov(zN(),e))}function V5e(n,e,t){const i=WN(n,t);if(i){const r=XN(i),s=r.path,o=r.queryId,a=Js(s,e),l=new ov(VN(o),a);return YN(n,s,l)}else return[]}function uS(n,e,t,i,r=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||vX(o,e))){const l=L5e(o,e,t,i);D5e(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!r){const c=u.findIndex(A=>A._queryParams.loadsAllData())!==-1,h=n.syncPointTree_.findOnPath(s,(A,v)=>of(v));if(c&&!h){const A=n.syncPointTree_.subtree(s);if(!A.isEmpty()){const v=H5e(A);for(let _=0;_<v.length;++_){const S=v[_],w=S.query,x=SX(n,S);n.listenProvider_.startListening(e1(w),lv(n,w),x.hashFn,x.onComplete)}}}!h&&u.length>0&&!i&&(c?n.listenProvider_.stopListening(e1(e),null):u.forEach(A=>{const v=n.queryToTagMap.get(Dw(A));n.listenProvider_.stopListening(e1(A),v)}))}$5e(n,u)}return a}function _X(n,e,t,i){const r=WN(n,i);if(r!=null){const s=XN(r),o=s.path,a=s.queryId,l=Js(o,e),u=new jd(VN(a),l,t);return YN(n,o,u)}else return[]}function G5e(n,e,t,i){const r=WN(n,i);if(r){const s=XN(r),o=s.path,a=s.queryId,l=Js(o,e),u=Fi.fromObject(t),c=new av(VN(a),l,u);return YN(n,o,c)}else return[]}function y5(n,e,t,i=!1){const r=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(r,(A,v)=>{const _=Js(A,r);s=s||$h(v,_),o=o||of(v)});let a=n.syncPointTree_.get(r);a?(o=o||of(a),s=s||$h(a,ai())):(a=new pX,n.syncPointTree_=n.syncPointTree_.set(r,a));let l;s!=null?l=!0:(l=!1,s=sn.EMPTY_NODE,n.syncPointTree_.subtree(r).foreachChild((v,_)=>{const S=$h(_,ai());S&&(s=s.updateImmediateChild(v,S))}));const u=vX(a,e);if(!u&&!e._queryParams.loadsAllData()){const A=Dw(e);yt(!n.queryToTagMap.has(A),"View does not exist, but we have a tag");const v=j5e();n.queryToTagMap.set(A,v),n.tagToQueryMap.set(v,A)}const c=Nw(n.pendingWriteTree_,r);let h=k5e(a,e,t,c,s,l);if(!u&&!o&&!i){const A=gX(a,e);h=h.concat(W5e(n,e,A))}return h}function jN(n,e,t){const r=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const l=Js(o,e),u=$h(a,l);if(u)return u});return lX(r,e,s,t,!0)}function q5e(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(u,c)=>{const h=Js(u,t);i=i||$h(c,h)});let r=n.syncPointTree_.get(t);r?i=i||$h(r,ai()):(r=new pX,n.syncPointTree_=n.syncPointTree_.set(t,r));const s=i!=null,o=s?new sf(i,!0,!1):null,a=Nw(n.pendingWriteTree_,e._path),l=AX(r,e,a,s?o.getNode():sn.EMPTY_NODE,s);return C5e(l)}function $v(n,e){return xX(e,n.syncPointTree_,null,Nw(n.pendingWriteTree_,ai()))}function xX(n,e,t,i){if(zn(n.path))return bX(n,e,t,i);{const r=e.get(ai());t==null&&r!=null&&(t=$h(r,ai()));let s=[];const o=Bn(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const u=t?t.getImmediateChild(o):null,c=uX(i,o);s=s.concat(xX(a,l,u,c))}return r&&(s=s.concat($N(r,n,i,t))),s}}function bX(n,e,t,i){const r=e.get(ai());t==null&&r!=null&&(t=$h(r,ai()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,u=uX(i,o),c=n.operationForChild(o);c&&(s=s.concat(bX(c,a,l,u)))}),r&&(s=s.concat($N(r,n,i,t))),s}function SX(n,e){const t=e.query,i=lv(n,t);return{hashFn:()=>(T5e(e)||sn.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return i?V5e(n,t._path,i):z5e(n,t._path);{const s=q4e(r,t);return uS(n,t,null,s)}}}}function lv(n,e){const t=Dw(e);return n.queryToTagMap.get(t)}function Dw(n){return n._path.toString()+"$"+n._queryIdentifier}function WN(n,e){return n.tagToQueryMap.get(e)}function XN(n){const e=n.indexOf("$");return yt(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Pi(n.substr(0,e))}}function YN(n,e,t){const i=n.syncPointTree_.get(e);yt(i,"Missing sync point for query tag that we're tracking");const r=Nw(n.pendingWriteTree_,e);return $N(i,t,r,null)}function H5e(n){return n.fold((e,t,i)=>{if(t&&of(t))return[Iw(t)];{let r=[];return t&&(r=mX(t)),Oo(i,(s,o)=>{r=r.concat(o)}),r}})}function e1(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(B5e())(n._repo,n._path):n}function $5e(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const r=Dw(i),s=n.queryToTagMap.get(r);n.queryToTagMap.delete(r),n.tagToQueryMap.delete(s)}}}function j5e(){return O5e++}function W5e(n,e,t){const i=e._path,r=lv(n,e),s=SX(n,t),o=n.listenProvider_.startListening(e1(e),r,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(i);if(r)yt(!of(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,c,h)=>{if(!zn(u)&&c&&of(c))return[Iw(c).query];{let A=[];return c&&(A=A.concat(mX(c).map(v=>v.query))),Oo(h,(v,_)=>{A=A.concat(_)}),A}});for(let u=0;u<l.length;++u){const c=l[u];n.listenProvider_.stopListening(e1(c),lv(n,c))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new QN(t)}node(){return this.node_}}class KN{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Br(this.path_,e);return new KN(this.syncTree_,t)}node(){return jN(this.syncTree_,this.path_)}}const X5e=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},qO=function(n,e,t){if(!n||typeof n!="object")return n;if(yt(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return Y5e(n[".sv"],e,t);if(typeof n[".sv"]=="object")return Q5e(n[".sv"],e);yt(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},Y5e=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:yt(!1,"Unexpected server value: "+n)}},Q5e=function(n,e,t){n.hasOwnProperty("increment")||yt(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&yt(!1,"Unexpected increment value: "+i);const r=e.node();if(yt(r!==null&&typeof r<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const o=r.getValue();return typeof o!="number"?i:o+i},K5e=function(n,e,t,i){return ZN(e,new KN(t,n),i)},wX=function(n,e,t){return ZN(n,new QN(e),t)};function ZN(n,e,t){const i=n.getPriority().val(),r=qO(i,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=qO(o.getValue(),e,t);return a!==o.getValue()||r!==o.getPriority().val()?new $r(a,Xr(r)):n}else{const o=n;return s=o,r!==o.getPriority().val()&&(s=s.updatePriority(new $r(r))),o.forEachChild(Ar,(a,l)=>{const u=ZN(l,e.getImmediateChild(a),t);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JN{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function e8(n,e){let t=e instanceof Pi?e:new Pi(e),i=n,r=Bn(t);for(;r!==null;){const s=B0(i.node.children,r)||{children:{},childCount:0};i=new JN(r,i,s),t=Ii(t),r=Bn(t)}return i}function um(n){return n.node.value}function EX(n,e){n.node.value=e,_5(n)}function TX(n){return n.node.childCount>0}function Z5e(n){return um(n)===void 0&&!TX(n)}function kw(n,e){Oo(n.node.children,(t,i)=>{e(new JN(t,n,i))})}function CX(n,e,t,i){t&&!i&&e(n),kw(n,r=>{CX(r,e,!0,i)}),t&&i&&e(n)}function J5e(n,e,t){let i=n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function jv(n){return new Pi(n.parent===null?n.name:jv(n.parent)+"/"+n.name)}function _5(n){n.parent!==null&&ePe(n.parent,n.name,n)}function ePe(n,e,t){const i=Z5e(t),r=Nc(n.node.children,e);i&&r?(delete n.node.children[e],n.node.childCount--,_5(n)):!i&&!r&&(n.node.children[e]=t.node,n.node.childCount++,_5(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tPe=/[\[\].#$\/\u0000-\u001F\u007F]/,nPe=/[\[\].#$\u0000-\u001F\u007F]/,lC=10*1024*1024,MX=function(n){return typeof n=="string"&&n.length!==0&&!tPe.test(n)},RX=function(n){return typeof n=="string"&&n.length!==0&&!nPe.test(n)},iPe=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),RX(n)},rPe=function(n,e,t,i){t8(SN(n,"value"),e,t)},t8=function(n,e,t){const i=t instanceof Pi?new bRe(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Kf(i));if(typeof e=="function")throw new Error(n+"contains a function "+Kf(i)+" with contents = "+e.toString());if(TW(e))throw new Error(n+"contains "+e.toString()+" "+Kf(i));if(typeof e=="string"&&e.length>lC/3&&Ew(e)>lC)throw new Error(n+"contains a string greater than "+lC+" utf8 bytes "+Kf(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,s=!1;if(Oo(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!MX(o)))throw new Error(n+" contains an invalid key ("+o+") "+Kf(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);SRe(i,o),t8(n,a,i),wRe(i)}),r&&s)throw new Error(n+' contains ".value" child '+Kf(i)+" in addition to actual children.")}},PX=function(n,e,t,i){if(!RX(t))throw new Error(SN(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},sPe=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),PX(n,e,t)},oPe=function(n,e){if(Bn(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},aPe=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!MX(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!iPe(t))throw new Error(SN(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lPe{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function n8(n,e){let t=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();t!==null&&!LN(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(r)}t&&n.eventLists_.push(t)}function NX(n,e,t){n8(n,t),IX(n,i=>LN(i,e))}function lu(n,e,t){n8(n,t),IX(n,i=>gl(i,e)||gl(e,i))}function IX(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const r=n.eventLists_[i];if(r){const s=r.path;e(s)?(uPe(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function uPe(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();Qg&&Rs("event: "+t.toString()),lm(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cPe="repo_interrupt",hPe=25;class fPe{constructor(e,t,i,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new lPe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tS(),this.transactionQueueTree_=new JN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function dPe(n,e,t){if(n.stats_=DN(n.repoInfo_),n.forceRestClient_||W4e())n.server_=new eS(n.repoInfo_,(i,r,s,o)=>{HO(n,i,r,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>$O(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Fr(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new sc(n.repoInfo_,e,(i,r,s,o)=>{HO(n,i,r,s,o)},i=>{$O(n,i)},i=>{APe(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Z4e(n.repoInfo_,()=>new QRe(n.stats_,n.server_)),n.infoData_=new $Re,n.infoSyncTree_=new GO({startListening:(i,r,s,o)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=Hv(n.infoSyncTree_,i._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),r8(n,"connected",!1),n.serverSyncTree_=new GO({startListening:(i,r,s,o)=>(n.server_.listen(i,s,r,(a,l)=>{const u=o(a,l);lu(n.eventQueue_,i._path,u)}),[]),stopListening:(i,r)=>{n.server_.unlisten(i,r)}})}function pPe(n){const t=n.infoData_.getNode(new Pi(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function i8(n){return X5e({timestamp:pPe(n)})}function HO(n,e,t,i,r){n.dataUpdateCount++;const s=new Pi(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(r)if(i){const l=Wb(t,u=>Xr(u));o=G5e(n.serverSyncTree_,s,l,r)}else{const l=Xr(t);o=_X(n.serverSyncTree_,s,l,r)}else if(i){const l=Wb(t,u=>Xr(u));o=U5e(n.serverSyncTree_,s,l)}else{const l=Xr(t);o=Hv(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Fw(n,s)),lu(n.eventQueue_,a,o)}function $O(n,e){r8(n,"connected",e),e===!1&&vPe(n)}function APe(n,e){Oo(e,(t,i)=>{r8(n,t,i)})}function r8(n,e,t){const i=new Pi("/.info/"+e),r=Xr(t);n.infoData_.updateSnapshot(i,r);const s=Hv(n.infoSyncTree_,i,r);lu(n.eventQueue_,i,s)}function DX(n){return n.nextWriteId_++}function mPe(n,e,t){const i=q5e(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(r=>{const s=Xr(r).withIndex(e._queryParams.getIndex());y5(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=Hv(n.serverSyncTree_,e._path,s);else{const a=lv(n.serverSyncTree_,e);o=_X(n.serverSyncTree_,e._path,s,a)}return lu(n.eventQueue_,e._path,o),uS(n.serverSyncTree_,e,t,null,!0),s},r=>(Lw(n,"get for query "+Fr(e)+" failed: "+r),Promise.reject(new Error(r))))}function gPe(n,e,t,i,r){Lw(n,"set",{path:e.toString(),value:t,priority:i});const s=i8(n),o=Xr(t,i),a=jN(n.serverSyncTree_,e),l=wX(o,a,s),u=DX(n),c=yX(n.serverSyncTree_,e,l,u,!0);n8(n.eventQueue_,c),n.server_.put(e.toString(),o.val(!0),(A,v)=>{const _=A==="ok";_||Do("set at "+e+" failed: "+A);const S=yd(n.serverSyncTree_,u,!_);lu(n.eventQueue_,e,S),xPe(n,r,A,v)});const h=OX(n,e);Fw(n,h),lu(n.eventQueue_,h,[])}function vPe(n){Lw(n,"onDisconnectEvents");const e=i8(n),t=tS();p5(n.onDisconnect_,ai(),(r,s)=>{const o=K5e(r,s,n.serverSyncTree_,e);iX(t,r,o)});let i=[];p5(t,ai(),(r,s)=>{i=i.concat(Hv(n.serverSyncTree_,r,s));const o=OX(n,r);Fw(n,o)}),n.onDisconnect_=tS(),lu(n.eventQueue_,ai(),i)}function yPe(n,e,t){let i;Bn(e._path)===".info"?i=y5(n.infoSyncTree_,e,t):i=y5(n.serverSyncTree_,e,t),NX(n.eventQueue_,e._path,i)}function jO(n,e,t){let i;Bn(e._path)===".info"?i=uS(n.infoSyncTree_,e,t):i=uS(n.serverSyncTree_,e,t),NX(n.eventQueue_,e._path,i)}function _Pe(n){n.persistentConnection_&&n.persistentConnection_.interrupt(cPe)}function Lw(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Rs(t,...e)}function xPe(n,e,t,i){e&&lm(()=>{if(t==="ok")e(null);else{const r=(t||"error").toUpperCase();let s=r;i&&(s+=": "+i);const o=new Error(s);o.code=r,e(o)}})}function kX(n,e,t){return jN(n.serverSyncTree_,e,t)||sn.EMPTY_NODE}function s8(n,e=n.transactionQueueTree_){if(e||Bw(n,e),um(e)){const t=FX(n,e);yt(t.length>0,"Sending zero length transaction queue"),t.every(r=>r.status===0)&&bPe(n,jv(e),t)}else TX(e)&&kw(e,t=>{s8(n,t)})}function bPe(n,e,t){const i=t.map(u=>u.currentWriteId),r=kX(n,e,i);let s=r;const o=r.hash();for(let u=0;u<t.length;u++){const c=t[u];yt(c.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;const h=Js(e,c.path);s=s.updateChild(h,c.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;n.server_.put(l.toString(),a,u=>{Lw(n,"transaction put response",{path:l.toString(),status:u});let c=[];if(u==="ok"){const h=[];for(let A=0;A<t.length;A++)t[A].status=2,c=c.concat(yd(n.serverSyncTree_,t[A].currentWriteId)),t[A].onComplete&&h.push(()=>t[A].onComplete(null,!0,t[A].currentOutputSnapshotResolved)),t[A].unwatcher();Bw(n,e8(n.transactionQueueTree_,e)),s8(n,n.transactionQueueTree_),lu(n.eventQueue_,e,c);for(let A=0;A<h.length;A++)lm(h[A])}else{if(u==="datastale")for(let h=0;h<t.length;h++)t[h].status===3?t[h].status=4:t[h].status=0;else{Do("transaction at "+l.toString()+" failed: "+u);for(let h=0;h<t.length;h++)t[h].status=4,t[h].abortReason=u}Fw(n,e)}},o)}function Fw(n,e){const t=LX(n,e),i=jv(t),r=FX(n,t);return SPe(n,r,i),i}function SPe(n,e,t){if(e.length===0)return;const i=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Js(t,l.path);let c=!1,h;if(yt(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)c=!0,h=l.abortReason,r=r.concat(yd(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=hPe)c=!0,h="maxretry",r=r.concat(yd(n.serverSyncTree_,l.currentWriteId,!0));else{const A=kX(n,l.path,o);l.currentInputSnapshot=A;const v=e[a].update(A.val());if(v!==void 0){t8("transaction failed: Data returned ",v,l.path);let _=Xr(v);typeof v=="object"&&v!=null&&Nc(v,".priority")||(_=_.updatePriority(A.getPriority()));const w=l.currentWriteId,x=i8(n),M=wX(_,A,x);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=M,l.currentWriteId=DX(n),o.splice(o.indexOf(w),1),r=r.concat(yX(n.serverSyncTree_,l.path,M,l.currentWriteId,l.applyLocally)),r=r.concat(yd(n.serverSyncTree_,w,!0))}else c=!0,h="nodata",r=r.concat(yd(n.serverSyncTree_,l.currentWriteId,!0))}lu(n.eventQueue_,t,r),r=[],c&&(e[a].status=2,function(A){setTimeout(A,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(h),!1,null))))}Bw(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)lm(i[a]);s8(n,n.transactionQueueTree_)}function LX(n,e){let t,i=n.transactionQueueTree_;for(t=Bn(e);t!==null&&um(i)===void 0;)i=e8(i,t),e=Ii(e),t=Bn(e);return i}function FX(n,e){const t=[];return BX(n,e,t),t.sort((i,r)=>i.order-r.order),t}function BX(n,e,t){const i=um(e);if(i)for(let r=0;r<i.length;r++)t.push(i[r]);kw(e,r=>{BX(n,r,t)})}function Bw(n,e){const t=um(e);if(t){let i=0;for(let r=0;r<t.length;r++)t[r].status!==2&&(t[i]=t[r],i++);t.length=i,EX(e,t.length>0?t:void 0)}kw(e,i=>{Bw(n,i)})}function OX(n,e){const t=jv(LX(n,e)),i=e8(n.transactionQueueTree_,e);return J5e(i,r=>{uC(n,r)}),uC(n,i),CX(i,r=>{uC(n,r)}),t}function uC(n,e){const t=um(e);if(t){const i=[];let r=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(yt(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(yt(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(yd(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&i.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?EX(e,void 0):t.length=s+1,lu(n.eventQueue_,jv(e),r);for(let o=0;o<i.length;o++)lm(i[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wPe(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let r=t[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function EPe(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Do(`Invalid query segment '${t}' in query '${n}'`)}return e}const WO=function(n,e){const t=TPe(n),i=t.namespace;t.domain==="firebase.com"&&_c(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&_c("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||O4e();const r=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new OW(t.host,t.secure,i,r,e,"",i!==t.subdomain),path:new Pi(t.pathString)}},TPe=function(n){let e="",t="",i="",r="",s="",o=!0,a="https",l=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let c=n.indexOf("/");c===-1&&(c=n.length);let h=n.indexOf("?");h===-1&&(h=n.length),e=n.substring(0,Math.min(c,h)),c<h&&(r=wPe(n.substring(c,h)));const A=EPe(n.substring(Math.min(n.length,h)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(u+1),10)):u=e.length;const v=e.slice(0,u);if(v.toLowerCase()==="localhost")t="localhost";else if(v.split(".").length<=2)t=v;else{const _=e.indexOf(".");i=e.substring(0,_).toLowerCase(),t=e.substring(_+1),s=i}"ns"in A&&(s=A.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CPe{constructor(e,t,i,r){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Fr(this.snapshot.exportVal())}}class MPe{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UX{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return yt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e,t,i,r){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=r}get key(){return zn(this._path)?null:WW(this._path)}get ref(){return new Ic(this._repo,this._path)}get _queryIdentifier(){const e=NO(this._queryParams),t=NN(e);return t==="{}"?"default":t}get _queryObject(){return NO(this._queryParams)}isEqual(e){if(e=ds(e),!(e instanceof o8))return!1;const t=this._repo===e._repo,i=LN(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&i&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+xRe(this._path)}}class Ic extends o8{constructor(e,t){super(e,t,new UN,!1)}get parent(){const e=YW(this._path);return e===null?null:new Ic(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class uv{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Pi(e),i=x5(this.ref,e);return new uv(this._node.getChild(t),i,Ar)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,r)=>e(new uv(r,x5(this.ref,i),Ar)))}hasChild(e){const t=new Pi(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function cm(n,e){return n=ds(n),n._checkNotDeleted("ref"),e!==void 0?x5(n._root,e):n._root}function x5(n,e){return n=ds(n),Bn(n._path)===null?sPe("child","path",e):PX("child","path",e),new Ic(n._repo,Br(n._path,e))}function Ow(n,e){n=ds(n),oPe("set",n._path),rPe("set",e,n._path);const t=new ww;return gPe(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function RPe(n){n=ds(n);const e=new UX(()=>{}),t=new Uw(e);return mPe(n._repo,n,t).then(i=>new uv(i,new Ic(n._repo,n._path),n._queryParams.getIndex()))}class Uw{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new CPe("value",this,new uv(e.snapshotNode,new Ic(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new MPe(this,e,t):null}matches(e){return e instanceof Uw?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function PPe(n,e,t,i,r){let s;if(typeof i=="object"&&(s=void 0,r=i),typeof i=="function"&&(s=i),r&&r.onlyOnce){const l=t,u=(c,h)=>{jO(n._repo,n,a),l(c,h)};u.userCallback=t.userCallback,u.context=t.context,t=u}const o=new UX(t,s||void 0),a=new Uw(o);return yPe(n._repo,n,a),()=>jO(n._repo,n,a)}function a8(n,e,t,i){return PPe(n,"value",e,t,i)}N5e(Ic);F5e(Ic);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NPe="FIREBASE_DATABASE_EMULATOR_HOST",b5={};let IPe=!1;function DPe(n,e,t,i){n.repoInfo_=new OW(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function kPe(n,e,t,i,r){let s=i||n.options.databaseURL;s===void 0&&(n.options.projectId||_c("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Rs("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=WO(s,r),a=o.repoInfo,l;typeof process<"u"&&dO&&(l=dO[NPe]),l?(s=`http://${l}?ns=${a.namespace}`,o=WO(s,r),a=o.repoInfo):o.repoInfo.secure;const u=new Y4e(n.name,n.options,e);aPe("Invalid Firebase Database URL",o),zn(o.path)||_c("Database URL must point to the root of a Firebase Database (not including a child path).");const c=FPe(a,n,u,new X4e(n,t));return new BPe(c,n)}function LPe(n,e){const t=b5[e];(!t||t[n.key]!==n)&&_c(`Database ${e}(${n.repoInfo_}) has already been deleted.`),_Pe(n),delete t[n.key]}function FPe(n,e,t,i){let r=b5[e.name];r||(r={},b5[e.name]=r);let s=r[n.toURLString()];return s&&_c("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new fPe(n,IPe,t,i),r[n.toURLString()]=s,s}class BPe{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(dPe(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ic(this._repo,ai())),this._rootInternal}_delete(){return this._rootInternal!==null&&(LPe(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&_c("Cannot call "+e+" on a deleted database.")}}function OPe(n=EN(),e){const t=ap(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=UTe("database");i&&UPe(t,...i)}return t}function UPe(n,e,t,i={}){n=ds(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&_c("Cannot call useEmulator() after instance has already been initialized.");const r=n._repoInternal;let s;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&_c('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new nx(nx.OWNER);else if(i.mockUserToken){const o=typeof i.mockUserToken=="string"?i.mockUserToken:zTe(i.mockUserToken,n.app.options.projectId);s=new nx(o)}DPe(r,e,t,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zPe(n){I4e(om),au(new Pl("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return kPe(i,r,s,t)},"PUBLIC").setMultipleInstances(!0)),Fa(pO,AO,n),Fa(pO,AO,"esm2017")}sc.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};sc.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};zPe();function l8(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function zX(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const VPe=zX,VX=new op("auth","Firebase",zX());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS=new Tw("@firebase/auth");function GPe(n,...e){cS.logLevel<=Ei.WARN&&cS.warn(`Auth (${om}): ${n}`,...e)}function ix(n,...e){cS.logLevel<=Ei.ERROR&&cS.error(`Auth (${om}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nl(n,...e){throw u8(n,...e)}function tu(n,...e){return u8(n,...e)}function GX(n,e,t){const i=Object.assign(Object.assign({},VPe()),{[e]:t});return new op("auth","Firebase",i).create(e,{appName:n.name})}function oc(n){return GX(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function u8(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return VX.create(n,...e)}function on(n,e,...t){if(!n)throw u8(e,...t)}function Hu(n){const e="INTERNAL ASSERTION FAILED: "+n;throw ix(e),new Error(e)}function xc(n,e){n||Hu(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S5(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function qPe(){return XO()==="http:"||XO()==="https:"}function XO(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HPe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(qPe()||qj()||"connection"in navigator)?navigator.onLine:!0}function $Pe(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e,t){this.shortDelay=e,this.longDelay=t,xc(t>e,"Short delay should be less than long delay!"),this.isMobile=bN()||Hj()}get(){return HPe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(n,e){xc(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qX{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jPe={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WPe=new Wv(3e4,6e4);function vf(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function yf(n,e,t,i,r={}){return HX(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=sm(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},s);return VTe()||(u.referrerPolicy="no-referrer"),qX.fetch()($X(n,n.config.apiHost,t,a),u)})}async function HX(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},jPe),e);try{const r=new YPe(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw f2(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw f2(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw f2(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw f2(n,"user-disabled",o);const c=i[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw GX(n,c,u);Nl(n,c)}}catch(r){if(r instanceof hu)throw r;Nl(n,"network-request-failed",{message:String(r)})}}async function Xv(n,e,t,i,r={}){const s=await yf(n,e,t,i,r);return"mfaPendingCredential"in s&&Nl(n,"multi-factor-auth-required",{_serverResponse:s}),s}function $X(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?c8(n.config,r):`${n.config.apiScheme}://${r}`}function XPe(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class YPe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(tu(this.auth,"network-request-failed")),WPe.get())})}}function f2(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=tu(n,e,i);return r.customData._tokenResponse=t,r}function YO(n){return n!==void 0&&n.enterprise!==void 0}class QPe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return XPe(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function KPe(n,e){return yf(n,"GET","/v2/recaptchaConfig",vf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZPe(n,e){return yf(n,"POST","/v1/accounts:delete",e)}async function jX(n,e){return yf(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JPe(n,e=!1){const t=ds(n),i=await t.getIdToken(e),r=h8(i);on(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:t1(cC(r.auth_time)),issuedAtTime:t1(cC(r.iat)),expirationTime:t1(cC(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function cC(n){return Number(n)*1e3}function h8(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return ix("JWT malformed, contained fewer than 3 sections"),null;try{const r=jb(t);return r?JSON.parse(r):(ix("Failed to decode base64 JWT payload"),null)}catch(r){return ix("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function QO(n){const e=h8(n);return on(e,"internal-error"),on(typeof e.exp<"u","internal-error"),on(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cv(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof hu&&e6e(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function e6e({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6e{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=t1(this.lastLoginAt),this.creationTime=t1(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hS(n){var e;const t=n.auth,i=await n.getIdToken(),r=await cv(n,jX(t,{idToken:i}));on(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?WX(s.providerUserInfo):[],a=i6e(n.providerData,o),l=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),c=l?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new w5(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(n,h)}async function n6e(n){const e=ds(n);await hS(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function i6e(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function WX(n){return n.map(e=>{var{providerId:t}=e,i=l8(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r6e(n,e){const t=await HX(n,{},async()=>{const i=sm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=$X(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",qX.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function s6e(n,e){return yf(n,"POST","/v2/accounts:revokeToken",vf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){on(e.idToken,"internal-error"),on(typeof e.idToken<"u","internal-error"),on(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):QO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){on(e.length!==0,"internal-error");const t=QO(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(on(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await r6e(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new i0;return i&&(on(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(on(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(on(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new i0,this.toJSON())}_performRefresh(){return Hu("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(n,e){on(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class $u{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=l8(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new t6e(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new w5(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await cv(this,this.stsTokenManager.getToken(this.auth,e));return on(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JPe(this,e)}reload(){return n6e(this)}_assign(e){this!==e&&(on(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new $u(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){on(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await hS(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ra(this.auth.app))return Promise.reject(oc(this.auth));const e=await this.getIdToken();return await cv(this,ZPe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,l,u,c;const h=(i=t.displayName)!==null&&i!==void 0?i:void 0,A=(r=t.email)!==null&&r!==void 0?r:void 0,v=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,_=(o=t.photoURL)!==null&&o!==void 0?o:void 0,S=(a=t.tenantId)!==null&&a!==void 0?a:void 0,w=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,x=(u=t.createdAt)!==null&&u!==void 0?u:void 0,M=(c=t.lastLoginAt)!==null&&c!==void 0?c:void 0,{uid:R,emailVerified:N,isAnonymous:B,providerData:T,stsTokenManager:D}=t;on(R&&D,e,"internal-error");const F=i0.fromJSON(this.name,D);on(typeof R=="string",e,"internal-error"),sh(h,e.name),sh(A,e.name),on(typeof N=="boolean",e,"internal-error"),on(typeof B=="boolean",e,"internal-error"),sh(v,e.name),sh(_,e.name),sh(S,e.name),sh(w,e.name),sh(x,e.name),sh(M,e.name);const L=new $u({uid:R,auth:e,email:A,emailVerified:N,displayName:h,isAnonymous:B,photoURL:_,phoneNumber:v,tenantId:S,stsTokenManager:F,createdAt:x,lastLoginAt:M});return T&&Array.isArray(T)&&(L.providerData=T.map(O=>Object.assign({},O))),w&&(L._redirectEventId=w),L}static async _fromIdTokenResponse(e,t,i=!1){const r=new i0;r.updateFromServerResponse(t);const s=new $u({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await hS(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];on(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?WX(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new i0;a.updateFromIdToken(i);const l=new $u({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new w5(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=new Map;function ju(n){xc(n instanceof Function,"Expected a class definition");let e=KO.get(n);return e?(xc(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,KO.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XX{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}XX.type="NONE";const ZO=XX;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(n,e,t){return`firebase:${n}:${e}:${t}`}class r0{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=rx(this.userKey,r.apiKey,s),this.fullPersistenceKey=rx("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?$u._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new r0(ju(ZO),e,i);const r=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=r[0]||ju(ZO);const o=rx(i,e.config.apiKey,e.name);let a=null;for(const u of t)try{const c=await u._get(o);if(c){const h=$u._fromJSON(e,c);u!==s&&(a=h),s=u;break}}catch{}const l=r.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new r0(s,e,i):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new r0(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JO(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ZX(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(YX(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eY(e))return"Blackberry";if(tY(e))return"Webos";if(QX(e))return"Safari";if((e.includes("chrome/")||KX(e))&&!e.includes("edge/"))return"Chrome";if(JX(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function YX(n=ro()){return/firefox\//i.test(n)}function QX(n=ro()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function KX(n=ro()){return/crios\//i.test(n)}function ZX(n=ro()){return/iemobile/i.test(n)}function JX(n=ro()){return/android/i.test(n)}function eY(n=ro()){return/blackberry/i.test(n)}function tY(n=ro()){return/webos/i.test(n)}function f8(n=ro()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function o6e(n=ro()){var e;return f8(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function a6e(){return GTe()&&document.documentMode===10}function nY(n=ro()){return f8(n)||JX(n)||tY(n)||eY(n)||/windows phone/i.test(n)||ZX(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iY(n,e=[]){let t;switch(n){case"Browser":t=JO(ro());break;case"Worker":t=`${JO(ro())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${om}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6e{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u6e(n,e={}){return yf(n,"GET","/v2/passwordPolicy",vf(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c6e=6;class h6e{constructor(e){var t,i,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:c6e,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(i=l.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(r=l.containsLowercaseLetter)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6e{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new e9(this),this.idTokenSubscription=new e9(this),this.beforeStateQueue=new l6e(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=VX,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ju(t)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await r0.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await jX(this,{idToken:e}),i=await $u._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ra(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(r=l.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return on(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await hS(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$Pe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ra(this.app))return Promise.reject(oc(this));const t=e?ds(e):null;return t&&on(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&on(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ra(this.app)?Promise.reject(oc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ra(this.app)?Promise.reject(oc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ju(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await u6e(this),t=new h6e(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new op("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await s6e(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ju(e)||this._popupRedirectResolver;on(t,this,"argument-error"),this.redirectPersistenceManager=await r0.create(this,[ju(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(on(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,i,r);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return on(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=iY(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(Ra(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&GPe(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function up(n){return ds(n)}class e9{constructor(e){this.auth=e,this.observer=null,this.addObserver=QTe(t=>this.observer=t)}get next(){return on(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zw={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function d6e(n){zw=n}function rY(n){return zw.loadJS(n)}function p6e(){return zw.recaptchaEnterpriseScript}function A6e(){return zw.gapiScript}function m6e(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class g6e{constructor(){this.enterprise=new v6e}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class v6e{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const y6e="recaptcha-enterprise",sY="NO_RECAPTCHA";class _6e{constructor(e){this.type=y6e,this.auth=up(e)}async verify(e="verify",t=!1){async function i(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{KPe(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new QPe(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function r(s,o,a){const l=window.grecaptcha;YO(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(sY)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new g6e().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{i(this.auth).then(a=>{if(!t&&YO(window.grecaptcha))r(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=p6e();l.length!==0&&(l+=a),rY(l).then(()=>{r(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function t9(n,e,t,i=!1,r=!1){const s=new _6e(n);let o;if(r)o=sY;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return i?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function E5(n,e,t,i,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await t9(n,e,t,t==="getOobCode");return i(n,o)}else return i(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await t9(n,e,t,t==="getOobCode");return i(n,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x6e(n,e){const t=ap(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(ev(s,e??{}))return r;Nl(r,"already-initialized")}return t.initialize({options:e})}function b6e(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(ju);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function S6e(n,e,t){const i=up(n);on(i._canInitEmulator,i,"emulator-config-failed"),on(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=oY(e),{host:o,port:a}=w6e(e),l=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),E6e()}function oY(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function w6e(n){const e=oY(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:n9(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:n9(o)}}}function n9(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function E6e(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d8{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Hu("not implemented")}_getIdTokenResponse(e){return Hu("not implemented")}_linkToIdToken(e,t){return Hu("not implemented")}_getReauthenticationResolver(e){return Hu("not implemented")}}async function T6e(n,e){return yf(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C6e(n,e){return Xv(n,"POST","/v1/accounts:signInWithPassword",vf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M6e(n,e){return Xv(n,"POST","/v1/accounts:signInWithEmailLink",vf(n,e))}async function R6e(n,e){return Xv(n,"POST","/v1/accounts:signInWithEmailLink",vf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv extends d8{constructor(e,t,i,r=null){super("password",i),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new hv(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new hv(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return E5(e,t,"signInWithPassword",C6e);case"emailLink":return M6e(e,{email:this._email,oobCode:this._password});default:Nl(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return E5(e,i,"signUpPassword",T6e);case"emailLink":return R6e(e,{idToken:t,email:this._email,oobCode:this._password});default:Nl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s0(n,e){return Xv(n,"POST","/v1/accounts:signInWithIdp",vf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P6e="http://localhost";class Xd extends d8{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Xd(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Nl("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=l8(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new Xd(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return s0(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,s0(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,s0(e,t)}buildRequest(){const e={requestUri:P6e,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=sm(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N6e(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function I6e(n){const e=Sg(wg(n)).link,t=e?Sg(wg(e)).deep_link_id:null,i=Sg(wg(n)).deep_link_id;return(i?Sg(wg(i)).link:null)||i||t||e||n}class p8{constructor(e){var t,i,r,s,o,a;const l=Sg(wg(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,c=(i=l.oobCode)!==null&&i!==void 0?i:null,h=N6e((r=l.mode)!==null&&r!==void 0?r:null);on(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=I6e(e);try{return new p8(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(){this.providerId=hm.PROVIDER_ID}static credential(e,t){return hv._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=p8.parseLink(t);return on(i,"argument-error"),hv._fromEmailAndCode(e,i.code,i.tenantId)}}hm.PROVIDER_ID="password";hm.EMAIL_PASSWORD_SIGN_IN_METHOD="password";hm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aY{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv extends aY{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends Yv{constructor(){super("facebook.com")}static credential(e){return Xd._fromParams({providerId:_h.PROVIDER_ID,signInMethod:_h.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _h.credentialFromTaggedObject(e)}static credentialFromError(e){return _h.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _h.credential(e.oauthAccessToken)}catch{return null}}}_h.FACEBOOK_SIGN_IN_METHOD="facebook.com";_h.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh extends Yv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xd._fromParams({providerId:xh.PROVIDER_ID,signInMethod:xh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return xh.credentialFromTaggedObject(e)}static credentialFromError(e){return xh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return xh.credential(t,i)}catch{return null}}}xh.GOOGLE_SIGN_IN_METHOD="google.com";xh.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh extends Yv{constructor(){super("github.com")}static credential(e){return Xd._fromParams({providerId:bh.PROVIDER_ID,signInMethod:bh.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bh.credentialFromTaggedObject(e)}static credentialFromError(e){return bh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return bh.credential(e.oauthAccessToken)}catch{return null}}}bh.GITHUB_SIGN_IN_METHOD="github.com";bh.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh extends Yv{constructor(){super("twitter.com")}static credential(e,t){return Xd._fromParams({providerId:Sh.PROVIDER_ID,signInMethod:Sh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Sh.credentialFromTaggedObject(e)}static credentialFromError(e){return Sh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Sh.credential(t,i)}catch{return null}}}Sh.TWITTER_SIGN_IN_METHOD="twitter.com";Sh.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D6e(n,e){return Xv(n,"POST","/v1/accounts:signUp",vf(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await $u._fromIdTokenResponse(e,i,r),o=i9(i);return new Yd({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=i9(i);return new Yd({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function i9(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS extends hu{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,fS.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new fS(e,t,i,r)}}function lY(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?fS._fromErrorAndOperation(n,s,e,i):s})}async function k6e(n,e,t=!1){const i=await cv(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Yd._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L6e(n,e,t=!1){const{auth:i}=n;if(Ra(i.app))return Promise.reject(oc(i));const r="reauthenticate";try{const s=await cv(n,lY(i,r,e,n),t);on(s.idToken,i,"internal-error");const o=h8(s.idToken);on(o,i,"internal-error");const{sub:a}=o;return on(n.uid===a,i,"user-mismatch"),Yd._forOperation(n,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Nl(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uY(n,e,t=!1){if(Ra(n.app))return Promise.reject(oc(n));const i="signIn",r=await lY(n,i,e),s=await Yd._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}async function F6e(n,e){return uY(up(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cY(n){const e=up(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function B6e(n,e,t){if(Ra(n.app))return Promise.reject(oc(n));const i=up(n),o=await E5(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",D6e).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&cY(n),l}),a=await Yd._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function hY(n,e,t){return Ra(n.app)?Promise.reject(oc(n)):F6e(ds(n),hm.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&cY(n),i})}function O6e(n,e,t,i){return ds(n).onIdTokenChanged(e,t,i)}function U6e(n,e,t){return ds(n).beforeAuthStateChanged(e,t)}function z6e(n,e,t,i){return ds(n).onAuthStateChanged(e,t,i)}function V6e(n){return ds(n).signOut()}const dS="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(dS,"1"),this.storage.removeItem(dS),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6e=1e3,q6e=10;class dY extends fY{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nY(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);a6e()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,q6e):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},G6e)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dY.type="LOCAL";const H6e=dY;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pY extends fY{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}pY.type="SESSION";const AY=pY;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $6e(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Vw(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async u=>u(t.origin,s)),l=await $6e(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vw.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A8(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6e{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=A8("",20);r.port1.start();const c=setTimeout(()=>{l(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(h){const A=h;if(A.data.eventId===u)switch(A.data.status){case"ack":clearTimeout(c),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(A.data.response);break;default:clearTimeout(c),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nu(){return window}function W6e(n){nu().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mY(){return typeof nu().WorkerGlobalScope<"u"&&typeof nu().importScripts=="function"}async function X6e(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Y6e(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Q6e(){return mY()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gY="firebaseLocalStorageDb",K6e=1,pS="firebaseLocalStorage",vY="fbase_key";class Qv{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gw(n,e){return n.transaction([pS],e?"readwrite":"readonly").objectStore(pS)}function Z6e(){const n=indexedDB.deleteDatabase(gY);return new Qv(n).toPromise()}function T5(){const n=indexedDB.open(gY,K6e);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(pS,{keyPath:vY})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(pS)?e(i):(i.close(),await Z6e(),e(await T5()))})})}async function r9(n,e,t){const i=Gw(n,!0).put({[vY]:e,value:t});return new Qv(i).toPromise()}async function J6e(n,e){const t=Gw(n,!1).get(e),i=await new Qv(t).toPromise();return i===void 0?null:i.value}function s9(n,e){const t=Gw(n,!0).delete(e);return new Qv(t).toPromise()}const eNe=800,tNe=3;class yY{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await T5(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>tNe)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mY()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vw._getInstance(Q6e()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await X6e(),!this.activeServiceWorker)return;this.sender=new j6e(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Y6e()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await T5();return await r9(e,dS,"1"),await s9(e,dS),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>r9(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>J6e(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>s9(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=Gw(r,!1).getAll();return new Qv(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eNe)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yY.type="LOCAL";const nNe=yY;new Wv(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iNe(n,e){return e?ju(e):(on(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8 extends d8{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return s0(e,this._buildIdpRequest())}_linkToIdToken(e,t){return s0(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return s0(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function rNe(n){return uY(n.auth,new m8(n),n.bypassAuthState)}function sNe(n){const{auth:e,user:t}=n;return on(t,e,"internal-error"),L6e(t,new m8(n),n.bypassAuthState)}async function oNe(n){const{auth:e,user:t}=n;return on(t,e,"internal-error"),k6e(t,new m8(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Y{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return rNe;case"linkViaPopup":case"linkViaRedirect":return oNe;case"reauthViaPopup":case"reauthViaRedirect":return sNe;default:Nl(this.auth,"internal-error")}}resolve(e){xc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xc(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aNe=new Wv(2e3,1e4);class LA extends _Y{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,LA.currentPopupAction&&LA.currentPopupAction.cancel(),LA.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return on(e,this.auth,"internal-error"),e}async onExecution(){xc(this.filter.length===1,"Popup operations only handle one event");const e=A8();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(tu(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(tu(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,LA.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(tu(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,aNe.get())};e()}}LA.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lNe="pendingRedirect",sx=new Map;class uNe extends _Y{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=sx.get(this.auth._key());if(!e){try{const i=await cNe(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}sx.set(this.auth._key(),e)}return this.bypassAuthState||sx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function cNe(n,e){const t=dNe(e),i=fNe(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function hNe(n,e){sx.set(n._key(),e)}function fNe(n){return ju(n._redirectPersistence)}function dNe(n){return rx(lNe,n.config.apiKey,n.name)}async function pNe(n,e,t=!1){if(Ra(n.app))return Promise.reject(oc(n));const i=up(n),r=iNe(i,e),o=await new uNe(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ANe=10*60*1e3;class mNe{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gNe(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!xY(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(tu(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ANe&&this.cachedEventUids.clear(),this.cachedEventUids.has(o9(e))}saveEventToCache(e){this.cachedEventUids.add(o9(e)),this.lastProcessedEventTime=Date.now()}}function o9(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xY({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function gNe(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xY(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vNe(n,e={}){return yf(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yNe=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_Ne=/^https?/;async function xNe(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vNe(n);for(const t of e)try{if(bNe(t))return}catch{}Nl(n,"unauthorized-domain")}function bNe(n){const e=S5(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!_Ne.test(t))return!1;if(yNe.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SNe=new Wv(3e4,6e4);function a9(){const n=nu().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function wNe(n){return new Promise((e,t)=>{var i,r,s;function o(){a9(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{a9(),t(tu(n,"network-request-failed"))},timeout:SNe.get()})}if(!((r=(i=nu().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=nu().gapi)===null||s===void 0)&&s.load)o();else{const a=m6e("iframefcb");return nu()[a]=()=>{gapi.load?o():t(tu(n,"network-request-failed"))},rY(`${A6e()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw ox=null,e})}let ox=null;function ENe(n){return ox=ox||wNe(n),ox}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TNe=new Wv(5e3,15e3),CNe="__/auth/iframe",MNe="emulator/auth/iframe",RNe={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PNe=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NNe(n){const e=n.config;on(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?c8(e,MNe):`https://${n.config.authDomain}/${CNe}`,i={apiKey:e.apiKey,appName:n.name,v:om},r=PNe.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${sm(i).slice(1)}`}async function INe(n){const e=await ENe(n),t=nu().gapi;return on(t,n,"internal-error"),e.open({where:document.body,url:NNe(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RNe,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=tu(n,"network-request-failed"),a=nu().setTimeout(()=>{s(o)},TNe.get());function l(){nu().clearTimeout(a),r(i)}i.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DNe={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kNe=500,LNe=600,FNe="_blank",BNe="http://localhost";class l9{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ONe(n,e,t,i=kNe,r=LNe){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},DNe),{width:i.toString(),height:r.toString(),top:s,left:o}),u=ro().toLowerCase();t&&(a=KX(u)?FNe:t),YX(u)&&(e=e||BNe,l.scrollbars="yes");const c=Object.entries(l).reduce((A,[v,_])=>`${A}${v}=${_},`,"");if(o6e(u)&&a!=="_self")return UNe(e||"",a),new l9(null);const h=window.open(e||"",a,c);on(h,n,"popup-blocked");try{h.focus()}catch{}return new l9(h)}function UNe(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zNe="__/auth/handler",VNe="emulator/auth/handler",GNe=encodeURIComponent("fac");async function u9(n,e,t,i,r,s){on(n.config.authDomain,n,"auth-domain-config-required"),on(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:om,eventId:r};if(e instanceof aY){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",r5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,h]of Object.entries({}))o[c]=h}if(e instanceof Yv){const c=e.getScopes().filter(h=>h!=="");c.length>0&&(o.scopes=c.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];const l=await n._getAppCheckToken(),u=l?`#${GNe}=${encodeURIComponent(l)}`:"";return`${qNe(n)}?${sm(a).slice(1)}${u}`}function qNe({config:n}){return n.emulator?c8(n,VNe):`https://${n.authDomain}/${zNe}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC="webStorageSupport";class HNe{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=AY,this._completeRedirectFn=pNe,this._overrideRedirectResult=hNe}async _openPopup(e,t,i,r){var s;xc((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await u9(e,t,i,S5(),r);return ONe(e,o,A8())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await u9(e,t,i,S5(),r);return W6e(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(xc(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await INe(e),i=new mNe(e);return t.register("authEvent",r=>(on(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hC,{type:hC},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[hC];o!==void 0&&t(!!o),Nl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xNe(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return nY()||QX()||f8()}}const $Ne=HNe;var c9="@firebase/auth",h9="1.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jNe{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){on(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WNe(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function XNe(n){au(new Pl("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;on(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:iY(n)},u=new f6e(i,r,s,l);return b6e(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),au(new Pl("auth-internal",e=>{const t=up(e.getProvider("auth").getImmediate());return(i=>new jNe(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fa(c9,h9,WNe(n)),Fa(c9,h9,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YNe=5*60,QNe=Gj("authIdTokenMaxAge")||YNe;let f9=null;const KNe=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>QNe)return;const r=t==null?void 0:t.token;f9!==r&&(f9=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function ZNe(n=EN()){const e=ap(n,"auth");if(e.isInitialized())return e.getImmediate();const t=x6e(n,{popupRedirectResolver:$Ne,persistence:[nNe,H6e,AY]}),i=Gj("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=KNe(s.toString());U6e(t,o,()=>o(t.currentUser)),O6e(t,a=>o(a))}}const r=zj("auth");return r&&S6e(t,`http://${r}`),t}function JNe(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}d6e({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=tu("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",JNe().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});XNe("Browser");const e8e={apiKey:"AIzaSyCSKpwZmAuBLmZCcJWP24YPeBGU-AMY7zQ",authDomain:"design-for-displacement.firebaseapp.com",projectId:"design-for-displacement",storageBucket:"design-for-displacement.firebasestorage.app",messagingSenderId:"1032628266185",appId:"1:1032628266185:web:fa2f85596eec097e069918",measurementId:"G-FYMP76TDB8"},bY=Zj(e8e);M4e(bY);const fm=OPe(),t8e=(n,e)=>{const t=cm(fm,e);a8(t,i=>{const r=i.val(),s=Object.keys(r).map(o=>({id:parseInt(o,10),...r[o]}));n(s)})},n8e=(n,e,t)=>{Ow(cm(fm,t+n),{content:e}).then(()=>{console.log("Data is updated")})},i8e=(n,e)=>{Ow(cm(fm,e+n),null).then(()=>{console.log("Data is deleted"),r8e(e)})},SY=async()=>{const n=cm(fm,"DFD_CODE");return new Promise((e,t)=>{a8(n,i=>{const r=i.val();e(r)},t)})},r8e=n=>{const e=cm(fm,n);a8(e,t=>{const i=t.val();if(i){const r=Object.keys(i).map(o=>({id:parseInt(o,10),...i[o]}));r.sort((o,a)=>o.id-a.id);const s=r.reduce((o,a,l)=>(o[l]={content:a.content},o),{});Ow(e,s).then(()=>{console.log("Blocks indexed correctly")})}})},s8e=async(n,e,t)=>{const i=cm(fm,t),s=(await RPe(i)).val();if(s){const o=Object.keys(s).map(l=>({id:parseInt(l,10),...s[l]}));o.sort((l,u)=>l.id-u.id);const a=o.reduce((l,u)=>(u.id>=n?l[u.id+1]={content:u.content}:l[u.id]={content:u.content},l),{});a[n]={content:e},await Ow(i,a),console.log("New block inserted and blocks reindexed")}},af=ZNe(bY),o8e=async(n,e)=>{try{return await B6e(af,n,e),await hY(af,n,e),!0}catch(t){console.error("Sign up error:",t)}},a8e=async(n,e)=>{try{return await hY(af,n,e),!0}catch(t){console.error("Sign in error:",t)}},l8e=async()=>(await V6e(af),!0);function qw(n,e){return z6e(n,t=>{e(t||null)})}function u8e(){const[n,e]=de.useState(null);de.useEffect(()=>{const i=qw(af,e);return()=>i()},[]);async function t(){try{await l8e()}catch(i){console.error(i)}}return fe.jsxs("div",{children:[fe.jsx("h2",{className:"admin-header",children:fe.jsxs("section",{className:"top-header",children:[fe.jsx("h1",{children:"Design For Displacement Admin"}),fe.jsx(_o,{to:"/",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Main DfD"})}),n?fe.jsxs("div",{children:[fe.jsxs("p",{children:[" Welcome, ",n.email]}),fe.jsx("button",{onClick:t,children:"Sign Out"})]}):fe.jsxs("div",{children:[fe.jsx(_o,{to:"/admin/sign-in",className:"custom-link",children:fe.jsx("h2",{children:"Sign In"})}),fe.jsx(_o,{to:"/admin/sign-up",className:"custom-link",children:fe.jsx("h2",{children:"Sign up"})})]})]})}),fe.jsxs("div",{className:"sections",children:[fe.jsx("section",{className:"macro-section",children:fe.jsx(_o,{to:"/admin/macro",className:"custom-link",children:fe.jsx("h2",{children:"Macro"})})}),fe.jsx("section",{className:"meso-section",children:fe.jsx(_o,{to:"/admin/meso",className:"custom-link",children:fe.jsx("h2",{children:"Meso"})})}),fe.jsx("section",{className:"micro-section",children:fe.jsx(_o,{to:"/admin/micro",className:"custom-link",children:fe.jsx("h2",{children:"Micro"})})})]})]})}var c8e=Object.create,h8e=Object.getPrototypeOf,d9=Object.defineProperty,f8e=Object.getOwnPropertyNames,d8e=Object.prototype.hasOwnProperty,p8e=(n,e,t)=>{t=n!=null?c8e(h8e(n)):{};const i=d9(t,"default",{value:n,enumerable:!0});for(let r of f8e(n))d8e.call(i,r)||d9(i,r,{get:()=>n[r],enumerable:!0});return i},g8=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),A8e=g8((n,e)=>{e.exports={quot:'"',amp:"&",apos:"'",lt:"<",gt:">",nbsp:"",iexcl:"",cent:"",pound:"",curren:"",yen:"",brvbar:"",sect:"",uml:"",copy:"",ordf:"",laquo:"",not:"",shy:"",reg:"",macr:"",deg:"",plusmn:"",sup2:"",sup3:"",acute:"",micro:"",para:"",middot:"",cedil:"",sup1:"",ordm:"",raquo:"",frac14:"",frac12:"",frac34:"",iquest:"",Agrave:"",Aacute:"",Acirc:"",Atilde:"",Auml:"",Aring:"",AElig:"",Ccedil:"",Egrave:"",Eacute:"",Ecirc:"",Euml:"",Igrave:"",Iacute:"",Icirc:"",Iuml:"",ETH:"",Ntilde:"",Ograve:"",Oacute:"",Ocirc:"",Otilde:"",Ouml:"",times:"",Oslash:"",Ugrave:"",Uacute:"",Ucirc:"",Uuml:"",Yacute:"",THORN:"",szlig:"",agrave:"",aacute:"",acirc:"",atilde:"",auml:"",aring:"",aelig:"",ccedil:"",egrave:"",eacute:"",ecirc:"",euml:"",igrave:"",iacute:"",icirc:"",iuml:"",eth:"",ntilde:"",ograve:"",oacute:"",ocirc:"",otilde:"",ouml:"",divide:"",oslash:"",ugrave:"",uacute:"",ucirc:"",uuml:"",yacute:"",thorn:"",yuml:"",OElig:"",oelig:"",Scaron:"",scaron:"",Yuml:"",fnof:"",circ:"",tilde:"",Alpha:"",Beta:"",Gamma:"",Delta:"",Epsilon:"",Zeta:"",Eta:"",Theta:"",Iota:"",Kappa:"",Lambda:"",Mu:"",Nu:"",Xi:"",Omicron:"",Pi:"",Rho:"",Sigma:"",Tau:"",Upsilon:"",Phi:"",Chi:"",Psi:"",Omega:"",alpha:"",beta:"",gamma:"",delta:"",epsilon:"",zeta:"",eta:"",theta:"",iota:"",kappa:"",lambda:"",mu:"",nu:"",xi:"",omicron:"",pi:"",rho:"",sigmaf:"",sigma:"",tau:"",upsilon:"",phi:"",chi:"",psi:"",omega:"",thetasym:"",upsih:"",piv:"",ensp:"",emsp:"",thinsp:"",zwnj:"",zwj:"",lrm:"",rlm:"",ndash:"",mdash:"",lsquo:"",rsquo:"",sbquo:"",ldquo:"",rdquo:"",bdquo:"",dagger:"",Dagger:"",bull:"",hellip:"",permil:"",prime:"",Prime:"",lsaquo:"",rsaquo:"",oline:"",frasl:"",euro:"",image:"",weierp:"",real:"",trade:"",alefsym:"",larr:"",uarr:"",rarr:"",darr:"",harr:"",crarr:"",lArr:"",uArr:"",rArr:"",dArr:"",hArr:"",forall:"",part:"",exist:"",empty:"",nabla:"",isin:"",notin:"",ni:"",prod:"",sum:"",minus:"",lowast:"",radic:"",prop:"",infin:"",ang:"",and:"",or:"",cap:"",cup:"",int:"",there4:"",sim:"",cong:"",asymp:"",ne:"",equiv:"",le:"",ge:"",sub:"",sup:"",nsub:"",sube:"",supe:"",oplus:"",otimes:"",perp:"",sdot:"",lceil:"",rceil:"",lfloor:"",rfloor:"",lang:"",rang:"",loz:"",spades:"",clubs:"",hearts:"",diams:""}}),p9=g8((n,e)=>{(function(t,i){typeof n=="object"&&typeof e<"u"?i(n):typeof define=="function"&&define.amd?define(["exports"],i):(t=typeof globalThis<"u"?globalThis:t||self,i(t.acorn={}))})(n,function(t){var i=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],r=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],s="-----------------------------------------------------------------------------------------------------------------------------------------------------",o="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",a={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},l="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",u={5:l,"5module":l+" export import",6:l+" const class extends export import super"},c=/^in(stanceof)?$/,h=new RegExp("["+o+"]"),A=new RegExp("["+o+s+"]");function v(y,I){for(var G=65536,H=0;H<I.length;H+=2){if(G+=I[H],G>y)return!1;if(G+=I[H+1],G>=y)return!0}return!1}function _(y,I){return y<65?y===36:y<91?!0:y<97?y===95:y<123?!0:y<=65535?y>=170&&h.test(String.fromCharCode(y)):I===!1?!1:v(y,r)}function S(y,I){return y<48?y===36:y<58?!0:y<65?!1:y<91?!0:y<97?y===95:y<123?!0:y<=65535?y>=170&&A.test(String.fromCharCode(y)):I===!1?!1:v(y,r)||v(y,i)}var w=function(I,G){G===void 0&&(G={}),this.label=I,this.keyword=G.keyword,this.beforeExpr=!!G.beforeExpr,this.startsExpr=!!G.startsExpr,this.isLoop=!!G.isLoop,this.isAssign=!!G.isAssign,this.prefix=!!G.prefix,this.postfix=!!G.postfix,this.binop=G.binop||null,this.updateContext=null};function x(y,I){return new w(y,{beforeExpr:!0,binop:I})}var M={beforeExpr:!0},R={startsExpr:!0},N={};function B(y,I){return I===void 0&&(I={}),I.keyword=y,N[y]=new w(y,I)}var T={num:new w("num",R),regexp:new w("regexp",R),string:new w("string",R),name:new w("name",R),privateId:new w("privateId",R),eof:new w("eof"),bracketL:new w("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new w("]"),braceL:new w("{",{beforeExpr:!0,startsExpr:!0}),braceR:new w("}"),parenL:new w("(",{beforeExpr:!0,startsExpr:!0}),parenR:new w(")"),comma:new w(",",M),semi:new w(";",M),colon:new w(":",M),dot:new w("."),question:new w("?",M),questionDot:new w("?."),arrow:new w("=>",M),template:new w("template"),invalidTemplate:new w("invalidTemplate"),ellipsis:new w("...",M),backQuote:new w("`",R),dollarBraceL:new w("${",{beforeExpr:!0,startsExpr:!0}),eq:new w("=",{beforeExpr:!0,isAssign:!0}),assign:new w("_=",{beforeExpr:!0,isAssign:!0}),incDec:new w("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new w("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:x("||",1),logicalAND:x("&&",2),bitwiseOR:x("|",3),bitwiseXOR:x("^",4),bitwiseAND:x("&",5),equality:x("==/!=/===/!==",6),relational:x("</>/<=/>=",7),bitShift:x("<</>>/>>>",8),plusMin:new w("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:x("%",10),star:x("*",10),slash:x("/",10),starstar:new w("**",{beforeExpr:!0}),coalesce:x("??",1),_break:B("break"),_case:B("case",M),_catch:B("catch"),_continue:B("continue"),_debugger:B("debugger"),_default:B("default",M),_do:B("do",{isLoop:!0,beforeExpr:!0}),_else:B("else",M),_finally:B("finally"),_for:B("for",{isLoop:!0}),_function:B("function",R),_if:B("if"),_return:B("return",M),_switch:B("switch"),_throw:B("throw",M),_try:B("try"),_var:B("var"),_const:B("const"),_while:B("while",{isLoop:!0}),_with:B("with"),_new:B("new",{beforeExpr:!0,startsExpr:!0}),_this:B("this",R),_super:B("super",R),_class:B("class",R),_extends:B("extends",M),_export:B("export"),_import:B("import",R),_null:B("null",R),_true:B("true",R),_false:B("false",R),_in:B("in",{beforeExpr:!0,binop:7}),_instanceof:B("instanceof",{beforeExpr:!0,binop:7}),_typeof:B("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:B("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:B("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},D=/\r\n?|\n|\u2028|\u2029/,F=new RegExp(D.source,"g");function L(y){return y===10||y===13||y===8232||y===8233}function O(y,I,G){G===void 0&&(G=y.length);for(var H=I;H<G;H++){var se=y.charCodeAt(H);if(L(se))return H<G-1&&se===13&&y.charCodeAt(H+1)===10?H+2:H+1}return-1}var z=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Q=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,j=Object.prototype,ee=j.hasOwnProperty,$=j.toString,Z=Object.hasOwn||function(y,I){return ee.call(y,I)},ce=Array.isArray||function(y){return $.call(y)==="[object Array]"},ie=Object.create(null);function oe(y){return ie[y]||(ie[y]=new RegExp("^(?:"+y.replace(/ /g,"|")+")$"))}function me(y){return y<=65535?String.fromCharCode(y):(y-=65536,String.fromCharCode((y>>10)+55296,(y&1023)+56320))}var _e=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Oe=function(I,G){this.line=I,this.column=G};Oe.prototype.offset=function(I){return new Oe(this.line,this.column+I)};var Ke=function(I,G,H){this.start=G,this.end=H,I.sourceFile!==null&&(this.source=I.sourceFile)};function Me(y,I){for(var G=1,H=0;;){var se=O(y,H,I);if(se<0)return new Oe(G,I-H);++G,H=se}}var ze={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},nt=!1;function tt(y){var I={};for(var G in ze)I[G]=y&&Z(y,G)?y[G]:ze[G];if(I.ecmaVersion==="latest"?I.ecmaVersion=1e8:I.ecmaVersion==null?(!nt&&typeof console=="object"&&console.warn&&(nt=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),I.ecmaVersion=11):I.ecmaVersion>=2015&&(I.ecmaVersion-=2009),I.allowReserved==null&&(I.allowReserved=I.ecmaVersion<5),(!y||y.allowHashBang==null)&&(I.allowHashBang=I.ecmaVersion>=14),ce(I.onToken)){var H=I.onToken;I.onToken=function(se){return H.push(se)}}return ce(I.onComment)&&(I.onComment=Ot(I,I.onComment)),I}function Ot(y,I){return function(G,H,se,Ce,Le,At){var bt={type:G?"Block":"Line",value:H,start:se,end:Ce};y.locations&&(bt.loc=new Ke(this,Le,At)),y.ranges&&(bt.range=[se,Ce]),I.push(bt)}}var Ht=1,Ct=2,en=4,Ze=8,at=16,ue=32,zt=64,st=128,xt=256,ht=Ht|Ct|xt;function Yt(y,I){return Ct|(y?en:0)|(I?Ze:0)}var Nt=0,re=1,W=2,Ne=3,He=4,et=5,Be=function(I,G,H){this.options=I=tt(I),this.sourceFile=I.sourceFile,this.keywords=oe(u[I.ecmaVersion>=6?6:I.sourceType==="module"?"5module":5]);var se="";I.allowReserved!==!0&&(se=a[I.ecmaVersion>=6?6:I.ecmaVersion===5?5:3],I.sourceType==="module"&&(se+=" await")),this.reservedWords=oe(se);var Ce=(se?se+" ":"")+a.strict;this.reservedWordsStrict=oe(Ce),this.reservedWordsStrictBind=oe(Ce+" "+a.strictBind),this.input=String(G),this.containsEsc=!1,H?(this.pos=H,this.lineStart=this.input.lastIndexOf(`
`,H-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(D).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=T.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=I.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&I.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Ht),this.regexpState=null,this.privateNameStack=[]},It={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Be.prototype.parse=function(){var I=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(I)},It.inFunction.get=function(){return(this.currentVarScope().flags&Ct)>0},It.inGenerator.get=function(){return(this.currentVarScope().flags&Ze)>0&&!this.currentVarScope().inClassFieldInit},It.inAsync.get=function(){return(this.currentVarScope().flags&en)>0&&!this.currentVarScope().inClassFieldInit},It.canAwait.get=function(){for(var y=this.scopeStack.length-1;y>=0;y--){var I=this.scopeStack[y];if(I.inClassFieldInit||I.flags&xt)return!1;if(I.flags&Ct)return(I.flags&en)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},It.allowSuper.get=function(){var y=this.currentThisScope(),I=y.flags,G=y.inClassFieldInit;return(I&zt)>0||G||this.options.allowSuperOutsideMethod},It.allowDirectSuper.get=function(){return(this.currentThisScope().flags&st)>0},It.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},It.allowNewDotTarget.get=function(){var y=this.currentThisScope(),I=y.flags,G=y.inClassFieldInit;return(I&(Ct|xt))>0||G},It.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&xt)>0},Be.extend=function(){for(var I=[],G=arguments.length;G--;)I[G]=arguments[G];for(var H=this,se=0;se<I.length;se++)H=I[se](H);return H},Be.parse=function(I,G){return new this(G,I).parse()},Be.parseExpressionAt=function(I,G,H){var se=new this(H,I,G);return se.nextToken(),se.parseExpression()},Be.tokenizer=function(I,G){return new this(G,I)},Object.defineProperties(Be.prototype,It);var ut=Be.prototype,Dt=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;ut.strictDirective=function(y){if(this.options.ecmaVersion<5)return!1;for(;;){Q.lastIndex=y,y+=Q.exec(this.input)[0].length;var I=Dt.exec(this.input.slice(y));if(!I)return!1;if((I[1]||I[2])==="use strict"){Q.lastIndex=y+I[0].length;var G=Q.exec(this.input),H=G.index+G[0].length,se=this.input.charAt(H);return se===";"||se==="}"||D.test(G[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(se)||se==="!"&&this.input.charAt(H+1)==="=")}y+=I[0].length,Q.lastIndex=y,y+=Q.exec(this.input)[0].length,this.input[y]===";"&&y++}},ut.eat=function(y){return this.type===y?(this.next(),!0):!1},ut.isContextual=function(y){return this.type===T.name&&this.value===y&&!this.containsEsc},ut.eatContextual=function(y){return this.isContextual(y)?(this.next(),!0):!1},ut.expectContextual=function(y){this.eatContextual(y)||this.unexpected()},ut.canInsertSemicolon=function(){return this.type===T.eof||this.type===T.braceR||D.test(this.input.slice(this.lastTokEnd,this.start))},ut.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},ut.semicolon=function(){!this.eat(T.semi)&&!this.insertSemicolon()&&this.unexpected()},ut.afterTrailingComma=function(y,I){if(this.type===y)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),I||this.next(),!0},ut.expect=function(y){this.eat(y)||this.unexpected()},ut.unexpected=function(y){this.raise(y??this.start,"Unexpected token")};var _n=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};ut.checkPatternErrors=function(y,I){if(y){y.trailingComma>-1&&this.raiseRecoverable(y.trailingComma,"Comma is not permitted after the rest element");var G=I?y.parenthesizedAssign:y.parenthesizedBind;G>-1&&this.raiseRecoverable(G,I?"Assigning to rvalue":"Parenthesized pattern")}},ut.checkExpressionErrors=function(y,I){if(!y)return!1;var G=y.shorthandAssign,H=y.doubleProto;if(!I)return G>=0||H>=0;G>=0&&this.raise(G,"Shorthand property assignments are valid only in destructuring patterns"),H>=0&&this.raiseRecoverable(H,"Redefinition of __proto__ property")},ut.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},ut.isSimpleAssignTarget=function(y){return y.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(y.expression):y.type==="Identifier"||y.type==="MemberExpression"};var ke=Be.prototype;ke.parseTopLevel=function(y){var I=Object.create(null);for(y.body||(y.body=[]);this.type!==T.eof;){var G=this.parseStatement(null,!0,I);y.body.push(G)}if(this.inModule)for(var H=0,se=Object.keys(this.undefinedExports);H<se.length;H+=1){var Ce=se[H];this.raiseRecoverable(this.undefinedExports[Ce].start,"Export '"+Ce+"' is not defined")}return this.adaptDirectivePrologue(y.body),this.next(),y.sourceType=this.options.sourceType,this.finishNode(y,"Program")};var Lt={kind:"loop"},Zt={kind:"switch"};ke.isLet=function(y){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Q.lastIndex=this.pos;var I=Q.exec(this.input),G=this.pos+I[0].length,H=this.input.charCodeAt(G);if(H===91||H===92)return!0;if(y)return!1;if(H===123||H>55295&&H<56320)return!0;if(_(H,!0)){for(var se=G+1;S(H=this.input.charCodeAt(se),!0);)++se;if(H===92||H>55295&&H<56320)return!0;var Ce=this.input.slice(G,se);if(!c.test(Ce))return!0}return!1},ke.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Q.lastIndex=this.pos;var y=Q.exec(this.input),I=this.pos+y[0].length,G;return!D.test(this.input.slice(this.pos,I))&&this.input.slice(I,I+8)==="function"&&(I+8===this.input.length||!(S(G=this.input.charCodeAt(I+8))||G>55295&&G<56320))},ke.parseStatement=function(y,I,G){var H=this.type,se=this.startNode(),Ce;switch(this.isLet(y)&&(H=T._var,Ce="let"),H){case T._break:case T._continue:return this.parseBreakContinueStatement(se,H.keyword);case T._debugger:return this.parseDebuggerStatement(se);case T._do:return this.parseDoStatement(se);case T._for:return this.parseForStatement(se);case T._function:return y&&(this.strict||y!=="if"&&y!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(se,!1,!y);case T._class:return y&&this.unexpected(),this.parseClass(se,!0);case T._if:return this.parseIfStatement(se);case T._return:return this.parseReturnStatement(se);case T._switch:return this.parseSwitchStatement(se);case T._throw:return this.parseThrowStatement(se);case T._try:return this.parseTryStatement(se);case T._const:case T._var:return Ce=Ce||this.value,y&&Ce!=="var"&&this.unexpected(),this.parseVarStatement(se,Ce);case T._while:return this.parseWhileStatement(se);case T._with:return this.parseWithStatement(se);case T.braceL:return this.parseBlock(!0,se);case T.semi:return this.parseEmptyStatement(se);case T._export:case T._import:if(this.options.ecmaVersion>10&&H===T._import){Q.lastIndex=this.pos;var Le=Q.exec(this.input),At=this.pos+Le[0].length,bt=this.input.charCodeAt(At);if(bt===40||bt===46)return this.parseExpressionStatement(se,this.parseExpression())}return this.options.allowImportExportEverywhere||(I||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),H===T._import?this.parseImport(se):this.parseExport(se,G);default:if(this.isAsyncFunction())return y&&this.unexpected(),this.next(),this.parseFunctionStatement(se,!0,!y);var yn=this.value,nn=this.parseExpression();return H===T.name&&nn.type==="Identifier"&&this.eat(T.colon)?this.parseLabeledStatement(se,yn,nn,y):this.parseExpressionStatement(se,nn)}},ke.parseBreakContinueStatement=function(y,I){var G=I==="break";this.next(),this.eat(T.semi)||this.insertSemicolon()?y.label=null:this.type!==T.name?this.unexpected():(y.label=this.parseIdent(),this.semicolon());for(var H=0;H<this.labels.length;++H){var se=this.labels[H];if((y.label==null||se.name===y.label.name)&&(se.kind!=null&&(G||se.kind==="loop")||y.label&&G))break}return H===this.labels.length&&this.raise(y.start,"Unsyntactic "+I),this.finishNode(y,G?"BreakStatement":"ContinueStatement")},ke.parseDebuggerStatement=function(y){return this.next(),this.semicolon(),this.finishNode(y,"DebuggerStatement")},ke.parseDoStatement=function(y){return this.next(),this.labels.push(Lt),y.body=this.parseStatement("do"),this.labels.pop(),this.expect(T._while),y.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(T.semi):this.semicolon(),this.finishNode(y,"DoWhileStatement")},ke.parseForStatement=function(y){this.next();var I=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Lt),this.enterScope(0),this.expect(T.parenL),this.type===T.semi)return I>-1&&this.unexpected(I),this.parseFor(y,null);var G=this.isLet();if(this.type===T._var||this.type===T._const||G){var H=this.startNode(),se=G?"let":this.value;return this.next(),this.parseVar(H,!0,se),this.finishNode(H,"VariableDeclaration"),(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&H.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===T._in?I>-1&&this.unexpected(I):y.await=I>-1),this.parseForIn(y,H)):(I>-1&&this.unexpected(I),this.parseFor(y,H))}var Ce=this.isContextual("let"),Le=!1,At=this.containsEsc,bt=new _n,yn=this.start,nn=I>-1?this.parseExprSubscripts(bt,"await"):this.parseExpression(!0,bt);return this.type===T._in||(Le=this.options.ecmaVersion>=6&&this.isContextual("of"))?(I>-1?(this.type===T._in&&this.unexpected(I),y.await=!0):Le&&this.options.ecmaVersion>=8&&(nn.start===yn&&!At&&nn.type==="Identifier"&&nn.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(y.await=!1)),Ce&&Le&&this.raise(nn.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(nn,!1,bt),this.checkLValPattern(nn),this.parseForIn(y,nn)):(this.checkExpressionErrors(bt,!0),I>-1&&this.unexpected(I),this.parseFor(y,nn))},ke.parseFunctionStatement=function(y,I,G){return this.next(),this.parseFunction(y,kt|(G?0:Mn),!1,I)},ke.parseIfStatement=function(y){return this.next(),y.test=this.parseParenExpression(),y.consequent=this.parseStatement("if"),y.alternate=this.eat(T._else)?this.parseStatement("if"):null,this.finishNode(y,"IfStatement")},ke.parseReturnStatement=function(y){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(T.semi)||this.insertSemicolon()?y.argument=null:(y.argument=this.parseExpression(),this.semicolon()),this.finishNode(y,"ReturnStatement")},ke.parseSwitchStatement=function(y){this.next(),y.discriminant=this.parseParenExpression(),y.cases=[],this.expect(T.braceL),this.labels.push(Zt),this.enterScope(0);for(var I,G=!1;this.type!==T.braceR;)if(this.type===T._case||this.type===T._default){var H=this.type===T._case;I&&this.finishNode(I,"SwitchCase"),y.cases.push(I=this.startNode()),I.consequent=[],this.next(),H?I.test=this.parseExpression():(G&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),G=!0,I.test=null),this.expect(T.colon)}else I||this.unexpected(),I.consequent.push(this.parseStatement(null));return this.exitScope(),I&&this.finishNode(I,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(y,"SwitchStatement")},ke.parseThrowStatement=function(y){return this.next(),D.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),y.argument=this.parseExpression(),this.semicolon(),this.finishNode(y,"ThrowStatement")};var tn=[];ke.parseCatchClauseParam=function(){var y=this.parseBindingAtom(),I=y.type==="Identifier";return this.enterScope(I?ue:0),this.checkLValPattern(y,I?He:W),this.expect(T.parenR),y},ke.parseTryStatement=function(y){if(this.next(),y.block=this.parseBlock(),y.handler=null,this.type===T._catch){var I=this.startNode();this.next(),this.eat(T.parenL)?I.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),I.param=null,this.enterScope(0)),I.body=this.parseBlock(!1),this.exitScope(),y.handler=this.finishNode(I,"CatchClause")}return y.finalizer=this.eat(T._finally)?this.parseBlock():null,!y.handler&&!y.finalizer&&this.raise(y.start,"Missing catch or finally clause"),this.finishNode(y,"TryStatement")},ke.parseVarStatement=function(y,I,G){return this.next(),this.parseVar(y,!1,I,G),this.semicolon(),this.finishNode(y,"VariableDeclaration")},ke.parseWhileStatement=function(y){return this.next(),y.test=this.parseParenExpression(),this.labels.push(Lt),y.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(y,"WhileStatement")},ke.parseWithStatement=function(y){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),y.object=this.parseParenExpression(),y.body=this.parseStatement("with"),this.finishNode(y,"WithStatement")},ke.parseEmptyStatement=function(y){return this.next(),this.finishNode(y,"EmptyStatement")},ke.parseLabeledStatement=function(y,I,G,H){for(var se=0,Ce=this.labels;se<Ce.length;se+=1){var Le=Ce[se];Le.name===I&&this.raise(G.start,"Label '"+I+"' is already declared")}for(var At=this.type.isLoop?"loop":this.type===T._switch?"switch":null,bt=this.labels.length-1;bt>=0;bt--){var yn=this.labels[bt];if(yn.statementStart===y.start)yn.statementStart=this.start,yn.kind=At;else break}return this.labels.push({name:I,kind:At,statementStart:this.start}),y.body=this.parseStatement(H?H.indexOf("label")===-1?H+"label":H:"label"),this.labels.pop(),y.label=G,this.finishNode(y,"LabeledStatement")},ke.parseExpressionStatement=function(y,I){return y.expression=I,this.semicolon(),this.finishNode(y,"ExpressionStatement")},ke.parseBlock=function(y,I,G){for(y===void 0&&(y=!0),I===void 0&&(I=this.startNode()),I.body=[],this.expect(T.braceL),y&&this.enterScope(0);this.type!==T.braceR;){var H=this.parseStatement(null);I.body.push(H)}return G&&(this.strict=!1),this.next(),y&&this.exitScope(),this.finishNode(I,"BlockStatement")},ke.parseFor=function(y,I){return y.init=I,this.expect(T.semi),y.test=this.type===T.semi?null:this.parseExpression(),this.expect(T.semi),y.update=this.type===T.parenR?null:this.parseExpression(),this.expect(T.parenR),y.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(y,"ForStatement")},ke.parseForIn=function(y,I){var G=this.type===T._in;return this.next(),I.type==="VariableDeclaration"&&I.declarations[0].init!=null&&(!G||this.options.ecmaVersion<8||this.strict||I.kind!=="var"||I.declarations[0].id.type!=="Identifier")&&this.raise(I.start,(G?"for-in":"for-of")+" loop variable declaration may not have an initializer"),y.left=I,y.right=G?this.parseExpression():this.parseMaybeAssign(),this.expect(T.parenR),y.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(y,G?"ForInStatement":"ForOfStatement")},ke.parseVar=function(y,I,G,H){for(y.declarations=[],y.kind=G;;){var se=this.startNode();if(this.parseVarId(se,G),this.eat(T.eq)?se.init=this.parseMaybeAssign(I):!H&&G==="const"&&!(this.type===T._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!H&&se.id.type!=="Identifier"&&!(I&&(this.type===T._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):se.init=null,y.declarations.push(this.finishNode(se,"VariableDeclarator")),!this.eat(T.comma))break}return y},ke.parseVarId=function(y,I){y.id=this.parseBindingAtom(),this.checkLValPattern(y.id,I==="var"?re:W,!1)};var kt=1,Mn=2,pn=4;ke.parseFunction=function(y,I,G,H,se){this.initFunction(y),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!H)&&(this.type===T.star&&I&Mn&&this.unexpected(),y.generator=this.eat(T.star)),this.options.ecmaVersion>=8&&(y.async=!!H),I&kt&&(y.id=I&pn&&this.type!==T.name?null:this.parseIdent(),y.id&&!(I&Mn)&&this.checkLValSimple(y.id,this.strict||y.generator||y.async?this.treatFunctionsAsVar?re:W:Ne));var Ce=this.yieldPos,Le=this.awaitPos,At=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Yt(y.async,y.generator)),I&kt||(y.id=this.type===T.name?this.parseIdent():null),this.parseFunctionParams(y),this.parseFunctionBody(y,G,!1,se),this.yieldPos=Ce,this.awaitPos=Le,this.awaitIdentPos=At,this.finishNode(y,I&kt?"FunctionDeclaration":"FunctionExpression")},ke.parseFunctionParams=function(y){this.expect(T.parenL),y.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},ke.parseClass=function(y,I){this.next();var G=this.strict;this.strict=!0,this.parseClassId(y,I),this.parseClassSuper(y);var H=this.enterClassBody(),se=this.startNode(),Ce=!1;for(se.body=[],this.expect(T.braceL);this.type!==T.braceR;){var Le=this.parseClassElement(y.superClass!==null);Le&&(se.body.push(Le),Le.type==="MethodDefinition"&&Le.kind==="constructor"?(Ce&&this.raiseRecoverable(Le.start,"Duplicate constructor in the same class"),Ce=!0):Le.key&&Le.key.type==="PrivateIdentifier"&&hi(H,Le)&&this.raiseRecoverable(Le.key.start,"Identifier '#"+Le.key.name+"' has already been declared"))}return this.strict=G,this.next(),y.body=this.finishNode(se,"ClassBody"),this.exitClassBody(),this.finishNode(y,I?"ClassDeclaration":"ClassExpression")},ke.parseClassElement=function(y){if(this.eat(T.semi))return null;var I=this.options.ecmaVersion,G=this.startNode(),H="",se=!1,Ce=!1,Le="method",At=!1;if(this.eatContextual("static")){if(I>=13&&this.eat(T.braceL))return this.parseClassStaticBlock(G),G;this.isClassElementNameStart()||this.type===T.star?At=!0:H="static"}if(G.static=At,!H&&I>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===T.star)&&!this.canInsertSemicolon()?Ce=!0:H="async"),!H&&(I>=9||!Ce)&&this.eat(T.star)&&(se=!0),!H&&!Ce&&!se){var bt=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?Le=bt:H=bt)}if(H?(G.computed=!1,G.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),G.key.name=H,this.finishNode(G.key,"Identifier")):this.parseClassElementName(G),I<13||this.type===T.parenL||Le!=="method"||se||Ce){var yn=!G.static&&ve(G,"constructor"),nn=yn&&y;yn&&Le!=="method"&&this.raise(G.key.start,"Constructor can't have get/set modifier"),G.kind=yn?"constructor":Le,this.parseClassMethod(G,se,Ce,nn)}else this.parseClassField(G);return G},ke.isClassElementNameStart=function(){return this.type===T.name||this.type===T.privateId||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword},ke.parseClassElementName=function(y){this.type===T.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),y.computed=!1,y.key=this.parsePrivateIdent()):this.parsePropertyName(y)},ke.parseClassMethod=function(y,I,G,H){var se=y.key;y.kind==="constructor"?(I&&this.raise(se.start,"Constructor can't be a generator"),G&&this.raise(se.start,"Constructor can't be an async method")):y.static&&ve(y,"prototype")&&this.raise(se.start,"Classes may not have a static property named prototype");var Ce=y.value=this.parseMethod(I,G,H);return y.kind==="get"&&Ce.params.length!==0&&this.raiseRecoverable(Ce.start,"getter should have no params"),y.kind==="set"&&Ce.params.length!==1&&this.raiseRecoverable(Ce.start,"setter should have exactly one param"),y.kind==="set"&&Ce.params[0].type==="RestElement"&&this.raiseRecoverable(Ce.params[0].start,"Setter cannot use rest params"),this.finishNode(y,"MethodDefinition")},ke.parseClassField=function(y){if(ve(y,"constructor")?this.raise(y.key.start,"Classes can't have a field named 'constructor'"):y.static&&ve(y,"prototype")&&this.raise(y.key.start,"Classes can't have a static field named 'prototype'"),this.eat(T.eq)){var I=this.currentThisScope(),G=I.inClassFieldInit;I.inClassFieldInit=!0,y.value=this.parseMaybeAssign(),I.inClassFieldInit=G}else y.value=null;return this.semicolon(),this.finishNode(y,"PropertyDefinition")},ke.parseClassStaticBlock=function(y){y.body=[];var I=this.labels;for(this.labels=[],this.enterScope(xt|zt);this.type!==T.braceR;){var G=this.parseStatement(null);y.body.push(G)}return this.next(),this.exitScope(),this.labels=I,this.finishNode(y,"StaticBlock")},ke.parseClassId=function(y,I){this.type===T.name?(y.id=this.parseIdent(),I&&this.checkLValSimple(y.id,W,!1)):(I===!0&&this.unexpected(),y.id=null)},ke.parseClassSuper=function(y){y.superClass=this.eat(T._extends)?this.parseExprSubscripts(null,!1):null},ke.enterClassBody=function(){var y={declared:Object.create(null),used:[]};return this.privateNameStack.push(y),y.declared},ke.exitClassBody=function(){var y=this.privateNameStack.pop(),I=y.declared,G=y.used;if(this.options.checkPrivateFields)for(var H=this.privateNameStack.length,se=H===0?null:this.privateNameStack[H-1],Ce=0;Ce<G.length;++Ce){var Le=G[Ce];Z(I,Le.name)||(se?se.used.push(Le):this.raiseRecoverable(Le.start,"Private field '#"+Le.name+"' must be declared in an enclosing class"))}};function hi(y,I){var G=I.key.name,H=y[G],se="true";return I.type==="MethodDefinition"&&(I.kind==="get"||I.kind==="set")&&(se=(I.static?"s":"i")+I.kind),H==="iget"&&se==="iset"||H==="iset"&&se==="iget"||H==="sget"&&se==="sset"||H==="sset"&&se==="sget"?(y[G]="true",!1):H?!0:(y[G]=se,!1)}function ve(y,I){var G=y.computed,H=y.key;return!G&&(H.type==="Identifier"&&H.name===I||H.type==="Literal"&&H.value===I)}ke.parseExportAllDeclaration=function(y,I){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(y.exported=this.parseModuleExportName(),this.checkExport(I,y.exported,this.lastTokStart)):y.exported=null),this.expectContextual("from"),this.type!==T.string&&this.unexpected(),y.source=this.parseExprAtom(),this.semicolon(),this.finishNode(y,"ExportAllDeclaration")},ke.parseExport=function(y,I){if(this.next(),this.eat(T.star))return this.parseExportAllDeclaration(y,I);if(this.eat(T._default))return this.checkExport(I,"default",this.lastTokStart),y.declaration=this.parseExportDefaultDeclaration(),this.finishNode(y,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())y.declaration=this.parseExportDeclaration(y),y.declaration.type==="VariableDeclaration"?this.checkVariableExport(I,y.declaration.declarations):this.checkExport(I,y.declaration.id,y.declaration.id.start),y.specifiers=[],y.source=null;else{if(y.declaration=null,y.specifiers=this.parseExportSpecifiers(I),this.eatContextual("from"))this.type!==T.string&&this.unexpected(),y.source=this.parseExprAtom();else{for(var G=0,H=y.specifiers;G<H.length;G+=1){var se=H[G];this.checkUnreserved(se.local),this.checkLocalExport(se.local),se.local.type==="Literal"&&this.raise(se.local.start,"A string literal cannot be used as an exported binding without `from`.")}y.source=null}this.semicolon()}return this.finishNode(y,"ExportNamedDeclaration")},ke.parseExportDeclaration=function(y){return this.parseStatement(null)},ke.parseExportDefaultDeclaration=function(){var y;if(this.type===T._function||(y=this.isAsyncFunction())){var I=this.startNode();return this.next(),y&&this.next(),this.parseFunction(I,kt|pn,!1,y)}else if(this.type===T._class){var G=this.startNode();return this.parseClass(G,"nullableID")}else{var H=this.parseMaybeAssign();return this.semicolon(),H}},ke.checkExport=function(y,I,G){y&&(typeof I!="string"&&(I=I.type==="Identifier"?I.name:I.value),Z(y,I)&&this.raiseRecoverable(G,"Duplicate export '"+I+"'"),y[I]=!0)},ke.checkPatternExport=function(y,I){var G=I.type;if(G==="Identifier")this.checkExport(y,I,I.start);else if(G==="ObjectPattern")for(var H=0,se=I.properties;H<se.length;H+=1){var Ce=se[H];this.checkPatternExport(y,Ce)}else if(G==="ArrayPattern")for(var Le=0,At=I.elements;Le<At.length;Le+=1){var bt=At[Le];bt&&this.checkPatternExport(y,bt)}else G==="Property"?this.checkPatternExport(y,I.value):G==="AssignmentPattern"?this.checkPatternExport(y,I.left):G==="RestElement"&&this.checkPatternExport(y,I.argument)},ke.checkVariableExport=function(y,I){if(y)for(var G=0,H=I;G<H.length;G+=1){var se=H[G];this.checkPatternExport(y,se.id)}},ke.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},ke.parseExportSpecifier=function(y){var I=this.startNode();return I.local=this.parseModuleExportName(),I.exported=this.eatContextual("as")?this.parseModuleExportName():I.local,this.checkExport(y,I.exported,I.exported.start),this.finishNode(I,"ExportSpecifier")},ke.parseExportSpecifiers=function(y){var I=[],G=!0;for(this.expect(T.braceL);!this.eat(T.braceR);){if(G)G=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;I.push(this.parseExportSpecifier(y))}return I},ke.parseImport=function(y){return this.next(),this.type===T.string?(y.specifiers=tn,y.source=this.parseExprAtom()):(y.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),y.source=this.type===T.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(y,"ImportDeclaration")},ke.parseImportSpecifier=function(){var y=this.startNode();return y.imported=this.parseModuleExportName(),this.eatContextual("as")?y.local=this.parseIdent():(this.checkUnreserved(y.imported),y.local=y.imported),this.checkLValSimple(y.local,W),this.finishNode(y,"ImportSpecifier")},ke.parseImportDefaultSpecifier=function(){var y=this.startNode();return y.local=this.parseIdent(),this.checkLValSimple(y.local,W),this.finishNode(y,"ImportDefaultSpecifier")},ke.parseImportNamespaceSpecifier=function(){var y=this.startNode();return this.next(),this.expectContextual("as"),y.local=this.parseIdent(),this.checkLValSimple(y.local,W),this.finishNode(y,"ImportNamespaceSpecifier")},ke.parseImportSpecifiers=function(){var y=[],I=!0;if(this.type===T.name&&(y.push(this.parseImportDefaultSpecifier()),!this.eat(T.comma)))return y;if(this.type===T.star)return y.push(this.parseImportNamespaceSpecifier()),y;for(this.expect(T.braceL);!this.eat(T.braceR);){if(I)I=!1;else if(this.expect(T.comma),this.afterTrailingComma(T.braceR))break;y.push(this.parseImportSpecifier())}return y},ke.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===T.string){var y=this.parseLiteral(this.value);return _e.test(y.value)&&this.raise(y.start,"An export name cannot include a lone surrogate."),y}return this.parseIdent(!0)},ke.adaptDirectivePrologue=function(y){for(var I=0;I<y.length&&this.isDirectiveCandidate(y[I]);++I)y[I].directive=y[I].expression.raw.slice(1,-1)},ke.isDirectiveCandidate=function(y){return this.options.ecmaVersion>=5&&y.type==="ExpressionStatement"&&y.expression.type==="Literal"&&typeof y.expression.value=="string"&&(this.input[y.start]==='"'||this.input[y.start]==="'")};var ft=Be.prototype;ft.toAssignable=function(y,I,G){if(this.options.ecmaVersion>=6&&y)switch(y.type){case"Identifier":this.inAsync&&y.name==="await"&&this.raise(y.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":y.type="ObjectPattern",G&&this.checkPatternErrors(G,!0);for(var H=0,se=y.properties;H<se.length;H+=1){var Ce=se[H];this.toAssignable(Ce,I),Ce.type==="RestElement"&&(Ce.argument.type==="ArrayPattern"||Ce.argument.type==="ObjectPattern")&&this.raise(Ce.argument.start,"Unexpected token")}break;case"Property":y.kind!=="init"&&this.raise(y.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(y.value,I);break;case"ArrayExpression":y.type="ArrayPattern",G&&this.checkPatternErrors(G,!0),this.toAssignableList(y.elements,I);break;case"SpreadElement":y.type="RestElement",this.toAssignable(y.argument,I),y.argument.type==="AssignmentPattern"&&this.raise(y.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":y.operator!=="="&&this.raise(y.left.end,"Only '=' operator can be used for specifying default value."),y.type="AssignmentPattern",delete y.operator,this.toAssignable(y.left,I);break;case"ParenthesizedExpression":this.toAssignable(y.expression,I,G);break;case"ChainExpression":this.raiseRecoverable(y.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!I)break;default:this.raise(y.start,"Assigning to rvalue")}else G&&this.checkPatternErrors(G,!0);return y},ft.toAssignableList=function(y,I){for(var G=y.length,H=0;H<G;H++){var se=y[H];se&&this.toAssignable(se,I)}if(G){var Ce=y[G-1];this.options.ecmaVersion===6&&I&&Ce&&Ce.type==="RestElement"&&Ce.argument.type!=="Identifier"&&this.unexpected(Ce.argument.start)}return y},ft.parseSpread=function(y){var I=this.startNode();return this.next(),I.argument=this.parseMaybeAssign(!1,y),this.finishNode(I,"SpreadElement")},ft.parseRestBinding=function(){var y=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==T.name&&this.unexpected(),y.argument=this.parseBindingAtom(),this.finishNode(y,"RestElement")},ft.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case T.bracketL:var y=this.startNode();return this.next(),y.elements=this.parseBindingList(T.bracketR,!0,!0),this.finishNode(y,"ArrayPattern");case T.braceL:return this.parseObj(!0)}return this.parseIdent()},ft.parseBindingList=function(y,I,G,H){for(var se=[],Ce=!0;!this.eat(y);)if(Ce?Ce=!1:this.expect(T.comma),I&&this.type===T.comma)se.push(null);else{if(G&&this.afterTrailingComma(y))break;if(this.type===T.ellipsis){var Le=this.parseRestBinding();this.parseBindingListItem(Le),se.push(Le),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(y);break}else se.push(this.parseAssignableListItem(H))}return se},ft.parseAssignableListItem=function(y){var I=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(I),I},ft.parseBindingListItem=function(y){return y},ft.parseMaybeDefault=function(y,I,G){if(G=G||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(T.eq))return G;var H=this.startNodeAt(y,I);return H.left=G,H.right=this.parseMaybeAssign(),this.finishNode(H,"AssignmentPattern")},ft.checkLValSimple=function(y,I,G){I===void 0&&(I=Nt);var H=I!==Nt;switch(y.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(y.name)&&this.raiseRecoverable(y.start,(H?"Binding ":"Assigning to ")+y.name+" in strict mode"),H&&(I===W&&y.name==="let"&&this.raiseRecoverable(y.start,"let is disallowed as a lexically bound name"),G&&(Z(G,y.name)&&this.raiseRecoverable(y.start,"Argument name clash"),G[y.name]=!0),I!==et&&this.declareName(y.name,I,y.start));break;case"ChainExpression":this.raiseRecoverable(y.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":H&&this.raiseRecoverable(y.start,"Binding member expression");break;case"ParenthesizedExpression":return H&&this.raiseRecoverable(y.start,"Binding parenthesized expression"),this.checkLValSimple(y.expression,I,G);default:this.raise(y.start,(H?"Binding":"Assigning to")+" rvalue")}},ft.checkLValPattern=function(y,I,G){switch(I===void 0&&(I=Nt),y.type){case"ObjectPattern":for(var H=0,se=y.properties;H<se.length;H+=1){var Ce=se[H];this.checkLValInnerPattern(Ce,I,G)}break;case"ArrayPattern":for(var Le=0,At=y.elements;Le<At.length;Le+=1){var bt=At[Le];bt&&this.checkLValInnerPattern(bt,I,G)}break;default:this.checkLValSimple(y,I,G)}},ft.checkLValInnerPattern=function(y,I,G){switch(I===void 0&&(I=Nt),y.type){case"Property":this.checkLValInnerPattern(y.value,I,G);break;case"AssignmentPattern":this.checkLValPattern(y.left,I,G);break;case"RestElement":this.checkLValPattern(y.argument,I,G);break;default:this.checkLValPattern(y,I,G)}};var Fe=function(I,G,H,se,Ce){this.token=I,this.isExpr=!!G,this.preserveSpace=!!H,this.override=se,this.generator=!!Ce},Ve={b_stat:new Fe("{",!1),b_expr:new Fe("{",!0),b_tmpl:new Fe("${",!1),p_stat:new Fe("(",!1),p_expr:new Fe("(",!0),q_tmpl:new Fe("`",!0,!0,function(y){return y.tryReadTemplateToken()}),f_stat:new Fe("function",!1),f_expr:new Fe("function",!0),f_expr_gen:new Fe("function",!0,!1,null,!0),f_gen:new Fe("function",!1,!1,null,!0)},Te=Be.prototype;Te.initialContext=function(){return[Ve.b_stat]},Te.curContext=function(){return this.context[this.context.length-1]},Te.braceIsBlock=function(y){var I=this.curContext();return I===Ve.f_expr||I===Ve.f_stat?!0:y===T.colon&&(I===Ve.b_stat||I===Ve.b_expr)?!I.isExpr:y===T._return||y===T.name&&this.exprAllowed?D.test(this.input.slice(this.lastTokEnd,this.start)):y===T._else||y===T.semi||y===T.eof||y===T.parenR||y===T.arrow?!0:y===T.braceL?I===Ve.b_stat:y===T._var||y===T._const||y===T.name?!1:!this.exprAllowed},Te.inGeneratorContext=function(){for(var y=this.context.length-1;y>=1;y--){var I=this.context[y];if(I.token==="function")return I.generator}return!1},Te.updateContext=function(y){var I,G=this.type;G.keyword&&y===T.dot?this.exprAllowed=!1:(I=G.updateContext)?I.call(this,y):this.exprAllowed=G.beforeExpr},Te.overrideContext=function(y){this.curContext()!==y&&(this.context[this.context.length-1]=y)},T.parenR.updateContext=T.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var y=this.context.pop();y===Ve.b_stat&&this.curContext().token==="function"&&(y=this.context.pop()),this.exprAllowed=!y.isExpr},T.braceL.updateContext=function(y){this.context.push(this.braceIsBlock(y)?Ve.b_stat:Ve.b_expr),this.exprAllowed=!0},T.dollarBraceL.updateContext=function(){this.context.push(Ve.b_tmpl),this.exprAllowed=!0},T.parenL.updateContext=function(y){var I=y===T._if||y===T._for||y===T._with||y===T._while;this.context.push(I?Ve.p_stat:Ve.p_expr),this.exprAllowed=!0},T.incDec.updateContext=function(){},T._function.updateContext=T._class.updateContext=function(y){y.beforeExpr&&y!==T._else&&!(y===T.semi&&this.curContext()!==Ve.p_stat)&&!(y===T._return&&D.test(this.input.slice(this.lastTokEnd,this.start)))&&!((y===T.colon||y===T.braceL)&&this.curContext()===Ve.b_stat)?this.context.push(Ve.f_expr):this.context.push(Ve.f_stat),this.exprAllowed=!1},T.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0},T.backQuote.updateContext=function(){this.curContext()===Ve.q_tmpl?this.context.pop():this.context.push(Ve.q_tmpl),this.exprAllowed=!1},T.star.updateContext=function(y){if(y===T._function){var I=this.context.length-1;this.context[I]===Ve.f_expr?this.context[I]=Ve.f_expr_gen:this.context[I]=Ve.f_gen}this.exprAllowed=!0},T.name.updateContext=function(y){var I=!1;this.options.ecmaVersion>=6&&y!==T.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(I=!0),this.exprAllowed=I};var Ye=Be.prototype;Ye.checkPropClash=function(y,I,G){if(!(this.options.ecmaVersion>=9&&y.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(y.computed||y.method||y.shorthand))){var H=y.key,se;switch(H.type){case"Identifier":se=H.name;break;case"Literal":se=String(H.value);break;default:return}var Ce=y.kind;if(this.options.ecmaVersion>=6){se==="__proto__"&&Ce==="init"&&(I.proto&&(G?G.doubleProto<0&&(G.doubleProto=H.start):this.raiseRecoverable(H.start,"Redefinition of __proto__ property")),I.proto=!0);return}se="$"+se;var Le=I[se];if(Le){var At;Ce==="init"?At=this.strict&&Le.init||Le.get||Le.set:At=Le.init||Le[Ce],At&&this.raiseRecoverable(H.start,"Redefinition of property")}else Le=I[se]={init:!1,get:!1,set:!1};Le[Ce]=!0}},Ye.parseExpression=function(y,I){var G=this.start,H=this.startLoc,se=this.parseMaybeAssign(y,I);if(this.type===T.comma){var Ce=this.startNodeAt(G,H);for(Ce.expressions=[se];this.eat(T.comma);)Ce.expressions.push(this.parseMaybeAssign(y,I));return this.finishNode(Ce,"SequenceExpression")}return se},Ye.parseMaybeAssign=function(y,I,G){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(y);this.exprAllowed=!1}var H=!1,se=-1,Ce=-1,Le=-1;I?(se=I.parenthesizedAssign,Ce=I.trailingComma,Le=I.doubleProto,I.parenthesizedAssign=I.trailingComma=-1):(I=new _n,H=!0);var At=this.start,bt=this.startLoc;(this.type===T.parenL||this.type===T.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=y==="await");var yn=this.parseMaybeConditional(y,I);if(G&&(yn=G.call(this,yn,At,bt)),this.type.isAssign){var nn=this.startNodeAt(At,bt);return nn.operator=this.value,this.type===T.eq&&(yn=this.toAssignable(yn,!1,I)),H||(I.parenthesizedAssign=I.trailingComma=I.doubleProto=-1),I.shorthandAssign>=yn.start&&(I.shorthandAssign=-1),this.type===T.eq?this.checkLValPattern(yn):this.checkLValSimple(yn),nn.left=yn,this.next(),nn.right=this.parseMaybeAssign(y),Le>-1&&(I.doubleProto=Le),this.finishNode(nn,"AssignmentExpression")}else H&&this.checkExpressionErrors(I,!0);return se>-1&&(I.parenthesizedAssign=se),Ce>-1&&(I.trailingComma=Ce),yn},Ye.parseMaybeConditional=function(y,I){var G=this.start,H=this.startLoc,se=this.parseExprOps(y,I);if(this.checkExpressionErrors(I))return se;if(this.eat(T.question)){var Ce=this.startNodeAt(G,H);return Ce.test=se,Ce.consequent=this.parseMaybeAssign(),this.expect(T.colon),Ce.alternate=this.parseMaybeAssign(y),this.finishNode(Ce,"ConditionalExpression")}return se},Ye.parseExprOps=function(y,I){var G=this.start,H=this.startLoc,se=this.parseMaybeUnary(I,!1,!1,y);return this.checkExpressionErrors(I)||se.start===G&&se.type==="ArrowFunctionExpression"?se:this.parseExprOp(se,G,H,-1,y)},Ye.parseExprOp=function(y,I,G,H,se){var Ce=this.type.binop;if(Ce!=null&&(!se||this.type!==T._in)&&Ce>H){var Le=this.type===T.logicalOR||this.type===T.logicalAND,At=this.type===T.coalesce;At&&(Ce=T.logicalAND.binop);var bt=this.value;this.next();var yn=this.start,nn=this.startLoc,cr=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,se),yn,nn,Ce,se),kl=this.buildBinary(I,G,y,cr,bt,Le||At);return(Le&&this.type===T.coalesce||At&&(this.type===T.logicalOR||this.type===T.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(kl,I,G,H,se)}return y},Ye.buildBinary=function(y,I,G,H,se,Ce){H.type==="PrivateIdentifier"&&this.raise(H.start,"Private identifier can only be left side of binary expression");var Le=this.startNodeAt(y,I);return Le.left=G,Le.operator=se,Le.right=H,this.finishNode(Le,Ce?"LogicalExpression":"BinaryExpression")},Ye.parseMaybeUnary=function(y,I,G,H){var se=this.start,Ce=this.startLoc,Le;if(this.isContextual("await")&&this.canAwait)Le=this.parseAwait(H),I=!0;else if(this.type.prefix){var At=this.startNode(),bt=this.type===T.incDec;At.operator=this.value,At.prefix=!0,this.next(),At.argument=this.parseMaybeUnary(null,!0,bt,H),this.checkExpressionErrors(y,!0),bt?this.checkLValSimple(At.argument):this.strict&&At.operator==="delete"&&an(At.argument)?this.raiseRecoverable(At.start,"Deleting local variable in strict mode"):At.operator==="delete"&&bi(At.argument)?this.raiseRecoverable(At.start,"Private fields can not be deleted"):I=!0,Le=this.finishNode(At,bt?"UpdateExpression":"UnaryExpression")}else if(!I&&this.type===T.privateId)(H||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),Le=this.parsePrivateIdent(),this.type!==T._in&&this.unexpected();else{if(Le=this.parseExprSubscripts(y,H),this.checkExpressionErrors(y))return Le;for(;this.type.postfix&&!this.canInsertSemicolon();){var yn=this.startNodeAt(se,Ce);yn.operator=this.value,yn.prefix=!1,yn.argument=Le,this.checkLValSimple(Le),this.next(),Le=this.finishNode(yn,"UpdateExpression")}}if(!G&&this.eat(T.starstar))if(I)this.unexpected(this.lastTokStart);else return this.buildBinary(se,Ce,Le,this.parseMaybeUnary(null,!1,!1,H),"**",!1);else return Le};function an(y){return y.type==="Identifier"||y.type==="ParenthesizedExpression"&&an(y.expression)}function bi(y){return y.type==="MemberExpression"&&y.property.type==="PrivateIdentifier"||y.type==="ChainExpression"&&bi(y.expression)||y.type==="ParenthesizedExpression"&&bi(y.expression)}Ye.parseExprSubscripts=function(y,I){var G=this.start,H=this.startLoc,se=this.parseExprAtom(y,I);if(se.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return se;var Ce=this.parseSubscripts(se,G,H,!1,I);return y&&Ce.type==="MemberExpression"&&(y.parenthesizedAssign>=Ce.start&&(y.parenthesizedAssign=-1),y.parenthesizedBind>=Ce.start&&(y.parenthesizedBind=-1),y.trailingComma>=Ce.start&&(y.trailingComma=-1)),Ce},Ye.parseSubscripts=function(y,I,G,H,se){for(var Ce=this.options.ecmaVersion>=8&&y.type==="Identifier"&&y.name==="async"&&this.lastTokEnd===y.end&&!this.canInsertSemicolon()&&y.end-y.start===5&&this.potentialArrowAt===y.start,Le=!1;;){var At=this.parseSubscript(y,I,G,H,Ce,Le,se);if(At.optional&&(Le=!0),At===y||At.type==="ArrowFunctionExpression"){if(Le){var bt=this.startNodeAt(I,G);bt.expression=At,At=this.finishNode(bt,"ChainExpression")}return At}y=At}},Ye.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(T.arrow)},Ye.parseSubscriptAsyncArrow=function(y,I,G,H){return this.parseArrowExpression(this.startNodeAt(y,I),G,!0,H)},Ye.parseSubscript=function(y,I,G,H,se,Ce,Le){var At=this.options.ecmaVersion>=11,bt=At&&this.eat(T.questionDot);H&&bt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var yn=this.eat(T.bracketL);if(yn||bt&&this.type!==T.parenL&&this.type!==T.backQuote||this.eat(T.dot)){var nn=this.startNodeAt(I,G);nn.object=y,yn?(nn.property=this.parseExpression(),this.expect(T.bracketR)):this.type===T.privateId&&y.type!=="Super"?nn.property=this.parsePrivateIdent():nn.property=this.parseIdent(this.options.allowReserved!=="never"),nn.computed=!!yn,At&&(nn.optional=bt),y=this.finishNode(nn,"MemberExpression")}else if(!H&&this.eat(T.parenL)){var cr=new _n,kl=this.yieldPos,xf=this.awaitPos,Lc=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var cp=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1,cr);if(se&&!bt&&this.shouldParseAsyncArrow())return this.checkPatternErrors(cr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=kl,this.awaitPos=xf,this.awaitIdentPos=Lc,this.parseSubscriptAsyncArrow(I,G,cp,Le);this.checkExpressionErrors(cr,!0),this.yieldPos=kl||this.yieldPos,this.awaitPos=xf||this.awaitPos,this.awaitIdentPos=Lc||this.awaitIdentPos;var Ki=this.startNodeAt(I,G);Ki.callee=y,Ki.arguments=cp,At&&(Ki.optional=bt),y=this.finishNode(Ki,"CallExpression")}else if(this.type===T.backQuote){(bt||Ce)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var po=this.startNodeAt(I,G);po.tag=y,po.quasi=this.parseTemplate({isTagged:!0}),y=this.finishNode(po,"TaggedTemplateExpression")}return y},Ye.parseExprAtom=function(y,I,G){this.type===T.slash&&this.readRegexp();var H,se=this.potentialArrowAt===this.start;switch(this.type){case T._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),H=this.startNode(),this.next(),this.type===T.parenL&&!this.allowDirectSuper&&this.raise(H.start,"super() call outside constructor of a subclass"),this.type!==T.dot&&this.type!==T.bracketL&&this.type!==T.parenL&&this.unexpected(),this.finishNode(H,"Super");case T._this:return H=this.startNode(),this.next(),this.finishNode(H,"ThisExpression");case T.name:var Ce=this.start,Le=this.startLoc,At=this.containsEsc,bt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!At&&bt.name==="async"&&!this.canInsertSemicolon()&&this.eat(T._function))return this.overrideContext(Ve.f_expr),this.parseFunction(this.startNodeAt(Ce,Le),0,!1,!0,I);if(se&&!this.canInsertSemicolon()){if(this.eat(T.arrow))return this.parseArrowExpression(this.startNodeAt(Ce,Le),[bt],!1,I);if(this.options.ecmaVersion>=8&&bt.name==="async"&&this.type===T.name&&!At&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return bt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(T.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(Ce,Le),[bt],!0,I)}return bt;case T.regexp:var yn=this.value;return H=this.parseLiteral(yn.value),H.regex={pattern:yn.pattern,flags:yn.flags},H;case T.num:case T.string:return this.parseLiteral(this.value);case T._null:case T._true:case T._false:return H=this.startNode(),H.value=this.type===T._null?null:this.type===T._true,H.raw=this.type.keyword,this.next(),this.finishNode(H,"Literal");case T.parenL:var nn=this.start,cr=this.parseParenAndDistinguishExpression(se,I);return y&&(y.parenthesizedAssign<0&&!this.isSimpleAssignTarget(cr)&&(y.parenthesizedAssign=nn),y.parenthesizedBind<0&&(y.parenthesizedBind=nn)),cr;case T.bracketL:return H=this.startNode(),this.next(),H.elements=this.parseExprList(T.bracketR,!0,!0,y),this.finishNode(H,"ArrayExpression");case T.braceL:return this.overrideContext(Ve.b_expr),this.parseObj(!1,y);case T._function:return H=this.startNode(),this.next(),this.parseFunction(H,0);case T._class:return this.parseClass(this.startNode(),!1);case T._new:return this.parseNew();case T.backQuote:return this.parseTemplate();case T._import:return this.options.ecmaVersion>=11?this.parseExprImport(G):this.unexpected();default:return this.parseExprAtomDefault()}},Ye.parseExprAtomDefault=function(){this.unexpected()},Ye.parseExprImport=function(y){var I=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===T.parenL&&!y)return this.parseDynamicImport(I);if(this.type===T.dot){var G=this.startNodeAt(I.start,I.loc&&I.loc.start);return G.name="import",I.meta=this.finishNode(G,"Identifier"),this.parseImportMeta(I)}else this.unexpected()},Ye.parseDynamicImport=function(y){if(this.next(),y.source=this.parseMaybeAssign(),!this.eat(T.parenR)){var I=this.start;this.eat(T.comma)&&this.eat(T.parenR)?this.raiseRecoverable(I,"Trailing comma is not allowed in import()"):this.unexpected(I)}return this.finishNode(y,"ImportExpression")},Ye.parseImportMeta=function(y){this.next();var I=this.containsEsc;return y.property=this.parseIdent(!0),y.property.name!=="meta"&&this.raiseRecoverable(y.property.start,"The only valid meta property for import is 'import.meta'"),I&&this.raiseRecoverable(y.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(y.start,"Cannot use 'import.meta' outside a module"),this.finishNode(y,"MetaProperty")},Ye.parseLiteral=function(y){var I=this.startNode();return I.value=y,I.raw=this.input.slice(this.start,this.end),I.raw.charCodeAt(I.raw.length-1)===110&&(I.bigint=I.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(I,"Literal")},Ye.parseParenExpression=function(){this.expect(T.parenL);var y=this.parseExpression();return this.expect(T.parenR),y},Ye.shouldParseArrow=function(y){return!this.canInsertSemicolon()},Ye.parseParenAndDistinguishExpression=function(y,I){var G=this.start,H=this.startLoc,se,Ce=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Le=this.start,At=this.startLoc,bt=[],yn=!0,nn=!1,cr=new _n,kl=this.yieldPos,xf=this.awaitPos,Lc;for(this.yieldPos=0,this.awaitPos=0;this.type!==T.parenR;)if(yn?yn=!1:this.expect(T.comma),Ce&&this.afterTrailingComma(T.parenR,!0)){nn=!0;break}else if(this.type===T.ellipsis){Lc=this.start,bt.push(this.parseParenItem(this.parseRestBinding())),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else bt.push(this.parseMaybeAssign(!1,cr,this.parseParenItem));var cp=this.lastTokEnd,Ki=this.lastTokEndLoc;if(this.expect(T.parenR),y&&this.shouldParseArrow(bt)&&this.eat(T.arrow))return this.checkPatternErrors(cr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=kl,this.awaitPos=xf,this.parseParenArrowList(G,H,bt,I);(!bt.length||nn)&&this.unexpected(this.lastTokStart),Lc&&this.unexpected(Lc),this.checkExpressionErrors(cr,!0),this.yieldPos=kl||this.yieldPos,this.awaitPos=xf||this.awaitPos,bt.length>1?(se=this.startNodeAt(Le,At),se.expressions=bt,this.finishNodeAt(se,"SequenceExpression",cp,Ki)):se=bt[0]}else se=this.parseParenExpression();if(this.options.preserveParens){var po=this.startNodeAt(G,H);return po.expression=se,this.finishNode(po,"ParenthesizedExpression")}else return se},Ye.parseParenItem=function(y){return y},Ye.parseParenArrowList=function(y,I,G,H){return this.parseArrowExpression(this.startNodeAt(y,I),G,!1,H)};var yr=[];Ye.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var y=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===T.dot){var I=this.startNodeAt(y.start,y.loc&&y.loc.start);I.name="new",y.meta=this.finishNode(I,"Identifier"),this.next();var G=this.containsEsc;return y.property=this.parseIdent(!0),y.property.name!=="target"&&this.raiseRecoverable(y.property.start,"The only valid meta property for new is 'new.target'"),G&&this.raiseRecoverable(y.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(y.start,"'new.target' can only be used in functions and class static block"),this.finishNode(y,"MetaProperty")}var H=this.start,se=this.startLoc;return y.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),H,se,!0,!1),this.eat(T.parenL)?y.arguments=this.parseExprList(T.parenR,this.options.ecmaVersion>=8,!1):y.arguments=yr,this.finishNode(y,"NewExpression")},Ye.parseTemplateElement=function(y){var I=y.isTagged,G=this.startNode();return this.type===T.invalidTemplate?(I||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),G.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):G.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),G.tail=this.type===T.backQuote,this.finishNode(G,"TemplateElement")},Ye.parseTemplate=function(y){y===void 0&&(y={});var I=y.isTagged;I===void 0&&(I=!1);var G=this.startNode();this.next(),G.expressions=[];var H=this.parseTemplateElement({isTagged:I});for(G.quasis=[H];!H.tail;)this.type===T.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(T.dollarBraceL),G.expressions.push(this.parseExpression()),this.expect(T.braceR),G.quasis.push(H=this.parseTemplateElement({isTagged:I}));return this.next(),this.finishNode(G,"TemplateLiteral")},Ye.isAsyncProp=function(y){return!y.computed&&y.key.type==="Identifier"&&y.key.name==="async"&&(this.type===T.name||this.type===T.num||this.type===T.string||this.type===T.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===T.star)&&!D.test(this.input.slice(this.lastTokEnd,this.start))},Ye.parseObj=function(y,I){var G=this.startNode(),H=!0,se={};for(G.properties=[],this.next();!this.eat(T.braceR);){if(H)H=!1;else if(this.expect(T.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(T.braceR))break;var Ce=this.parseProperty(y,I);y||this.checkPropClash(Ce,se,I),G.properties.push(Ce)}return this.finishNode(G,y?"ObjectPattern":"ObjectExpression")},Ye.parseProperty=function(y,I){var G=this.startNode(),H,se,Ce,Le;if(this.options.ecmaVersion>=9&&this.eat(T.ellipsis))return y?(G.argument=this.parseIdent(!1),this.type===T.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(G,"RestElement")):(G.argument=this.parseMaybeAssign(!1,I),this.type===T.comma&&I&&I.trailingComma<0&&(I.trailingComma=this.start),this.finishNode(G,"SpreadElement"));this.options.ecmaVersion>=6&&(G.method=!1,G.shorthand=!1,(y||I)&&(Ce=this.start,Le=this.startLoc),y||(H=this.eat(T.star)));var At=this.containsEsc;return this.parsePropertyName(G),!y&&!At&&this.options.ecmaVersion>=8&&!H&&this.isAsyncProp(G)?(se=!0,H=this.options.ecmaVersion>=9&&this.eat(T.star),this.parsePropertyName(G)):se=!1,this.parsePropertyValue(G,y,H,se,Ce,Le,I,At),this.finishNode(G,"Property")},Ye.parseGetterSetter=function(y){y.kind=y.key.name,this.parsePropertyName(y),y.value=this.parseMethod(!1);var I=y.kind==="get"?0:1;if(y.value.params.length!==I){var G=y.value.start;y.kind==="get"?this.raiseRecoverable(G,"getter should have no params"):this.raiseRecoverable(G,"setter should have exactly one param")}else y.kind==="set"&&y.value.params[0].type==="RestElement"&&this.raiseRecoverable(y.value.params[0].start,"Setter cannot use rest params")},Ye.parsePropertyValue=function(y,I,G,H,se,Ce,Le,At){(G||H)&&this.type===T.colon&&this.unexpected(),this.eat(T.colon)?(y.value=I?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,Le),y.kind="init"):this.options.ecmaVersion>=6&&this.type===T.parenL?(I&&this.unexpected(),y.kind="init",y.method=!0,y.value=this.parseMethod(G,H)):!I&&!At&&this.options.ecmaVersion>=5&&!y.computed&&y.key.type==="Identifier"&&(y.key.name==="get"||y.key.name==="set")&&this.type!==T.comma&&this.type!==T.braceR&&this.type!==T.eq?((G||H)&&this.unexpected(),this.parseGetterSetter(y)):this.options.ecmaVersion>=6&&!y.computed&&y.key.type==="Identifier"?((G||H)&&this.unexpected(),this.checkUnreserved(y.key),y.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=se),y.kind="init",I?y.value=this.parseMaybeDefault(se,Ce,this.copyNode(y.key)):this.type===T.eq&&Le?(Le.shorthandAssign<0&&(Le.shorthandAssign=this.start),y.value=this.parseMaybeDefault(se,Ce,this.copyNode(y.key))):y.value=this.copyNode(y.key),y.shorthand=!0):this.unexpected()},Ye.parsePropertyName=function(y){if(this.options.ecmaVersion>=6){if(this.eat(T.bracketL))return y.computed=!0,y.key=this.parseMaybeAssign(),this.expect(T.bracketR),y.key;y.computed=!1}return y.key=this.type===T.num||this.type===T.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},Ye.initFunction=function(y){y.id=null,this.options.ecmaVersion>=6&&(y.generator=y.expression=!1),this.options.ecmaVersion>=8&&(y.async=!1)},Ye.parseMethod=function(y,I,G){var H=this.startNode(),se=this.yieldPos,Ce=this.awaitPos,Le=this.awaitIdentPos;return this.initFunction(H),this.options.ecmaVersion>=6&&(H.generator=y),this.options.ecmaVersion>=8&&(H.async=!!I),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Yt(I,H.generator)|zt|(G?st:0)),this.expect(T.parenL),H.params=this.parseBindingList(T.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(H,!1,!0,!1),this.yieldPos=se,this.awaitPos=Ce,this.awaitIdentPos=Le,this.finishNode(H,"FunctionExpression")},Ye.parseArrowExpression=function(y,I,G,H){var se=this.yieldPos,Ce=this.awaitPos,Le=this.awaitIdentPos;return this.enterScope(Yt(G,!1)|at),this.initFunction(y),this.options.ecmaVersion>=8&&(y.async=!!G),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,y.params=this.toAssignableList(I,!0),this.parseFunctionBody(y,!0,!1,H),this.yieldPos=se,this.awaitPos=Ce,this.awaitIdentPos=Le,this.finishNode(y,"ArrowFunctionExpression")},Ye.parseFunctionBody=function(y,I,G,H){var se=I&&this.type!==T.braceL,Ce=this.strict,Le=!1;if(se)y.body=this.parseMaybeAssign(H),y.expression=!0,this.checkParams(y,!1);else{var At=this.options.ecmaVersion>=7&&!this.isSimpleParamList(y.params);(!Ce||At)&&(Le=this.strictDirective(this.end),Le&&At&&this.raiseRecoverable(y.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var bt=this.labels;this.labels=[],Le&&(this.strict=!0),this.checkParams(y,!Ce&&!Le&&!I&&!G&&this.isSimpleParamList(y.params)),this.strict&&y.id&&this.checkLValSimple(y.id,et),y.body=this.parseBlock(!1,void 0,Le&&!Ce),y.expression=!1,this.adaptDirectivePrologue(y.body.body),this.labels=bt}this.exitScope()},Ye.isSimpleParamList=function(y){for(var I=0,G=y;I<G.length;I+=1){var H=G[I];if(H.type!=="Identifier")return!1}return!0},Ye.checkParams=function(y,I){for(var G=Object.create(null),H=0,se=y.params;H<se.length;H+=1){var Ce=se[H];this.checkLValInnerPattern(Ce,re,I?null:G)}},Ye.parseExprList=function(y,I,G,H){for(var se=[],Ce=!0;!this.eat(y);){if(Ce)Ce=!1;else if(this.expect(T.comma),I&&this.afterTrailingComma(y))break;var Le=void 0;G&&this.type===T.comma?Le=null:this.type===T.ellipsis?(Le=this.parseSpread(H),H&&this.type===T.comma&&H.trailingComma<0&&(H.trailingComma=this.start)):Le=this.parseMaybeAssign(!1,H),se.push(Le)}return se},Ye.checkUnreserved=function(y){var I=y.start,G=y.end,H=y.name;if(this.inGenerator&&H==="yield"&&this.raiseRecoverable(I,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&H==="await"&&this.raiseRecoverable(I,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&H==="arguments"&&this.raiseRecoverable(I,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(H==="arguments"||H==="await")&&this.raise(I,"Cannot use "+H+" in class static initialization block"),this.keywords.test(H)&&this.raise(I,"Unexpected keyword '"+H+"'"),!(this.options.ecmaVersion<6&&this.input.slice(I,G).indexOf("\\")!==-1)){var se=this.strict?this.reservedWordsStrict:this.reservedWords;se.test(H)&&(!this.inAsync&&H==="await"&&this.raiseRecoverable(I,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(I,"The keyword '"+H+"' is reserved"))}},Ye.parseIdent=function(y){var I=this.parseIdentNode();return this.next(!!y),this.finishNode(I,"Identifier"),y||(this.checkUnreserved(I),I.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=I.start)),I},Ye.parseIdentNode=function(){var y=this.startNode();return this.type===T.name?y.name=this.value:this.type.keyword?(y.name=this.type.keyword,(y.name==="class"||y.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=T.name):this.unexpected(),y},Ye.parsePrivateIdent=function(){var y=this.startNode();return this.type===T.privateId?y.name=this.value:this.unexpected(),this.next(),this.finishNode(y,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(y.start,"Private field '#"+y.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(y)),y},Ye.parseYield=function(y){this.yieldPos||(this.yieldPos=this.start);var I=this.startNode();return this.next(),this.type===T.semi||this.canInsertSemicolon()||this.type!==T.star&&!this.type.startsExpr?(I.delegate=!1,I.argument=null):(I.delegate=this.eat(T.star),I.argument=this.parseMaybeAssign(y)),this.finishNode(I,"YieldExpression")},Ye.parseAwait=function(y){this.awaitPos||(this.awaitPos=this.start);var I=this.startNode();return this.next(),I.argument=this.parseMaybeUnary(null,!0,!1,y),this.finishNode(I,"AwaitExpression")};var Fn=Be.prototype;Fn.raise=function(y,I){var G=Me(this.input,y);I+=" ("+G.line+":"+G.column+")";var H=new SyntaxError(I);throw H.pos=y,H.loc=G,H.raisedAt=this.pos,H},Fn.raiseRecoverable=Fn.raise,Fn.curPosition=function(){if(this.options.locations)return new Oe(this.curLine,this.pos-this.lineStart)};var Xi=Be.prototype,lo=function(I){this.flags=I,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};Xi.enterScope=function(y){this.scopeStack.push(new lo(y))},Xi.exitScope=function(){this.scopeStack.pop()},Xi.treatFunctionsAsVarInScope=function(y){return y.flags&Ct||!this.inModule&&y.flags&Ht},Xi.declareName=function(y,I,G){var H=!1;if(I===W){var se=this.currentScope();H=se.lexical.indexOf(y)>-1||se.functions.indexOf(y)>-1||se.var.indexOf(y)>-1,se.lexical.push(y),this.inModule&&se.flags&Ht&&delete this.undefinedExports[y]}else if(I===He){var Ce=this.currentScope();Ce.lexical.push(y)}else if(I===Ne){var Le=this.currentScope();this.treatFunctionsAsVar?H=Le.lexical.indexOf(y)>-1:H=Le.lexical.indexOf(y)>-1||Le.var.indexOf(y)>-1,Le.functions.push(y)}else for(var At=this.scopeStack.length-1;At>=0;--At){var bt=this.scopeStack[At];if(bt.lexical.indexOf(y)>-1&&!(bt.flags&ue&&bt.lexical[0]===y)||!this.treatFunctionsAsVarInScope(bt)&&bt.functions.indexOf(y)>-1){H=!0;break}if(bt.var.push(y),this.inModule&&bt.flags&Ht&&delete this.undefinedExports[y],bt.flags&ht)break}H&&this.raiseRecoverable(G,"Identifier '"+y+"' has already been declared")},Xi.checkLocalExport=function(y){this.scopeStack[0].lexical.indexOf(y.name)===-1&&this.scopeStack[0].var.indexOf(y.name)===-1&&(this.undefinedExports[y.name]=y)},Xi.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Xi.currentVarScope=function(){for(var y=this.scopeStack.length-1;;y--){var I=this.scopeStack[y];if(I.flags&ht)return I}},Xi.currentThisScope=function(){for(var y=this.scopeStack.length-1;;y--){var I=this.scopeStack[y];if(I.flags&ht&&!(I.flags&at))return I}};var Ga=function(I,G,H){this.type="",this.start=G,this.end=0,I.options.locations&&(this.loc=new Ke(I,H)),I.options.directSourceFile&&(this.sourceFile=I.options.directSourceFile),I.options.ranges&&(this.range=[G,0])},Vo=Be.prototype;Vo.startNode=function(){return new Ga(this,this.start,this.startLoc)},Vo.startNodeAt=function(y,I){return new Ga(this,y,I)};function uo(y,I,G,H){return y.type=I,y.end=G,this.options.locations&&(y.loc.end=H),this.options.ranges&&(y.range[1]=G),y}Vo.finishNode=function(y,I){return uo.call(this,y,I,this.lastTokEnd,this.lastTokEndLoc)},Vo.finishNodeAt=function(y,I,G,H){return uo.call(this,y,I,G,H)},Vo.copyNode=function(y){var I=new Ga(this,y.start,this.startLoc);for(var G in y)I[G]=y[G];return I};var co="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Re=co+" Extended_Pictographic",We=Re,dt=We+" EBase EComp EMod EPres ExtPict",jt=dt,p=jt,J={9:co,10:Re,11:We,12:dt,13:jt,14:p},In="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",Yn={9:"",10:"",11:"",12:"",13:"",14:In},Yi="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",An="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",X=An+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",ye=X+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Ee=ye+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",xe=Ee+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",ge=xe+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",ct={9:An,10:X,11:ye,12:Ee,13:xe,14:ge},Mt={};function Vt(y){var I=Mt[y]={binary:oe(J[y]+" "+Yi),binaryOfStrings:oe(Yn[y]),nonBinary:{General_Category:oe(Yi),Script:oe(ct[y])}};I.nonBinary.Script_Extensions=I.nonBinary.Script,I.nonBinary.gc=I.nonBinary.General_Category,I.nonBinary.sc=I.nonBinary.Script,I.nonBinary.scx=I.nonBinary.Script_Extensions}for(var Rt=0,Qt=[9,10,11,12,13,14];Rt<Qt.length;Rt+=1){var Kt=Qt[Rt];Vt(Kt)}var $e=Be.prototype,Dn=function(I,G){this.parent=I,this.base=G||this};Dn.prototype.separatedFrom=function(I){for(var G=this;G;G=G.parent)for(var H=I;H;H=H.parent)if(G.base===H.base&&G!==H)return!0;return!1},Dn.prototype.sibling=function(){return new Dn(this.parent,this.base)};var mn=function(I){this.parser=I,this.validFlags="gim"+(I.options.ecmaVersion>=6?"uy":"")+(I.options.ecmaVersion>=9?"s":"")+(I.options.ecmaVersion>=13?"d":"")+(I.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Mt[I.options.ecmaVersion>=14?14:I.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};mn.prototype.reset=function(I,G,H){var se=H.indexOf("v")!==-1,Ce=H.indexOf("u")!==-1;this.start=I|0,this.source=G+"",this.flags=H,se&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=Ce&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=Ce&&this.parser.options.ecmaVersion>=9)},mn.prototype.raise=function(I){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+I)},mn.prototype.at=function(I,G){G===void 0&&(G=!1);var H=this.source,se=H.length;if(I>=se)return-1;var Ce=H.charCodeAt(I);if(!(G||this.switchU)||Ce<=55295||Ce>=57344||I+1>=se)return Ce;var Le=H.charCodeAt(I+1);return Le>=56320&&Le<=57343?(Ce<<10)+Le-56613888:Ce},mn.prototype.nextIndex=function(I,G){G===void 0&&(G=!1);var H=this.source,se=H.length;if(I>=se)return se;var Ce=H.charCodeAt(I),Le;return!(G||this.switchU)||Ce<=55295||Ce>=57344||I+1>=se||(Le=H.charCodeAt(I+1))<56320||Le>57343?I+1:I+2},mn.prototype.current=function(I){return I===void 0&&(I=!1),this.at(this.pos,I)},mn.prototype.lookahead=function(I){return I===void 0&&(I=!1),this.at(this.nextIndex(this.pos,I),I)},mn.prototype.advance=function(I){I===void 0&&(I=!1),this.pos=this.nextIndex(this.pos,I)},mn.prototype.eat=function(I,G){return G===void 0&&(G=!1),this.current(G)===I?(this.advance(G),!0):!1},mn.prototype.eatChars=function(I,G){G===void 0&&(G=!1);for(var H=this.pos,se=0,Ce=I;se<Ce.length;se+=1){var Le=Ce[se],At=this.at(H,G);if(At===-1||At!==Le)return!1;H=this.nextIndex(H,G)}return this.pos=H,!0},$e.validateRegExpFlags=function(y){for(var I=y.validFlags,G=y.flags,H=!1,se=!1,Ce=0;Ce<G.length;Ce++){var Le=G.charAt(Ce);I.indexOf(Le)===-1&&this.raise(y.start,"Invalid regular expression flag"),G.indexOf(Le,Ce+1)>-1&&this.raise(y.start,"Duplicate regular expression flag"),Le==="u"&&(H=!0),Le==="v"&&(se=!0)}this.options.ecmaVersion>=15&&H&&se&&this.raise(y.start,"Invalid regular expression flag")};function Ft(y){for(var I in y)return!0;return!1}$e.validateRegExpPattern=function(y){this.regexp_pattern(y),!y.switchN&&this.options.ecmaVersion>=9&&Ft(y.groupNames)&&(y.switchN=!0,this.regexp_pattern(y))},$e.regexp_pattern=function(y){y.pos=0,y.lastIntValue=0,y.lastStringValue="",y.lastAssertionIsQuantifiable=!1,y.numCapturingParens=0,y.maxBackReference=0,y.groupNames=Object.create(null),y.backReferenceNames.length=0,y.branchID=null,this.regexp_disjunction(y),y.pos!==y.source.length&&(y.eat(41)&&y.raise("Unmatched ')'"),(y.eat(93)||y.eat(125))&&y.raise("Lone quantifier brackets")),y.maxBackReference>y.numCapturingParens&&y.raise("Invalid escape");for(var I=0,G=y.backReferenceNames;I<G.length;I+=1){var H=G[I];y.groupNames[H]||y.raise("Invalid named capture referenced")}},$e.regexp_disjunction=function(y){var I=this.options.ecmaVersion>=16;for(I&&(y.branchID=new Dn(y.branchID,null)),this.regexp_alternative(y);y.eat(124);)I&&(y.branchID=y.branchID.sibling()),this.regexp_alternative(y);I&&(y.branchID=y.branchID.parent),this.regexp_eatQuantifier(y,!0)&&y.raise("Nothing to repeat"),y.eat(123)&&y.raise("Lone quantifier brackets")},$e.regexp_alternative=function(y){for(;y.pos<y.source.length&&this.regexp_eatTerm(y););},$e.regexp_eatTerm=function(y){return this.regexp_eatAssertion(y)?(y.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(y)&&y.switchU&&y.raise("Invalid quantifier"),!0):(y.switchU?this.regexp_eatAtom(y):this.regexp_eatExtendedAtom(y))?(this.regexp_eatQuantifier(y),!0):!1},$e.regexp_eatAssertion=function(y){var I=y.pos;if(y.lastAssertionIsQuantifiable=!1,y.eat(94)||y.eat(36))return!0;if(y.eat(92)){if(y.eat(66)||y.eat(98))return!0;y.pos=I}if(y.eat(40)&&y.eat(63)){var G=!1;if(this.options.ecmaVersion>=9&&(G=y.eat(60)),y.eat(61)||y.eat(33))return this.regexp_disjunction(y),y.eat(41)||y.raise("Unterminated group"),y.lastAssertionIsQuantifiable=!G,!0}return y.pos=I,!1},$e.regexp_eatQuantifier=function(y,I){return I===void 0&&(I=!1),this.regexp_eatQuantifierPrefix(y,I)?(y.eat(63),!0):!1},$e.regexp_eatQuantifierPrefix=function(y,I){return y.eat(42)||y.eat(43)||y.eat(63)||this.regexp_eatBracedQuantifier(y,I)},$e.regexp_eatBracedQuantifier=function(y,I){var G=y.pos;if(y.eat(123)){var H=0,se=-1;if(this.regexp_eatDecimalDigits(y)&&(H=y.lastIntValue,y.eat(44)&&this.regexp_eatDecimalDigits(y)&&(se=y.lastIntValue),y.eat(125)))return se!==-1&&se<H&&!I&&y.raise("numbers out of order in {} quantifier"),!0;y.switchU&&!I&&y.raise("Incomplete quantifier"),y.pos=G}return!1},$e.regexp_eatAtom=function(y){return this.regexp_eatPatternCharacters(y)||y.eat(46)||this.regexp_eatReverseSolidusAtomEscape(y)||this.regexp_eatCharacterClass(y)||this.regexp_eatUncapturingGroup(y)||this.regexp_eatCapturingGroup(y)},$e.regexp_eatReverseSolidusAtomEscape=function(y){var I=y.pos;if(y.eat(92)){if(this.regexp_eatAtomEscape(y))return!0;y.pos=I}return!1},$e.regexp_eatUncapturingGroup=function(y){var I=y.pos;if(y.eat(40)){if(y.eat(63)&&y.eat(58)){if(this.regexp_disjunction(y),y.eat(41))return!0;y.raise("Unterminated group")}y.pos=I}return!1},$e.regexp_eatCapturingGroup=function(y){if(y.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(y):y.current()===63&&y.raise("Invalid group"),this.regexp_disjunction(y),y.eat(41))return y.numCapturingParens+=1,!0;y.raise("Unterminated group")}return!1},$e.regexp_eatExtendedAtom=function(y){return y.eat(46)||this.regexp_eatReverseSolidusAtomEscape(y)||this.regexp_eatCharacterClass(y)||this.regexp_eatUncapturingGroup(y)||this.regexp_eatCapturingGroup(y)||this.regexp_eatInvalidBracedQuantifier(y)||this.regexp_eatExtendedPatternCharacter(y)},$e.regexp_eatInvalidBracedQuantifier=function(y){return this.regexp_eatBracedQuantifier(y,!0)&&y.raise("Nothing to repeat"),!1},$e.regexp_eatSyntaxCharacter=function(y){var I=y.current();return ne(I)?(y.lastIntValue=I,y.advance(),!0):!1};function ne(y){return y===36||y>=40&&y<=43||y===46||y===63||y>=91&&y<=94||y>=123&&y<=125}$e.regexp_eatPatternCharacters=function(y){for(var I=y.pos,G=0;(G=y.current())!==-1&&!ne(G);)y.advance();return y.pos!==I},$e.regexp_eatExtendedPatternCharacter=function(y){var I=y.current();return I!==-1&&I!==36&&!(I>=40&&I<=43)&&I!==46&&I!==63&&I!==91&&I!==94&&I!==124?(y.advance(),!0):!1},$e.regexp_groupSpecifier=function(y){if(y.eat(63)){this.regexp_eatGroupName(y)||y.raise("Invalid group");var I=this.options.ecmaVersion>=16,G=y.groupNames[y.lastStringValue];if(G)if(I)for(var H=0,se=G;H<se.length;H+=1){var Ce=se[H];Ce.separatedFrom(y.branchID)||y.raise("Duplicate capture group name")}else y.raise("Duplicate capture group name");I?(G||(y.groupNames[y.lastStringValue]=[])).push(y.branchID):y.groupNames[y.lastStringValue]=!0}},$e.regexp_eatGroupName=function(y){if(y.lastStringValue="",y.eat(60)){if(this.regexp_eatRegExpIdentifierName(y)&&y.eat(62))return!0;y.raise("Invalid capture group name")}return!1},$e.regexp_eatRegExpIdentifierName=function(y){if(y.lastStringValue="",this.regexp_eatRegExpIdentifierStart(y)){for(y.lastStringValue+=me(y.lastIntValue);this.regexp_eatRegExpIdentifierPart(y);)y.lastStringValue+=me(y.lastIntValue);return!0}return!1},$e.regexp_eatRegExpIdentifierStart=function(y){var I=y.pos,G=this.options.ecmaVersion>=11,H=y.current(G);return y.advance(G),H===92&&this.regexp_eatRegExpUnicodeEscapeSequence(y,G)&&(H=y.lastIntValue),_t(H)?(y.lastIntValue=H,!0):(y.pos=I,!1)};function _t(y){return _(y,!0)||y===36||y===95}$e.regexp_eatRegExpIdentifierPart=function(y){var I=y.pos,G=this.options.ecmaVersion>=11,H=y.current(G);return y.advance(G),H===92&&this.regexp_eatRegExpUnicodeEscapeSequence(y,G)&&(H=y.lastIntValue),$t(H)?(y.lastIntValue=H,!0):(y.pos=I,!1)};function $t(y){return S(y,!0)||y===36||y===95||y===8204||y===8205}$e.regexp_eatAtomEscape=function(y){return this.regexp_eatBackReference(y)||this.regexp_eatCharacterClassEscape(y)||this.regexp_eatCharacterEscape(y)||y.switchN&&this.regexp_eatKGroupName(y)?!0:(y.switchU&&(y.current()===99&&y.raise("Invalid unicode escape"),y.raise("Invalid escape")),!1)},$e.regexp_eatBackReference=function(y){var I=y.pos;if(this.regexp_eatDecimalEscape(y)){var G=y.lastIntValue;if(y.switchU)return G>y.maxBackReference&&(y.maxBackReference=G),!0;if(G<=y.numCapturingParens)return!0;y.pos=I}return!1},$e.regexp_eatKGroupName=function(y){if(y.eat(107)){if(this.regexp_eatGroupName(y))return y.backReferenceNames.push(y.lastStringValue),!0;y.raise("Invalid named reference")}return!1},$e.regexp_eatCharacterEscape=function(y){return this.regexp_eatControlEscape(y)||this.regexp_eatCControlLetter(y)||this.regexp_eatZero(y)||this.regexp_eatHexEscapeSequence(y)||this.regexp_eatRegExpUnicodeEscapeSequence(y,!1)||!y.switchU&&this.regexp_eatLegacyOctalEscapeSequence(y)||this.regexp_eatIdentityEscape(y)},$e.regexp_eatCControlLetter=function(y){var I=y.pos;if(y.eat(99)){if(this.regexp_eatControlLetter(y))return!0;y.pos=I}return!1},$e.regexp_eatZero=function(y){return y.current()===48&&!ms(y.lookahead())?(y.lastIntValue=0,y.advance(),!0):!1},$e.regexp_eatControlEscape=function(y){var I=y.current();return I===116?(y.lastIntValue=9,y.advance(),!0):I===110?(y.lastIntValue=10,y.advance(),!0):I===118?(y.lastIntValue=11,y.advance(),!0):I===102?(y.lastIntValue=12,y.advance(),!0):I===114?(y.lastIntValue=13,y.advance(),!0):!1},$e.regexp_eatControlLetter=function(y){var I=y.current();return ho(I)?(y.lastIntValue=I%32,y.advance(),!0):!1};function ho(y){return y>=65&&y<=90||y>=97&&y<=122}$e.regexp_eatRegExpUnicodeEscapeSequence=function(y,I){I===void 0&&(I=!1);var G=y.pos,H=I||y.switchU;if(y.eat(117)){if(this.regexp_eatFixedHexDigits(y,4)){var se=y.lastIntValue;if(H&&se>=55296&&se<=56319){var Ce=y.pos;if(y.eat(92)&&y.eat(117)&&this.regexp_eatFixedHexDigits(y,4)){var Le=y.lastIntValue;if(Le>=56320&&Le<=57343)return y.lastIntValue=(se-55296)*1024+(Le-56320)+65536,!0}y.pos=Ce,y.lastIntValue=se}return!0}if(H&&y.eat(123)&&this.regexp_eatHexDigits(y)&&y.eat(125)&&Qn(y.lastIntValue))return!0;H&&y.raise("Invalid unicode escape"),y.pos=G}return!1};function Qn(y){return y>=0&&y<=1114111}$e.regexp_eatIdentityEscape=function(y){if(y.switchU)return this.regexp_eatSyntaxCharacter(y)?!0:y.eat(47)?(y.lastIntValue=47,!0):!1;var I=y.current();return I!==99&&(!y.switchN||I!==107)?(y.lastIntValue=I,y.advance(),!0):!1},$e.regexp_eatDecimalEscape=function(y){y.lastIntValue=0;var I=y.current();if(I>=49&&I<=57){do y.lastIntValue=10*y.lastIntValue+(I-48),y.advance();while((I=y.current())>=48&&I<=57);return!0}return!1};var ps=0,Gr=1,Y=2;$e.regexp_eatCharacterClassEscape=function(y){var I=y.current();if(pu(I))return y.lastIntValue=-1,y.advance(),Gr;var G=!1;if(y.switchU&&this.options.ecmaVersion>=9&&((G=I===80)||I===112)){y.lastIntValue=-1,y.advance();var H;if(y.eat(123)&&(H=this.regexp_eatUnicodePropertyValueExpression(y))&&y.eat(125))return G&&H===Y&&y.raise("Invalid property name"),H;y.raise("Invalid property name")}return ps};function pu(y){return y===100||y===68||y===115||y===83||y===119||y===87}$e.regexp_eatUnicodePropertyValueExpression=function(y){var I=y.pos;if(this.regexp_eatUnicodePropertyName(y)&&y.eat(61)){var G=y.lastStringValue;if(this.regexp_eatUnicodePropertyValue(y)){var H=y.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(y,G,H),Gr}}if(y.pos=I,this.regexp_eatLoneUnicodePropertyNameOrValue(y)){var se=y.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(y,se)}return ps},$e.regexp_validateUnicodePropertyNameAndValue=function(y,I,G){Z(y.unicodeProperties.nonBinary,I)||y.raise("Invalid property name"),y.unicodeProperties.nonBinary[I].test(G)||y.raise("Invalid property value")},$e.regexp_validateUnicodePropertyNameOrValue=function(y,I){if(y.unicodeProperties.binary.test(I))return Gr;if(y.switchV&&y.unicodeProperties.binaryOfStrings.test(I))return Y;y.raise("Invalid property name")},$e.regexp_eatUnicodePropertyName=function(y){var I=0;for(y.lastStringValue="";fi(I=y.current());)y.lastStringValue+=me(I),y.advance();return y.lastStringValue!==""};function fi(y){return ho(y)||y===95}$e.regexp_eatUnicodePropertyValue=function(y){var I=0;for(y.lastStringValue="";fo(I=y.current());)y.lastStringValue+=me(I),y.advance();return y.lastStringValue!==""};function fo(y){return fi(y)||ms(y)}$e.regexp_eatLoneUnicodePropertyNameOrValue=function(y){return this.regexp_eatUnicodePropertyValue(y)},$e.regexp_eatCharacterClass=function(y){if(y.eat(91)){var I=y.eat(94),G=this.regexp_classContents(y);return y.eat(93)||y.raise("Unterminated character class"),I&&G===Y&&y.raise("Negated character class may contain strings"),!0}return!1},$e.regexp_classContents=function(y){return y.current()===93?Gr:y.switchV?this.regexp_classSetExpression(y):(this.regexp_nonEmptyClassRanges(y),Gr)},$e.regexp_nonEmptyClassRanges=function(y){for(;this.regexp_eatClassAtom(y);){var I=y.lastIntValue;if(y.eat(45)&&this.regexp_eatClassAtom(y)){var G=y.lastIntValue;y.switchU&&(I===-1||G===-1)&&y.raise("Invalid character class"),I!==-1&&G!==-1&&I>G&&y.raise("Range out of order in character class")}}},$e.regexp_eatClassAtom=function(y){var I=y.pos;if(y.eat(92)){if(this.regexp_eatClassEscape(y))return!0;if(y.switchU){var G=y.current();(G===99||Aa(G))&&y.raise("Invalid class escape"),y.raise("Invalid escape")}y.pos=I}var H=y.current();return H!==93?(y.lastIntValue=H,y.advance(),!0):!1},$e.regexp_eatClassEscape=function(y){var I=y.pos;if(y.eat(98))return y.lastIntValue=8,!0;if(y.switchU&&y.eat(45))return y.lastIntValue=45,!0;if(!y.switchU&&y.eat(99)){if(this.regexp_eatClassControlLetter(y))return!0;y.pos=I}return this.regexp_eatCharacterClassEscape(y)||this.regexp_eatCharacterEscape(y)},$e.regexp_classSetExpression=function(y){var I=Gr,G;if(!this.regexp_eatClassSetRange(y))if(G=this.regexp_eatClassSetOperand(y)){G===Y&&(I=Y);for(var H=y.pos;y.eatChars([38,38]);){if(y.current()!==38&&(G=this.regexp_eatClassSetOperand(y))){G!==Y&&(I=Gr);continue}y.raise("Invalid character in character class")}if(H!==y.pos)return I;for(;y.eatChars([45,45]);)this.regexp_eatClassSetOperand(y)||y.raise("Invalid character in character class");if(H!==y.pos)return I}else y.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(y)){if(G=this.regexp_eatClassSetOperand(y),!G)return I;G===Y&&(I=Y)}},$e.regexp_eatClassSetRange=function(y){var I=y.pos;if(this.regexp_eatClassSetCharacter(y)){var G=y.lastIntValue;if(y.eat(45)&&this.regexp_eatClassSetCharacter(y)){var H=y.lastIntValue;return G!==-1&&H!==-1&&G>H&&y.raise("Range out of order in character class"),!0}y.pos=I}return!1},$e.regexp_eatClassSetOperand=function(y){return this.regexp_eatClassSetCharacter(y)?Gr:this.regexp_eatClassStringDisjunction(y)||this.regexp_eatNestedClass(y)},$e.regexp_eatNestedClass=function(y){var I=y.pos;if(y.eat(91)){var G=y.eat(94),H=this.regexp_classContents(y);if(y.eat(93))return G&&H===Y&&y.raise("Negated character class may contain strings"),H;y.pos=I}if(y.eat(92)){var se=this.regexp_eatCharacterClassEscape(y);if(se)return se;y.pos=I}return null},$e.regexp_eatClassStringDisjunction=function(y){var I=y.pos;if(y.eatChars([92,113])){if(y.eat(123)){var G=this.regexp_classStringDisjunctionContents(y);if(y.eat(125))return G}else y.raise("Invalid escape");y.pos=I}return null},$e.regexp_classStringDisjunctionContents=function(y){for(var I=this.regexp_classString(y);y.eat(124);)this.regexp_classString(y)===Y&&(I=Y);return I},$e.regexp_classString=function(y){for(var I=0;this.regexp_eatClassSetCharacter(y);)I++;return I===1?Gr:Y},$e.regexp_eatClassSetCharacter=function(y){var I=y.pos;if(y.eat(92))return this.regexp_eatCharacterEscape(y)||this.regexp_eatClassSetReservedPunctuator(y)?!0:y.eat(98)?(y.lastIntValue=8,!0):(y.pos=I,!1);var G=y.current();return G<0||G===y.lookahead()&&Au(G)||As(G)?!1:(y.advance(),y.lastIntValue=G,!0)};function Au(y){return y===33||y>=35&&y<=38||y>=42&&y<=44||y===46||y>=58&&y<=64||y===94||y===96||y===126}function As(y){return y===40||y===41||y===45||y===47||y>=91&&y<=93||y>=123&&y<=125}$e.regexp_eatClassSetReservedPunctuator=function(y){var I=y.current();return pa(I)?(y.lastIntValue=I,y.advance(),!0):!1};function pa(y){return y===33||y===35||y===37||y===38||y===44||y===45||y>=58&&y<=62||y===64||y===96||y===126}$e.regexp_eatClassControlLetter=function(y){var I=y.current();return ms(I)||I===95?(y.lastIntValue=I%32,y.advance(),!0):!1},$e.regexp_eatHexEscapeSequence=function(y){var I=y.pos;if(y.eat(120)){if(this.regexp_eatFixedHexDigits(y,2))return!0;y.switchU&&y.raise("Invalid escape"),y.pos=I}return!1},$e.regexp_eatDecimalDigits=function(y){var I=y.pos,G=0;for(y.lastIntValue=0;ms(G=y.current());)y.lastIntValue=10*y.lastIntValue+(G-48),y.advance();return y.pos!==I};function ms(y){return y>=48&&y<=57}$e.regexp_eatHexDigits=function(y){var I=y.pos,G=0;for(y.lastIntValue=0;kc(G=y.current());)y.lastIntValue=16*y.lastIntValue+mm(G),y.advance();return y.pos!==I};function kc(y){return y>=48&&y<=57||y>=65&&y<=70||y>=97&&y<=102}function mm(y){return y>=65&&y<=70?10+(y-65):y>=97&&y<=102?10+(y-97):y-48}$e.regexp_eatLegacyOctalEscapeSequence=function(y){if(this.regexp_eatOctalDigit(y)){var I=y.lastIntValue;if(this.regexp_eatOctalDigit(y)){var G=y.lastIntValue;I<=3&&this.regexp_eatOctalDigit(y)?y.lastIntValue=I*64+G*8+y.lastIntValue:y.lastIntValue=I*8+G}else y.lastIntValue=I;return!0}return!1},$e.regexp_eatOctalDigit=function(y){var I=y.current();return Aa(I)?(y.lastIntValue=I-48,y.advance(),!0):(y.lastIntValue=0,!1)};function Aa(y){return y>=48&&y<=55}$e.regexp_eatFixedHexDigits=function(y,I){var G=y.pos;y.lastIntValue=0;for(var H=0;H<I;++H){var se=y.current();if(!kc(se))return y.pos=G,!1;y.lastIntValue=16*y.lastIntValue+mm(se),y.advance()}return!0};var Qi=function(I){this.type=I.type,this.value=I.value,this.start=I.start,this.end=I.end,I.options.locations&&(this.loc=new Ke(I,I.startLoc,I.endLoc)),I.options.ranges&&(this.range=[I.start,I.end])},Rn=Be.prototype;Rn.next=function(y){!y&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Qi(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Rn.getToken=function(){return this.next(),new Qi(this)},typeof Symbol<"u"&&(Rn[Symbol.iterator]=function(){var y=this;return{next:function(){var I=y.getToken();return{done:I.type===T.eof,value:I}}}}),Rn.nextToken=function(){var y=this.curContext();if((!y||!y.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(T.eof);if(y.override)return y.override(this);this.readToken(this.fullCharCodeAtPos())},Rn.readToken=function(y){return _(y,this.options.ecmaVersion>=6)||y===92?this.readWord():this.getTokenFromCode(y)},Rn.fullCharCodeAtPos=function(){var y=this.input.charCodeAt(this.pos);if(y<=55295||y>=56320)return y;var I=this.input.charCodeAt(this.pos+1);return I<=56319||I>=57344?y:(y<<10)+I-56613888},Rn.skipBlockComment=function(){var y=this.options.onComment&&this.curPosition(),I=this.pos,G=this.input.indexOf("*/",this.pos+=2);if(G===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=G+2,this.options.locations)for(var H=void 0,se=I;(H=O(this.input,se,this.pos))>-1;)++this.curLine,se=this.lineStart=H;this.options.onComment&&this.options.onComment(!0,this.input.slice(I+2,G),I,this.pos,y,this.curPosition())},Rn.skipLineComment=function(y){for(var I=this.pos,G=this.options.onComment&&this.curPosition(),H=this.input.charCodeAt(this.pos+=y);this.pos<this.input.length&&!L(H);)H=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(I+y,this.pos),I,this.pos,G,this.curPosition())},Rn.skipSpace=function(){e:for(;this.pos<this.input.length;){var y=this.input.charCodeAt(this.pos);switch(y){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(y>8&&y<14||y>=5760&&z.test(String.fromCharCode(y)))++this.pos;else break e}}},Rn.finishToken=function(y,I){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var G=this.type;this.type=y,this.value=I,this.updateContext(G)},Rn.readToken_dot=function(){var y=this.input.charCodeAt(this.pos+1);if(y>=48&&y<=57)return this.readNumber(!0);var I=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&y===46&&I===46?(this.pos+=3,this.finishToken(T.ellipsis)):(++this.pos,this.finishToken(T.dot))},Rn.readToken_slash=function(){var y=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):y===61?this.finishOp(T.assign,2):this.finishOp(T.slash,1)},Rn.readToken_mult_modulo_exp=function(y){var I=this.input.charCodeAt(this.pos+1),G=1,H=y===42?T.star:T.modulo;return this.options.ecmaVersion>=7&&y===42&&I===42&&(++G,H=T.starstar,I=this.input.charCodeAt(this.pos+2)),I===61?this.finishOp(T.assign,G+1):this.finishOp(H,G)},Rn.readToken_pipe_amp=function(y){var I=this.input.charCodeAt(this.pos+1);if(I===y){if(this.options.ecmaVersion>=12){var G=this.input.charCodeAt(this.pos+2);if(G===61)return this.finishOp(T.assign,3)}return this.finishOp(y===124?T.logicalOR:T.logicalAND,2)}return I===61?this.finishOp(T.assign,2):this.finishOp(y===124?T.bitwiseOR:T.bitwiseAND,1)},Rn.readToken_caret=function(){var y=this.input.charCodeAt(this.pos+1);return y===61?this.finishOp(T.assign,2):this.finishOp(T.bitwiseXOR,1)},Rn.readToken_plus_min=function(y){var I=this.input.charCodeAt(this.pos+1);return I===y?I===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||D.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(T.incDec,2):I===61?this.finishOp(T.assign,2):this.finishOp(T.plusMin,1)},Rn.readToken_lt_gt=function(y){var I=this.input.charCodeAt(this.pos+1),G=1;return I===y?(G=y===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+G)===61?this.finishOp(T.assign,G+1):this.finishOp(T.bitShift,G)):I===33&&y===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(I===61&&(G=2),this.finishOp(T.relational,G))},Rn.readToken_eq_excl=function(y){var I=this.input.charCodeAt(this.pos+1);return I===61?this.finishOp(T.equality,this.input.charCodeAt(this.pos+2)===61?3:2):y===61&&I===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(T.arrow)):this.finishOp(y===61?T.eq:T.prefix,1)},Rn.readToken_question=function(){var y=this.options.ecmaVersion;if(y>=11){var I=this.input.charCodeAt(this.pos+1);if(I===46){var G=this.input.charCodeAt(this.pos+2);if(G<48||G>57)return this.finishOp(T.questionDot,2)}if(I===63){if(y>=12){var H=this.input.charCodeAt(this.pos+2);if(H===61)return this.finishOp(T.assign,3)}return this.finishOp(T.coalesce,2)}}return this.finishOp(T.question,1)},Rn.readToken_numberSign=function(){var y=this.options.ecmaVersion,I=35;if(y>=13&&(++this.pos,I=this.fullCharCodeAtPos(),_(I,!0)||I===92))return this.finishToken(T.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+me(I)+"'")},Rn.getTokenFromCode=function(y){switch(y){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(T.parenL);case 41:return++this.pos,this.finishToken(T.parenR);case 59:return++this.pos,this.finishToken(T.semi);case 44:return++this.pos,this.finishToken(T.comma);case 91:return++this.pos,this.finishToken(T.bracketL);case 93:return++this.pos,this.finishToken(T.bracketR);case 123:return++this.pos,this.finishToken(T.braceL);case 125:return++this.pos,this.finishToken(T.braceR);case 58:return++this.pos,this.finishToken(T.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(T.backQuote);case 48:var I=this.input.charCodeAt(this.pos+1);if(I===120||I===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(I===111||I===79)return this.readRadixNumber(8);if(I===98||I===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(y);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(y);case 124:case 38:return this.readToken_pipe_amp(y);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(y);case 60:case 62:return this.readToken_lt_gt(y);case 61:case 33:return this.readToken_eq_excl(y);case 63:return this.readToken_question();case 126:return this.finishOp(T.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+me(y)+"'")},Rn.finishOp=function(y,I){var G=this.input.slice(this.pos,this.pos+I);return this.pos+=I,this.finishToken(y,G)},Rn.readRegexp=function(){for(var y,I,G=this.pos;;){this.pos>=this.input.length&&this.raise(G,"Unterminated regular expression");var H=this.input.charAt(this.pos);if(D.test(H)&&this.raise(G,"Unterminated regular expression"),y)y=!1;else{if(H==="[")I=!0;else if(H==="]"&&I)I=!1;else if(H==="/"&&!I)break;y=H==="\\"}++this.pos}var se=this.input.slice(G,this.pos);++this.pos;var Ce=this.pos,Le=this.readWord1();this.containsEsc&&this.unexpected(Ce);var At=this.regexpState||(this.regexpState=new mn(this));At.reset(G,se,Le),this.validateRegExpFlags(At),this.validateRegExpPattern(At);var bt=null;try{bt=new RegExp(se,Le)}catch{}return this.finishToken(T.regexp,{pattern:se,flags:Le,value:bt})},Rn.readInt=function(y,I,G){for(var H=this.options.ecmaVersion>=12&&I===void 0,se=G&&this.input.charCodeAt(this.pos)===48,Ce=this.pos,Le=0,At=0,bt=0,yn=I??1/0;bt<yn;++bt,++this.pos){var nn=this.input.charCodeAt(this.pos),cr=void 0;if(H&&nn===95){se&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),At===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),bt===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),At=nn;continue}if(nn>=97?cr=nn-97+10:nn>=65?cr=nn-65+10:nn>=48&&nn<=57?cr=nn-48:cr=1/0,cr>=y)break;At=nn,Le=Le*y+cr}return H&&At===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ce||I!=null&&this.pos-Ce!==I?null:Le};function Yw(y,I){return I?parseInt(y,8):parseFloat(y.replace(/_/g,""))}function ty(y){return typeof BigInt!="function"?null:BigInt(y.replace(/_/g,""))}Rn.readRadixNumber=function(y){var I=this.pos;this.pos+=2;var G=this.readInt(y);return G==null&&this.raise(this.start+2,"Expected number in radix "+y),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(G=ty(this.input.slice(I,this.pos)),++this.pos):_(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,G)},Rn.readNumber=function(y){var I=this.pos;!y&&this.readInt(10,void 0,!0)===null&&this.raise(I,"Invalid number");var G=this.pos-I>=2&&this.input.charCodeAt(I)===48;G&&this.strict&&this.raise(I,"Invalid number");var H=this.input.charCodeAt(this.pos);if(!G&&!y&&this.options.ecmaVersion>=11&&H===110){var se=ty(this.input.slice(I,this.pos));return++this.pos,_(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(T.num,se)}G&&/[89]/.test(this.input.slice(I,this.pos))&&(G=!1),H===46&&!G&&(++this.pos,this.readInt(10),H=this.input.charCodeAt(this.pos)),(H===69||H===101)&&!G&&(H=this.input.charCodeAt(++this.pos),(H===43||H===45)&&++this.pos,this.readInt(10)===null&&this.raise(I,"Invalid number")),_(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ce=Yw(this.input.slice(I,this.pos),G);return this.finishToken(T.num,Ce)},Rn.readCodePoint=function(){var y=this.input.charCodeAt(this.pos),I;if(y===123){this.options.ecmaVersion<6&&this.unexpected();var G=++this.pos;I=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,I>1114111&&this.invalidStringToken(G,"Code point out of bounds")}else I=this.readHexChar(4);return I},Rn.readString=function(y){for(var I="",G=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var H=this.input.charCodeAt(this.pos);if(H===y)break;H===92?(I+=this.input.slice(G,this.pos),I+=this.readEscapedChar(!1),G=this.pos):H===8232||H===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(L(H)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return I+=this.input.slice(G,this.pos++),this.finishToken(T.string,I)};var gm={};Rn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(y){if(y===gm)this.readInvalidTemplateToken();else throw y}this.inTemplateElement=!1},Rn.invalidStringToken=function(y,I){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw gm;this.raise(y,I)},Rn.readTmplToken=function(){for(var y="",I=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var G=this.input.charCodeAt(this.pos);if(G===96||G===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===T.template||this.type===T.invalidTemplate)?G===36?(this.pos+=2,this.finishToken(T.dollarBraceL)):(++this.pos,this.finishToken(T.backQuote)):(y+=this.input.slice(I,this.pos),this.finishToken(T.template,y));if(G===92)y+=this.input.slice(I,this.pos),y+=this.readEscapedChar(!0),I=this.pos;else if(L(G)){switch(y+=this.input.slice(I,this.pos),++this.pos,G){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:y+=`
`;break;default:y+=String.fromCharCode(G);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),I=this.pos}else++this.pos}},Rn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(T.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")},Rn.readEscapedChar=function(y){var I=this.input.charCodeAt(++this.pos);switch(++this.pos,I){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return me(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),y){var G=this.pos-1;this.invalidStringToken(G,"Invalid escape sequence in template string")}default:if(I>=48&&I<=55){var H=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],se=parseInt(H,8);return se>255&&(H=H.slice(0,-1),se=parseInt(H,8)),this.pos+=H.length-1,I=this.input.charCodeAt(this.pos),(H!=="0"||I===56||I===57)&&(this.strict||y)&&this.invalidStringToken(this.pos-1-H.length,y?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(se)}return L(I)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(I)}},Rn.readHexChar=function(y){var I=this.pos,G=this.readInt(16,y);return G===null&&this.invalidStringToken(I,"Bad character escape sequence"),G},Rn.readWord1=function(){this.containsEsc=!1;for(var y="",I=!0,G=this.pos,H=this.options.ecmaVersion>=6;this.pos<this.input.length;){var se=this.fullCharCodeAtPos();if(S(se,H))this.pos+=se<=65535?1:2;else if(se===92){this.containsEsc=!0,y+=this.input.slice(G,this.pos);var Ce=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var Le=this.readCodePoint();(I?_:S)(Le,H)||this.invalidStringToken(Ce,"Invalid Unicode escape"),y+=me(Le),G=this.pos}else break;I=!1}return y+this.input.slice(G,this.pos)},Rn.readWord=function(){var y=this.readWord1(),I=T.name;return this.keywords.test(y)&&(I=N[y]),this.finishToken(I,y)};var ny="8.12.1";Be.acorn={Parser:Be,version:ny,defaultOptions:ze,Position:Oe,SourceLocation:Ke,getLineInfo:Me,Node:Ga,TokenType:w,tokTypes:T,keywordTypes:N,TokContext:Fe,tokContexts:Ve,isIdentifierChar:S,isIdentifierStart:_,Token:Qi,isNewLine:L,lineBreak:D,lineBreakG:F,nonASCIIwhitespace:z};function Qw(y,I){return Be.parse(y,I)}function Kw(y,I,G){return Be.parseExpressionAt(y,I,G)}function Si(y,I){return Be.tokenizer(y,I)}t.Node=Ga,t.Parser=Be,t.Position=Oe,t.SourceLocation=Ke,t.TokContext=Fe,t.Token=Qi,t.TokenType=w,t.defaultOptions=ze,t.getLineInfo=Me,t.isIdentifierChar=S,t.isIdentifierStart=_,t.isNewLine=L,t.keywordTypes=N,t.lineBreak=D,t.lineBreakG=F,t.nonASCIIwhitespace=z,t.parse=Qw,t.parseExpressionAt=Kw,t.tokContexts=Ve,t.tokTypes=T,t.tokenizer=Si,t.version=ny})}),m8e=g8((n,e)=>{var t=A8e(),i=/^[\da-fA-F]+$/,r=/^\d+$/,s=new WeakMap;function o(u){u=u.Parser.acorn||u;let c=s.get(u);if(!c){const h=u.tokTypes,A=u.TokContext,v=u.TokenType,_=new A("<tag",!1),S=new A("</tag",!1),w=new A("<tag>...</tag>",!0,!0),x={tc_oTag:_,tc_cTag:S,tc_expr:w},M={jsxName:new v("jsxName"),jsxText:new v("jsxText",{beforeExpr:!0}),jsxTagStart:new v("jsxTagStart",{startsExpr:!0}),jsxTagEnd:new v("jsxTagEnd")};M.jsxTagStart.updateContext=function(){this.context.push(w),this.context.push(_),this.exprAllowed=!1},M.jsxTagEnd.updateContext=function(R){let N=this.context.pop();N===_&&R===h.slash||N===S?(this.context.pop(),this.exprAllowed=this.curContext()===w):this.exprAllowed=!0},c={tokContexts:x,tokTypes:M},s.set(u,c)}return c}function a(u){if(!u)return u;if(u.type==="JSXIdentifier")return u.name;if(u.type==="JSXNamespacedName")return u.namespace.name+":"+u.name.name;if(u.type==="JSXMemberExpression")return a(u.object)+"."+a(u.property)}e.exports=function(u){return u=u||{},function(c){return l({allowNamespaces:u.allowNamespaces!==!1,allowNamespacedObjects:!!u.allowNamespacedObjects,autoCloseVoidElements:!!u.autoCloseVoidElements},c)}},Object.defineProperty(e.exports,"tokTypes",{get:function(){return o(p9()).tokTypes},configurable:!0,enumerable:!0});function l(u,c){const h=c.acorn||p9(),A=o(h),v=h.tokTypes,_=A.tokTypes,S=h.tokContexts,w=A.tokContexts.tc_oTag,x=A.tokContexts.tc_cTag,M=A.tokContexts.tc_expr,R=h.isNewLine,N=h.isIdentifierStart,B=h.isIdentifierChar;return class extends c{static get acornJsx(){return A}jsx_readToken(){let T="",D=this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated JSX contents");let F=this.input.charCodeAt(this.pos);switch(F){case 60:case 123:return this.pos===this.start?F===60&&this.exprAllowed?(++this.pos,this.finishToken(_.jsxTagStart)):this.getTokenFromCode(F):(T+=this.input.slice(D,this.pos),this.finishToken(_.jsxText,T));case 38:T+=this.input.slice(D,this.pos),T+=this.jsx_readEntity(),D=this.pos;break;case 62:case 125:this.raise(this.pos,"Unexpected token `"+this.input[this.pos]+"`. Did you mean `"+(F===62?"&gt;":"&rbrace;")+'` or `{"'+this.input[this.pos]+'"}`?');default:R(F)?(T+=this.input.slice(D,this.pos),T+=this.jsx_readNewLine(!0),D=this.pos):++this.pos}}}jsx_readNewLine(T){let D=this.input.charCodeAt(this.pos),F;return++this.pos,D===13&&this.input.charCodeAt(this.pos)===10?(++this.pos,F=T?`
`:`\r
`):F=String.fromCharCode(D),this.options.locations&&(++this.curLine,this.lineStart=this.pos),F}jsx_readString(T){let D="",F=++this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");let L=this.input.charCodeAt(this.pos);if(L===T)break;L===38?(D+=this.input.slice(F,this.pos),D+=this.jsx_readEntity(),F=this.pos):R(L)?(D+=this.input.slice(F,this.pos),D+=this.jsx_readNewLine(!1),F=this.pos):++this.pos}return D+=this.input.slice(F,this.pos++),this.finishToken(v.string,D)}jsx_readEntity(){let T="",D=0,F,L=this.input[this.pos];L!=="&"&&this.raise(this.pos,"Entity must start with an ampersand");let O=++this.pos;for(;this.pos<this.input.length&&D++<10;){if(L=this.input[this.pos++],L===";"){T[0]==="#"?T[1]==="x"?(T=T.substr(2),i.test(T)&&(F=String.fromCharCode(parseInt(T,16)))):(T=T.substr(1),r.test(T)&&(F=String.fromCharCode(parseInt(T,10)))):F=t[T];break}T+=L}return F||(this.pos=O,"&")}jsx_readWord(){let T,D=this.pos;do T=this.input.charCodeAt(++this.pos);while(B(T)||T===45);return this.finishToken(_.jsxName,this.input.slice(D,this.pos))}jsx_parseIdentifier(){let T=this.startNode();return this.type===_.jsxName?T.name=this.value:this.type.keyword?T.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(T,"JSXIdentifier")}jsx_parseNamespacedName(){let T=this.start,D=this.startLoc,F=this.jsx_parseIdentifier();if(!u.allowNamespaces||!this.eat(v.colon))return F;var L=this.startNodeAt(T,D);return L.namespace=F,L.name=this.jsx_parseIdentifier(),this.finishNode(L,"JSXNamespacedName")}jsx_parseElementName(){if(this.type===_.jsxTagEnd)return"";let T=this.start,D=this.startLoc,F=this.jsx_parseNamespacedName();for(this.type===v.dot&&F.type==="JSXNamespacedName"&&!u.allowNamespacedObjects&&this.unexpected();this.eat(v.dot);){let L=this.startNodeAt(T,D);L.object=F,L.property=this.jsx_parseIdentifier(),F=this.finishNode(L,"JSXMemberExpression")}return F}jsx_parseAttributeValue(){switch(this.type){case v.braceL:let T=this.jsx_parseExpressionContainer();return T.expression.type==="JSXEmptyExpression"&&this.raise(T.start,"JSX attributes must only be assigned a non-empty expression"),T;case _.jsxTagStart:case v.string:return this.parseExprAtom();default:this.raise(this.start,"JSX value should be either an expression or a quoted JSX text")}}jsx_parseEmptyExpression(){let T=this.startNodeAt(this.lastTokEnd,this.lastTokEndLoc);return this.finishNodeAt(T,"JSXEmptyExpression",this.start,this.startLoc)}jsx_parseExpressionContainer(){let T=this.startNode();return this.next(),T.expression=this.type===v.braceR?this.jsx_parseEmptyExpression():this.parseExpression(),this.expect(v.braceR),this.finishNode(T,"JSXExpressionContainer")}jsx_parseAttribute(){let T=this.startNode();return this.eat(v.braceL)?(this.expect(v.ellipsis),T.argument=this.parseMaybeAssign(),this.expect(v.braceR),this.finishNode(T,"JSXSpreadAttribute")):(T.name=this.jsx_parseNamespacedName(),T.value=this.eat(v.eq)?this.jsx_parseAttributeValue():null,this.finishNode(T,"JSXAttribute"))}jsx_parseOpeningElementAt(T,D){let F=this.startNodeAt(T,D);F.attributes=[];let L=this.jsx_parseElementName();for(L&&(F.name=L);this.type!==v.slash&&this.type!==_.jsxTagEnd;)F.attributes.push(this.jsx_parseAttribute());F.selfClosing=this.eat(v.slash),this.expect(_.jsxTagEnd);const O=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];return u.autoCloseVoidElements&&L&&O.includes(L.name)&&(F.selfClosing=!0),this.finishNode(F,L?"JSXOpeningElement":"JSXOpeningFragment")}jsx_parseClosingElementAt(T,D){let F=this.startNodeAt(T,D),L=this.jsx_parseElementName();return L&&(F.name=L),this.expect(_.jsxTagEnd),this.finishNode(F,L?"JSXClosingElement":"JSXClosingFragment")}jsx_parseElementAt(T,D){let F=this.startNodeAt(T,D),L=[],O=this.jsx_parseOpeningElementAt(T,D),z=null;if(!O.selfClosing){e:for(;;)switch(this.type){case _.jsxTagStart:if(T=this.start,D=this.startLoc,this.next(),this.eat(v.slash)){z=this.jsx_parseClosingElementAt(T,D);break e}L.push(this.jsx_parseElementAt(T,D));break;case _.jsxText:L.push(this.parseExprAtom());break;case v.braceL:L.push(this.jsx_parseExpressionContainer());break;default:this.unexpected()}a(z.name)!==a(O.name)&&this.raise(z.start,"Expected corresponding JSX closing tag for <"+a(O.name)+">")}let Q=O.name?"Element":"Fragment";return F["opening"+Q]=O,F["closing"+Q]=z,F.children=L,this.type===v.relational&&this.value==="<"&&this.raise(this.start,"Adjacent JSX elements must be wrapped in an enclosing tag"),this.finishNode(F,"JSX"+Q)}jsx_parseText(){let T=this.parseLiteral(this.value);return T.type="JSXText",T}jsx_parseElement(){let T=this.start,D=this.startLoc;return this.next(),this.jsx_parseElementAt(T,D)}parseExprAtom(T){return this.type===_.jsxText?this.jsx_parseText():this.type===_.jsxTagStart?this.jsx_parseElement():super.parseExprAtom(T)}readToken(T){let D=this.curContext();if(D===M)return this.jsx_readToken();if(D===w||D===x){if(N(T))return this.jsx_readWord();if(T==62)return++this.pos,this.finishToken(_.jsxTagEnd);if((T===34||T===39)&&D==w)return this.jsx_readString(T)}return T===60&&this.exprAllowed&&this.input.charCodeAt(this.pos+1)!==33?(++this.pos,this.finishToken(_.jsxTagStart)):super.readToken(T)}updateContext(T){if(this.type==v.braceL){var D=this.curContext();D==w?this.context.push(S.b_expr):D==M?this.context.push(S.b_tmpl):super.updateContext(T),this.exprAllowed=!0}else if(this.type===v.slash&&T===_.jsxTagStart)this.context.length-=2,this.context.push(x),this.exprAllowed=!1;else return super.updateContext(T)}}}}),g8e=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],wY=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],v8e="-----------------------------------------------------------------------------------------------------------------------------------------------------",EY="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",fC={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},dC="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",y8e={5:dC,"5module":dC+" export import",6:dC+" const class extends export import super"},_8e=/^in(stanceof)?$/,x8e=new RegExp("["+EY+"]"),b8e=new RegExp("["+EY+v8e+"]");function C5(n,e){for(var t=65536,i=0;i<e.length;i+=2){if(t+=e[i],t>n)return!1;if(t+=e[i+1],t>=n)return!0}return!1}function bc(n,e){return n<65?n===36:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&x8e.test(String.fromCharCode(n)):e===!1?!1:C5(n,wY)}function V0(n,e){return n<48?n===36:n<58?!0:n<65?!1:n<91?!0:n<97?n===95:n<123?!0:n<=65535?n>=170&&b8e.test(String.fromCharCode(n)):e===!1?!1:C5(n,wY)||C5(n,g8e)}var ti=function(e,t){t===void 0&&(t={}),this.label=e,this.keyword=t.keyword,this.beforeExpr=!!t.beforeExpr,this.startsExpr=!!t.startsExpr,this.isLoop=!!t.isLoop,this.isAssign=!!t.isAssign,this.prefix=!!t.prefix,this.postfix=!!t.postfix,this.binop=t.binop||null,this.updateContext=null};function _a(n,e){return new ti(n,{beforeExpr:!0,binop:e})}var xa={beforeExpr:!0},go={startsExpr:!0},v8={};function Xn(n,e){return e===void 0&&(e={}),e.keyword=n,v8[n]=new ti(n,e)}var K={num:new ti("num",go),regexp:new ti("regexp",go),string:new ti("string",go),name:new ti("name",go),privateId:new ti("privateId",go),eof:new ti("eof"),bracketL:new ti("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new ti("]"),braceL:new ti("{",{beforeExpr:!0,startsExpr:!0}),braceR:new ti("}"),parenL:new ti("(",{beforeExpr:!0,startsExpr:!0}),parenR:new ti(")"),comma:new ti(",",xa),semi:new ti(";",xa),colon:new ti(":",xa),dot:new ti("."),question:new ti("?",xa),questionDot:new ti("?."),arrow:new ti("=>",xa),template:new ti("template"),invalidTemplate:new ti("invalidTemplate"),ellipsis:new ti("...",xa),backQuote:new ti("`",go),dollarBraceL:new ti("${",{beforeExpr:!0,startsExpr:!0}),eq:new ti("=",{beforeExpr:!0,isAssign:!0}),assign:new ti("_=",{beforeExpr:!0,isAssign:!0}),incDec:new ti("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new ti("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:_a("||",1),logicalAND:_a("&&",2),bitwiseOR:_a("|",3),bitwiseXOR:_a("^",4),bitwiseAND:_a("&",5),equality:_a("==/!=/===/!==",6),relational:_a("</>/<=/>=",7),bitShift:_a("<</>>/>>>",8),plusMin:new ti("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:_a("%",10),star:_a("*",10),slash:_a("/",10),starstar:new ti("**",{beforeExpr:!0}),coalesce:_a("??",1),_break:Xn("break"),_case:Xn("case",xa),_catch:Xn("catch"),_continue:Xn("continue"),_debugger:Xn("debugger"),_default:Xn("default",xa),_do:Xn("do",{isLoop:!0,beforeExpr:!0}),_else:Xn("else",xa),_finally:Xn("finally"),_for:Xn("for",{isLoop:!0}),_function:Xn("function",go),_if:Xn("if"),_return:Xn("return",xa),_switch:Xn("switch"),_throw:Xn("throw",xa),_try:Xn("try"),_var:Xn("var"),_const:Xn("const"),_while:Xn("while",{isLoop:!0}),_with:Xn("with"),_new:Xn("new",{beforeExpr:!0,startsExpr:!0}),_this:Xn("this",go),_super:Xn("super",go),_class:Xn("class",go),_extends:Xn("extends",xa),_export:Xn("export"),_import:Xn("import",go),_null:Xn("null",go),_true:Xn("true",go),_false:Xn("false",go),_in:Xn("in",{beforeExpr:!0,binop:7}),_instanceof:Xn("instanceof",{beforeExpr:!0,binop:7}),_typeof:Xn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Xn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Xn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},za=/\r\n?|\n|\u2028|\u2029/,S8e=new RegExp(za.source,"g");function dm(n){return n===10||n===13||n===8232||n===8233}function TY(n,e,t){t===void 0&&(t=n.length);for(var i=e;i<t;i++){var r=n.charCodeAt(i);if(dm(r))return i<t-1&&r===13&&n.charCodeAt(i+1)===10?i+2:i+1}return-1}var CY=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ca=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,MY=Object.prototype,w8e=MY.hasOwnProperty,E8e=MY.toString,Kv=Object.hasOwn||function(n,e){return w8e.call(n,e)},A9=Array.isArray||function(n){return E8e.call(n)==="[object Array]"},m9=Object.create(null);function Ch(n){return m9[n]||(m9[n]=new RegExp("^(?:"+n.replace(/ /g,"|")+")$"))}function lf(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}var T8e=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,fv=function(e,t){this.line=e,this.column=t};fv.prototype.offset=function(e){return new fv(this.line,this.column+e)};var Hw=function(e,t,i){this.start=t,this.end=i,e.sourceFile!==null&&(this.source=e.sourceFile)};function RY(n,e){for(var t=1,i=0;;){var r=TY(n,i,e);if(r<0)return new fv(t,e-i);++t,i=r}}var M5={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},g9=!1;function C8e(n){var e={};for(var t in M5)e[t]=n&&Kv(n,t)?n[t]:M5[t];if(e.ecmaVersion==="latest"?e.ecmaVersion=1e8:e.ecmaVersion==null?(!g9&&typeof console=="object"&&console.warn&&(g9=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),e.allowReserved==null&&(e.allowReserved=e.ecmaVersion<5),(!n||n.allowHashBang==null)&&(e.allowHashBang=e.ecmaVersion>=14),A9(e.onToken)){var i=e.onToken;e.onToken=function(r){return i.push(r)}}return A9(e.onComment)&&(e.onComment=M8e(e,e.onComment)),e}function M8e(n,e){return function(t,i,r,s,o,a){var l={type:t?"Block":"Line",value:i,start:r,end:s};n.locations&&(l.loc=new Hw(this,o,a)),n.ranges&&(l.range=[r,s]),e.push(l)}}var dv=1,pm=2,y8=4,PY=8,NY=16,IY=32,_8=64,DY=128,Zv=256,x8=dv|pm|Zv;function b8(n,e){return pm|(n?y8:0)|(e?PY:0)}var AS=0,S8=1,Dc=2,kY=3,LY=4,FY=5,Vr=function(e,t,i){this.options=e=C8e(e),this.sourceFile=e.sourceFile,this.keywords=Ch(y8e[e.ecmaVersion>=6?6:e.sourceType==="module"?"5module":5]);var r="";e.allowReserved!==!0&&(r=fC[e.ecmaVersion>=6?6:e.ecmaVersion===5?5:3],e.sourceType==="module"&&(r+=" await")),this.reservedWords=Ch(r);var s=(r?r+" ":"")+fC.strict;this.reservedWordsStrict=Ch(s),this.reservedWordsStrictBind=Ch(s+" "+fC.strictBind),this.input=String(t),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(za).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=K.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=e.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&e.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(dv),this.regexpState=null,this.privateNameStack=[]},fu={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Vr.prototype.parse=function(){var e=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(e)};fu.inFunction.get=function(){return(this.currentVarScope().flags&pm)>0};fu.inGenerator.get=function(){return(this.currentVarScope().flags&PY)>0&&!this.currentVarScope().inClassFieldInit};fu.inAsync.get=function(){return(this.currentVarScope().flags&y8)>0&&!this.currentVarScope().inClassFieldInit};fu.canAwait.get=function(){for(var n=this.scopeStack.length-1;n>=0;n--){var e=this.scopeStack[n];if(e.inClassFieldInit||e.flags&Zv)return!1;if(e.flags&pm)return(e.flags&y8)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};fu.allowSuper.get=function(){var n=this.currentThisScope(),e=n.flags,t=n.inClassFieldInit;return(e&_8)>0||t||this.options.allowSuperOutsideMethod};fu.allowDirectSuper.get=function(){return(this.currentThisScope().flags&DY)>0};fu.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};fu.allowNewDotTarget.get=function(){var n=this.currentThisScope(),e=n.flags,t=n.inClassFieldInit;return(e&(pm|Zv))>0||t};fu.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Zv)>0};Vr.extend=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var i=this,r=0;r<e.length;r++)i=e[r](i);return i};Vr.parse=function(e,t){return new this(t,e).parse()};Vr.parseExpressionAt=function(e,t,i){var r=new this(i,e,t);return r.nextToken(),r.parseExpression()};Vr.tokenizer=function(e,t){return new this(t,e)};Object.defineProperties(Vr.prototype,fu);var ao=Vr.prototype,R8e=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;ao.strictDirective=function(n){if(this.options.ecmaVersion<5)return!1;for(;;){Ca.lastIndex=n,n+=Ca.exec(this.input)[0].length;var e=R8e.exec(this.input.slice(n));if(!e)return!1;if((e[1]||e[2])==="use strict"){Ca.lastIndex=n+e[0].length;var t=Ca.exec(this.input),i=t.index+t[0].length,r=this.input.charAt(i);return r===";"||r==="}"||za.test(t[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||r==="!"&&this.input.charAt(i+1)==="=")}n+=e[0].length,Ca.lastIndex=n,n+=Ca.exec(this.input)[0].length,this.input[n]===";"&&n++}};ao.eat=function(n){return this.type===n?(this.next(),!0):!1};ao.isContextual=function(n){return this.type===K.name&&this.value===n&&!this.containsEsc};ao.eatContextual=function(n){return this.isContextual(n)?(this.next(),!0):!1};ao.expectContextual=function(n){this.eatContextual(n)||this.unexpected()};ao.canInsertSemicolon=function(){return this.type===K.eof||this.type===K.braceR||za.test(this.input.slice(this.lastTokEnd,this.start))};ao.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};ao.semicolon=function(){!this.eat(K.semi)&&!this.insertSemicolon()&&this.unexpected()};ao.afterTrailingComma=function(n,e){if(this.type===n)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0};ao.expect=function(n){this.eat(n)||this.unexpected()};ao.unexpected=function(n){this.raise(n??this.start,"Unexpected token")};var $w=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};ao.checkPatternErrors=function(n,e){if(n){n.trailingComma>-1&&this.raiseRecoverable(n.trailingComma,"Comma is not permitted after the rest element");var t=e?n.parenthesizedAssign:n.parenthesizedBind;t>-1&&this.raiseRecoverable(t,e?"Assigning to rvalue":"Parenthesized pattern")}};ao.checkExpressionErrors=function(n,e){if(!n)return!1;var t=n.shorthandAssign,i=n.doubleProto;if(!e)return t>=0||i>=0;t>=0&&this.raise(t,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};ao.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};ao.isSimpleAssignTarget=function(n){return n.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(n.expression):n.type==="Identifier"||n.type==="MemberExpression"};var Xt=Vr.prototype;Xt.parseTopLevel=function(n){var e=Object.create(null);for(n.body||(n.body=[]);this.type!==K.eof;){var t=this.parseStatement(null,!0,e);n.body.push(t)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(n.body),this.next(),n.sourceType=this.options.sourceType,this.finishNode(n,"Program")};var w8={kind:"loop"},P8e={kind:"switch"};Xt.isLet=function(n){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ca.lastIndex=this.pos;var e=Ca.exec(this.input),t=this.pos+e[0].length,i=this.input.charCodeAt(t);if(i===91||i===92)return!0;if(n)return!1;if(i===123||i>55295&&i<56320)return!0;if(bc(i,!0)){for(var r=t+1;V0(i=this.input.charCodeAt(r),!0);)++r;if(i===92||i>55295&&i<56320)return!0;var s=this.input.slice(t,r);if(!_8e.test(s))return!0}return!1};Xt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ca.lastIndex=this.pos;var n=Ca.exec(this.input),e=this.pos+n[0].length,t;return!za.test(this.input.slice(this.pos,e))&&this.input.slice(e,e+8)==="function"&&(e+8===this.input.length||!(V0(t=this.input.charCodeAt(e+8))||t>55295&&t<56320))};Xt.parseStatement=function(n,e,t){var i=this.type,r=this.startNode(),s;switch(this.isLet(n)&&(i=K._var,s="let"),i){case K._break:case K._continue:return this.parseBreakContinueStatement(r,i.keyword);case K._debugger:return this.parseDebuggerStatement(r);case K._do:return this.parseDoStatement(r);case K._for:return this.parseForStatement(r);case K._function:return n&&(this.strict||n!=="if"&&n!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(r,!1,!n);case K._class:return n&&this.unexpected(),this.parseClass(r,!0);case K._if:return this.parseIfStatement(r);case K._return:return this.parseReturnStatement(r);case K._switch:return this.parseSwitchStatement(r);case K._throw:return this.parseThrowStatement(r);case K._try:return this.parseTryStatement(r);case K._const:case K._var:return s=s||this.value,n&&s!=="var"&&this.unexpected(),this.parseVarStatement(r,s);case K._while:return this.parseWhileStatement(r);case K._with:return this.parseWithStatement(r);case K.braceL:return this.parseBlock(!0,r);case K.semi:return this.parseEmptyStatement(r);case K._export:case K._import:if(this.options.ecmaVersion>10&&i===K._import){Ca.lastIndex=this.pos;var o=Ca.exec(this.input),a=this.pos+o[0].length,l=this.input.charCodeAt(a);if(l===40||l===46)return this.parseExpressionStatement(r,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===K._import?this.parseImport(r):this.parseExport(r,t);default:if(this.isAsyncFunction())return n&&this.unexpected(),this.next(),this.parseFunctionStatement(r,!0,!n);var u=this.value,c=this.parseExpression();return i===K.name&&c.type==="Identifier"&&this.eat(K.colon)?this.parseLabeledStatement(r,u,c,n):this.parseExpressionStatement(r,c)}};Xt.parseBreakContinueStatement=function(n,e){var t=e==="break";this.next(),this.eat(K.semi)||this.insertSemicolon()?n.label=null:this.type!==K.name?this.unexpected():(n.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if((n.label==null||r.name===n.label.name)&&(r.kind!=null&&(t||r.kind==="loop")||n.label&&t))break}return i===this.labels.length&&this.raise(n.start,"Unsyntactic "+e),this.finishNode(n,t?"BreakStatement":"ContinueStatement")};Xt.parseDebuggerStatement=function(n){return this.next(),this.semicolon(),this.finishNode(n,"DebuggerStatement")};Xt.parseDoStatement=function(n){return this.next(),this.labels.push(w8),n.body=this.parseStatement("do"),this.labels.pop(),this.expect(K._while),n.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(K.semi):this.semicolon(),this.finishNode(n,"DoWhileStatement")};Xt.parseForStatement=function(n){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(w8),this.enterScope(0),this.expect(K.parenL),this.type===K.semi)return e>-1&&this.unexpected(e),this.parseFor(n,null);var t=this.isLet();if(this.type===K._var||this.type===K._const||t){var i=this.startNode(),r=t?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===K._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&i.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===K._in?e>-1&&this.unexpected(e):n.await=e>-1),this.parseForIn(n,i)):(e>-1&&this.unexpected(e),this.parseFor(n,i))}var s=this.isContextual("let"),o=!1,a=this.containsEsc,l=new $w,u=this.start,c=e>-1?this.parseExprSubscripts(l,"await"):this.parseExpression(!0,l);return this.type===K._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(e>-1?(this.type===K._in&&this.unexpected(e),n.await=!0):o&&this.options.ecmaVersion>=8&&(c.start===u&&!a&&c.type==="Identifier"&&c.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(n.await=!1)),s&&o&&this.raise(c.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(c,!1,l),this.checkLValPattern(c),this.parseForIn(n,c)):(this.checkExpressionErrors(l,!0),e>-1&&this.unexpected(e),this.parseFor(n,c))};Xt.parseFunctionStatement=function(n,e,t){return this.next(),this.parseFunction(n,n1|(t?0:R5),!1,e)};Xt.parseIfStatement=function(n){return this.next(),n.test=this.parseParenExpression(),n.consequent=this.parseStatement("if"),n.alternate=this.eat(K._else)?this.parseStatement("if"):null,this.finishNode(n,"IfStatement")};Xt.parseReturnStatement=function(n){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(K.semi)||this.insertSemicolon()?n.argument=null:(n.argument=this.parseExpression(),this.semicolon()),this.finishNode(n,"ReturnStatement")};Xt.parseSwitchStatement=function(n){this.next(),n.discriminant=this.parseParenExpression(),n.cases=[],this.expect(K.braceL),this.labels.push(P8e),this.enterScope(0);for(var e,t=!1;this.type!==K.braceR;)if(this.type===K._case||this.type===K._default){var i=this.type===K._case;e&&this.finishNode(e,"SwitchCase"),n.cases.push(e=this.startNode()),e.consequent=[],this.next(),i?e.test=this.parseExpression():(t&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),t=!0,e.test=null),this.expect(K.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(n,"SwitchStatement")};Xt.parseThrowStatement=function(n){return this.next(),za.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),n.argument=this.parseExpression(),this.semicolon(),this.finishNode(n,"ThrowStatement")};var N8e=[];Xt.parseCatchClauseParam=function(){var n=this.parseBindingAtom(),e=n.type==="Identifier";return this.enterScope(e?IY:0),this.checkLValPattern(n,e?LY:Dc),this.expect(K.parenR),n};Xt.parseTryStatement=function(n){if(this.next(),n.block=this.parseBlock(),n.handler=null,this.type===K._catch){var e=this.startNode();this.next(),this.eat(K.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),n.handler=this.finishNode(e,"CatchClause")}return n.finalizer=this.eat(K._finally)?this.parseBlock():null,!n.handler&&!n.finalizer&&this.raise(n.start,"Missing catch or finally clause"),this.finishNode(n,"TryStatement")};Xt.parseVarStatement=function(n,e,t){return this.next(),this.parseVar(n,!1,e,t),this.semicolon(),this.finishNode(n,"VariableDeclaration")};Xt.parseWhileStatement=function(n){return this.next(),n.test=this.parseParenExpression(),this.labels.push(w8),n.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(n,"WhileStatement")};Xt.parseWithStatement=function(n){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),n.object=this.parseParenExpression(),n.body=this.parseStatement("with"),this.finishNode(n,"WithStatement")};Xt.parseEmptyStatement=function(n){return this.next(),this.finishNode(n,"EmptyStatement")};Xt.parseLabeledStatement=function(n,e,t,i){for(var r=0,s=this.labels;r<s.length;r+=1){var o=s[r];o.name===e&&this.raise(t.start,"Label '"+e+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===K._switch?"switch":null,l=this.labels.length-1;l>=0;l--){var u=this.labels[l];if(u.statementStart===n.start)u.statementStart=this.start,u.kind=a;else break}return this.labels.push({name:e,kind:a,statementStart:this.start}),n.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),n.label=t,this.finishNode(n,"LabeledStatement")};Xt.parseExpressionStatement=function(n,e){return n.expression=e,this.semicolon(),this.finishNode(n,"ExpressionStatement")};Xt.parseBlock=function(n,e,t){for(n===void 0&&(n=!0),e===void 0&&(e=this.startNode()),e.body=[],this.expect(K.braceL),n&&this.enterScope(0);this.type!==K.braceR;){var i=this.parseStatement(null);e.body.push(i)}return t&&(this.strict=!1),this.next(),n&&this.exitScope(),this.finishNode(e,"BlockStatement")};Xt.parseFor=function(n,e){return n.init=e,this.expect(K.semi),n.test=this.type===K.semi?null:this.parseExpression(),this.expect(K.semi),n.update=this.type===K.parenR?null:this.parseExpression(),this.expect(K.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,"ForStatement")};Xt.parseForIn=function(n,e){var t=this.type===K._in;return this.next(),e.type==="VariableDeclaration"&&e.declarations[0].init!=null&&(!t||this.options.ecmaVersion<8||this.strict||e.kind!=="var"||e.declarations[0].id.type!=="Identifier")&&this.raise(e.start,(t?"for-in":"for-of")+" loop variable declaration may not have an initializer"),n.left=e,n.right=t?this.parseExpression():this.parseMaybeAssign(),this.expect(K.parenR),n.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(n,t?"ForInStatement":"ForOfStatement")};Xt.parseVar=function(n,e,t,i){for(n.declarations=[],n.kind=t;;){var r=this.startNode();if(this.parseVarId(r,t),this.eat(K.eq)?r.init=this.parseMaybeAssign(e):!i&&t==="const"&&!(this.type===K._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&r.id.type!=="Identifier"&&!(e&&(this.type===K._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):r.init=null,n.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(K.comma))break}return n};Xt.parseVarId=function(n,e){n.id=this.parseBindingAtom(),this.checkLValPattern(n.id,e==="var"?S8:Dc,!1)};var n1=1,R5=2,BY=4;Xt.parseFunction=function(n,e,t,i,r){this.initFunction(n),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===K.star&&e&R5&&this.unexpected(),n.generator=this.eat(K.star)),this.options.ecmaVersion>=8&&(n.async=!!i),e&n1&&(n.id=e&BY&&this.type!==K.name?null:this.parseIdent(),n.id&&!(e&R5)&&this.checkLValSimple(n.id,this.strict||n.generator||n.async?this.treatFunctionsAsVar?S8:Dc:kY));var s=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(b8(n.async,n.generator)),e&n1||(n.id=this.type===K.name?this.parseIdent():null),this.parseFunctionParams(n),this.parseFunctionBody(n,t,!1,r),this.yieldPos=s,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(n,e&n1?"FunctionDeclaration":"FunctionExpression")};Xt.parseFunctionParams=function(n){this.expect(K.parenL),n.params=this.parseBindingList(K.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Xt.parseClass=function(n,e){this.next();var t=this.strict;this.strict=!0,this.parseClassId(n,e),this.parseClassSuper(n);var i=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(K.braceL);this.type!==K.braceR;){var o=this.parseClassElement(n.superClass!==null);o&&(r.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(s&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),s=!0):o.key&&o.key.type==="PrivateIdentifier"&&I8e(i,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=t,this.next(),n.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(n,e?"ClassDeclaration":"ClassExpression")};Xt.parseClassElement=function(n){if(this.eat(K.semi))return null;var e=this.options.ecmaVersion,t=this.startNode(),i="",r=!1,s=!1,o="method",a=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(K.braceL))return this.parseClassStaticBlock(t),t;this.isClassElementNameStart()||this.type===K.star?a=!0:i="static"}if(t.static=a,!i&&e>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===K.star)&&!this.canInsertSemicolon()?s=!0:i="async"),!i&&(e>=9||!s)&&this.eat(K.star)&&(r=!0),!i&&!s&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=l:i=l)}if(i?(t.computed=!1,t.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),t.key.name=i,this.finishNode(t.key,"Identifier")):this.parseClassElementName(t),e<13||this.type===K.parenL||o!=="method"||r||s){var u=!t.static&&mS(t,"constructor"),c=u&&n;u&&o!=="method"&&this.raise(t.key.start,"Constructor can't have get/set modifier"),t.kind=u?"constructor":o,this.parseClassMethod(t,r,s,c)}else this.parseClassField(t);return t};Xt.isClassElementNameStart=function(){return this.type===K.name||this.type===K.privateId||this.type===K.num||this.type===K.string||this.type===K.bracketL||this.type.keyword};Xt.parseClassElementName=function(n){this.type===K.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),n.computed=!1,n.key=this.parsePrivateIdent()):this.parsePropertyName(n)};Xt.parseClassMethod=function(n,e,t,i){var r=n.key;n.kind==="constructor"?(e&&this.raise(r.start,"Constructor can't be a generator"),t&&this.raise(r.start,"Constructor can't be an async method")):n.static&&mS(n,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=n.value=this.parseMethod(e,t,i);return n.kind==="get"&&s.params.length!==0&&this.raiseRecoverable(s.start,"getter should have no params"),n.kind==="set"&&s.params.length!==1&&this.raiseRecoverable(s.start,"setter should have exactly one param"),n.kind==="set"&&s.params[0].type==="RestElement"&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(n,"MethodDefinition")};Xt.parseClassField=function(n){if(mS(n,"constructor")?this.raise(n.key.start,"Classes can't have a field named 'constructor'"):n.static&&mS(n,"prototype")&&this.raise(n.key.start,"Classes can't have a static field named 'prototype'"),this.eat(K.eq)){var e=this.currentThisScope(),t=e.inClassFieldInit;e.inClassFieldInit=!0,n.value=this.parseMaybeAssign(),e.inClassFieldInit=t}else n.value=null;return this.semicolon(),this.finishNode(n,"PropertyDefinition")};Xt.parseClassStaticBlock=function(n){n.body=[];var e=this.labels;for(this.labels=[],this.enterScope(Zv|_8);this.type!==K.braceR;){var t=this.parseStatement(null);n.body.push(t)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(n,"StaticBlock")};Xt.parseClassId=function(n,e){this.type===K.name?(n.id=this.parseIdent(),e&&this.checkLValSimple(n.id,Dc,!1)):(e===!0&&this.unexpected(),n.id=null)};Xt.parseClassSuper=function(n){n.superClass=this.eat(K._extends)?this.parseExprSubscripts(null,!1):null};Xt.enterClassBody=function(){var n={declared:Object.create(null),used:[]};return this.privateNameStack.push(n),n.declared};Xt.exitClassBody=function(){var n=this.privateNameStack.pop(),e=n.declared,t=n.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,r=i===0?null:this.privateNameStack[i-1],s=0;s<t.length;++s){var o=t[s];Kv(e,o.name)||(r?r.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function I8e(n,e){var t=e.key.name,i=n[t],r="true";return e.type==="MethodDefinition"&&(e.kind==="get"||e.kind==="set")&&(r=(e.static?"s":"i")+e.kind),i==="iget"&&r==="iset"||i==="iset"&&r==="iget"||i==="sget"&&r==="sset"||i==="sset"&&r==="sget"?(n[t]="true",!1):i?!0:(n[t]=r,!1)}function mS(n,e){var t=n.computed,i=n.key;return!t&&(i.type==="Identifier"&&i.name===e||i.type==="Literal"&&i.value===e)}Xt.parseExportAllDeclaration=function(n,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(n.exported=this.parseModuleExportName(),this.checkExport(e,n.exported,this.lastTokStart)):n.exported=null),this.expectContextual("from"),this.type!==K.string&&this.unexpected(),n.source=this.parseExprAtom(),this.semicolon(),this.finishNode(n,"ExportAllDeclaration")};Xt.parseExport=function(n,e){if(this.next(),this.eat(K.star))return this.parseExportAllDeclaration(n,e);if(this.eat(K._default))return this.checkExport(e,"default",this.lastTokStart),n.declaration=this.parseExportDefaultDeclaration(),this.finishNode(n,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())n.declaration=this.parseExportDeclaration(n),n.declaration.type==="VariableDeclaration"?this.checkVariableExport(e,n.declaration.declarations):this.checkExport(e,n.declaration.id,n.declaration.id.start),n.specifiers=[],n.source=null;else{if(n.declaration=null,n.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==K.string&&this.unexpected(),n.source=this.parseExprAtom();else{for(var t=0,i=n.specifiers;t<i.length;t+=1){var r=i[t];this.checkUnreserved(r.local),this.checkLocalExport(r.local),r.local.type==="Literal"&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}n.source=null}this.semicolon()}return this.finishNode(n,"ExportNamedDeclaration")};Xt.parseExportDeclaration=function(n){return this.parseStatement(null)};Xt.parseExportDefaultDeclaration=function(){var n;if(this.type===K._function||(n=this.isAsyncFunction())){var e=this.startNode();return this.next(),n&&this.next(),this.parseFunction(e,n1|BY,!1,n)}else if(this.type===K._class){var t=this.startNode();return this.parseClass(t,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};Xt.checkExport=function(n,e,t){n&&(typeof e!="string"&&(e=e.type==="Identifier"?e.name:e.value),Kv(n,e)&&this.raiseRecoverable(t,"Duplicate export '"+e+"'"),n[e]=!0)};Xt.checkPatternExport=function(n,e){var t=e.type;if(t==="Identifier")this.checkExport(n,e,e.start);else if(t==="ObjectPattern")for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(n,s)}else if(t==="ArrayPattern")for(var o=0,a=e.elements;o<a.length;o+=1){var l=a[o];l&&this.checkPatternExport(n,l)}else t==="Property"?this.checkPatternExport(n,e.value):t==="AssignmentPattern"?this.checkPatternExport(n,e.left):t==="RestElement"&&this.checkPatternExport(n,e.argument)};Xt.checkVariableExport=function(n,e){if(n)for(var t=0,i=e;t<i.length;t+=1){var r=i[t];this.checkPatternExport(n,r.id)}};Xt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Xt.parseExportSpecifier=function(n){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(n,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")};Xt.parseExportSpecifiers=function(n){var e=[],t=!0;for(this.expect(K.braceL);!this.eat(K.braceR);){if(t)t=!1;else if(this.expect(K.comma),this.afterTrailingComma(K.braceR))break;e.push(this.parseExportSpecifier(n))}return e};Xt.parseImport=function(n){return this.next(),this.type===K.string?(n.specifiers=N8e,n.source=this.parseExprAtom()):(n.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),n.source=this.type===K.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(n,"ImportDeclaration")};Xt.parseImportSpecifier=function(){var n=this.startNode();return n.imported=this.parseModuleExportName(),this.eatContextual("as")?n.local=this.parseIdent():(this.checkUnreserved(n.imported),n.local=n.imported),this.checkLValSimple(n.local,Dc),this.finishNode(n,"ImportSpecifier")};Xt.parseImportDefaultSpecifier=function(){var n=this.startNode();return n.local=this.parseIdent(),this.checkLValSimple(n.local,Dc),this.finishNode(n,"ImportDefaultSpecifier")};Xt.parseImportNamespaceSpecifier=function(){var n=this.startNode();return this.next(),this.expectContextual("as"),n.local=this.parseIdent(),this.checkLValSimple(n.local,Dc),this.finishNode(n,"ImportNamespaceSpecifier")};Xt.parseImportSpecifiers=function(){var n=[],e=!0;if(this.type===K.name&&(n.push(this.parseImportDefaultSpecifier()),!this.eat(K.comma)))return n;if(this.type===K.star)return n.push(this.parseImportNamespaceSpecifier()),n;for(this.expect(K.braceL);!this.eat(K.braceR);){if(e)e=!1;else if(this.expect(K.comma),this.afterTrailingComma(K.braceR))break;n.push(this.parseImportSpecifier())}return n};Xt.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===K.string){var n=this.parseLiteral(this.value);return T8e.test(n.value)&&this.raise(n.start,"An export name cannot include a lone surrogate."),n}return this.parseIdent(!0)};Xt.adaptDirectivePrologue=function(n){for(var e=0;e<n.length&&this.isDirectiveCandidate(n[e]);++e)n[e].directive=n[e].expression.raw.slice(1,-1)};Xt.isDirectiveCandidate=function(n){return this.options.ecmaVersion>=5&&n.type==="ExpressionStatement"&&n.expression.type==="Literal"&&typeof n.expression.value=="string"&&(this.input[n.start]==='"'||this.input[n.start]==="'")};var Va=Vr.prototype;Va.toAssignable=function(n,e,t){if(this.options.ecmaVersion>=6&&n)switch(n.type){case"Identifier":this.inAsync&&n.name==="await"&&this.raise(n.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":n.type="ObjectPattern",t&&this.checkPatternErrors(t,!0);for(var i=0,r=n.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,e),s.type==="RestElement"&&(s.argument.type==="ArrayPattern"||s.argument.type==="ObjectPattern")&&this.raise(s.argument.start,"Unexpected token")}break;case"Property":n.kind!=="init"&&this.raise(n.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(n.value,e);break;case"ArrayExpression":n.type="ArrayPattern",t&&this.checkPatternErrors(t,!0),this.toAssignableList(n.elements,e);break;case"SpreadElement":n.type="RestElement",this.toAssignable(n.argument,e),n.argument.type==="AssignmentPattern"&&this.raise(n.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":n.operator!=="="&&this.raise(n.left.end,"Only '=' operator can be used for specifying default value."),n.type="AssignmentPattern",delete n.operator,this.toAssignable(n.left,e);break;case"ParenthesizedExpression":this.toAssignable(n.expression,e,t);break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(n.start,"Assigning to rvalue")}else t&&this.checkPatternErrors(t,!0);return n};Va.toAssignableList=function(n,e){for(var t=n.length,i=0;i<t;i++){var r=n[i];r&&this.toAssignable(r,e)}if(t){var s=n[t-1];this.options.ecmaVersion===6&&e&&s&&s.type==="RestElement"&&s.argument.type!=="Identifier"&&this.unexpected(s.argument.start)}return n};Va.parseSpread=function(n){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,n),this.finishNode(e,"SpreadElement")};Va.parseRestBinding=function(){var n=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==K.name&&this.unexpected(),n.argument=this.parseBindingAtom(),this.finishNode(n,"RestElement")};Va.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case K.bracketL:var n=this.startNode();return this.next(),n.elements=this.parseBindingList(K.bracketR,!0,!0),this.finishNode(n,"ArrayPattern");case K.braceL:return this.parseObj(!0)}return this.parseIdent()};Va.parseBindingList=function(n,e,t,i){for(var r=[],s=!0;!this.eat(n);)if(s?s=!1:this.expect(K.comma),e&&this.type===K.comma)r.push(null);else{if(t&&this.afterTrailingComma(n))break;if(this.type===K.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),r.push(o),this.type===K.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(n);break}else r.push(this.parseAssignableListItem(i))}return r};Va.parseAssignableListItem=function(n){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e};Va.parseBindingListItem=function(n){return n};Va.parseMaybeDefault=function(n,e,t){if(t=t||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(K.eq))return t;var i=this.startNodeAt(n,e);return i.left=t,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};Va.checkLValSimple=function(n,e,t){e===void 0&&(e=AS);var i=e!==AS;switch(n.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(n.name)&&this.raiseRecoverable(n.start,(i?"Binding ":"Assigning to ")+n.name+" in strict mode"),i&&(e===Dc&&n.name==="let"&&this.raiseRecoverable(n.start,"let is disallowed as a lexically bound name"),t&&(Kv(t,n.name)&&this.raiseRecoverable(n.start,"Argument name clash"),t[n.name]=!0),e!==FY&&this.declareName(n.name,e,n.start));break;case"ChainExpression":this.raiseRecoverable(n.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(n.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(n.start,"Binding parenthesized expression"),this.checkLValSimple(n.expression,e,t);default:this.raise(n.start,(i?"Binding":"Assigning to")+" rvalue")}};Va.checkLValPattern=function(n,e,t){switch(e===void 0&&(e=AS),n.type){case"ObjectPattern":for(var i=0,r=n.properties;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,e,t)}break;case"ArrayPattern":for(var o=0,a=n.elements;o<a.length;o+=1){var l=a[o];l&&this.checkLValInnerPattern(l,e,t)}break;default:this.checkLValSimple(n,e,t)}};Va.checkLValInnerPattern=function(n,e,t){switch(e===void 0&&(e=AS),n.type){case"Property":this.checkLValInnerPattern(n.value,e,t);break;case"AssignmentPattern":this.checkLValPattern(n.left,e,t);break;case"RestElement":this.checkLValPattern(n.argument,e,t);break;default:this.checkLValPattern(n,e,t)}};var tl=function(e,t,i,r,s){this.token=e,this.isExpr=!!t,this.preserveSpace=!!i,this.override=r,this.generator=!!s},Hi={b_stat:new tl("{",!1),b_expr:new tl("{",!0),b_tmpl:new tl("${",!1),p_stat:new tl("(",!1),p_expr:new tl("(",!0),q_tmpl:new tl("`",!0,!0,function(n){return n.tryReadTemplateToken()}),f_stat:new tl("function",!1),f_expr:new tl("function",!0),f_expr_gen:new tl("function",!0,!1,null,!0),f_gen:new tl("function",!1,!1,null,!0)},Am=Vr.prototype;Am.initialContext=function(){return[Hi.b_stat]};Am.curContext=function(){return this.context[this.context.length-1]};Am.braceIsBlock=function(n){var e=this.curContext();return e===Hi.f_expr||e===Hi.f_stat?!0:n===K.colon&&(e===Hi.b_stat||e===Hi.b_expr)?!e.isExpr:n===K._return||n===K.name&&this.exprAllowed?za.test(this.input.slice(this.lastTokEnd,this.start)):n===K._else||n===K.semi||n===K.eof||n===K.parenR||n===K.arrow?!0:n===K.braceL?e===Hi.b_stat:n===K._var||n===K._const||n===K.name?!1:!this.exprAllowed};Am.inGeneratorContext=function(){for(var n=this.context.length-1;n>=1;n--){var e=this.context[n];if(e.token==="function")return e.generator}return!1};Am.updateContext=function(n){var e,t=this.type;t.keyword&&n===K.dot?this.exprAllowed=!1:(e=t.updateContext)?e.call(this,n):this.exprAllowed=t.beforeExpr};Am.overrideContext=function(n){this.curContext()!==n&&(this.context[this.context.length-1]=n)};K.parenR.updateContext=K.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var n=this.context.pop();n===Hi.b_stat&&this.curContext().token==="function"&&(n=this.context.pop()),this.exprAllowed=!n.isExpr};K.braceL.updateContext=function(n){this.context.push(this.braceIsBlock(n)?Hi.b_stat:Hi.b_expr),this.exprAllowed=!0};K.dollarBraceL.updateContext=function(){this.context.push(Hi.b_tmpl),this.exprAllowed=!0};K.parenL.updateContext=function(n){var e=n===K._if||n===K._for||n===K._with||n===K._while;this.context.push(e?Hi.p_stat:Hi.p_expr),this.exprAllowed=!0};K.incDec.updateContext=function(){};K._function.updateContext=K._class.updateContext=function(n){n.beforeExpr&&n!==K._else&&!(n===K.semi&&this.curContext()!==Hi.p_stat)&&!(n===K._return&&za.test(this.input.slice(this.lastTokEnd,this.start)))&&!((n===K.colon||n===K.braceL)&&this.curContext()===Hi.b_stat)?this.context.push(Hi.f_expr):this.context.push(Hi.f_stat),this.exprAllowed=!1};K.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};K.backQuote.updateContext=function(){this.curContext()===Hi.q_tmpl?this.context.pop():this.context.push(Hi.q_tmpl),this.exprAllowed=!1};K.star.updateContext=function(n){if(n===K._function){var e=this.context.length-1;this.context[e]===Hi.f_expr?this.context[e]=Hi.f_expr_gen:this.context[e]=Hi.f_gen}this.exprAllowed=!0};K.name.updateContext=function(n){var e=!1;this.options.ecmaVersion>=6&&n!==K.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var dn=Vr.prototype;dn.checkPropClash=function(n,e,t){if(!(this.options.ecmaVersion>=9&&n.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(n.computed||n.method||n.shorthand))){var i=n.key,r;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var s=n.kind;if(this.options.ecmaVersion>=6){r==="__proto__"&&s==="init"&&(e.proto&&(t?t.doubleProto<0&&(t.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),e.proto=!0);return}r="$"+r;var o=e[r];if(o){var a;s==="init"?a=this.strict&&o.init||o.get||o.set:a=o.init||o[s],a&&this.raiseRecoverable(i.start,"Redefinition of property")}else o=e[r]={init:!1,get:!1,set:!1};o[s]=!0}};dn.parseExpression=function(n,e){var t=this.start,i=this.startLoc,r=this.parseMaybeAssign(n,e);if(this.type===K.comma){var s=this.startNodeAt(t,i);for(s.expressions=[r];this.eat(K.comma);)s.expressions.push(this.parseMaybeAssign(n,e));return this.finishNode(s,"SequenceExpression")}return r};dn.parseMaybeAssign=function(n,e,t){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(n);this.exprAllowed=!1}var i=!1,r=-1,s=-1,o=-1;e?(r=e.parenthesizedAssign,s=e.trailingComma,o=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new $w,i=!0);var a=this.start,l=this.startLoc;(this.type===K.parenL||this.type===K.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=n==="await");var u=this.parseMaybeConditional(n,e);if(t&&(u=t.call(this,u,a,l)),this.type.isAssign){var c=this.startNodeAt(a,l);return c.operator=this.value,this.type===K.eq&&(u=this.toAssignable(u,!1,e)),i||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=u.start&&(e.shorthandAssign=-1),this.type===K.eq?this.checkLValPattern(u):this.checkLValSimple(u),c.left=u,this.next(),c.right=this.parseMaybeAssign(n),o>-1&&(e.doubleProto=o),this.finishNode(c,"AssignmentExpression")}else i&&this.checkExpressionErrors(e,!0);return r>-1&&(e.parenthesizedAssign=r),s>-1&&(e.trailingComma=s),u};dn.parseMaybeConditional=function(n,e){var t=this.start,i=this.startLoc,r=this.parseExprOps(n,e);if(this.checkExpressionErrors(e))return r;if(this.eat(K.question)){var s=this.startNodeAt(t,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(K.colon),s.alternate=this.parseMaybeAssign(n),this.finishNode(s,"ConditionalExpression")}return r};dn.parseExprOps=function(n,e){var t=this.start,i=this.startLoc,r=this.parseMaybeUnary(e,!1,!1,n);return this.checkExpressionErrors(e)||r.start===t&&r.type==="ArrowFunctionExpression"?r:this.parseExprOp(r,t,i,-1,n)};dn.parseExprOp=function(n,e,t,i,r){var s=this.type.binop;if(s!=null&&(!r||this.type!==K._in)&&s>i){var o=this.type===K.logicalOR||this.type===K.logicalAND,a=this.type===K.coalesce;a&&(s=K.logicalAND.binop);var l=this.value;this.next();var u=this.start,c=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),u,c,s,r),A=this.buildBinary(e,t,n,h,l,o||a);return(o&&this.type===K.coalesce||a&&(this.type===K.logicalOR||this.type===K.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(A,e,t,i,r)}return n};dn.buildBinary=function(n,e,t,i,r,s){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(n,e);return o.left=t,o.operator=r,o.right=i,this.finishNode(o,s?"LogicalExpression":"BinaryExpression")};dn.parseMaybeUnary=function(n,e,t,i){var r=this.start,s=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(i),e=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===K.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,i),this.checkExpressionErrors(n,!0),l?this.checkLValSimple(a.argument):this.strict&&a.operator==="delete"&&OY(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):a.operator==="delete"&&P5(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):e=!0,o=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(!e&&this.type===K.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==K._in&&this.unexpected();else{if(o=this.parseExprSubscripts(n,i),this.checkExpressionErrors(n))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var u=this.startNodeAt(r,s);u.operator=this.value,u.prefix=!1,u.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(u,"UpdateExpression")}}if(!t&&this.eat(K.starstar))if(e)this.unexpected(this.lastTokStart);else return this.buildBinary(r,s,o,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return o};function OY(n){return n.type==="Identifier"||n.type==="ParenthesizedExpression"&&OY(n.expression)}function P5(n){return n.type==="MemberExpression"&&n.property.type==="PrivateIdentifier"||n.type==="ChainExpression"&&P5(n.expression)||n.type==="ParenthesizedExpression"&&P5(n.expression)}dn.parseExprSubscripts=function(n,e){var t=this.start,i=this.startLoc,r=this.parseExprAtom(n,e);if(r.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return r;var s=this.parseSubscripts(r,t,i,!1,e);return n&&s.type==="MemberExpression"&&(n.parenthesizedAssign>=s.start&&(n.parenthesizedAssign=-1),n.parenthesizedBind>=s.start&&(n.parenthesizedBind=-1),n.trailingComma>=s.start&&(n.trailingComma=-1)),s};dn.parseSubscripts=function(n,e,t,i,r){for(var s=this.options.ecmaVersion>=8&&n.type==="Identifier"&&n.name==="async"&&this.lastTokEnd===n.end&&!this.canInsertSemicolon()&&n.end-n.start===5&&this.potentialArrowAt===n.start,o=!1;;){var a=this.parseSubscript(n,e,t,i,s,o,r);if(a.optional&&(o=!0),a===n||a.type==="ArrowFunctionExpression"){if(o){var l=this.startNodeAt(e,t);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}n=a}};dn.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(K.arrow)};dn.parseSubscriptAsyncArrow=function(n,e,t,i){return this.parseArrowExpression(this.startNodeAt(n,e),t,!0,i)};dn.parseSubscript=function(n,e,t,i,r,s,o){var a=this.options.ecmaVersion>=11,l=a&&this.eat(K.questionDot);i&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(K.bracketL);if(u||l&&this.type!==K.parenL&&this.type!==K.backQuote||this.eat(K.dot)){var c=this.startNodeAt(e,t);c.object=n,u?(c.property=this.parseExpression(),this.expect(K.bracketR)):this.type===K.privateId&&n.type!=="Super"?c.property=this.parsePrivateIdent():c.property=this.parseIdent(this.options.allowReserved!=="never"),c.computed=!!u,a&&(c.optional=l),n=this.finishNode(c,"MemberExpression")}else if(!i&&this.eat(K.parenL)){var h=new $w,A=this.yieldPos,v=this.awaitPos,_=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var S=this.parseExprList(K.parenR,this.options.ecmaVersion>=8,!1,h);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=A,this.awaitPos=v,this.awaitIdentPos=_,this.parseSubscriptAsyncArrow(e,t,S,o);this.checkExpressionErrors(h,!0),this.yieldPos=A||this.yieldPos,this.awaitPos=v||this.awaitPos,this.awaitIdentPos=_||this.awaitIdentPos;var w=this.startNodeAt(e,t);w.callee=n,w.arguments=S,a&&(w.optional=l),n=this.finishNode(w,"CallExpression")}else if(this.type===K.backQuote){(l||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var x=this.startNodeAt(e,t);x.tag=n,x.quasi=this.parseTemplate({isTagged:!0}),n=this.finishNode(x,"TaggedTemplateExpression")}return n};dn.parseExprAtom=function(n,e,t){this.type===K.slash&&this.readRegexp();var i,r=this.potentialArrowAt===this.start;switch(this.type){case K._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===K.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==K.dot&&this.type!==K.bracketL&&this.type!==K.parenL&&this.unexpected(),this.finishNode(i,"Super");case K._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case K.name:var s=this.start,o=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&l.name==="async"&&!this.canInsertSemicolon()&&this.eat(K._function))return this.overrideContext(Hi.f_expr),this.parseFunction(this.startNodeAt(s,o),0,!1,!0,e);if(r&&!this.canInsertSemicolon()){if(this.eat(K.arrow))return this.parseArrowExpression(this.startNodeAt(s,o),[l],!1,e);if(this.options.ecmaVersion>=8&&l.name==="async"&&this.type===K.name&&!a&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return l=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(K.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,o),[l],!0,e)}return l;case K.regexp:var u=this.value;return i=this.parseLiteral(u.value),i.regex={pattern:u.pattern,flags:u.flags},i;case K.num:case K.string:return this.parseLiteral(this.value);case K._null:case K._true:case K._false:return i=this.startNode(),i.value=this.type===K._null?null:this.type===K._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case K.parenL:var c=this.start,h=this.parseParenAndDistinguishExpression(r,e);return n&&(n.parenthesizedAssign<0&&!this.isSimpleAssignTarget(h)&&(n.parenthesizedAssign=c),n.parenthesizedBind<0&&(n.parenthesizedBind=c)),h;case K.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(K.bracketR,!0,!0,n),this.finishNode(i,"ArrayExpression");case K.braceL:return this.overrideContext(Hi.b_expr),this.parseObj(!1,n);case K._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case K._class:return this.parseClass(this.startNode(),!1);case K._new:return this.parseNew();case K.backQuote:return this.parseTemplate();case K._import:return this.options.ecmaVersion>=11?this.parseExprImport(t):this.unexpected();default:return this.parseExprAtomDefault()}};dn.parseExprAtomDefault=function(){this.unexpected()};dn.parseExprImport=function(n){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===K.parenL&&!n)return this.parseDynamicImport(e);if(this.type===K.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);return t.name="import",e.meta=this.finishNode(t,"Identifier"),this.parseImportMeta(e)}else this.unexpected()};dn.parseDynamicImport=function(n){if(this.next(),n.source=this.parseMaybeAssign(),!this.eat(K.parenR)){var e=this.start;this.eat(K.comma)&&this.eat(K.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(n,"ImportExpression")};dn.parseImportMeta=function(n){this.next();var e=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="meta"&&this.raiseRecoverable(n.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(n.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(n.start,"Cannot use 'import.meta' outside a module"),this.finishNode(n,"MetaProperty")};dn.parseLiteral=function(n){var e=this.startNode();return e.value=n,e.raw=this.input.slice(this.start,this.end),e.raw.charCodeAt(e.raw.length-1)===110&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")};dn.parseParenExpression=function(){this.expect(K.parenL);var n=this.parseExpression();return this.expect(K.parenR),n};dn.shouldParseArrow=function(n){return!this.canInsertSemicolon()};dn.parseParenAndDistinguishExpression=function(n,e){var t=this.start,i=this.startLoc,r,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,a=this.startLoc,l=[],u=!0,c=!1,h=new $w,A=this.yieldPos,v=this.awaitPos,_;for(this.yieldPos=0,this.awaitPos=0;this.type!==K.parenR;)if(u?u=!1:this.expect(K.comma),s&&this.afterTrailingComma(K.parenR,!0)){c=!0;break}else if(this.type===K.ellipsis){_=this.start,l.push(this.parseParenItem(this.parseRestBinding())),this.type===K.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else l.push(this.parseMaybeAssign(!1,h,this.parseParenItem));var S=this.lastTokEnd,w=this.lastTokEndLoc;if(this.expect(K.parenR),n&&this.shouldParseArrow(l)&&this.eat(K.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=A,this.awaitPos=v,this.parseParenArrowList(t,i,l,e);(!l.length||c)&&this.unexpected(this.lastTokStart),_&&this.unexpected(_),this.checkExpressionErrors(h,!0),this.yieldPos=A||this.yieldPos,this.awaitPos=v||this.awaitPos,l.length>1?(r=this.startNodeAt(o,a),r.expressions=l,this.finishNodeAt(r,"SequenceExpression",S,w)):r=l[0]}else r=this.parseParenExpression();if(this.options.preserveParens){var x=this.startNodeAt(t,i);return x.expression=r,this.finishNode(x,"ParenthesizedExpression")}else return r};dn.parseParenItem=function(n){return n};dn.parseParenArrowList=function(n,e,t,i){return this.parseArrowExpression(this.startNodeAt(n,e),t,!1,i)};var D8e=[];dn.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var n=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===K.dot){var e=this.startNodeAt(n.start,n.loc&&n.loc.start);e.name="new",n.meta=this.finishNode(e,"Identifier"),this.next();var t=this.containsEsc;return n.property=this.parseIdent(!0),n.property.name!=="target"&&this.raiseRecoverable(n.property.start,"The only valid meta property for new is 'new.target'"),t&&this.raiseRecoverable(n.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(n.start,"'new.target' can only be used in functions and class static block"),this.finishNode(n,"MetaProperty")}var i=this.start,r=this.startLoc;return n.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,r,!0,!1),this.eat(K.parenL)?n.arguments=this.parseExprList(K.parenR,this.options.ecmaVersion>=8,!1):n.arguments=D8e,this.finishNode(n,"NewExpression")};dn.parseTemplateElement=function(n){var e=n.isTagged,t=this.startNode();return this.type===K.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),t.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),t.tail=this.type===K.backQuote,this.finishNode(t,"TemplateElement")};dn.parseTemplate=function(n){n===void 0&&(n={});var e=n.isTagged;e===void 0&&(e=!1);var t=this.startNode();this.next(),t.expressions=[];var i=this.parseTemplateElement({isTagged:e});for(t.quasis=[i];!i.tail;)this.type===K.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(K.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(K.braceR),t.quasis.push(i=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(t,"TemplateLiteral")};dn.isAsyncProp=function(n){return!n.computed&&n.key.type==="Identifier"&&n.key.name==="async"&&(this.type===K.name||this.type===K.num||this.type===K.string||this.type===K.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===K.star)&&!za.test(this.input.slice(this.lastTokEnd,this.start))};dn.parseObj=function(n,e){var t=this.startNode(),i=!0,r={};for(t.properties=[],this.next();!this.eat(K.braceR);){if(i)i=!1;else if(this.expect(K.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(K.braceR))break;var s=this.parseProperty(n,e);n||this.checkPropClash(s,r,e),t.properties.push(s)}return this.finishNode(t,n?"ObjectPattern":"ObjectExpression")};dn.parseProperty=function(n,e){var t=this.startNode(),i,r,s,o;if(this.options.ecmaVersion>=9&&this.eat(K.ellipsis))return n?(t.argument=this.parseIdent(!1),this.type===K.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(t,"RestElement")):(t.argument=this.parseMaybeAssign(!1,e),this.type===K.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(t,"SpreadElement"));this.options.ecmaVersion>=6&&(t.method=!1,t.shorthand=!1,(n||e)&&(s=this.start,o=this.startLoc),n||(i=this.eat(K.star)));var a=this.containsEsc;return this.parsePropertyName(t),!n&&!a&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(t)?(r=!0,i=this.options.ecmaVersion>=9&&this.eat(K.star),this.parsePropertyName(t)):r=!1,this.parsePropertyValue(t,n,i,r,s,o,e,a),this.finishNode(t,"Property")};dn.parseGetterSetter=function(n){n.kind=n.key.name,this.parsePropertyName(n),n.value=this.parseMethod(!1);var e=n.kind==="get"?0:1;if(n.value.params.length!==e){var t=n.value.start;n.kind==="get"?this.raiseRecoverable(t,"getter should have no params"):this.raiseRecoverable(t,"setter should have exactly one param")}else n.kind==="set"&&n.value.params[0].type==="RestElement"&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")};dn.parsePropertyValue=function(n,e,t,i,r,s,o,a){(t||i)&&this.type===K.colon&&this.unexpected(),this.eat(K.colon)?(n.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),n.kind="init"):this.options.ecmaVersion>=6&&this.type===K.parenL?(e&&this.unexpected(),n.kind="init",n.method=!0,n.value=this.parseMethod(t,i)):!e&&!a&&this.options.ecmaVersion>=5&&!n.computed&&n.key.type==="Identifier"&&(n.key.name==="get"||n.key.name==="set")&&this.type!==K.comma&&this.type!==K.braceR&&this.type!==K.eq?((t||i)&&this.unexpected(),this.parseGetterSetter(n)):this.options.ecmaVersion>=6&&!n.computed&&n.key.type==="Identifier"?((t||i)&&this.unexpected(),this.checkUnreserved(n.key),n.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=r),n.kind="init",e?n.value=this.parseMaybeDefault(r,s,this.copyNode(n.key)):this.type===K.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),n.value=this.parseMaybeDefault(r,s,this.copyNode(n.key))):n.value=this.copyNode(n.key),n.shorthand=!0):this.unexpected()};dn.parsePropertyName=function(n){if(this.options.ecmaVersion>=6){if(this.eat(K.bracketL))return n.computed=!0,n.key=this.parseMaybeAssign(),this.expect(K.bracketR),n.key;n.computed=!1}return n.key=this.type===K.num||this.type===K.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};dn.initFunction=function(n){n.id=null,this.options.ecmaVersion>=6&&(n.generator=n.expression=!1),this.options.ecmaVersion>=8&&(n.async=!1)};dn.parseMethod=function(n,e,t){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=n),this.options.ecmaVersion>=8&&(i.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(b8(e,i.generator)|_8|(t?DY:0)),this.expect(K.parenL),i.params=this.parseBindingList(K.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")};dn.parseArrowExpression=function(n,e,t,i){var r=this.yieldPos,s=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(b8(t,!1)|NY),this.initFunction(n),this.options.ecmaVersion>=8&&(n.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,n.params=this.toAssignableList(e,!0),this.parseFunctionBody(n,!0,!1,i),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=o,this.finishNode(n,"ArrowFunctionExpression")};dn.parseFunctionBody=function(n,e,t,i){var r=e&&this.type!==K.braceL,s=this.strict,o=!1;if(r)n.body=this.parseMaybeAssign(i),n.expression=!0,this.checkParams(n,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(n.params);(!s||a)&&(o=this.strictDirective(this.end),o&&a&&this.raiseRecoverable(n.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var l=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(n,!s&&!o&&!e&&!t&&this.isSimpleParamList(n.params)),this.strict&&n.id&&this.checkLValSimple(n.id,FY),n.body=this.parseBlock(!1,void 0,o&&!s),n.expression=!1,this.adaptDirectivePrologue(n.body.body),this.labels=l}this.exitScope()};dn.isSimpleParamList=function(n){for(var e=0,t=n;e<t.length;e+=1){var i=t[e];if(i.type!=="Identifier")return!1}return!0};dn.checkParams=function(n,e){for(var t=Object.create(null),i=0,r=n.params;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,S8,e?null:t)}};dn.parseExprList=function(n,e,t,i){for(var r=[],s=!0;!this.eat(n);){if(s)s=!1;else if(this.expect(K.comma),e&&this.afterTrailingComma(n))break;var o=void 0;t&&this.type===K.comma?o=null:this.type===K.ellipsis?(o=this.parseSpread(i),i&&this.type===K.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),r.push(o)}return r};dn.checkUnreserved=function(n){var e=n.start,t=n.end,i=n.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&i==="arguments"&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(e,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(e,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(e,t).indexOf("\\")!==-1)){var r=this.strict?this.reservedWordsStrict:this.reservedWords;r.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+i+"' is reserved"))}};dn.parseIdent=function(n){var e=this.parseIdentNode();return this.next(!!n),this.finishNode(e,"Identifier"),n||(this.checkUnreserved(e),e.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=e.start)),e};dn.parseIdentNode=function(){var n=this.startNode();return this.type===K.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,(n.name==="class"||n.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=K.name):this.unexpected(),n};dn.parsePrivateIdent=function(){var n=this.startNode();return this.type===K.privateId?n.name=this.value:this.unexpected(),this.next(),this.finishNode(n,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(n.start,"Private field '#"+n.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(n)),n};dn.parseYield=function(n){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===K.semi||this.canInsertSemicolon()||this.type!==K.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(K.star),e.argument=this.parseMaybeAssign(n)),this.finishNode(e,"YieldExpression")};dn.parseAwait=function(n){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,n),this.finishNode(e,"AwaitExpression")};var gS=Vr.prototype;gS.raise=function(n,e){var t=RY(this.input,n);e+=" ("+t.line+":"+t.column+")";var i=new SyntaxError(e);throw i.pos=n,i.loc=t,i.raisedAt=this.pos,i};gS.raiseRecoverable=gS.raise;gS.curPosition=function(){if(this.options.locations)return new fv(this.curLine,this.pos-this.lineStart)};var _f=Vr.prototype,k8e=function(e){this.flags=e,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};_f.enterScope=function(n){this.scopeStack.push(new k8e(n))};_f.exitScope=function(){this.scopeStack.pop()};_f.treatFunctionsAsVarInScope=function(n){return n.flags&pm||!this.inModule&&n.flags&dv};_f.declareName=function(n,e,t){var i=!1;if(e===Dc){var r=this.currentScope();i=r.lexical.indexOf(n)>-1||r.functions.indexOf(n)>-1||r.var.indexOf(n)>-1,r.lexical.push(n),this.inModule&&r.flags&dv&&delete this.undefinedExports[n]}else if(e===LY){var s=this.currentScope();s.lexical.push(n)}else if(e===kY){var o=this.currentScope();this.treatFunctionsAsVar?i=o.lexical.indexOf(n)>-1:i=o.lexical.indexOf(n)>-1||o.var.indexOf(n)>-1,o.functions.push(n)}else for(var a=this.scopeStack.length-1;a>=0;--a){var l=this.scopeStack[a];if(l.lexical.indexOf(n)>-1&&!(l.flags&IY&&l.lexical[0]===n)||!this.treatFunctionsAsVarInScope(l)&&l.functions.indexOf(n)>-1){i=!0;break}if(l.var.push(n),this.inModule&&l.flags&dv&&delete this.undefinedExports[n],l.flags&x8)break}i&&this.raiseRecoverable(t,"Identifier '"+n+"' has already been declared")};_f.checkLocalExport=function(n){this.scopeStack[0].lexical.indexOf(n.name)===-1&&this.scopeStack[0].var.indexOf(n.name)===-1&&(this.undefinedExports[n.name]=n)};_f.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};_f.currentVarScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&x8)return e}};_f.currentThisScope=function(){for(var n=this.scopeStack.length-1;;n--){var e=this.scopeStack[n];if(e.flags&x8&&!(e.flags&NY))return e}};var jw=function(e,t,i){this.type="",this.start=t,this.end=0,e.options.locations&&(this.loc=new Hw(e,i)),e.options.directSourceFile&&(this.sourceFile=e.options.directSourceFile),e.options.ranges&&(this.range=[t,0])},Jv=Vr.prototype;Jv.startNode=function(){return new jw(this,this.start,this.startLoc)};Jv.startNodeAt=function(n,e){return new jw(this,n,e)};function UY(n,e,t,i){return n.type=e,n.end=t,this.options.locations&&(n.loc.end=i),this.options.ranges&&(n.range[1]=t),n}Jv.finishNode=function(n,e){return UY.call(this,n,e,this.lastTokEnd,this.lastTokEndLoc)};Jv.finishNodeAt=function(n,e,t,i){return UY.call(this,n,e,t,i)};Jv.copyNode=function(n){var e=new jw(this,n.start,this.startLoc);for(var t in n)e[t]=n[t];return e};var zY="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",VY=zY+" Extended_Pictographic",GY=VY,qY=GY+" EBase EComp EMod EPres ExtPict",HY=qY,L8e=HY,F8e={9:zY,10:VY,11:GY,12:qY,13:HY,14:L8e},B8e="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",O8e={9:"",10:"",11:"",12:"",13:"",14:B8e},v9="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",$Y="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",jY=$Y+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",WY=jY+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",XY=WY+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",YY=XY+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",U8e=YY+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",z8e={9:$Y,10:jY,11:WY,12:XY,13:YY,14:U8e},QY={};function V8e(n){var e=QY[n]={binary:Ch(F8e[n]+" "+v9),binaryOfStrings:Ch(O8e[n]),nonBinary:{General_Category:Ch(v9),Script:Ch(z8e[n])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(d2=0,pC=[9,10,11,12,13,14];d2<pC.length;d2+=1)y9=pC[d2],V8e(y9);var y9,d2,pC,qt=Vr.prototype,vS=function(e,t){this.parent=e,this.base=t||this};vS.prototype.separatedFrom=function(e){for(var t=this;t;t=t.parent)for(var i=e;i;i=i.parent)if(t.base===i.base&&t!==i)return!0;return!1};vS.prototype.sibling=function(){return new vS(this.parent,this.base)};var du=function(e){this.parser=e,this.validFlags="gim"+(e.options.ecmaVersion>=6?"uy":"")+(e.options.ecmaVersion>=9?"s":"")+(e.options.ecmaVersion>=13?"d":"")+(e.options.ecmaVersion>=15?"v":""),this.unicodeProperties=QY[e.options.ecmaVersion>=14?14:e.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};du.prototype.reset=function(e,t,i){var r=i.indexOf("v")!==-1,s=i.indexOf("u")!==-1;this.start=e|0,this.source=t+"",this.flags=i,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=s&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=s&&this.parser.options.ecmaVersion>=9)};du.prototype.raise=function(e){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+e)};du.prototype.at=function(e,t){t===void 0&&(t=!1);var i=this.source,r=i.length;if(e>=r)return-1;var s=i.charCodeAt(e);if(!(t||this.switchU)||s<=55295||s>=57344||e+1>=r)return s;var o=i.charCodeAt(e+1);return o>=56320&&o<=57343?(s<<10)+o-56613888:s};du.prototype.nextIndex=function(e,t){t===void 0&&(t=!1);var i=this.source,r=i.length;if(e>=r)return r;var s=i.charCodeAt(e),o;return!(t||this.switchU)||s<=55295||s>=57344||e+1>=r||(o=i.charCodeAt(e+1))<56320||o>57343?e+1:e+2};du.prototype.current=function(e){return e===void 0&&(e=!1),this.at(this.pos,e)};du.prototype.lookahead=function(e){return e===void 0&&(e=!1),this.at(this.nextIndex(this.pos,e),e)};du.prototype.advance=function(e){e===void 0&&(e=!1),this.pos=this.nextIndex(this.pos,e)};du.prototype.eat=function(e,t){return t===void 0&&(t=!1),this.current(t)===e?(this.advance(t),!0):!1};du.prototype.eatChars=function(e,t){t===void 0&&(t=!1);for(var i=this.pos,r=0,s=e;r<s.length;r+=1){var o=s[r],a=this.at(i,t);if(a===-1||a!==o)return!1;i=this.nextIndex(i,t)}return this.pos=i,!0};qt.validateRegExpFlags=function(n){for(var e=n.validFlags,t=n.flags,i=!1,r=!1,s=0;s<t.length;s++){var o=t.charAt(s);e.indexOf(o)===-1&&this.raise(n.start,"Invalid regular expression flag"),t.indexOf(o,s+1)>-1&&this.raise(n.start,"Duplicate regular expression flag"),o==="u"&&(i=!0),o==="v"&&(r=!0)}this.options.ecmaVersion>=15&&i&&r&&this.raise(n.start,"Invalid regular expression flag")};function G8e(n){for(var e in n)return!0;return!1}qt.validateRegExpPattern=function(n){this.regexp_pattern(n),!n.switchN&&this.options.ecmaVersion>=9&&G8e(n.groupNames)&&(n.switchN=!0,this.regexp_pattern(n))};qt.regexp_pattern=function(n){n.pos=0,n.lastIntValue=0,n.lastStringValue="",n.lastAssertionIsQuantifiable=!1,n.numCapturingParens=0,n.maxBackReference=0,n.groupNames=Object.create(null),n.backReferenceNames.length=0,n.branchID=null,this.regexp_disjunction(n),n.pos!==n.source.length&&(n.eat(41)&&n.raise("Unmatched ')'"),(n.eat(93)||n.eat(125))&&n.raise("Lone quantifier brackets")),n.maxBackReference>n.numCapturingParens&&n.raise("Invalid escape");for(var e=0,t=n.backReferenceNames;e<t.length;e+=1){var i=t[e];n.groupNames[i]||n.raise("Invalid named capture referenced")}};qt.regexp_disjunction=function(n){var e=this.options.ecmaVersion>=16;for(e&&(n.branchID=new vS(n.branchID,null)),this.regexp_alternative(n);n.eat(124);)e&&(n.branchID=n.branchID.sibling()),this.regexp_alternative(n);e&&(n.branchID=n.branchID.parent),this.regexp_eatQuantifier(n,!0)&&n.raise("Nothing to repeat"),n.eat(123)&&n.raise("Lone quantifier brackets")};qt.regexp_alternative=function(n){for(;n.pos<n.source.length&&this.regexp_eatTerm(n););};qt.regexp_eatTerm=function(n){return this.regexp_eatAssertion(n)?(n.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(n)&&n.switchU&&n.raise("Invalid quantifier"),!0):(n.switchU?this.regexp_eatAtom(n):this.regexp_eatExtendedAtom(n))?(this.regexp_eatQuantifier(n),!0):!1};qt.regexp_eatAssertion=function(n){var e=n.pos;if(n.lastAssertionIsQuantifiable=!1,n.eat(94)||n.eat(36))return!0;if(n.eat(92)){if(n.eat(66)||n.eat(98))return!0;n.pos=e}if(n.eat(40)&&n.eat(63)){var t=!1;if(this.options.ecmaVersion>=9&&(t=n.eat(60)),n.eat(61)||n.eat(33))return this.regexp_disjunction(n),n.eat(41)||n.raise("Unterminated group"),n.lastAssertionIsQuantifiable=!t,!0}return n.pos=e,!1};qt.regexp_eatQuantifier=function(n,e){return e===void 0&&(e=!1),this.regexp_eatQuantifierPrefix(n,e)?(n.eat(63),!0):!1};qt.regexp_eatQuantifierPrefix=function(n,e){return n.eat(42)||n.eat(43)||n.eat(63)||this.regexp_eatBracedQuantifier(n,e)};qt.regexp_eatBracedQuantifier=function(n,e){var t=n.pos;if(n.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(n)&&(i=n.lastIntValue,n.eat(44)&&this.regexp_eatDecimalDigits(n)&&(r=n.lastIntValue),n.eat(125)))return r!==-1&&r<i&&!e&&n.raise("numbers out of order in {} quantifier"),!0;n.switchU&&!e&&n.raise("Incomplete quantifier"),n.pos=t}return!1};qt.regexp_eatAtom=function(n){return this.regexp_eatPatternCharacters(n)||n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)};qt.regexp_eatReverseSolidusAtomEscape=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatAtomEscape(n))return!0;n.pos=e}return!1};qt.regexp_eatUncapturingGroup=function(n){var e=n.pos;if(n.eat(40)){if(n.eat(63)&&n.eat(58)){if(this.regexp_disjunction(n),n.eat(41))return!0;n.raise("Unterminated group")}n.pos=e}return!1};qt.regexp_eatCapturingGroup=function(n){if(n.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(n):n.current()===63&&n.raise("Invalid group"),this.regexp_disjunction(n),n.eat(41))return n.numCapturingParens+=1,!0;n.raise("Unterminated group")}return!1};qt.regexp_eatExtendedAtom=function(n){return n.eat(46)||this.regexp_eatReverseSolidusAtomEscape(n)||this.regexp_eatCharacterClass(n)||this.regexp_eatUncapturingGroup(n)||this.regexp_eatCapturingGroup(n)||this.regexp_eatInvalidBracedQuantifier(n)||this.regexp_eatExtendedPatternCharacter(n)};qt.regexp_eatInvalidBracedQuantifier=function(n){return this.regexp_eatBracedQuantifier(n,!0)&&n.raise("Nothing to repeat"),!1};qt.regexp_eatSyntaxCharacter=function(n){var e=n.current();return KY(e)?(n.lastIntValue=e,n.advance(),!0):!1};function KY(n){return n===36||n>=40&&n<=43||n===46||n===63||n>=91&&n<=94||n>=123&&n<=125}qt.regexp_eatPatternCharacters=function(n){for(var e=n.pos,t=0;(t=n.current())!==-1&&!KY(t);)n.advance();return n.pos!==e};qt.regexp_eatExtendedPatternCharacter=function(n){var e=n.current();return e!==-1&&e!==36&&!(e>=40&&e<=43)&&e!==46&&e!==63&&e!==91&&e!==94&&e!==124?(n.advance(),!0):!1};qt.regexp_groupSpecifier=function(n){if(n.eat(63)){this.regexp_eatGroupName(n)||n.raise("Invalid group");var e=this.options.ecmaVersion>=16,t=n.groupNames[n.lastStringValue];if(t)if(e)for(var i=0,r=t;i<r.length;i+=1){var s=r[i];s.separatedFrom(n.branchID)||n.raise("Duplicate capture group name")}else n.raise("Duplicate capture group name");e?(t||(n.groupNames[n.lastStringValue]=[])).push(n.branchID):n.groupNames[n.lastStringValue]=!0}};qt.regexp_eatGroupName=function(n){if(n.lastStringValue="",n.eat(60)){if(this.regexp_eatRegExpIdentifierName(n)&&n.eat(62))return!0;n.raise("Invalid capture group name")}return!1};qt.regexp_eatRegExpIdentifierName=function(n){if(n.lastStringValue="",this.regexp_eatRegExpIdentifierStart(n)){for(n.lastStringValue+=lf(n.lastIntValue);this.regexp_eatRegExpIdentifierPart(n);)n.lastStringValue+=lf(n.lastIntValue);return!0}return!1};qt.regexp_eatRegExpIdentifierStart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,i=n.current(t);return n.advance(t),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(i=n.lastIntValue),q8e(i)?(n.lastIntValue=i,!0):(n.pos=e,!1)};function q8e(n){return bc(n,!0)||n===36||n===95}qt.regexp_eatRegExpIdentifierPart=function(n){var e=n.pos,t=this.options.ecmaVersion>=11,i=n.current(t);return n.advance(t),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(n,t)&&(i=n.lastIntValue),H8e(i)?(n.lastIntValue=i,!0):(n.pos=e,!1)};function H8e(n){return V0(n,!0)||n===36||n===95||n===8204||n===8205}qt.regexp_eatAtomEscape=function(n){return this.regexp_eatBackReference(n)||this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)||n.switchN&&this.regexp_eatKGroupName(n)?!0:(n.switchU&&(n.current()===99&&n.raise("Invalid unicode escape"),n.raise("Invalid escape")),!1)};qt.regexp_eatBackReference=function(n){var e=n.pos;if(this.regexp_eatDecimalEscape(n)){var t=n.lastIntValue;if(n.switchU)return t>n.maxBackReference&&(n.maxBackReference=t),!0;if(t<=n.numCapturingParens)return!0;n.pos=e}return!1};qt.regexp_eatKGroupName=function(n){if(n.eat(107)){if(this.regexp_eatGroupName(n))return n.backReferenceNames.push(n.lastStringValue),!0;n.raise("Invalid named reference")}return!1};qt.regexp_eatCharacterEscape=function(n){return this.regexp_eatControlEscape(n)||this.regexp_eatCControlLetter(n)||this.regexp_eatZero(n)||this.regexp_eatHexEscapeSequence(n)||this.regexp_eatRegExpUnicodeEscapeSequence(n,!1)||!n.switchU&&this.regexp_eatLegacyOctalEscapeSequence(n)||this.regexp_eatIdentityEscape(n)};qt.regexp_eatCControlLetter=function(n){var e=n.pos;if(n.eat(99)){if(this.regexp_eatControlLetter(n))return!0;n.pos=e}return!1};qt.regexp_eatZero=function(n){return n.current()===48&&!Ww(n.lookahead())?(n.lastIntValue=0,n.advance(),!0):!1};qt.regexp_eatControlEscape=function(n){var e=n.current();return e===116?(n.lastIntValue=9,n.advance(),!0):e===110?(n.lastIntValue=10,n.advance(),!0):e===118?(n.lastIntValue=11,n.advance(),!0):e===102?(n.lastIntValue=12,n.advance(),!0):e===114?(n.lastIntValue=13,n.advance(),!0):!1};qt.regexp_eatControlLetter=function(n){var e=n.current();return ZY(e)?(n.lastIntValue=e%32,n.advance(),!0):!1};function ZY(n){return n>=65&&n<=90||n>=97&&n<=122}qt.regexp_eatRegExpUnicodeEscapeSequence=function(n,e){e===void 0&&(e=!1);var t=n.pos,i=e||n.switchU;if(n.eat(117)){if(this.regexp_eatFixedHexDigits(n,4)){var r=n.lastIntValue;if(i&&r>=55296&&r<=56319){var s=n.pos;if(n.eat(92)&&n.eat(117)&&this.regexp_eatFixedHexDigits(n,4)){var o=n.lastIntValue;if(o>=56320&&o<=57343)return n.lastIntValue=(r-55296)*1024+(o-56320)+65536,!0}n.pos=s,n.lastIntValue=r}return!0}if(i&&n.eat(123)&&this.regexp_eatHexDigits(n)&&n.eat(125)&&$8e(n.lastIntValue))return!0;i&&n.raise("Invalid unicode escape"),n.pos=t}return!1};function $8e(n){return n>=0&&n<=1114111}qt.regexp_eatIdentityEscape=function(n){if(n.switchU)return this.regexp_eatSyntaxCharacter(n)?!0:n.eat(47)?(n.lastIntValue=47,!0):!1;var e=n.current();return e!==99&&(!n.switchN||e!==107)?(n.lastIntValue=e,n.advance(),!0):!1};qt.regexp_eatDecimalEscape=function(n){n.lastIntValue=0;var e=n.current();if(e>=49&&e<=57){do n.lastIntValue=10*n.lastIntValue+(e-48),n.advance();while((e=n.current())>=48&&e<=57);return!0}return!1};var JY=0,Sc=1,Pa=2;qt.regexp_eatCharacterClassEscape=function(n){var e=n.current();if(j8e(e))return n.lastIntValue=-1,n.advance(),Sc;var t=!1;if(n.switchU&&this.options.ecmaVersion>=9&&((t=e===80)||e===112)){n.lastIntValue=-1,n.advance();var i;if(n.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(n))&&n.eat(125))return t&&i===Pa&&n.raise("Invalid property name"),i;n.raise("Invalid property name")}return JY};function j8e(n){return n===100||n===68||n===115||n===83||n===119||n===87}qt.regexp_eatUnicodePropertyValueExpression=function(n){var e=n.pos;if(this.regexp_eatUnicodePropertyName(n)&&n.eat(61)){var t=n.lastStringValue;if(this.regexp_eatUnicodePropertyValue(n)){var i=n.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(n,t,i),Sc}}if(n.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(n)){var r=n.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(n,r)}return JY};qt.regexp_validateUnicodePropertyNameAndValue=function(n,e,t){Kv(n.unicodeProperties.nonBinary,e)||n.raise("Invalid property name"),n.unicodeProperties.nonBinary[e].test(t)||n.raise("Invalid property value")};qt.regexp_validateUnicodePropertyNameOrValue=function(n,e){if(n.unicodeProperties.binary.test(e))return Sc;if(n.switchV&&n.unicodeProperties.binaryOfStrings.test(e))return Pa;n.raise("Invalid property name")};qt.regexp_eatUnicodePropertyName=function(n){var e=0;for(n.lastStringValue="";eQ(e=n.current());)n.lastStringValue+=lf(e),n.advance();return n.lastStringValue!==""};function eQ(n){return ZY(n)||n===95}qt.regexp_eatUnicodePropertyValue=function(n){var e=0;for(n.lastStringValue="";W8e(e=n.current());)n.lastStringValue+=lf(e),n.advance();return n.lastStringValue!==""};function W8e(n){return eQ(n)||Ww(n)}qt.regexp_eatLoneUnicodePropertyNameOrValue=function(n){return this.regexp_eatUnicodePropertyValue(n)};qt.regexp_eatCharacterClass=function(n){if(n.eat(91)){var e=n.eat(94),t=this.regexp_classContents(n);return n.eat(93)||n.raise("Unterminated character class"),e&&t===Pa&&n.raise("Negated character class may contain strings"),!0}return!1};qt.regexp_classContents=function(n){return n.current()===93?Sc:n.switchV?this.regexp_classSetExpression(n):(this.regexp_nonEmptyClassRanges(n),Sc)};qt.regexp_nonEmptyClassRanges=function(n){for(;this.regexp_eatClassAtom(n);){var e=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassAtom(n)){var t=n.lastIntValue;n.switchU&&(e===-1||t===-1)&&n.raise("Invalid character class"),e!==-1&&t!==-1&&e>t&&n.raise("Range out of order in character class")}}};qt.regexp_eatClassAtom=function(n){var e=n.pos;if(n.eat(92)){if(this.regexp_eatClassEscape(n))return!0;if(n.switchU){var t=n.current();(t===99||iQ(t))&&n.raise("Invalid class escape"),n.raise("Invalid escape")}n.pos=e}var i=n.current();return i!==93?(n.lastIntValue=i,n.advance(),!0):!1};qt.regexp_eatClassEscape=function(n){var e=n.pos;if(n.eat(98))return n.lastIntValue=8,!0;if(n.switchU&&n.eat(45))return n.lastIntValue=45,!0;if(!n.switchU&&n.eat(99)){if(this.regexp_eatClassControlLetter(n))return!0;n.pos=e}return this.regexp_eatCharacterClassEscape(n)||this.regexp_eatCharacterEscape(n)};qt.regexp_classSetExpression=function(n){var e=Sc,t;if(!this.regexp_eatClassSetRange(n))if(t=this.regexp_eatClassSetOperand(n)){t===Pa&&(e=Pa);for(var i=n.pos;n.eatChars([38,38]);){if(n.current()!==38&&(t=this.regexp_eatClassSetOperand(n))){t!==Pa&&(e=Sc);continue}n.raise("Invalid character in character class")}if(i!==n.pos)return e;for(;n.eatChars([45,45]);)this.regexp_eatClassSetOperand(n)||n.raise("Invalid character in character class");if(i!==n.pos)return e}else n.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(n)){if(t=this.regexp_eatClassSetOperand(n),!t)return e;t===Pa&&(e=Pa)}};qt.regexp_eatClassSetRange=function(n){var e=n.pos;if(this.regexp_eatClassSetCharacter(n)){var t=n.lastIntValue;if(n.eat(45)&&this.regexp_eatClassSetCharacter(n)){var i=n.lastIntValue;return t!==-1&&i!==-1&&t>i&&n.raise("Range out of order in character class"),!0}n.pos=e}return!1};qt.regexp_eatClassSetOperand=function(n){return this.regexp_eatClassSetCharacter(n)?Sc:this.regexp_eatClassStringDisjunction(n)||this.regexp_eatNestedClass(n)};qt.regexp_eatNestedClass=function(n){var e=n.pos;if(n.eat(91)){var t=n.eat(94),i=this.regexp_classContents(n);if(n.eat(93))return t&&i===Pa&&n.raise("Negated character class may contain strings"),i;n.pos=e}if(n.eat(92)){var r=this.regexp_eatCharacterClassEscape(n);if(r)return r;n.pos=e}return null};qt.regexp_eatClassStringDisjunction=function(n){var e=n.pos;if(n.eatChars([92,113])){if(n.eat(123)){var t=this.regexp_classStringDisjunctionContents(n);if(n.eat(125))return t}else n.raise("Invalid escape");n.pos=e}return null};qt.regexp_classStringDisjunctionContents=function(n){for(var e=this.regexp_classString(n);n.eat(124);)this.regexp_classString(n)===Pa&&(e=Pa);return e};qt.regexp_classString=function(n){for(var e=0;this.regexp_eatClassSetCharacter(n);)e++;return e===1?Sc:Pa};qt.regexp_eatClassSetCharacter=function(n){var e=n.pos;if(n.eat(92))return this.regexp_eatCharacterEscape(n)||this.regexp_eatClassSetReservedPunctuator(n)?!0:n.eat(98)?(n.lastIntValue=8,!0):(n.pos=e,!1);var t=n.current();return t<0||t===n.lookahead()&&X8e(t)||Y8e(t)?!1:(n.advance(),n.lastIntValue=t,!0)};function X8e(n){return n===33||n>=35&&n<=38||n>=42&&n<=44||n===46||n>=58&&n<=64||n===94||n===96||n===126}function Y8e(n){return n===40||n===41||n===45||n===47||n>=91&&n<=93||n>=123&&n<=125}qt.regexp_eatClassSetReservedPunctuator=function(n){var e=n.current();return Q8e(e)?(n.lastIntValue=e,n.advance(),!0):!1};function Q8e(n){return n===33||n===35||n===37||n===38||n===44||n===45||n>=58&&n<=62||n===64||n===96||n===126}qt.regexp_eatClassControlLetter=function(n){var e=n.current();return Ww(e)||e===95?(n.lastIntValue=e%32,n.advance(),!0):!1};qt.regexp_eatHexEscapeSequence=function(n){var e=n.pos;if(n.eat(120)){if(this.regexp_eatFixedHexDigits(n,2))return!0;n.switchU&&n.raise("Invalid escape"),n.pos=e}return!1};qt.regexp_eatDecimalDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;Ww(t=n.current());)n.lastIntValue=10*n.lastIntValue+(t-48),n.advance();return n.pos!==e};function Ww(n){return n>=48&&n<=57}qt.regexp_eatHexDigits=function(n){var e=n.pos,t=0;for(n.lastIntValue=0;tQ(t=n.current());)n.lastIntValue=16*n.lastIntValue+nQ(t),n.advance();return n.pos!==e};function tQ(n){return n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102}function nQ(n){return n>=65&&n<=70?10+(n-65):n>=97&&n<=102?10+(n-97):n-48}qt.regexp_eatLegacyOctalEscapeSequence=function(n){if(this.regexp_eatOctalDigit(n)){var e=n.lastIntValue;if(this.regexp_eatOctalDigit(n)){var t=n.lastIntValue;e<=3&&this.regexp_eatOctalDigit(n)?n.lastIntValue=e*64+t*8+n.lastIntValue:n.lastIntValue=e*8+t}else n.lastIntValue=e;return!0}return!1};qt.regexp_eatOctalDigit=function(n){var e=n.current();return iQ(e)?(n.lastIntValue=e-48,n.advance(),!0):(n.lastIntValue=0,!1)};function iQ(n){return n>=48&&n<=55}qt.regexp_eatFixedHexDigits=function(n,e){var t=n.pos;n.lastIntValue=0;for(var i=0;i<e;++i){var r=n.current();if(!tQ(r))return n.pos=t,!1;n.lastIntValue=16*n.lastIntValue+nQ(r),n.advance()}return!0};var E8=function(e){this.type=e.type,this.value=e.value,this.start=e.start,this.end=e.end,e.options.locations&&(this.loc=new Hw(e,e.startLoc,e.endLoc)),e.options.ranges&&(this.range=[e.start,e.end])},jn=Vr.prototype;jn.next=function(n){!n&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new E8(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};jn.getToken=function(){return this.next(),new E8(this)};typeof Symbol<"u"&&(jn[Symbol.iterator]=function(){var n=this;return{next:function(){var e=n.getToken();return{done:e.type===K.eof,value:e}}}});jn.nextToken=function(){var n=this.curContext();if((!n||!n.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(K.eof);if(n.override)return n.override(this);this.readToken(this.fullCharCodeAtPos())};jn.readToken=function(n){return bc(n,this.options.ecmaVersion>=6)||n===92?this.readWord():this.getTokenFromCode(n)};jn.fullCharCodeAtPos=function(){var n=this.input.charCodeAt(this.pos);if(n<=55295||n>=56320)return n;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?n:(n<<10)+e-56613888};jn.skipBlockComment=function(){var n=this.options.onComment&&this.curPosition(),e=this.pos,t=this.input.indexOf("*/",this.pos+=2);if(t===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=t+2,this.options.locations)for(var i=void 0,r=e;(i=TY(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,t),e,this.pos,n,this.curPosition())};jn.skipLineComment=function(n){for(var e=this.pos,t=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=n);this.pos<this.input.length&&!dm(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+n,this.pos),e,this.pos,t,this.curPosition())};jn.skipSpace=function(){e:for(;this.pos<this.input.length;){var n=this.input.charCodeAt(this.pos);switch(n){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(n>8&&n<14||n>=5760&&CY.test(String.fromCharCode(n)))++this.pos;else break e}}};jn.finishToken=function(n,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var t=this.type;this.type=n,this.value=e,this.updateContext(t)};jn.readToken_dot=function(){var n=this.input.charCodeAt(this.pos+1);if(n>=48&&n<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&n===46&&e===46?(this.pos+=3,this.finishToken(K.ellipsis)):(++this.pos,this.finishToken(K.dot))};jn.readToken_slash=function(){var n=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):n===61?this.finishOp(K.assign,2):this.finishOp(K.slash,1)};jn.readToken_mult_modulo_exp=function(n){var e=this.input.charCodeAt(this.pos+1),t=1,i=n===42?K.star:K.modulo;return this.options.ecmaVersion>=7&&n===42&&e===42&&(++t,i=K.starstar,e=this.input.charCodeAt(this.pos+2)),e===61?this.finishOp(K.assign,t+1):this.finishOp(i,t)};jn.readToken_pipe_amp=function(n){var e=this.input.charCodeAt(this.pos+1);if(e===n){if(this.options.ecmaVersion>=12){var t=this.input.charCodeAt(this.pos+2);if(t===61)return this.finishOp(K.assign,3)}return this.finishOp(n===124?K.logicalOR:K.logicalAND,2)}return e===61?this.finishOp(K.assign,2):this.finishOp(n===124?K.bitwiseOR:K.bitwiseAND,1)};jn.readToken_caret=function(){var n=this.input.charCodeAt(this.pos+1);return n===61?this.finishOp(K.assign,2):this.finishOp(K.bitwiseXOR,1)};jn.readToken_plus_min=function(n){var e=this.input.charCodeAt(this.pos+1);return e===n?e===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||za.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(K.incDec,2):e===61?this.finishOp(K.assign,2):this.finishOp(K.plusMin,1)};jn.readToken_lt_gt=function(n){var e=this.input.charCodeAt(this.pos+1),t=1;return e===n?(t=n===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+t)===61?this.finishOp(K.assign,t+1):this.finishOp(K.bitShift,t)):e===33&&n===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(e===61&&(t=2),this.finishOp(K.relational,t))};jn.readToken_eq_excl=function(n){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(K.equality,this.input.charCodeAt(this.pos+2)===61?3:2):n===61&&e===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(K.arrow)):this.finishOp(n===61?K.eq:K.prefix,1)};jn.readToken_question=function(){var n=this.options.ecmaVersion;if(n>=11){var e=this.input.charCodeAt(this.pos+1);if(e===46){var t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(K.questionDot,2)}if(e===63){if(n>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(K.assign,3)}return this.finishOp(K.coalesce,2)}}return this.finishOp(K.question,1)};jn.readToken_numberSign=function(){var n=this.options.ecmaVersion,e=35;if(n>=13&&(++this.pos,e=this.fullCharCodeAtPos(),bc(e,!0)||e===92))return this.finishToken(K.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+lf(e)+"'")};jn.getTokenFromCode=function(n){switch(n){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(K.parenL);case 41:return++this.pos,this.finishToken(K.parenR);case 59:return++this.pos,this.finishToken(K.semi);case 44:return++this.pos,this.finishToken(K.comma);case 91:return++this.pos,this.finishToken(K.bracketL);case 93:return++this.pos,this.finishToken(K.bracketR);case 123:return++this.pos,this.finishToken(K.braceL);case 125:return++this.pos,this.finishToken(K.braceR);case 58:return++this.pos,this.finishToken(K.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(K.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(e===120||e===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(e===111||e===79)return this.readRadixNumber(8);if(e===98||e===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(n);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(n);case 124:case 38:return this.readToken_pipe_amp(n);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(n);case 60:case 62:return this.readToken_lt_gt(n);case 61:case 33:return this.readToken_eq_excl(n);case 63:return this.readToken_question();case 126:return this.finishOp(K.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+lf(n)+"'")};jn.finishOp=function(n,e){var t=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(n,t)};jn.readRegexp=function(){for(var n,e,t=this.pos;;){this.pos>=this.input.length&&this.raise(t,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(za.test(i)&&this.raise(t,"Unterminated regular expression"),n)n=!1;else{if(i==="[")e=!0;else if(i==="]"&&e)e=!1;else if(i==="/"&&!e)break;n=i==="\\"}++this.pos}var r=this.input.slice(t,this.pos);++this.pos;var s=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(s);var a=this.regexpState||(this.regexpState=new du(this));a.reset(t,r,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(r,o)}catch{}return this.finishToken(K.regexp,{pattern:r,flags:o,value:l})};jn.readInt=function(n,e,t){for(var i=this.options.ecmaVersion>=12&&e===void 0,r=t&&this.input.charCodeAt(this.pos)===48,s=this.pos,o=0,a=0,l=0,u=e??1/0;l<u;++l,++this.pos){var c=this.input.charCodeAt(this.pos),h=void 0;if(i&&c===95){r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),a===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),l===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=c;continue}if(c>=97?h=c-97+10:c>=65?h=c-65+10:c>=48&&c<=57?h=c-48:h=1/0,h>=n)break;a=c,o=o*n+h}return i&&a===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||e!=null&&this.pos-s!==e?null:o};function K8e(n,e){return e?parseInt(n,8):parseFloat(n.replace(/_/g,""))}function rQ(n){return typeof BigInt!="function"?null:BigInt(n.replace(/_/g,""))}jn.readRadixNumber=function(n){var e=this.pos;this.pos+=2;var t=this.readInt(n);return t==null&&this.raise(this.start+2,"Expected number in radix "+n),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(t=rQ(this.input.slice(e,this.pos)),++this.pos):bc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(K.num,t)};jn.readNumber=function(n){var e=this.pos;!n&&this.readInt(10,void 0,!0)===null&&this.raise(e,"Invalid number");var t=this.pos-e>=2&&this.input.charCodeAt(e)===48;t&&this.strict&&this.raise(e,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!t&&!n&&this.options.ecmaVersion>=11&&i===110){var r=rQ(this.input.slice(e,this.pos));return++this.pos,bc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(K.num,r)}t&&/[89]/.test(this.input.slice(e,this.pos))&&(t=!1),i===46&&!t&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!t&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(e,"Invalid number")),bc(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=K8e(this.input.slice(e,this.pos),t);return this.finishToken(K.num,s)};jn.readCodePoint=function(){var n=this.input.charCodeAt(this.pos),e;if(n===123){this.options.ecmaVersion<6&&this.unexpected();var t=++this.pos;e=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,e>1114111&&this.invalidStringToken(t,"Code point out of bounds")}else e=this.readHexChar(4);return e};jn.readString=function(n){for(var e="",t=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===n)break;i===92?(e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!1),t=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(dm(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(t,this.pos++),this.finishToken(K.string,e)};var sQ={};jn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(n){if(n===sQ)this.readInvalidTemplateToken();else throw n}this.inTemplateElement=!1};jn.invalidStringToken=function(n,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw sQ;this.raise(n,e)};jn.readTmplToken=function(){for(var n="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var t=this.input.charCodeAt(this.pos);if(t===96||t===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===K.template||this.type===K.invalidTemplate)?t===36?(this.pos+=2,this.finishToken(K.dollarBraceL)):(++this.pos,this.finishToken(K.backQuote)):(n+=this.input.slice(e,this.pos),this.finishToken(K.template,n));if(t===92)n+=this.input.slice(e,this.pos),n+=this.readEscapedChar(!0),e=this.pos;else if(dm(t)){switch(n+=this.input.slice(e,this.pos),++this.pos,t){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:n+=`
`;break;default:n+=String.fromCharCode(t);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}};jn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(K.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};jn.readEscapedChar=function(n){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return lf(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),n){var t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,e=this.input.charCodeAt(this.pos),(i!=="0"||e===56||e===57)&&(this.strict||n)&&this.invalidStringToken(this.pos-1-i.length,n?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return dm(e)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(e)}};jn.readHexChar=function(n){var e=this.pos,t=this.readInt(16,n);return t===null&&this.invalidStringToken(e,"Bad character escape sequence"),t};jn.readWord1=function(){this.containsEsc=!1;for(var n="",e=!0,t=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(V0(r,i))this.pos+=r<=65535?1:2;else if(r===92){this.containsEsc=!0,n+=this.input.slice(t,this.pos);var s=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(e?bc:V0)(o,i)||this.invalidStringToken(s,"Invalid Unicode escape"),n+=lf(o),t=this.pos}else break;e=!1}return n+this.input.slice(t,this.pos)};jn.readWord=function(){var n=this.readWord1(),e=K.name;return this.keywords.test(n)&&(e=v8[n]),this.finishToken(e,n)};var Z8e="8.12.1";Vr.acorn={Parser:Vr,version:Z8e,defaultOptions:M5,Position:fv,SourceLocation:Hw,getLineInfo:RY,Node:jw,TokenType:ti,tokTypes:K,keywordTypes:v8,TokContext:tl,tokContexts:Hi,isIdentifierChar:V0,isIdentifierStart:bc,Token:E8,isNewLine:dm,lineBreak:za,lineBreakG:S8e,nonASCIIwhitespace:CY};var J8e=p8e(m8e()),_9={acceptcharset:"acceptCharset",accesskey:"accessKey",allowfullscreen:"allowFullScreen",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autofocus:"autoFocus",autoplay:"autoPlay",cellpadding:"cellPadding",cellspacing:"cellSpacing",charset:"charSet",class:"className",colspan:"colSpan",contenteditable:"contentEditable",crossorigin:"crossOrigin",datetime:"dateTime",enctype:"encType",for:"htmlFor",formaction:"formAction",formenctype:"formEncType",formmethod:"formMethod",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",hreflang:"hrefLang",httpequiv:"httpEquiv",inputmode:"inputMode",keyparams:"keyParams",keytype:"keyType",marginheight:"marginHeight",marginwidth:"marginWidth",maxlength:"maxLength",mediagroup:"mediaGroup",minlength:"minLength",novalidate:"noValidate",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rowspan:"rowSpan",spellcheck:"spellCheck",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex",usemap:"useMap"},eIe=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],tIe=["table","tbody","tfoot","thead","tr"];function nIe(n){return eIe.indexOf(n.toLowerCase())===-1}function iIe(n){return tIe.indexOf(n.toLowerCase())!==-1}class AC extends Error{constructor(e="Nullish value encountered"){super(e),this.name="NullishShortCircuit"}}var rIe=(n="",e=16)=>{const t=String(n);let i=0;return t.split("").forEach(r=>{i=(i<<5)-i+r.charCodeAt(0),i&=i}),Math.abs(i).toString(e)},x9=()=>rIe(Math.random().toString()),sIe=n=>n.replace(/([A-Z])([A-Z])/g,"$1 $2").replace(/([a-z])([A-Z])/g,"$1 $2").replace(/[^a-zA-Z\u00C0-\u00ff]/g," ").toLowerCase().split(" ").filter(e=>e).map((e,t)=>t>0?e[0].toUpperCase()+e.slice(1):e).join(""),oIe=n=>{switch(typeof n){case"string":return n.split(";").filter(e=>e).reduce((e,t)=>{const i=t.slice(0,t.indexOf(":")).trim(),r=t.slice(t.indexOf(":")+1).trim();return{...e,[sIe(i)]:r}},{});case"object":return n;default:return}},aIe=n=>n==null||n===""?[]:n.split("."),oQ=(n,e)=>{const[t,...i]=e;if(!(n==null||t==null))return i.length===0?n[t]:oQ(n[t],i)},b9=(n,e)=>oQ(n,aIe(e));function mC(n){return Number.isNaN(n)?"NaN":n}var _S,Mi,xS,bS,o0,Av;class N5 extends _i.Component{constructor(){super(...arguments);hy(this,"ParsedChildren",null);Cf(this,_S,t=>{const i=Vr.extend(J8e.default({autoCloseVoidElements:this.props.autoCloseVoidElements})),r=`<root>${t}</root>`;let s=[];try{s=i.parse(r,{ecmaVersion:"latest"}),s=s.body[0].expression.children||[]}catch(o){return this.props.showWarnings&&console.warn(o),this.props.onError&&this.props.onError(o),this.props.renderError?this.props.renderError({error:String(o)}):null}return s.map(o=>ei(this,Mi).call(this,o)).filter(Boolean)});Cf(this,Mi,(t,i)=>{var r,s;switch(t.type){case"JSXAttribute":return t.value===null?!0:ei(this,Mi).call(this,t.value,i);case"JSXElement":case"JSXFragment":return ei(this,Av).call(this,t,i);case"JSXExpressionContainer":return ei(this,Mi).call(this,t.expression,i);case"JSXText":const o=this.props.disableKeyGeneration?void 0:x9();return this.props.disableFragments?t.value:_i.createElement(de.Fragment,{key:o},t.value);case"ArrayExpression":return t.elements.map(_=>ei(this,Mi).call(this,_,i));case"BinaryExpression":const a=ei(this,Mi).call(this,t.left,i),l=ei(this,Mi).call(this,t.right,i);let u;switch(t.operator){case"-":u=a-l;break;case"!=":u=a!=l;break;case"!==":u=a!==l;break;case"*":u=a*l;break;case"**":u=a**l;break;case"/":u=a/l;break;case"%":u=a%l;break;case"+":u=a+l;break;case"<":u=a<l;break;case"<=":u=a<=l;break;case"==":u=a==l;break;case"===":u=a===l;break;case">":u=a>l;break;case">=":u=a>=l;break;default:this.props.onError(new Error(`Unsupported binary operator: ${t.operator}`));return}return mC(u);case"CallExpression":const c=ei(this,Mi).call(this,t.callee,i);if(c===void 0){if(t.optional)throw new AC;this.props.onError(new Error(`The expression '${t.callee}' could not be resolved, resulting in an undefined return value.`));return}return c(...t.arguments.map(_=>ei(this,Mi).call(this,_,t.callee)));case"ConditionalExpression":return ei(this,Mi).call(this,t.test,i)?ei(this,Mi).call(this,t.consequent,i):ei(this,Mi).call(this,t.alternate,i);case"ExpressionStatement":return ei(this,Mi).call(this,t.expression,i);case"Identifier":return t.name==="Infinity"?1/0:t.name==="-Infinity"?-1/0:t.name==="NaN"?NaN:i&&t.name in i?mC(i[t.name]):mC((this.props.bindings||{})[t.name]);case"Literal":return t.value;case"LogicalExpression":const h=ei(this,Mi).call(this,t.left,i);return t.operator==="||"&&h?h:t.operator==="&&"&&h||t.operator==="||"&&!h?ei(this,Mi).call(this,t.right,i):!1;case"MemberExpression":return ei(this,bS).call(this,t,i);case"ChainExpression":return ei(this,xS).call(this,t,i);case"ObjectExpression":const A={};return t.properties.forEach(_=>{A[_.key.name||_.key.value]=ei(this,Mi).call(this,_.value,i)}),A;case"TemplateElement":return t.value.cooked;case"TemplateLiteral":return[...t.expressions,...t.quasis].sort((_,S)=>_.start<S.start?-1:1).map(_=>ei(this,Mi).call(this,_,i)).join("");case"UnaryExpression":const v=ei(this,Mi).call(this,t.argument,i);switch(t.operator){case"+":return+v;case"-":return-v;case"!":return!v}return;case"ArrowFunctionExpression":return(t.async||t.generator)&&((s=(r=this.props).onError)==null||s.call(r,new Error("Async and generator arrow functions are not supported."))),(..._)=>{const S={};return t.params.forEach((w,x)=>{S[w.name]=_[x]}),ei(this,Mi).call(this,t.body,S)};default:this.props.onError(new Error(`The expression type '${t.type}' is not supported.`));return}});Cf(this,xS,(t,i)=>{try{return ei(this,Mi).call(this,t.expression,i)}catch(r){if(r instanceof AC)return;throw r}});Cf(this,bS,(t,i)=>{const r=ei(this,Mi).call(this,t.object,i);let s;if(t.computed)s=ei(this,Mi).call(this,t.property,i);else if(t.property.type==="Identifier")s=t.property.name;else{this.props.onError(new Error("Only simple MemberExpressions are supported."));return}if(r==null&&t.optional)throw new AC;let o;try{o=r[s]}catch{this.props.onError(new Error(`The property '${s}' could not be resolved on the object '${r}'.`));return}return typeof o=="function"?o.bind(r):o});Cf(this,o0,t=>t.type==="JSXIdentifier"?t.name:`${ei(this,o0).call(this,t.object)}.${ei(this,o0).call(this,t.property)}`);Cf(this,Av,(t,i)=>{const{allowUnknownElements:r,components:s,componentsOnly:o,onError:a}=this.props,{children:l=[]}=t,u=t.type==="JSXElement"?t.openingElement:t.openingFragment,{attributes:c=[]}=u,h=t.type==="JSXElement"?ei(this,o0).call(this,u.name):"",A=(this.props.blacklistedAttrs||[]).map(R=>R instanceof RegExp?R:new RegExp(R,"i")),v=(this.props.blacklistedTags||[]).map(R=>R.trim().toLowerCase()).filter(Boolean);if(/^(html|head|body)$/i.test(h))return l.map(R=>ei(this,Av).call(this,R,i));const _=h.trim().toLowerCase();if(v.indexOf(_)!==-1)return a(new Error(`The tag <${h}> is blacklisted, and will not be rendered.`)),null;if(h!==""&&!b9(s,h)){if(o)return a(new Error(`The component <${h}> is unrecognized, and will not be rendered.`)),this.props.renderUnrecognized(h);if(!r&&document.createElement(h)instanceof HTMLUnknownElement)return a(new Error(`The tag <${h}> is unrecognized in this browser, and will not be rendered.`)),this.props.renderUnrecognized(h)}let S;const w=t.type==="JSXElement"?b9(s,h):de.Fragment;(w||nIe(h))&&(S=l.map(R=>ei(this,Mi).call(this,R,i)),!w&&!iIe(h)&&(S=S.filter(R=>typeof R!="string"||!/^\s*$/.test(R))),S.length===0?S=void 0:S.length===1?[S]=S:S.length>1&&!this.props.disableKeyGeneration&&(S=S.map((R,N)=>R!=null&&R.type&&!(R!=null&&R.key)?{...R,key:R.key||N}:R)));const x={key:this.props.disableKeyGeneration?void 0:x9()};c.forEach(R=>{if(R.type==="JSXAttribute"){const N=R.name.name,B=_9[N]||N,T=ei(this,Mi).call(this,R,i);A.filter(F=>F.test(B)).length===0&&(x[B]=T)}else if(R.type==="JSXSpreadAttribute"&&R.argument.type==="Identifier"||R.argument.type==="MemberExpression"){const N=ei(this,Mi).call(this,R.argument,i);typeof N=="object"&&Object.keys(N).forEach(B=>{const T=_9[B]||B;A.filter(F=>F.test(T)).length===0&&(x[T]=N[B])})}}),typeof x.style=="string"&&(x.style=oIe(x.style));const M=h.toLowerCase();return M==="option"&&(S=S.props.children),_i.createElement(w||M,x,S)})}render(){const t=(this.props.jsx||"").trim().replace(/<!DOCTYPE([^>]*)>/g,"");this.ParsedChildren=ei(this,_S).call(this,t);const i=[...new Set(["jsx-parser",...String(this.props.className).split(" ")])].filter(Boolean).join(" ");return this.props.renderInWrapper?_i.createElement("div",{className:i},this.ParsedChildren):this.ParsedChildren}}_S=new WeakMap,Mi=new WeakMap,xS=new WeakMap,bS=new WeakMap,o0=new WeakMap,Av=new WeakMap,hy(N5,"displayName","JsxParser"),hy(N5,"defaultProps",{allowUnknownElements:!0,autoCloseVoidElements:!1,bindings:{},blacklistedAttrs:[/^on.+/i],blacklistedTags:["script"],className:"",components:{},componentsOnly:!1,disableFragments:!1,disableKeyGeneration:!1,jsx:"",onError:()=>{},showWarnings:!1,renderError:void 0,renderInWrapper:!0,renderUnrecognized:()=>null});var lIe=N5;function uIe({children:n,title:e,span:t,columns:i=1,flip:r=!1,id:s="",image_child:o}){const a={display:"grid",gridTemplateColumns:i===2?"1fr 1fr":"1fr",gap:"0"},l=e&&e.trim()!==""?fe.jsx("h2",{children:e}):null;return fe.jsx("div",{className:"info-block",id:s,children:r?fe.jsxs(fe.Fragment,{children:[fe.jsx("div",{className:"info-image-section",style:{width:t?`${t[1]}%`:"40%"},children:o}),fe.jsxs("div",{className:"info-text-section",style:{width:t?`${t[0]}%`:"50%"},children:[l,fe.jsx("div",{className:"info-text",style:a,children:n})]})]}):fe.jsxs(fe.Fragment,{children:[fe.jsxs("div",{className:"info-text-section",style:{width:t?`${t[0]}%`:"50%"},children:[l,fe.jsx("div",{className:"info-text",style:a,children:n})]}),fe.jsx("div",{className:"info-image-section",style:{width:t?`${t[1]}%`:"40%"},children:o})]})})}function cIe({source:n,figcaption:e=!0,size:t="30rem",lightText:i=!1}){var a,l;if(!n)return null;const r=((l=(a=n.split("/").pop())==null?void 0:a.split(".")[0])==null?void 0:l.replace(/_/g," "))||"",s={height:t},o={color:"var(--secondary-color)"};return fe.jsxs("figure",{children:[fe.jsx("img",{src:n,alt:r,style:s}),e?fe.jsxs("figcaption",{style:i?o:{},children:["Fig. ",r]}):null]})}function hIe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function S9(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function w9(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?S9(Object(t),!0).forEach(function(i){hIe(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):S9(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function fIe(n,e){if(n==null)return{};var t={},i=Object.keys(n),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function dIe(n,e){if(n==null)return{};var t=fIe(n,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(n,i)&&(t[i]=n[i])}return t}function pIe(n,e){return AIe(n)||mIe(n,e)||gIe(n,e)||vIe()}function AIe(n){if(Array.isArray(n))return n}function mIe(n,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(n)))){var t=[],i=!0,r=!1,s=void 0;try{for(var o=n[Symbol.iterator](),a;!(i=(a=o.next()).done)&&(t.push(a.value),!(e&&t.length===e));i=!0);}catch(l){r=!0,s=l}finally{try{!i&&o.return!=null&&o.return()}finally{if(r)throw s}}return t}}function gIe(n,e){if(n){if(typeof n=="string")return E9(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return E9(n,e)}}function E9(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function vIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yIe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function T9(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function C9(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?T9(Object(t),!0).forEach(function(i){yIe(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):T9(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function _Ie(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return function(i){return e.reduceRight(function(r,s){return s(r)},i)}}function Eg(n){return function e(){for(var t=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length>=n.length?n.apply(this,r):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(r,a))}}}function yS(n){return{}.toString.call(n).includes("Object")}function xIe(n){return!Object.keys(n).length}function pv(n){return typeof n=="function"}function bIe(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function SIe(n,e){return yS(e)||jh("changeType"),Object.keys(e).some(function(t){return!bIe(n,t)})&&jh("changeField"),e}function wIe(n){pv(n)||jh("selectorType")}function EIe(n){pv(n)||yS(n)||jh("handlerType"),yS(n)&&Object.values(n).some(function(e){return!pv(e)})&&jh("handlersType")}function TIe(n){n||jh("initialIsRequired"),yS(n)||jh("initialType"),xIe(n)&&jh("initialContent")}function CIe(n,e){throw new Error(n[e]||n.default)}var MIe={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},jh=Eg(CIe)(MIe),p2={changes:SIe,selector:wIe,handler:EIe,initial:TIe};function RIe(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};p2.initial(n),p2.handler(e);var t={current:n},i=Eg(IIe)(t,e),r=Eg(NIe)(t),s=Eg(p2.changes)(n),o=Eg(PIe)(t);function a(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(c){return c};return p2.selector(u),u(t.current)}function l(u){_Ie(i,r,s,o)(u)}return[a,l]}function PIe(n,e){return pv(e)?e(n.current):e}function NIe(n,e){return n.current=C9(C9({},n.current),e),e}function IIe(n,e,t){return pv(e)?e(n.current):Object.keys(t).forEach(function(i){var r;return(r=e[i])===null||r===void 0?void 0:r.call(e,n.current[i])}),t}var DIe={create:RIe},kIe={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.43.0/min/vs"}};function LIe(n){return function e(){for(var t=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length>=n.length?n.apply(this,r):function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return e.apply(t,[].concat(r,a))}}}function FIe(n){return{}.toString.call(n).includes("Object")}function BIe(n){return n||M9("configIsRequired"),FIe(n)||M9("configType"),n.urls?(OIe(),{paths:{vs:n.urls.monacoBase}}):n}function OIe(){console.warn(aQ.deprecation)}function UIe(n,e){throw new Error(n[e]||n.default)}var aQ={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},M9=LIe(UIe)(aQ),zIe={config:BIe},VIe=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduceRight(function(s,o){return o(s)},r)}};function lQ(n,e){return Object.keys(e).forEach(function(t){e[t]instanceof Object&&n[t]&&Object.assign(e[t],lQ(n[t],e[t]))}),w9(w9({},n),e)}var GIe={type:"cancelation",msg:"operation is manually canceled"};function gC(n){var e=!1,t=new Promise(function(i,r){n.then(function(s){return e?r(GIe):i(s)}),n.catch(r)});return t.cancel=function(){return e=!0},t}var qIe=DIe.create({config:kIe,isInitialized:!1,resolve:null,reject:null,monaco:null}),uQ=pIe(qIe,2),ey=uQ[0],Xw=uQ[1];function HIe(n){var e=zIe.config(n),t=e.monaco,i=dIe(e,["monaco"]);Xw(function(r){return{config:lQ(r.config,i),monaco:t}})}function $Ie(){var n=ey(function(e){var t=e.monaco,i=e.isInitialized,r=e.resolve;return{monaco:t,isInitialized:i,resolve:r}});if(!n.isInitialized){if(Xw({isInitialized:!0}),n.monaco)return n.resolve(n.monaco),gC(vC);if(window.monaco&&window.monaco.editor)return cQ(window.monaco),n.resolve(window.monaco),gC(vC);VIe(jIe,XIe)(YIe)}return gC(vC)}function jIe(n){return document.body.appendChild(n)}function WIe(n){var e=document.createElement("script");return n&&(e.src=n),e}function XIe(n){var e=ey(function(i){var r=i.config,s=i.reject;return{config:r,reject:s}}),t=WIe("".concat(e.config.paths.vs,"/loader.js"));return t.onload=function(){return n()},t.onerror=e.reject,t}function YIe(){var n=ey(function(t){var i=t.config,r=t.resolve,s=t.reject;return{config:i,resolve:r,reject:s}}),e=window.require;e.config(n.config),e(["vs/editor/editor.main"],function(t){cQ(t),n.resolve(t)},function(t){n.reject(t)})}function cQ(n){ey().monaco||Xw({monaco:n})}function QIe(){return ey(function(n){var e=n.monaco;return e})}var vC=new Promise(function(n,e){return Xw({resolve:n,reject:e})}),hQ={config:HIe,init:$Ie,__getMonacoInstance:QIe},KIe={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},yC=KIe,ZIe={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},JIe=ZIe;function eDe({children:n}){return _i.createElement("div",{style:JIe.container},n)}var tDe=eDe,nDe=tDe;function iDe({width:n,height:e,isEditorReady:t,loading:i,_ref:r,className:s,wrapperProps:o}){return _i.createElement("section",{style:{...yC.wrapper,width:n,height:e},...o},!t&&_i.createElement(nDe,null,i),_i.createElement("div",{ref:r,style:{...yC.fullWidth,...!t&&yC.hide},className:s}))}var rDe=iDe,fQ=de.memo(rDe);function sDe(n){de.useEffect(n,[])}var dQ=sDe;function oDe(n,e,t=!0){let i=de.useRef(!0);de.useEffect(i.current||!t?()=>{i.current=!1}:n,e)}var Jo=oDe;function i1(){}function FA(n,e,t,i){return aDe(n,i)||lDe(n,e,t,i)}function aDe(n,e){return n.editor.getModel(pQ(n,e))}function lDe(n,e,t,i){return n.editor.createModel(e,t,i?pQ(n,i):void 0)}function pQ(n,e){return n.Uri.parse(e)}function uDe({original:n,modified:e,language:t,originalLanguage:i,modifiedLanguage:r,originalModelPath:s,modifiedModelPath:o,keepCurrentOriginalModel:a=!1,keepCurrentModifiedModel:l=!1,theme:u="light",loading:c="Loading...",options:h={},height:A="100%",width:v="100%",className:_,wrapperProps:S={},beforeMount:w=i1,onMount:x=i1}){let[M,R]=de.useState(!1),[N,B]=de.useState(!0),T=de.useRef(null),D=de.useRef(null),F=de.useRef(null),L=de.useRef(x),O=de.useRef(w),z=de.useRef(!1);dQ(()=>{let $=hQ.init();return $.then(Z=>(D.current=Z)&&B(!1)).catch(Z=>(Z==null?void 0:Z.type)!=="cancelation"&&console.error("Monaco initialization: error:",Z)),()=>T.current?ee():$.cancel()}),Jo(()=>{if(T.current&&D.current){let $=T.current.getOriginalEditor(),Z=FA(D.current,n||"",i||t||"text",s||"");Z!==$.getModel()&&$.setModel(Z)}},[s],M),Jo(()=>{if(T.current&&D.current){let $=T.current.getModifiedEditor(),Z=FA(D.current,e||"",r||t||"text",o||"");Z!==$.getModel()&&$.setModel(Z)}},[o],M),Jo(()=>{let $=T.current.getModifiedEditor();$.getOption(D.current.editor.EditorOption.readOnly)?$.setValue(e||""):e!==$.getValue()&&($.executeEdits("",[{range:$.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),$.pushUndoStop())},[e],M),Jo(()=>{var $,Z;(Z=($=T.current)==null?void 0:$.getModel())==null||Z.original.setValue(n||"")},[n],M),Jo(()=>{let{original:$,modified:Z}=T.current.getModel();D.current.editor.setModelLanguage($,i||t||"text"),D.current.editor.setModelLanguage(Z,r||t||"text")},[t,i,r],M),Jo(()=>{var $;($=D.current)==null||$.editor.setTheme(u)},[u],M),Jo(()=>{var $;($=T.current)==null||$.updateOptions(h)},[h],M);let Q=de.useCallback(()=>{var ce;if(!D.current)return;O.current(D.current);let $=FA(D.current,n||"",i||t||"text",s||""),Z=FA(D.current,e||"",r||t||"text",o||"");(ce=T.current)==null||ce.setModel({original:$,modified:Z})},[t,e,r,n,i,s,o]),j=de.useCallback(()=>{var $;!z.current&&F.current&&(T.current=D.current.editor.createDiffEditor(F.current,{automaticLayout:!0,...h}),Q(),($=D.current)==null||$.editor.setTheme(u),R(!0),z.current=!0)},[h,u,Q]);de.useEffect(()=>{M&&L.current(T.current,D.current)},[M]),de.useEffect(()=>{!N&&!M&&j()},[N,M,j]);function ee(){var Z,ce,ie,oe;let $=(Z=T.current)==null?void 0:Z.getModel();a||((ce=$==null?void 0:$.original)==null||ce.dispose()),l||((ie=$==null?void 0:$.modified)==null||ie.dispose()),(oe=T.current)==null||oe.dispose()}return _i.createElement(fQ,{width:v,height:A,isEditorReady:M,loading:c,_ref:F,className:_,wrapperProps:S})}var cDe=uDe;de.memo(cDe);function hDe(n){let e=de.useRef();return de.useEffect(()=>{e.current=n},[n]),e.current}var fDe=hDe,A2=new Map;function dDe({defaultValue:n,defaultLanguage:e,defaultPath:t,value:i,language:r,path:s,theme:o="light",line:a,loading:l="Loading...",options:u={},overrideServices:c={},saveViewState:h=!0,keepCurrentModel:A=!1,width:v="100%",height:_="100%",className:S,wrapperProps:w={},beforeMount:x=i1,onMount:M=i1,onChange:R,onValidate:N=i1}){let[B,T]=de.useState(!1),[D,F]=de.useState(!0),L=de.useRef(null),O=de.useRef(null),z=de.useRef(null),Q=de.useRef(M),j=de.useRef(x),ee=de.useRef(),$=de.useRef(i),Z=fDe(s),ce=de.useRef(!1),ie=de.useRef(!1);dQ(()=>{let _e=hQ.init();return _e.then(Oe=>(L.current=Oe)&&F(!1)).catch(Oe=>(Oe==null?void 0:Oe.type)!=="cancelation"&&console.error("Monaco initialization: error:",Oe)),()=>O.current?me():_e.cancel()}),Jo(()=>{var Oe,Ke,Me,ze;let _e=FA(L.current,n||i||"",e||r||"",s||t||"");_e!==((Oe=O.current)==null?void 0:Oe.getModel())&&(h&&A2.set(Z,(Ke=O.current)==null?void 0:Ke.saveViewState()),(Me=O.current)==null||Me.setModel(_e),h&&((ze=O.current)==null||ze.restoreViewState(A2.get(s))))},[s],B),Jo(()=>{var _e;(_e=O.current)==null||_e.updateOptions(u)},[u],B),Jo(()=>{!O.current||i===void 0||(O.current.getOption(L.current.editor.EditorOption.readOnly)?O.current.setValue(i):i!==O.current.getValue()&&(ie.current=!0,O.current.executeEdits("",[{range:O.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),O.current.pushUndoStop(),ie.current=!1))},[i],B),Jo(()=>{var Oe,Ke;let _e=(Oe=O.current)==null?void 0:Oe.getModel();_e&&r&&((Ke=L.current)==null||Ke.editor.setModelLanguage(_e,r))},[r],B),Jo(()=>{var _e;a!==void 0&&((_e=O.current)==null||_e.revealLine(a))},[a],B),Jo(()=>{var _e;(_e=L.current)==null||_e.editor.setTheme(o)},[o],B);let oe=de.useCallback(()=>{var _e;if(!(!z.current||!L.current)&&!ce.current){j.current(L.current);let Oe=s||t,Ke=FA(L.current,i||n||"",e||r||"",Oe||"");O.current=(_e=L.current)==null?void 0:_e.editor.create(z.current,{model:Ke,automaticLayout:!0,...u},c),h&&O.current.restoreViewState(A2.get(Oe)),L.current.editor.setTheme(o),a!==void 0&&O.current.revealLine(a),T(!0),ce.current=!0}},[n,e,t,i,r,s,u,c,h,o,a]);de.useEffect(()=>{B&&Q.current(O.current,L.current)},[B]),de.useEffect(()=>{!D&&!B&&oe()},[D,B,oe]),$.current=i,de.useEffect(()=>{var _e,Oe;B&&R&&((_e=ee.current)==null||_e.dispose(),ee.current=(Oe=O.current)==null?void 0:Oe.onDidChangeModelContent(Ke=>{ie.current||R(O.current.getValue(),Ke)}))},[B,R]),de.useEffect(()=>{if(B){let _e=L.current.editor.onDidChangeMarkers(Oe=>{var Me;let Ke=(Me=O.current.getModel())==null?void 0:Me.uri;if(Ke&&Oe.find(ze=>ze.path===Ke.path)){let ze=L.current.editor.getModelMarkers({resource:Ke});N==null||N(ze)}});return()=>{_e==null||_e.dispose()}}return()=>{}},[B,N]);function me(){var _e,Oe;(_e=ee.current)==null||_e.dispose(),A?h&&A2.set(s,O.current.saveViewState()):(Oe=O.current.getModel())==null||Oe.dispose(),O.current.dispose()}return _i.createElement(fQ,{width:v,height:_,isEditorReady:B,loading:l,_ref:z,className:S,wrapperProps:w})}var pDe=dDe,ADe=de.memo(pDe);function mDe({editable:n=!0,initialValue:e="Enter Here!",onValueChange:t}){const[i,r]=de.useState(e);return fe.jsx("div",{children:fe.jsx(ADe,{height:"20rem",defaultLanguage:"html",defaultValue:e,theme:"vs-dark",value:i,onChange:s=>{const o=s||"";r(o),t&&t(o)},options:{readOnly:!n}})})}function gDe({blockId:n,blockContent:e,blockPath:t}){const[i,r]=de.useState(!1),[s,o]=de.useState(!1),[a,l]=de.useState(!1),[u,c]=de.useState(!1),[h,A]=de.useState(e||""),v=de.useRef(null);function _(){r(!i)}function S(){o(!s)}function w(){i8e(n,t),o(!1)}function x(){l(!a),i||r(!0)}function M(){n8e(n,h,t),l(!1)}function R(){A(e||""),l(!1),r(!1)}function N(){c(!u)}return de.useEffect(()=>{function B(T){v.current&&!v.current.contains(T.target)&&o(!1)}return s?document.addEventListener("mousedown",B):document.removeEventListener("mousedown",B),()=>{document.removeEventListener("mousedown",B)}},[s]),fe.jsxs(fe.Fragment,{children:[fe.jsxs("div",{className:"content-edit",children:[fe.jsxs("section",{ref:v,className:`delete-box ${s?"":"null-del-box"}`,children:[fe.jsxs("h2",{children:[" Are you sure you would like to delete block ",n,"?"]}),fe.jsxs("div",{className:"delete-options",children:[fe.jsx("h3",{onClick:w,children:"Yes"}),fe.jsx("h3",{onClick:S,children:"No"})]})]}),fe.jsxs("section",{className:"top-section-options",children:[fe.jsx("h3",{children:n}),fe.jsxs("div",{className:"icon-options",children:[fe.jsx("img",{src:"/icons/x-square.svg",alt:"cancel",className:`cancel-icon ${a?"active-edit":"not-edit"}`,onClick:R}),fe.jsx("img",{src:"/icons/check-square.svg",alt:"save",className:`save-icon ${a?"active-edit":"not-edit"}`,onClick:M}),fe.jsx("img",{src:"/icons/edit.svg",alt:"edit",className:`edit-icon ${a?"active-edit":"not-edit"}`,onClick:x}),fe.jsx("img",{src:"/icons/trash.svg",alt:"delete",className:"delete-icon",onClick:S}),fe.jsx("img",{src:"/icons/eye-off.svg",alt:"preview",className:`preview-icon ${u?"":"closed"}`,onClick:N}),fe.jsx("img",{src:"/icons/eye.svg",alt:"preview",className:`preview-icon ${u?"closed":""}`,onClick:N}),fe.jsx("img",{src:"/icons/chevron-right.svg",alt:"options",className:i?"chevron-open":"chevron-closed",onClick:_})]})]}),fe.jsx("section",{className:`lower-section-content ${i?"":"closed"}`,children:fe.jsx(mDe,{editable:a,initialValue:e,onValueChange:A})})]}),fe.jsx("div",{className:`jsx-preview ${u?"":"closed"}`,children:fe.jsx(lIe,{components:{InfoBlock:uIe,Image:cIe},jsx:e})})]})}const T8=({blockPath:n="blocks/macro/"})=>{const[e,t]=de.useState([]);de.useEffect(()=>{t8e(r=>{t(r)},n)},[n]);const i=(r,s="Enter Block data here...")=>{s8e(r+1,s,n)};return fe.jsxs("div",{className:"p-4",children:[fe.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Block Profile"}),fe.jsx("div",{className:"mb-4",children:e.length>0?e.map(r=>fe.jsxs("div",{children:[fe.jsx(gDe,{blockId:r.id,blockContent:r.content,blockPath:n}),fe.jsx("img",{src:"/icons/plus-circle.svg",alt:"add",className:"add-btn",onClick:()=>i(r.id)})]},r.id)):fe.jsx("p",{children:"Loading..."})})]})};function C8({cloudName:n,uploadPreset:e,folder:t,sources:i,multiple:r,maxFiles:s,cropping:o}){const a=de.useRef(null),l=de.useRef(null);return de.useEffect(()=>{a.current=window.cloudinary,a.current&&(l.current=a.current.createUploadWidget({cloudName:n,uploadPreset:e,folder:t,sources:i,multiple:r,maxFiles:s,cropping:o},(u,c)=>{if(u){console.error("Upload error:",u.message);return}(c==null?void 0:c.event)==="success"&&console.log("Upload URL:",c.info.secure_url)}))},[n,e,t,i,r,s,o]),fe.jsx("button",{onClick:()=>{var u;return(u=l.current)==null?void 0:u.open()},children:"Upload Images"})}function vDe(){const[n,e]=de.useState(null);return de.useEffect(()=>{const t=qw(af,e);return()=>t()},[]),fe.jsxs(fe.Fragment,{children:[fe.jsx("div",{className:"admin-header",children:fe.jsxs("section",{className:"top-header",children:[fe.jsx("h1",{children:"Admin Macro"}),fe.jsx(_o,{to:"/admin",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Admin"})}),fe.jsx(_o,{to:"/",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Main DfD"})})]})}),n?fe.jsxs(fe.Fragment,{children:[fe.jsx(C8,{cloudName:"dtlj6wzki",uploadPreset:"gggggug",folder:"Macro"}),fe.jsx(T8,{blockPath:"blocks/macro/"})," "]}):fe.jsx("p",{children:" Please sign in to access this page. "})]})}function yDe(){const[n,e]=de.useState(null);return de.useEffect(()=>{const t=qw(af,e);return()=>t()},[]),fe.jsxs(fe.Fragment,{children:[fe.jsx("div",{className:"admin-header",children:fe.jsxs("section",{className:"top-header",children:[fe.jsx("h1",{children:"Admin Meso"}),fe.jsx(_o,{to:"/admin",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Admin"})}),fe.jsx(_o,{to:"/",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Main DfD"})})]})}),n?fe.jsxs(fe.Fragment,{children:[fe.jsx(C8,{cloudName:"dtlj6wzki",uploadPreset:"gggggug",folder:"Meso"}),fe.jsx(T8,{blockPath:"blocks/meso/"})," "]}):fe.jsx("p",{children:" Please sign in to access this page. "})]})}function _De(){const[n,e]=de.useState(null);return de.useEffect(()=>{const t=qw(af,e);return()=>t()},[]),fe.jsxs(fe.Fragment,{children:[fe.jsx("div",{className:"admin-header",children:fe.jsxs("section",{className:"top-header",children:[fe.jsx("h1",{children:"Admin Micro"}),fe.jsx(_o,{to:"/admin",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Admin"})}),fe.jsx(_o,{to:"/",className:"custom-link",children:fe.jsx("h2",{children:"Go back to Main DfD"})})]})}),n?fe.jsxs(fe.Fragment,{children:[fe.jsx(C8,{cloudName:"dtlj6wzki",uploadPreset:"gggggug",folder:"Micro"}),fe.jsx(T8,{blockPath:"blocks/micro/"})," "]}):fe.jsx("p",{children:" Please sign in to access this page. "})]})}function xDe(){const n=MP(),[e,t]=de.useState(""),[i,r]=de.useState(""),[s,o]=de.useState("");de.useEffect(()=>{async function l(){try{const u=await SY();t(String(u))}catch(u){console.error("Error fetching DFD code:",u)}}l()},[]);async function a(l){l.preventDefault();const u=l.currentTarget,c=u.email.value,h=u.password.value;if(u.code.value.trim()!==e){o("Invalid code. Please try again.");return}try{await a8e(c,h)?n("/admin"):o("Failed to sign in. Please check your credentials.")}catch(v){console.error(v),o("Failed to sign in. Please check your credentials.")}}return fe.jsxs("div",{className:"container",children:[fe.jsx("h1",{className:"title",children:"Sign In"}),fe.jsxs("form",{onSubmit:a,className:"form",children:[fe.jsx("label",{className:"label",children:"Email:"}),fe.jsx("input",{name:"email",type:"email",placeholder:"Enter your email",className:"input"}),fe.jsx("br",{}),fe.jsx("label",{className:"label",children:"Password:"}),fe.jsx("input",{name:"password",type:"password",placeholder:"Enter your password",className:"input"}),fe.jsx("br",{}),s&&fe.jsx("p",{className:"error",children:s}),fe.jsx("label",{className:"label",children:"Six-Digit DFD Code:"}),fe.jsx("input",{name:"code",type:"text",placeholder:"Enter six-digit code",value:i,onChange:l=>r(l.target.value),className:"input"}),fe.jsx("br",{}),fe.jsx("button",{type:"submit",className:"button",children:"Sign In"})]})]})}function bDe(){const n=MP(),[e,t]=de.useState(""),[i,r]=de.useState(""),[s,o]=de.useState(""),[a,l]=de.useState(""),[u,c]=de.useState("");de.useEffect(()=>{async function A(){try{const v=await SY();t(String(v))}catch(v){console.error("Error fetching DFD code:",v)}}A()},[]);async function h(A){A.preventDefault();const v=A.currentTarget,_=v.email.value,S=v.password.value,w=v.confirmPassword.value,x=v.code.value.trim();if(S!==w){c("Passwords do not match.");return}if(x!==e){c("Invalid code. Please try again.");return}try{await o8e(_,S)&&n("/admin")}catch(M){console.error(M)}}return fe.jsxs("div",{className:"container",children:[fe.jsx("h1",{className:"title",children:"Sign Up"}),fe.jsxs("form",{onSubmit:h,className:"form",children:[fe.jsx("label",{className:"label",children:"Email:"}),fe.jsx("input",{name:"email",type:"email",placeholder:"Enter your email",className:"input"}),fe.jsx("br",{}),fe.jsx("label",{className:"label",children:"Password:"}),fe.jsx("input",{name:"password",type:"password",placeholder:"Enter your password",value:s,onChange:A=>o(A.target.value),className:"input"}),fe.jsx("br",{}),fe.jsx("label",{className:"label",children:"Confirm Password:"}),fe.jsx("input",{name:"confirmPassword",type:"password",placeholder:"Confirm your password",value:a,onChange:A=>l(A.target.value),className:"input"}),fe.jsx("br",{}),u&&fe.jsx("p",{className:"error",children:u}),fe.jsx("label",{className:"label",children:"Six-Digit DFD Code:"}),fe.jsx("input",{name:"code",type:"text",placeholder:"Enter six-digit code",value:i,onChange:A=>r(A.target.value),className:"input"}),fe.jsx("br",{}),fe.jsx("button",{type:"submit",className:"button",children:"Sign Up"})]})]})}function SDe(){return fe.jsx("div",{children:fe.jsx("h1",{children:"Contact"})})}function wDe(){return fe.jsx("div",{children:fe.jsx("h1",{children:"References"})})}function EDe(){return fe.jsx("div",{children:fe.jsx("h1",{children:"Unit Overview"})})}const TDe=()=>fe.jsx(Dte,{children:fe.jsxs(ute,{children:[fe.jsx(Ja,{path:"/",element:fe.jsx(PTe,{})}),fe.jsx(Ja,{path:"/admin",element:fe.jsx(u8e,{})}),fe.jsx(Ja,{path:"/admin/macro",element:fe.jsx(vDe,{})}),fe.jsx(Ja,{path:"/admin/meso",element:fe.jsx(yDe,{})}),fe.jsx(Ja,{path:"/admin/micro",element:fe.jsx(_De,{})}),fe.jsx(Ja,{path:"/admin/sign-in",element:fe.jsx(xDe,{})}),fe.jsx(Ja,{path:"/admin/sign-up",element:fe.jsx(bDe,{})}),fe.jsx(Ja,{path:"/contact",element:fe.jsx(SDe,{})}),fe.jsx(Ja,{path:"/references",element:fe.jsx(wDe,{})}),fe.jsx(Ja,{path:"/unit-overview",element:fe.jsx(EDe,{})})]})}),CDe=()=>fe.jsx("div",{children:fe.jsx(TDe,{})});Gz(document.getElementById("root")).render(fe.jsx(de.StrictMode,{children:fe.jsx(CDe,{})}));export{uIe as I,cIe as a,fe as j,de as r};
